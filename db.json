{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"themes/matery/source/favicon.jpg","path":"favicon.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/css/gitment.css","path":"css/gitment.css","modified":0,"renderable":1},{"_id":"themes/matery/source/css/matery.css","path":"css/matery.css","modified":0,"renderable":1},{"_id":"themes/matery/source/css/my-gitalk.css","path":"css/my-gitalk.css","modified":0,"renderable":1},{"_id":"themes/matery/source/css/my.css","path":"css/my.css","modified":0,"renderable":1},{"_id":"themes/matery/source/js/search.js","path":"js/search.js","modified":0,"renderable":1},{"_id":"themes/matery/source/js/matery.js","path":"js/matery.js","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/avatar.jpg","path":"medias/avatar.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/animate/animate.min.css","path":"libs/animate/animate.min.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/aos/aos.js","path":"libs/aos/aos.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/aplayer/APlayer.min.css","path":"libs/aplayer/APlayer.min.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/cryptojs/crypto-js.min.js","path":"libs/cryptojs/crypto-js.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/dplayer/DPlayer.min.css","path":"libs/dplayer/DPlayer.min.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/gitalk/gitalk.css","path":"libs/gitalk/gitalk.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/gitment/gitment-default.css","path":"libs/gitment/gitment-default.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/jqcloud/jqcloud-1.0.4.min.js","path":"libs/jqcloud/jqcloud-1.0.4.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/jqcloud/jqcloud.css","path":"libs/jqcloud/jqcloud.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/masonry/masonry.pkgd.min.js","path":"libs/masonry/masonry.pkgd.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/others/busuanzi.pure.mini.js","path":"libs/others/busuanzi.pure.mini.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/others/clicklove.js","path":"libs/others/clicklove.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/scrollprogress/scrollProgress.min.js","path":"libs/scrollprogress/scrollProgress.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/tocbot/tocbot.css","path":"libs/tocbot/tocbot.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/tocbot/tocbot.min.js","path":"libs/tocbot/tocbot.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/cover.jpg","path":"medias/cover.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/logo.png","path":"medias/logo.png","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/reward/alipay.jpg","path":"medias/reward/alipay.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/aos/aos.css","path":"libs/aos/aos.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/jquery/jquery-2.2.0.min.js","path":"libs/jquery/jquery-2.2.0.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/valine/Valine.min.js","path":"libs/valine/Valine.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/reward/wechat.jpg","path":"medias/reward/wechat.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/aplayer/APlayer.min.js","path":"libs/aplayer/APlayer.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/css/font-awesome.min.css","path":"libs/awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/gitment/gitment.js","path":"libs/gitment/gitment.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/css/lightgallery.min.css","path":"libs/lightGallery/css/lightgallery.min.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.eot","path":"libs/lightGallery/fonts/lg.eot","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.svg","path":"libs/lightGallery/fonts/lg.svg","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.ttf","path":"libs/lightGallery/fonts/lg.ttf","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.woff","path":"libs/lightGallery/fonts/lg.woff","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/img/loading.gif","path":"libs/lightGallery/img/loading.gif","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/img/video-play.png","path":"libs/lightGallery/img/video-play.png","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/img/vimeo-play.png","path":"libs/lightGallery/img/vimeo-play.png","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/img/youtube-play.png","path":"libs/lightGallery/img/youtube-play.png","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/js/lightgallery-all.min.js","path":"libs/lightGallery/js/lightgallery-all.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/materialize/materialize.min.css","path":"libs/materialize/materialize.min.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/share/css/share.min.css","path":"libs/share/css/share.min.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/share/fonts/iconfont.eot","path":"libs/share/fonts/iconfont.eot","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/share/fonts/iconfont.svg","path":"libs/share/fonts/iconfont.svg","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/share/fonts/iconfont.ttf","path":"libs/share/fonts/iconfont.ttf","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/share/fonts/iconfont.woff","path":"libs/share/fonts/iconfont.woff","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/share/js/jquery.share.min.js","path":"libs/share/js/jquery.share.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/share/js/social-share.min.js","path":"libs/share/js/social-share.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/2.jpg","path":"medias/banner/2.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/photo/2.jpg","path":"medias/photo/2.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/fonts/fontawesome-webfont.woff","path":"libs/awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/fonts/fontawesome-webfont.woff2","path":"libs/awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/dplayer/DPlayer.min.js","path":"libs/dplayer/DPlayer.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/gitalk/gitalk.min.js","path":"libs/gitalk/gitalk.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/fonts/fontawesome-webfont.eot","path":"libs/awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/fonts/fontawesome-webfont.ttf","path":"libs/awesome/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/valine/av-min.js","path":"libs/valine/av-min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/fonts/FontAwesome.otf","path":"libs/awesome/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/materialize/materialize.min.js","path":"libs/materialize/materialize.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/0.jpg","path":"medias/banner/0.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/fonts/fontawesome-webfont.svg","path":"libs/awesome/fonts/fontawesome-webfont.svg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/6.jpg","path":"medias/banner/6.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/photo/6.jpg","path":"medias/photo/6.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/echarts/echarts.min.js","path":"libs/echarts/echarts.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/photo/5.jpg","path":"medias/photo/5.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/5.jpg","path":"medias/banner/5.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/photo/3.jpg","path":"medias/photo/3.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/3.jpg","path":"medias/banner/3.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/4.jpg","path":"medias/banner/4.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/photo/1.jpg","path":"medias/photo/1.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/1.jpg","path":"medias/banner/1.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/music/LeavingAkina.mp3","path":"medias/music/LeavingAkina.mp3","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/music/wecantstop.mp3","path":"medias/music/wecantstop.mp3","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/photo/0.jpg","path":"medias/photo/0.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/8.jpg","path":"medias/banner/8.jpg","modified":0,"renderable":1}],"Cache":[{"_id":"source/404.md","hash":"9e6f55d7c01343e1ffd36d55860587fd269d6cb6","modified":1582541381282},{"_id":"source/CNAME","hash":"64f12ba4fc85e919e927bf1750221800453187cd","modified":1582541381282},{"_id":"source/friends.json","hash":"ed2bc844047e1dde553d4b3a1910b8f736f7417e","modified":1582541381451},{"_id":"themes/matery/LICENSE","hash":"7df059597099bb7dcf25d2a9aedfaf4465f72d8d","modified":1582541381452},{"_id":"themes/matery/README.md","hash":"c46e2a112951e49af60ad6ad7a2893738e3e413d","modified":1582541381452},{"_id":"themes/matery/README_CN.md","hash":"302393db1fa6c0911558402ab8c75745516fa5ed","modified":1582541381453},{"_id":"themes/matery/_config.yml","hash":"7d4a1432a416fced7fe9b46707330139961c62bc","modified":1582541381453},{"_id":"source/_bbs/index.md","hash":"eb40bcb5ee1e5741f25463f7791ea1d288b51811","modified":1582541381283},{"_id":"source/_data/friends.json","hash":"a504fe2f7e2c013c06d443bf8b6b8c3b520c1a17","modified":1582541381283},{"_id":"source/_data/musics.json","hash":"66260ade69d134f872dffb45754b2700f961ae44","modified":1582541381283},{"_id":"source/categories/index.md","hash":"444b7cf46adaad3f5f898cf928c8b8d2a81739ad","modified":1582541381451},{"_id":"source/_posts/2020.md","hash":"bd634091fbfcf1f345d0dd9416099a4ec7be5f0b","modified":1582541381283},{"_id":"source/_posts/About-Proxy.md","hash":"d1bb9cd4b5e6a057781e6a949f988d844b880aa3","modified":1582541381283},{"_id":"source/_posts/Anaconda.md","hash":"2953b02f273e387a1e77df09c9ba5ab59c76be58","modified":1582541381288},{"_id":"source/_posts/Arch-Linux.md","hash":"f5121f550ceba721935fa65ad706be36a9943fef","modified":1582541381294},{"_id":"source/_posts/Bilibili-Evolved.md","hash":"57c9c2b764b779330eec9581eb9829d70ecbcbf8","modified":1582541381321},{"_id":"source/_posts/Day14.md","hash":"c8ae697528aefcb5b055c776d904daa55db39c18","modified":1582541381327},{"_id":"source/_posts/Digital-Image-Processing.md","hash":"4bf9587f197fb627dc991cea9e2950c0fd652e17","modified":1582541381327},{"_id":"source/_posts/Enjoy-PyTorch-Task1.md","hash":"3b72589634410752f15e0cf7071e8a18bb0b55d8","modified":1582541381327},{"_id":"source/_posts/Enjoy-PyTorch.md","hash":"835b9baddb4096a1445b6dcabde810324c69c6d0","modified":1582541381328},{"_id":"source/_posts/Face-Detection.md","hash":"5737a86f0f0ef4aea87d285f4eb444be3afa57b1","modified":1582541381330},{"_id":"source/_posts/Face-Recognition-with-OpenCV.md","hash":"79e7f8df55d076862fb1321359cdc3d58c73260a","modified":1582541381331},{"_id":"source/_posts/Git-Github.md","hash":"52253275c123ec12148f42fe754973ac1cc7e70e","modified":1582541381357},{"_id":"source/_posts/High-quality-ellipse-detection.md","hash":"3e5078c22a4b505fe616ceb501ec06756dfb8185","modified":1582541381358},{"_id":"source/_posts/Horner-s-Method.md","hash":"eeacf73cc1528d1a87d9cdb8566ae623e8523f15","modified":1582541381358},{"_id":"source/_posts/How-to-install-OpenCV-and-OpenCV-contrib-in-Ubuntu16-04.md","hash":"99c915da9382bb2dba23a263df8e7fcd61b1f7b5","modified":1582541381358},{"_id":"source/_posts/Local-Binary-Patterns.md","hash":"f6a7e8be965efc59409a9edfec1deb0489f2beee","modified":1582541381358},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇.md","hash":"61fbba3cc499f9e5a9fa7f50a549921a3b8a6004","modified":1582541381359},{"_id":"source/_posts/Markdown数学公式汇总.md","hash":"b741359fb55990314378f480d74aa6abc2d46ff2","modified":1582541381377},{"_id":"source/_posts/My-Vim-Config.md","hash":"d6e343501374654a1713dd0596c9b3d983df7ffe","modified":1582541381378},{"_id":"source/_posts/My-plan.md","hash":"da98d422d3a4e007729258a537a7a8a881cea80b","modified":1582541381378},{"_id":"source/_posts/OpenCV入坑指南-环境搭建篇.md","hash":"fbd8e8fc1cb7f849705bc895ab1e79640147be1b","modified":1583149966371},{"_id":"source/_posts/PCA原理分析.md","hash":"6b032c5805a58940fa3656a9902a3b6c93cc50bb","modified":1582541381378},{"_id":"source/_posts/PCA算法实现.md","hash":"ffb3d66cface0ef7dc2c10745e19fd089733a04c","modified":1582541381418},{"_id":"source/_posts/SORT.md","hash":"c56aabf38e2de6ee75e6ba96faa8d1f60a176d40","modified":1582541381424},{"_id":"source/_posts/Vim.md","hash":"ae4e56bf0b26ecdc83aa88aab887eb0262c36393","modified":1582541381437},{"_id":"source/_posts/hexo大坑.md","hash":"73188610796307e3e5505cac981684d40cd977d7","modified":1582541381449},{"_id":"source/_posts/ranger.md","hash":"5534a453388240ad1405f4ef241ef571c8faae1b","modified":1582541381449},{"_id":"source/_posts/图像分割.md","hash":"b0130b84b63cc9b0fe6d9bd69f3cbc4b2d523914","modified":1582541381449},{"_id":"source/_posts/图形绘制.md","hash":"9e082a93bfbe0d324e363ef013f34c7f2f4b478c","modified":1582541381449},{"_id":"source/_posts/圆形检测.md","hash":"63544420f3471e54cb957ebeff8e11d840857257","modified":1582541381450},{"_id":"source/_posts/形态学图像处理.md","hash":"1731f13e807564ad657f717329015e7402b81b8a","modified":1582541381450},{"_id":"source/_posts/空间滤波.md","hash":"8bf8dcf5d291523e0d4cbd8c5d9cfd22683bc42c","modified":1582541381450},{"_id":"source/_posts/霍夫变换.md","hash":"1b46c5456f78418c19f2661c7d535e39c4beaf96","modified":1582541381450},{"_id":"source/_posts/频域滤波.md","hash":"4df842286096efd208fd8d7a653f11deb27a434f","modified":1582541381450},{"_id":"source/_posts/频域滤波器及其应用.md","hash":"5e8007e993ff035c8f0e31b5c265e36ca7abca6f","modified":1582541381451},{"_id":"source/about/index.md","hash":"863e56477447bb1ac8c24c61acf01ced2d955a54","modified":1582541381451},{"_id":"source/friends/index.md","hash":"067eda63e1207b3f40d36a17f4c9c77bcba1db0b","modified":1582541381451},{"_id":"source/tags/index.md","hash":"9bea216a33b3e5b31ee760ba18e1f390070a4933","modified":1582541381451},{"_id":"themes/matery/languages/default.yml","hash":"0dabf7ed059bfe20561288c2e178f0640d9a0b3b","modified":1582541381453},{"_id":"themes/matery/languages/zh-CN.yml","hash":"a34ae486c288a4966c5968abc29d3f40207d6d2f","modified":1582541381453},{"_id":"themes/matery/layout/404.ejs","hash":"03952ff773d83a5b418a5d3a80d05871097bf29e","modified":1582541381454},{"_id":"themes/matery/layout/about.ejs","hash":"ee639d0310867976b3e5fb9f92c215a17a433703","modified":1582541381458},{"_id":"themes/matery/layout/archive.ejs","hash":"aef83631460e091af8130cf3f9614477ee24914f","modified":1582541381458},{"_id":"themes/matery/layout/bbs.ejs","hash":"21ca6d5ff2bb98cc95c996bfb0a479bfea31a23c","modified":1582541381459},{"_id":"themes/matery/layout/categories.ejs","hash":"8e54665cc25d7c333da7d9f312987190be6215da","modified":1582541381459},{"_id":"themes/matery/layout/category.ejs","hash":"dff72c3a6f3ec6022886e526e6c404e8a0e630bf","modified":1582541381459},{"_id":"themes/matery/layout/friends.ejs","hash":"1c08e2257a756d7ce40eedfdb80e642fbd5215ed","modified":1582541381459},{"_id":"themes/matery/layout/index.ejs","hash":"57ab845a407baad6e6cc573b2c32b2dbcc972258","modified":1582541381459},{"_id":"themes/matery/layout/layout.ejs","hash":"10f20cf017af6f46c035e5f7080fa4b70a9dd239","modified":1582541381459},{"_id":"themes/matery/layout/post.ejs","hash":"37c6888af845cfa4204b6f490d332442d0db3656","modified":1582541381459},{"_id":"themes/matery/layout/tag.ejs","hash":"4305eeeb3434c24ba2493fa08d1f1bd9f2efa9aa","modified":1582541381459},{"_id":"themes/matery/layout/tags.ejs","hash":"cf9517aa6a0111355121f44615d6923e312283c7","modified":1582541381459},{"_id":"themes/matery/source/favicon.jpg","hash":"f78e544a4aa6ec66ea8d25b18ea220880580b126","modified":1582541381461},{"_id":"source/_posts/About-Proxy/2.png","hash":"c5fee3c7cfbc53e158191fbe9f634c8ee72b6df4","modified":1582541381285},{"_id":"source/_posts/About-Proxy/6.png","hash":"77e0945934e4065c8e6866479d09e0cdb9782801","modified":1582541381287},{"_id":"source/_posts/About-Proxy/7.png","hash":"54c9527c0cc38c9e925408a522c486d8f504a705","modified":1582541381287},{"_id":"source/_posts/About-Proxy/8.png","hash":"c995a86890279a773f1ed1745ec087ac933d5737","modified":1582541381287},{"_id":"source/_posts/Anaconda/0.jpeg","hash":"731484d90acf9f3fd59b0a5b2f27f21ec284bde6","modified":1582541381288},{"_id":"source/_posts/Anaconda/00.jpg","hash":"0fde2f7ae07bd2e5188fa74fd48fa00a84bce687","modified":1582541381289},{"_id":"source/_posts/Anaconda/1.png","hash":"4d5a6a0b4788a885a2b5df788080e035ecf05a46","modified":1582541381289},{"_id":"source/_posts/Anaconda/10.png","hash":"e1ed1e229b61fcc3838cabbf2773e2bfb7d71951","modified":1582541381289},{"_id":"source/_posts/Anaconda/2.png","hash":"07a14ac83a30e95ccc682709f030984403d5d367","modified":1582541381290},{"_id":"source/_posts/Anaconda/6.png","hash":"ea1c686f1cf988d566ef64093c0af64cd01c2d93","modified":1582541381293},{"_id":"source/_posts/Anaconda/5.png","hash":"04c0025e3ccdf19cd32220e47fc502cc6ac06d7c","modified":1582541381293},{"_id":"source/_posts/Anaconda/8.png","hash":"20e04e03665ca1a0386eb992fb256bdf7f7fdf7b","modified":1582541381294},{"_id":"source/_posts/Anaconda/9.png","hash":"a47985d996c54567c05384a0b385427c78a931b0","modified":1582541381294},{"_id":"source/_posts/Arch-Linux/10.png","hash":"9d09fb65423dd01f766a18189211f2be954b3938","modified":1582541381296},{"_id":"source/_posts/Arch-Linux/11.png","hash":"af21a5ea6f5667c5bc9dd5278622c5b61316c176","modified":1582541381297},{"_id":"source/_posts/Arch-Linux/12.png","hash":"b7dcb082d48082b0988dde64f09486408f58f095","modified":1582541381298},{"_id":"source/_posts/Arch-Linux/2.png","hash":"c6922ea6d2a61c14fca329ccc86e0a500fc36ff7","modified":1582541381299},{"_id":"source/_posts/Arch-Linux/5.png","hash":"4f1f00d559d98aa9200a0f2f581da5232f77e579","modified":1582541381301},{"_id":"source/_posts/Arch-Linux/7.png","hash":"58e508a4331d903e92dd08e7d66935b42c9c81ed","modified":1582541381302},{"_id":"source/_posts/Arch-Linux/8.png","hash":"5a0b1a47649f0bb26e935d844e5098f24eeaaadf","modified":1582541381303},{"_id":"source/_posts/Arch-Linux/9.png","hash":"38ac4551d75cb4bd58e4d5670401dc2a8dec245a","modified":1582541381303},{"_id":"source/_posts/Arch-Linux/albert.png","hash":"ed031ad73d16735f3d737ef2db55e5d3848bbf6d","modified":1582541381304},{"_id":"source/_posts/Bilibili-Evolved/0.svg","hash":"aeb42106337f7542b7c620dfeec53e07f12149d9","modified":1582541381321},{"_id":"source/_posts/Bilibili-Evolved/5.png","hash":"5f1b44939635c9d8ac6844dc1251fb2137577b94","modified":1582541381326},{"_id":"source/_posts/Enjoy-PyTorch/1.png","hash":"27216299db2dde24c97eb5c79b56beab42cf36b9","modified":1582541381328},{"_id":"source/_posts/Enjoy-PyTorch-Task1/1.png","hash":"62b8d8e55ec4e7985bd78c520aabf90ba84c9ec9","modified":1582541381327},{"_id":"source/_posts/Face-Recognition-with-OpenCV/2.png","hash":"86fe9273c1a12a9ee29434fd4b52076924c59217","modified":1582541381332},{"_id":"source/_posts/Face-Recognition-with-OpenCV/1.png","hash":"b99f2ff35370b03d14ef9a6f2a3dbfa87a6fad71","modified":1582541381332},{"_id":"source/_posts/Face-Recognition-with-OpenCV/5.png","hash":"59127cfb6ef84f22567f03816911317b1bc9c9a7","modified":1582541381335},{"_id":"source/_posts/Face-Recognition-with-OpenCV/6.png","hash":"1b321511a5e298c4d7976d826d1f4c93b961be8d","modified":1582541381335},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/1.png","hash":"8d85248771c37969ffae14603632e2936ba7fe33","modified":1582541381359},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/13.png","hash":"5744c5f4ba1707114dd8a3b7781ff4f19c6a0d16","modified":1582541381364},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/14.png","hash":"6b7ebd185a1a99e331c62f48b04160c762f26184","modified":1582541381364},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/18.png","hash":"4a6e2c7e1d646f1a345758bc6f43607621ab23fc","modified":1582541381369},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/2.png","hash":"0610d99a3ed7a01824a4edeb427972784b9ed206","modified":1582541381370},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/20.png","hash":"9b20d3e64540c37880c53d4c1e23e896f1f1212a","modified":1582541381370},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/3.png","hash":"58dba86fdcb1c2939e4691ec247c0f42b6487744","modified":1582541381371},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/4.png","hash":"74351b762dcf51ca05e06321086a79e181255668","modified":1582541381371},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/6.png","hash":"1b49e77c79e9bc683fc725dc3a0bd18ac22c0bc2","modified":1582541381372},{"_id":"source/_posts/PCA原理分析/01.png","hash":"8589b73b17a5b40615619ba7f8d76420315fa53d","modified":1582541381380},{"_id":"source/_posts/PCA原理分析/02.png","hash":"03f787abd87e8ac5c51ef9951da4c0dbc360d4c5","modified":1582541381380},{"_id":"source/_posts/PCA原理分析/03.png","hash":"6cc32153244ba33af752159cb71ff7a0ac417d06","modified":1582541381380},{"_id":"source/_posts/PCA原理分析/05.png","hash":"1acd87f837814fb46cfaa0b029445caa57fc9c12","modified":1582541381381},{"_id":"source/_posts/PCA原理分析/06.png","hash":"b4dce1b49516ac0527c9e1423c0d30138b345efd","modified":1582541381381},{"_id":"source/_posts/PCA原理分析/07.png","hash":"3accf1b5326def91e3698dd848bf5049a9e79094","modified":1582541381382},{"_id":"source/_posts/PCA算法实现/02.png","hash":"3accf1b5326def91e3698dd848bf5049a9e79094","modified":1582541381424},{"_id":"source/_posts/Vim/0.jpg","hash":"3a3031b9df01700e5ca76d0e3dfc5db53cf8fd5b","modified":1582541381438},{"_id":"source/_posts/Vim/colemak.png","hash":"cc10956b035b48ed48487a45654dbe92c0a96fe0","modified":1582541381438},{"_id":"themes/matery/layout/_partial/back-top.ejs","hash":"8c91d2088c9bb323246b054d4940bde6cead6828","modified":1582541381454},{"_id":"themes/matery/layout/_partial/bg-cover-content.ejs","hash":"04e11ad052befe3e7fe0ce86bf67db95c11cb762","modified":1582541381454},{"_id":"themes/matery/layout/_partial/bg-cover.ejs","hash":"02191109712f61c0e487b8f0b8466597181a9004","modified":1582541381454},{"_id":"themes/matery/layout/_partial/disqus.ejs","hash":"a0f53d1a9b579d52e52ccad8c6e330bf3b89547e","modified":1582541381454},{"_id":"themes/matery/layout/_partial/footer.ejs","hash":"bddb924c4be02e92a625a1545972f4e8ff3efb4c","modified":1582541381454},{"_id":"themes/matery/layout/_partial/gitalk.ejs","hash":"e4c5bf28ddc29519eee8debe79cce45bf279adeb","modified":1582541381454},{"_id":"themes/matery/layout/_partial/github-link.ejs","hash":"3aeb581bd78ab8e15b858e4c44c03bcf92f20b9e","modified":1582541381454},{"_id":"themes/matery/layout/_partial/gitment.ejs","hash":"0abfb51dc80ad063fb2118bee28de6bb8d99ed4e","modified":1582541381455},{"_id":"themes/matery/layout/_partial/google-analytics.ejs","hash":"5f4992205617da5f8cc5863c62b5ec46e414e2fb","modified":1582541381455},{"_id":"themes/matery/layout/_partial/head.ejs","hash":"1f337fe1343f87fc958eded799a9ac93fc194e87","modified":1582541381455},{"_id":"themes/matery/layout/_partial/header.ejs","hash":"e253c813b3ee5ed924700a95133741802e58adc5","modified":1582541381455},{"_id":"themes/matery/layout/_partial/index-cover.ejs","hash":"6583c00323d891a03343b6a621a0484a68d74f8a","modified":1582541381455},{"_id":"themes/matery/layout/_partial/livere.ejs","hash":"9c3401b42ea7f26410a5593bae93ada7e57b43be","modified":1582541381455},{"_id":"themes/matery/layout/_partial/mobile-nav.ejs","hash":"b70a2d40677d64d6b56fc51ac1331ad3a50e777c","modified":1582541381455},{"_id":"themes/matery/layout/_partial/navigation.ejs","hash":"20216e7ad6b48d4a4f8d11d6881e667e5186820f","modified":1582541381455},{"_id":"themes/matery/layout/_partial/paging.ejs","hash":"68a24cad2b2049c4dc3a250aa30bf4256f9e50cb","modified":1582541381455},{"_id":"themes/matery/layout/_partial/post-cover.ejs","hash":"5b423384b9c0fe77acc4247a8a85304022e5bd2a","modified":1582541381456},{"_id":"themes/matery/layout/_partial/post-detail-toc.ejs","hash":"d4114c22126704cc1754d6d28cb00aec020b428b","modified":1582541381456},{"_id":"themes/matery/layout/_partial/post-detail.ejs","hash":"f06a29c00cd58fe8159e7b1e7a5ea8277b97f25b","modified":1582541381456},{"_id":"themes/matery/layout/_partial/post-statis.ejs","hash":"2b2fe8e8e94e65c52a4dbd454168e9b9df6baf10","modified":1582541381456},{"_id":"themes/matery/layout/_partial/prev-next.ejs","hash":"30b51f344d6ab2856dfe2393e2a32556eb54bb10","modified":1582541381456},{"_id":"themes/matery/layout/_partial/reprint-statement.ejs","hash":"3d61d4acde8d27a63072145130d2661df8c05df7","modified":1582541381456},{"_id":"themes/matery/layout/_partial/reward.ejs","hash":"3dff4f6a73973b0b32f40604244255f3c2a5bb78","modified":1582541381456},{"_id":"themes/matery/layout/_partial/search.ejs","hash":"942609b9240d5c8c09b24562fc8fb31eabe1cae4","modified":1582541381456},{"_id":"themes/matery/layout/_partial/share.ejs","hash":"34f8e4250bb66012026aa50686a7c89a0414ca1b","modified":1582541381456},{"_id":"themes/matery/layout/_partial/social-link.ejs","hash":"62e10bf4577946190e9c31dcdc2799a4ad1d00dd","modified":1582541381457},{"_id":"themes/matery/layout/_partial/valine.ejs","hash":"90527186fc8ed906eb1f20b59bc7f86caab9087b","modified":1582541381457},{"_id":"themes/matery/layout/_widget/category-cloud.ejs","hash":"a5a10d6fa66a389d0253d7a52e0a646af6e8e9be","modified":1582541381457},{"_id":"themes/matery/layout/_widget/category-radar.ejs","hash":"f5561dd7d53d68897a33090bf677719213459b19","modified":1582541381457},{"_id":"themes/matery/layout/_widget/dream.ejs","hash":"684450f0b42f89ab70370c5248b34e55b7adf6fc","modified":1582541381457},{"_id":"themes/matery/layout/_widget/music.ejs","hash":"8eafddbd73fed80e85c66d49837c1a241b087258","modified":1582541381457},{"_id":"themes/matery/layout/_widget/my-gallery.ejs","hash":"f81eb2891bea326908057029e2a063001371ba9b","modified":1582541381457},{"_id":"themes/matery/layout/_widget/my-projects.ejs","hash":"b9bf70ec5d97b0e14bb1b4f60f92db7680be5949","modified":1582541381457},{"_id":"themes/matery/layout/_widget/my-skills.ejs","hash":"bd0edf8dad95b2255890d59fb6d6ed6f2eab9c2f","modified":1582541381458},{"_id":"themes/matery/layout/_widget/post-calendar.ejs","hash":"0b0a3eb6af29bf0d55d535958c44b01c0f18d10d","modified":1582541381458},{"_id":"themes/matery/layout/_widget/post-charts.ejs","hash":"af0604623db37ef800bb7ad48028d18d99efbbc3","modified":1582541381458},{"_id":"themes/matery/layout/_widget/recommend.ejs","hash":"babaa0cb32146870785449c70748721235e4eff0","modified":1582541381458},{"_id":"themes/matery/layout/_widget/tag-cloud.ejs","hash":"a3725f0e3a405acb595b04630a27765b537fb580","modified":1582541381458},{"_id":"themes/matery/layout/_widget/tag-wordcloud.ejs","hash":"cb7a0151cd20e90351e151c22bca9d4c3112f234","modified":1582541381458},{"_id":"themes/matery/layout/_widget/video.ejs","hash":"bda810cc135b52f834f1c1ccf52defccacace714","modified":1582541381458},{"_id":"themes/matery/source/css/gitment.css","hash":"2bd15cc17dca35ac3ecc0acf167a23a1dd362acd","modified":1582541381460},{"_id":"themes/matery/source/css/matery.css","hash":"fd5461b7924e3411ae5689dcc44c9d870df2b702","modified":1582541381460},{"_id":"themes/matery/source/css/my-gitalk.css","hash":"eeda46a83d0db1cc239a9cd27d544faf663f9883","modified":1582541381460},{"_id":"themes/matery/source/css/my.css","hash":"497e50351f7838f8546cac76850a42e7e380a110","modified":1582541381460},{"_id":"themes/matery/source/js/search.js","hash":"499e11786efbb04815b54a1de317cc8606a37555","modified":1582541381461},{"_id":"themes/matery/source/js/matery.js","hash":"92f07106944f5ef7cd72e84bb3534513d00eebe1","modified":1582541381461},{"_id":"themes/matery/source/medias/avatar.jpg","hash":"f78e544a4aa6ec66ea8d25b18ea220880580b126","modified":1582541381488},{"_id":"source/_posts/About-Proxy/4.png","hash":"6adf17c5912b198d9c8e788107dc5d41af9fbe3d","modified":1582541381286},{"_id":"source/_posts/About-Proxy/5.png","hash":"728a7b8537909567f1de895bf2b5c58c66f1dc6f","modified":1582541381286},{"_id":"source/_posts/About-Proxy/1.png","hash":"5ff8baf8e3480c3efe6593ccd2780d913d7b5652","modified":1582541381284},{"_id":"source/_posts/About-Proxy/9.png","hash":"0158cde3b6ee4b6058613215bcb5ef476308e2de","modified":1582541381288},{"_id":"source/_posts/Anaconda/3.png","hash":"18bc4410f213dd3b2095fb2b7250a3bb1d8f5139","modified":1582541381290},{"_id":"source/_posts/Anaconda/7.png","hash":"51116906d1f8734f528c23f87fe988db810eb3bf","modified":1582541381294},{"_id":"source/_posts/Arch-Linux/1.png","hash":"11398b9c0dbeb6754533db34bd6f0a8d01f3d5a8","modified":1582541381296},{"_id":"source/_posts/Arch-Linux/3.png","hash":"59bd77a5b1a3149059e652146bc8490c5990fc3e","modified":1582541381299},{"_id":"source/_posts/Arch-Linux/4.png","hash":"fb75e1db2c27402f8d442d09d92996d72a5f0490","modified":1582541381300},{"_id":"source/_posts/Arch-Linux/6.png","hash":"a29171475409e9a52af969b65de5fffef5460014","modified":1582541381301},{"_id":"source/_posts/Bilibili-Evolved/6.png","hash":"add26a6a44128e11fa03c20300e5660f8f0dc277","modified":1582541381326},{"_id":"source/_posts/Bilibili-Evolved/7.png","hash":"9b2539cd678f93fc7171a8befcb1ee0f730bf472","modified":1582541381327},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/11.png","hash":"21d69575382f3577673a7ba2def20f9ffb93ae81","modified":1582541381363},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/12.png","hash":"5a8fd16cf99511f6a9c66f597a3abfcbf4a01355","modified":1582541381363},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/15.png","hash":"ca5521897aceb2bbf5e8273ec9c85dc2cfc7168f","modified":1582541381365},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/5.png","hash":"8f9d79c85f6424a7985ddb91c43f01ff228a0538","modified":1582541381372},{"_id":"source/_posts/Anaconda/4.png","hash":"be0239eac2c67e0472fa2a44720da5ed6f21213c","modified":1582541381292},{"_id":"source/_posts/Bilibili-Evolved/4.png","hash":"4a3d4bd1c725a9a932a71e0ca877003b8469a12f","modified":1582541381325},{"_id":"source/_posts/Face-Recognition-with-OpenCV/7.jpg","hash":"41bf0a58bd66f600dc331adc572685fb8609a99b","modified":1582541381336},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/7.png","hash":"9c161b5ce1ff149de8c02ffed3715745feb09582","modified":1582541381373},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/8.png","hash":"5ab59c39c45f80b8a138351e652625681d5ae8db","modified":1582541381374},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/9.png","hash":"24d857d824887cabd173bb38c139e5193ba356f7","modified":1582541381375},{"_id":"themes/matery/source/libs/animate/animate.min.css","hash":"97afa151569f046b2e01f27c1871646e9cd87caf","modified":1582541381461},{"_id":"themes/matery/source/libs/aos/aos.js","hash":"02bfb40b0c4b6e9b0b4081218357145cbb327d74","modified":1582541381462},{"_id":"themes/matery/source/libs/aplayer/APlayer.min.css","hash":"07372a2ba507388d0fed166d761b1c2c2a659dce","modified":1582541381463},{"_id":"themes/matery/source/libs/cryptojs/crypto-js.min.js","hash":"5989527a378b55011a59522f41eeb3981518325c","modified":1582541381470},{"_id":"themes/matery/source/libs/dplayer/DPlayer.min.css","hash":"f7d19655f873b813ffba5d1a17145c91f82631b8","modified":1582541381471},{"_id":"themes/matery/source/libs/gitalk/gitalk.css","hash":"3aac1db83b0135c521187254ff302d125cc30706","modified":1582541381475},{"_id":"themes/matery/source/libs/gitment/gitment-default.css","hash":"2903c59ee06b965bef32e937bd69f5b0b2190717","modified":1582541381476},{"_id":"themes/matery/source/libs/jqcloud/jqcloud-1.0.4.min.js","hash":"257eaae3020599e4939f50d5008a743827f25b8c","modified":1582541381477},{"_id":"themes/matery/source/libs/jqcloud/jqcloud.css","hash":"20d9f11a19d95c70e27cb922e0d6dccbec4eae89","modified":1582541381477},{"_id":"themes/matery/source/libs/masonry/masonry.pkgd.min.js","hash":"ff940b4ea68368ca0e4d5560cbb79fb147dfc3c5","modified":1582541381483},{"_id":"themes/matery/source/libs/others/busuanzi.pure.mini.js","hash":"6e41f31100ae7eb3a6f23f2c168f6dd56e7f7a9a","modified":1582541381485},{"_id":"themes/matery/source/libs/others/clicklove.js","hash":"6a39b8c683ba5dcd92f70c6ab45d1cfac3213e8e","modified":1582541381485},{"_id":"themes/matery/source/libs/scrollprogress/scrollProgress.min.js","hash":"777ffe5d07e85a14fbe97d846f45ffc0087251cc","modified":1582541381485},{"_id":"themes/matery/source/libs/tocbot/tocbot.css","hash":"15601837bf8557c2fd111e4450ed4c8495fd11a0","modified":1582541381487},{"_id":"themes/matery/source/libs/tocbot/tocbot.min.js","hash":"5ec27317f0270b8cf6b884c6f12025700b9a565c","modified":1582541381487},{"_id":"themes/matery/source/medias/cover.jpg","hash":"d4957ff7cc5e88555cd840f2956ab0561e6f1ccf","modified":1582541381637},{"_id":"themes/matery/source/medias/logo.png","hash":"9125f67111ebf310cf4ab95c00e992f378a24ba6","modified":1582541381639},{"_id":"themes/matery/source/medias/reward/alipay.jpg","hash":"359852e00bf6ffa8985958a987311dedd7e0e22b","modified":1582541381828},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/19.png","hash":"e9b763626294e8d67590305588389e399dfe304a","modified":1582541381370},{"_id":"source/_posts/Vim/vim.gif","hash":"029de04d3ebbcdb1d550f28ac6f981cb4ca58c00","modified":1582541381440},{"_id":"themes/matery/source/libs/aos/aos.css","hash":"191a3705a8f63e589a50a0ff2f2c5559f1a1b6b2","modified":1582541381462},{"_id":"themes/matery/source/libs/jquery/jquery-2.2.0.min.js","hash":"5d7e5bbfa540f0e53bd599e4305e1a4e815b5dd1","modified":1582541381478},{"_id":"themes/matery/source/libs/valine/Valine.min.js","hash":"031c1a5640d64ab3b829395ad5a7596b9fb122e6","modified":1582541381487},{"_id":"themes/matery/source/medias/reward/wechat.jpg","hash":"20f7dc6b4753bec2a6367693ac0900334b8d2209","modified":1582541381829},{"_id":"source/_posts/About-Proxy/3.png","hash":"a8fd5b9cb619289ce436b418133d78735e29403c","modified":1582541381285},{"_id":"source/_posts/Bilibili-Evolved/1.png","hash":"80e4e58fd3839889593550eb9d38548e86ecde00","modified":1582541381322},{"_id":"source/_posts/Bilibili-Evolved/2.png","hash":"dd4a5b7d53ef4b1db5caa0405d9ad7cca2fa8e69","modified":1582541381324},{"_id":"source/_posts/Bilibili-Evolved/3.png","hash":"dffe0b98665e370493280f998c46e5263d2a24cc","modified":1582541381324},{"_id":"themes/matery/source/libs/aplayer/APlayer.min.js","hash":"22caa28ff6b41a16ff40f15d38f1739e22359478","modified":1582541381463},{"_id":"themes/matery/source/libs/awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1582541381464},{"_id":"themes/matery/source/libs/gitment/gitment.js","hash":"28c02c45ce568e084cd1041dc493f83f9c6c88c6","modified":1582541381477},{"_id":"themes/matery/source/libs/lightGallery/css/lightgallery.min.css","hash":"1b7227237f9785c66062a4811508916518e4132c","modified":1582541381479},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.eot","hash":"54caf05a81e33d7bf04f2e420736ce6f1de5f936","modified":1582541381480},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.svg","hash":"9a732790adc004b22022cc60fd5f77ec4c8e3e5a","modified":1582541381480},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.ttf","hash":"f6421c0c397311ae09f9257aa58bcd5e9720f493","modified":1582541381480},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.woff","hash":"3048de344dd5cad4624e0127e58eaae4b576f574","modified":1582541381480},{"_id":"themes/matery/source/libs/lightGallery/img/loading.gif","hash":"15a76af2739482d8de7354abc6d8dc4fca8d145e","modified":1582541381481},{"_id":"themes/matery/source/libs/lightGallery/img/video-play.png","hash":"fbfdbe06aebf7d0c00da175a4810cf888d128f11","modified":1582541381481},{"_id":"themes/matery/source/libs/lightGallery/img/vimeo-play.png","hash":"1142b47de219dddfba2e712cd3189dec0c8b7bee","modified":1582541381481},{"_id":"themes/matery/source/libs/lightGallery/img/youtube-play.png","hash":"39150b45ec5fc03155b7ebeaa44f1829281788e2","modified":1582541381482},{"_id":"themes/matery/source/libs/lightGallery/js/lightgallery-all.min.js","hash":"9f5ef4bc8a0a3c746ca4f3c3e6d64493b1a977d8","modified":1582541381482},{"_id":"themes/matery/source/libs/materialize/materialize.min.css","hash":"80ae4aa0dba3634dd9bf59586d541d2dd8d8191c","modified":1582541381483},{"_id":"themes/matery/source/libs/share/css/share.min.css","hash":"8a778a86f3ce9a042df6be63a9f1039631e351a5","modified":1582541381485},{"_id":"themes/matery/source/libs/share/fonts/iconfont.eot","hash":"00ff749c8e202401190cc98d56087cdda716abe4","modified":1582541381486},{"_id":"themes/matery/source/libs/share/fonts/iconfont.svg","hash":"f0a1b849868a6bf351ff98dc3924a4e7254eb88b","modified":1582541381486},{"_id":"themes/matery/source/libs/share/fonts/iconfont.ttf","hash":"afd898f59d363887418669520b24d175f966a083","modified":1582541381486},{"_id":"themes/matery/source/libs/share/fonts/iconfont.woff","hash":"2e3fce1dcfbd6e2114e7bfbeaf72d3c62e15a1bd","modified":1582541381486},{"_id":"themes/matery/source/libs/share/js/jquery.share.min.js","hash":"16ce82901ca0e302cf47a35fb10f59009a5e7eb9","modified":1582541381486},{"_id":"themes/matery/source/libs/share/js/social-share.min.js","hash":"4df722bafde2c5d8faaace0d1f894798385a8793","modified":1582541381487},{"_id":"themes/matery/source/medias/banner/2.jpg","hash":"8d3c8391ff161eec70f66d69e5545a9468cc52ef","modified":1582541381506},{"_id":"themes/matery/source/medias/photo/2.jpg","hash":"8d3c8391ff161eec70f66d69e5545a9468cc52ef","modified":1582541381806},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/17.png","hash":"d90d3841a1394f7a5822f7aebcf447f95cde03ab","modified":1582541381368},{"_id":"source/_posts/SORT/BUBBLE_SORT.gif","hash":"f6712a2189b0d16173644e3142634cc25b27cd72","modified":1582541381426},{"_id":"source/_posts/SORT/SELECT_SORT.gif","hash":"f39212fc6e2507830393342e216259b1284a5223","modified":1582541381437},{"_id":"themes/matery/source/libs/awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1582541381470},{"_id":"themes/matery/source/libs/awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1582541381470},{"_id":"themes/matery/source/libs/dplayer/DPlayer.min.js","hash":"c3bad7b265574fab0ae4d45867422ea1cb9d6599","modified":1582541381471},{"_id":"themes/matery/source/libs/gitalk/gitalk.min.js","hash":"734f56442e62fe55f677e8ccae7f175445667767","modified":1582541381476},{"_id":"themes/matery/source/libs/awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1582541381466},{"_id":"themes/matery/source/libs/awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1582541381469},{"_id":"themes/matery/source/libs/valine/av-min.js","hash":"2577e72b52b736d99649f9e95be8976d58563333","modified":1582541381488},{"_id":"source/_posts/Face-Recognition-with-OpenCV/4.jpg","hash":"2340b6c5403623064b93f532c86eaffc514cd9eb","modified":1582541381334},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/10.png","hash":"0307de15ac1915c71daa614c7da8deb80c492413","modified":1582541381362},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/paper.jpg","hash":"295d6013a8a18aa31f5a2e93fabe8eed3fcd9f37","modified":1582541381377},{"_id":"source/_posts/SORT/INSERTION_SORT.gif","hash":"6b2fc2ae17627495b509f5b4f3400518da62feb5","modified":1582541381430},{"_id":"source/_posts/SORT/MERGE_SORT.gif","hash":"2335402e8d7c498383680ccb0b582b11786a396d","modified":1582541381434},{"_id":"themes/matery/source/libs/awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1582541381465},{"_id":"themes/matery/source/libs/materialize/materialize.min.js","hash":"c8b4c65651921d888cf5f27430dfe2ad190d35bf","modified":1582541381484},{"_id":"source/_posts/PCA算法实现/01.png","hash":"32e72c36f17cee27412c321469812ef99bc2b0b9","modified":1582541381424},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/16.png","hash":"48abc9d2f4d80b240caf6be1fec8c926a3d3bcd6","modified":1582541381367},{"_id":"themes/matery/source/medias/banner/0.jpg","hash":"c8b89a0b0b8a5b75e24a14e2c5b5eed6242d3170","modified":1582541381491},{"_id":"themes/matery/source/libs/awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1582541381468},{"_id":"source/_posts/Vim/vim_cheat_sheet.png","hash":"474b1b3d5a68b5fa0712904a57bf5e4fa08fc674","modified":1582541381449},{"_id":"themes/matery/source/medias/banner/6.jpg","hash":"04e60da4ae7625da3798052c22bcf1396f0ffc57","modified":1582541381550},{"_id":"themes/matery/source/medias/photo/6.jpg","hash":"04e60da4ae7625da3798052c22bcf1396f0ffc57","modified":1582541381827},{"_id":"source/_posts/Arch-Linux/main.png","hash":"259ecf679cca97d956c77d2bfec4c1da28c188c4","modified":1582541381309},{"_id":"themes/matery/source/libs/echarts/echarts.min.js","hash":"9496f386a0da4601cad22c479cc5543913a4d67f","modified":1582541381475},{"_id":"themes/matery/source/medias/photo/5.jpg","hash":"cea89ba2b56b36e33889ad4676aa1e06c57004ff","modified":1582541381824},{"_id":"themes/matery/source/medias/banner/5.jpg","hash":"cea89ba2b56b36e33889ad4676aa1e06c57004ff","modified":1582541381544},{"_id":"themes/matery/source/medias/photo/3.jpg","hash":"2376fd0a08925906fde4c67ade2cb2c0b853f38b","modified":1582541381817},{"_id":"themes/matery/source/medias/banner/3.jpg","hash":"2376fd0a08925906fde4c67ade2cb2c0b853f38b","modified":1582541381519},{"_id":"themes/matery/source/medias/banner/4.jpg","hash":"0ac255cfb6bbd62e09c15967828262bf450239bb","modified":1582541381533},{"_id":"themes/matery/source/medias/photo/1.jpg","hash":"2f384c9b7dc8a639ab73b7d33014f923c2540b9b","modified":1582541381805},{"_id":"themes/matery/source/medias/banner/1.jpg","hash":"2f384c9b7dc8a639ab73b7d33014f923c2540b9b","modified":1582541381505},{"_id":"source/_posts/Arch-Linux/music.png","hash":"f27b0ba0ce342e0792a792523939768e920bdd4b","modified":1582541381320},{"_id":"themes/matery/source/medias/music/LeavingAkina.mp3","hash":"947133ccfa2d46745b859acce5a7bee974720b98","modified":1582541381659},{"_id":"source/_posts/Face-Recognition-with-OpenCV/att_faces.zip","hash":"6c6d27116725c51910e639009c35117eaa8b0716","modified":1582541381357},{"_id":"source/_posts/PCA原理分析/PCA.pdf","hash":"5346883e784b16b146048413df0c647a518dbcee","modified":1582541381418},{"_id":"themes/matery/source/medias/music/wecantstop.mp3","hash":"ff63acedb5c200f53b7836b7471ea9ea5f8d9a41","modified":1582541381737},{"_id":"themes/matery/source/medias/photo/0.jpg","hash":"2b5dba18c130df5c69bf7c33f1cfef6eb576e789","modified":1582541381793},{"_id":"themes/matery/source/medias/banner/8.jpg","hash":"2b5dba18c130df5c69bf7c33f1cfef6eb576e789","modified":1582541381636},{"_id":"public/friends.json","hash":"3e0a0172ce25c9e003d762b6e2481ccb985e135b","modified":1582542082598},{"_id":"public/atom.xml","hash":"164635992bc1655535c5b46da433075b77668fb3","modified":1582542082601},{"_id":"public/search.xml","hash":"308e8c1b9f6498256b6a32c232c57bb742c0827b","modified":1583149974338},{"_id":"public/404.html","hash":"ee9406a966d71667e3e0d4b096c6785bf99c21b5","modified":1583149976106},{"_id":"public/categories/index.html","hash":"13b78b9d72a519eda1c90e731b364043079093bf","modified":1583149976106},{"_id":"public/about/index.html","hash":"ea834a62a37f50d7af7236630eb513b70d18cd19","modified":1583149976106},{"_id":"public/friends/index.html","hash":"196de784f791346b3aafd0de3d89e5e4fed586a0","modified":1583149976106},{"_id":"public/tags/index.html","hash":"35fba10d7a0cf891f0c04fe01ab09041921bb33d","modified":1583149976106},{"_id":"public/2020/02/04/about-proxy/index.html","hash":"dc0d90dca59dae26c4a885dc9097c6a4ad04c4b1","modified":1583149976106},{"_id":"public/2020/02/02/horner-s-method/index.html","hash":"38ce51a9d337b6b29ec704fd27b3e04be6eaf98c","modified":1583149976106},{"_id":"public/2020/01/29/sort/index.html","hash":"9fa15e773a934425bec5cfdb22f4811f4c295664","modified":1583149976106},{"_id":"public/2020/01/01/2020/index.html","hash":"7a23baa1fcd6c3d3dad4fe7d91ee5195a8bca256","modified":1583149976106},{"_id":"public/2019/12/17/ranger/index.html","hash":"799b86c2524f945de04dc2bf99861e050da3ffd5","modified":1583149976106},{"_id":"public/2019/11/23/vim/index.html","hash":"268323fa051c8d20cb208fc63d76cea107d3a9ac","modified":1583149976106},{"_id":"public/2019/12/06/arch-linux/index.html","hash":"cfdcb2501cae313fee0db4b41323fff82fe09cfb","modified":1583149976106},{"_id":"public/2019/09/21/bilibili-evolved/index.html","hash":"7f2f4204c6e453e9bde5fc90ff0c18249c98c204","modified":1583149976106},{"_id":"public/2019/09/18/git-github/index.html","hash":"ad52d82ea1061b5037738d7f12eef5089750a268","modified":1583149976106},{"_id":"public/2019/09/18/anaconda/index.html","hash":"36bdd1bc138d37b24c0a7cd9f7f8a9171a1d2f2b","modified":1583149976106},{"_id":"public/2019/09/12/my-vim-config/index.html","hash":"667ad1a7d6203c6eba74bb59873c4dcca08a8553","modified":1583149976106},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/index.html","hash":"2c67d0f4ec9c308cf823d08b6de2cca5061c3986","modified":1583149976107},{"_id":"public/2019/08/10/face-recognition-with-opencv/index.html","hash":"8e2781b52a2c6fd7b30edc82d370ea92ddbc42b7","modified":1583149976107},{"_id":"public/2019/08/09/how-to-install-opencv-and-opencv-contrib-in-ubuntu16-04/index.html","hash":"530e6b162ed6c511f6662852cf06241716ffd915","modified":1583149976107},{"_id":"public/2019/08/07/enjoy-pytorch-task1/index.html","hash":"53e6ad59022b527faf4e6dd0afeefe923209a427","modified":1583149976107},{"_id":"public/2019/08/07/enjoy-pytorch/index.html","hash":"9f714e357087edc7ec5a3f8ce37e436d175a8bdb","modified":1583149976107},{"_id":"public/2019/08/07/pca-suan-fa-shi-xian/index.html","hash":"5f29040edd9e34f64b2f8833c51d41beb4af65c9","modified":1583149976107},{"_id":"public/2019/08/05/pca-yuan-li-fen-xi/index.html","hash":"7ecf10d5eada1d681dc86149c3bdcafabead49cd","modified":1583149976107},{"_id":"public/2019/08/03/face-detection/index.html","hash":"0f35052975b8aba5cdfca9fcae28cbeddda44737","modified":1583149976107},{"_id":"public/2019/08/01/local-binary-patterns/index.html","hash":"e2849b38ce364292d5a821e7e72e018d52c6b978","modified":1583149976107},{"_id":"public/2019/07/30/tu-xing-hui-zhi/index.html","hash":"4071dc537a4d04f29d28c6e2ba54b1e199e3212a","modified":1583149976107},{"_id":"public/2019/07/29/high-quality-ellipse-detection/index.html","hash":"ff68dc30ac3e483423c43c10d06cdbadcaa0ed01","modified":1583149976107},{"_id":"public/2019/07/28/day14/index.html","hash":"481d331db902c155c657e6f5e6439cf1ab4fbd0a","modified":1583149976107},{"_id":"public/2019/07/26/yuan-xing-jian-ce/index.html","hash":"4fd7319baeec6df1868eb3bd95e44f35689cb739","modified":1583149976108},{"_id":"public/2019/07/26/huo-fu-bian-huan/index.html","hash":"6319d62d40b614de2dc46ae8e25390e6fef733c3","modified":1583149976108},{"_id":"public/2019/07/25/opencv-ru-keng-zhi-nan-huan-jing-da-jian-pian/index.html","hash":"818023be9a5c51ab4ae672b9b1c656a0bc642e39","modified":1583149976108},{"_id":"public/2019/07/24/tu-xiang-fen-ge/index.html","hash":"3f02210346795b5882a9d6e874902e64ad4356cc","modified":1583149976108},{"_id":"public/2019/07/22/hexo-da-keng/index.html","hash":"68d89e05abf4496655c2385df96319e33270d93e","modified":1583149976108},{"_id":"public/2019/07/22/xing-tai-xue-tu-xiang-chu-li/index.html","hash":"0bdaf7f06d29db263cb4be2c632e99ed7fffe787","modified":1583149976108},{"_id":"public/2019/07/20/pin-yu-lu-bo-qi-ji-qi-ying-yong/index.html","hash":"ec0a3f938a1406cfe8886fa856be75819a052b0b","modified":1583149976108},{"_id":"public/2019/07/19/markdown-shu-xue-gong-shi-hui-zong/index.html","hash":"fdd4e93cdaf434a35ff9b9338fdbe56cf2a6fcb6","modified":1583149976108},{"_id":"public/2019/07/19/pin-yu-lu-bo/index.html","hash":"2ca4deb09c807f46865bc9b800aebbb6ace6873b","modified":1583149976108},{"_id":"public/2019/07/17/kong-jian-lu-bo/index.html","hash":"94ed858d79d5c6ee6105ff3b1ef0e859bed84f36","modified":1583149976108},{"_id":"public/2019/07/15/digital-image-processing/index.html","hash":"b7c77ef6bb73d57a78500bad8fb656ef393c0b6b","modified":1583149976108},{"_id":"public/2019/07/05/my-plan/index.html","hash":"cc5c441414147f3c169274987b2debd8466235a3","modified":1583149976108},{"_id":"public/archives/index.html","hash":"3dedce0dd4d279f95d210538e279a27047ae456f","modified":1583149976111},{"_id":"public/archives/page/2/index.html","hash":"519e2676dc11523f93f3f4b2558d0bfe1e8585a4","modified":1583149976111},{"_id":"public/archives/page/3/index.html","hash":"7c4a1842dce9a6f8e0e1b3c8911edef85e739209","modified":1583149976111},{"_id":"public/archives/2019/index.html","hash":"8fddf8e454c5b7056de403ec7fc0df8549ff60f1","modified":1583149976111},{"_id":"public/archives/2019/page/2/index.html","hash":"a77bb6010dea5571d830cbe3a7897146967a6ec5","modified":1583149976111},{"_id":"public/archives/2019/page/3/index.html","hash":"89173041212e4d95fe34d88ad04f09ef35d98af5","modified":1583149976111},{"_id":"public/archives/2019/07/index.html","hash":"98bc6db4b3e41090d3509165a228bfe31c594614","modified":1583149976111},{"_id":"public/archives/2019/07/page/2/index.html","hash":"3f6be0fdf0eb0e1f4fa872faf537ebb17f48b3eb","modified":1583149976111},{"_id":"public/archives/2019/08/index.html","hash":"e477e0ea8e7c7bd3f54a77c77ab0e4be2b42b434","modified":1583149976111},{"_id":"public/archives/2019/09/index.html","hash":"1ed272f22f9c4724c7a033d6a446a8f25dc8a98c","modified":1583149976111},{"_id":"public/archives/2019/11/index.html","hash":"5b70fd6a8a37585b039bedbd964d54dbb3f65339","modified":1583149976111},{"_id":"public/archives/2019/12/index.html","hash":"f496af4d93da31fda9306f3da05f2f872142aaae","modified":1583149976111},{"_id":"public/archives/2020/index.html","hash":"ca1ddaa3816da17c316611bb87300f6e33207d0f","modified":1583149976111},{"_id":"public/archives/2020/01/index.html","hash":"1521fd565ca8bcdd9a40fc4e6d0464e84d23b3a0","modified":1583149976111},{"_id":"public/archives/2020/02/index.html","hash":"0e456534508c72eff95019a9db1b50636ff9afcf","modified":1583149976111},{"_id":"public/categories/教程/index.html","hash":"a88a0f90e23e906aae53d9e20a9d016b85541f39","modified":1583149976109},{"_id":"public/categories/Digital-Image-Processing/index.html","hash":"dfd5db3b5a8e7d653144ab4d6e5a9d1547a255a1","modified":1583149976109},{"_id":"public/categories/PyTorch-Notes/index.html","hash":"026d42ad34e2f711eff87c51ce3028acbe74f558","modified":1583149976109},{"_id":"public/categories/人脸检测/index.html","hash":"400615e7abfd8e3eb36ec0e6eedbabf6d3a293a1","modified":1583149976109},{"_id":"public/categories/Face-Recognition/index.html","hash":"f1755fe12c42c909c453015c2376c0f7ae02b645","modified":1583149976109},{"_id":"public/categories/Open-Source/index.html","hash":"f5add8b315e71711d7847e9083a79aed2e0cf629","modified":1583149976109},{"_id":"public/categories/算法/index.html","hash":"3f584eb34131ab1d14dc200c233202cbac174be9","modified":1583149976109},{"_id":"public/categories/Algorithms/index.html","hash":"89b2d5f0a4dd33aef82ff2f9c276b8ab2c31142d","modified":1583149976109},{"_id":"public/categories/OpenCV学习笔记/index.html","hash":"16bc43876dbdeae22229a46eee8f0b45a77aa149","modified":1583149976109},{"_id":"public/index.html","hash":"b37178694421a1963ec8ac520b5c85db3d54deed","modified":1583149976108},{"_id":"public/page/2/index.html","hash":"e7c733faa5b9af8a3423d5d9125edaf93371f0bd","modified":1583149976109},{"_id":"public/page/3/index.html","hash":"06224f9f7231a0ffc2f3ad7b750f97dff639ddff","modified":1583149976109},{"_id":"public/tags/Arch/index.html","hash":"9c87a438a8728126ad9e585547d3db89140e5a9c","modified":1583149976109},{"_id":"public/tags/linux/index.html","hash":"ea308e3a91ec408516e7443f235ecfeb781c445d","modified":1583149976109},{"_id":"public/tags/Python/index.html","hash":"af925025eadacb70863240fafe27e7b5085fbd79","modified":1583149976109},{"_id":"public/tags/Anaconda3/index.html","hash":"3e189ef9e3622e7db2cedb5708bb7a345f987aa3","modified":1583149976109},{"_id":"public/tags/实习/index.html","hash":"4891b0bb72b12495baaca7782ca42cd37f8e852e","modified":1583149976110},{"_id":"public/tags/Script/index.html","hash":"5b03e86e90b20c38488edb8e37205864b4950c78","modified":1583149976110},{"_id":"public/tags/Bilibili-com/index.html","hash":"8bbcaee353dd4311c72a03b6e4d3fe453124ac18","modified":1583149976110},{"_id":"public/tags/图像处理/index.html","hash":"466ed7be3edc279220162b0b1e27fd16fa17fcd6","modified":1583149976110},{"_id":"public/tags/Matlab/index.html","hash":"efd00043ac030ae1ce55736f50749d0c35ca65b2","modified":1583149976110},{"_id":"public/tags/PyTorch/index.html","hash":"fde5a9f3ce965725c7ac658c073c55b7934a98ed","modified":1583149976110},{"_id":"public/tags/Deep-Learning/index.html","hash":"f2455ade98aca1092fd9fb09f8042f119fca72d1","modified":1583149976110},{"_id":"public/tags/Deep-Learing/index.html","hash":"bc5d07c0dea25fb55d3f00cc1b48ad777e1c7449","modified":1583149976110},{"_id":"public/tags/Face-Detection/index.html","hash":"d7123821899075c3ac9f9b0d44579d5faf361e14","modified":1583149976110},{"_id":"public/tags/c/index.html","hash":"0da6d0d6ef148e305470207a39c670a1aa7d0676","modified":1583149976110},{"_id":"public/tags/OpenCV/index.html","hash":"52deb1f18eafae6d96f00b1ea50985cd2da8370b","modified":1583149976110},{"_id":"public/tags/Face-Recongnition/index.html","hash":"54c4285647b76517ddf769148aa380f8dbc775a5","modified":1583149976110},{"_id":"public/tags/python/index.html","hash":"89c146deb06c69c1ea2ba39c1099bdcf52ef9480","modified":1583149976110},{"_id":"public/tags/Git/index.html","hash":"9d5d983b872e835ee989b24ad400c74933c0c7a9","modified":1583149976110},{"_id":"public/tags/Github/index.html","hash":"c11f703800a932cc30ea99606dcb052bc858316d","modified":1583149976110},{"_id":"public/tags/LBP/index.html","hash":"90b7c047316dd47dd1763d384589e83df50837f5","modified":1583149976110},{"_id":"public/tags/Manjaro/index.html","hash":"45058f1a993cd8ba032eb947c2cdfe15c4b828fb","modified":1583149976110},{"_id":"public/tags/i3wm/index.html","hash":"2e806800d696b4aa4616b20bce6d5fd10d7cbfc5","modified":1583149976110},{"_id":"public/tags/Markdown/index.html","hash":"c2fc89a047197b42bdc98669f7a9e7437e04353a","modified":1583149976110},{"_id":"public/tags/plan/index.html","hash":"131651a68b30a9f88d37662d29ea7ef8e93e468c","modified":1583149976110},{"_id":"public/tags/PCA/index.html","hash":"d46d6f1baf4a9283e01fd8b4bacb68cb6301d3a2","modified":1583149976110},{"_id":"public/tags/Vim/index.html","hash":"4882381a539216ed64fe005e023c58f3fb648326","modified":1583149976110},{"_id":"public/tags/Linux/index.html","hash":"7fe6a221013e6ad0b7613cd7f8bd8d163c3f7675","modified":1583149976111},{"_id":"public/tags/hexo/index.html","hash":"3872bb5ab8e4b50aba700867158b30777fc6caa9","modified":1583149976111},{"_id":"public/CNAME","hash":"64f12ba4fc85e919e927bf1750221800453187cd","modified":1582542085740},{"_id":"public/favicon.jpg","hash":"f78e544a4aa6ec66ea8d25b18ea220880580b126","modified":1582542085740},{"_id":"public/medias/avatar.jpg","hash":"f78e544a4aa6ec66ea8d25b18ea220880580b126","modified":1582542085740},{"_id":"public/medias/reward/alipay.jpg","hash":"359852e00bf6ffa8985958a987311dedd7e0e22b","modified":1582542085740},{"_id":"public/libs/lightGallery/fonts/lg.eot","hash":"54caf05a81e33d7bf04f2e420736ce6f1de5f936","modified":1582542085740},{"_id":"public/libs/lightGallery/fonts/lg.svg","hash":"9a732790adc004b22022cc60fd5f77ec4c8e3e5a","modified":1582542085741},{"_id":"public/libs/lightGallery/fonts/lg.ttf","hash":"f6421c0c397311ae09f9257aa58bcd5e9720f493","modified":1582542085741},{"_id":"public/libs/lightGallery/fonts/lg.woff","hash":"3048de344dd5cad4624e0127e58eaae4b576f574","modified":1582542085741},{"_id":"public/libs/lightGallery/img/loading.gif","hash":"15a76af2739482d8de7354abc6d8dc4fca8d145e","modified":1582542085741},{"_id":"public/libs/lightGallery/img/video-play.png","hash":"fbfdbe06aebf7d0c00da175a4810cf888d128f11","modified":1582542085741},{"_id":"public/libs/lightGallery/img/vimeo-play.png","hash":"1142b47de219dddfba2e712cd3189dec0c8b7bee","modified":1582542085741},{"_id":"public/libs/lightGallery/img/youtube-play.png","hash":"39150b45ec5fc03155b7ebeaa44f1829281788e2","modified":1582542085741},{"_id":"public/libs/share/fonts/iconfont.eot","hash":"00ff749c8e202401190cc98d56087cdda716abe4","modified":1582542085741},{"_id":"public/libs/share/fonts/iconfont.svg","hash":"f0a1b849868a6bf351ff98dc3924a4e7254eb88b","modified":1582542085741},{"_id":"public/libs/share/fonts/iconfont.ttf","hash":"afd898f59d363887418669520b24d175f966a083","modified":1582542085741},{"_id":"public/libs/share/fonts/iconfont.woff","hash":"2e3fce1dcfbd6e2114e7bfbeaf72d3c62e15a1bd","modified":1582542085741},{"_id":"public/2019/08/07/enjoy-pytorch/1.png","hash":"27216299db2dde24c97eb5c79b56beab42cf36b9","modified":1582542085741},{"_id":"public/2019/08/07/enjoy-pytorch-task1/1.png","hash":"62b8d8e55ec4e7985bd78c520aabf90ba84c9ec9","modified":1582542085741},{"_id":"public/2019/08/07/pca-suan-fa-shi-xian/02.png","hash":"3accf1b5326def91e3698dd848bf5049a9e79094","modified":1582542085741},{"_id":"public/2019/11/23/vim/0.jpg","hash":"3a3031b9df01700e5ca76d0e3dfc5db53cf8fd5b","modified":1582542085741},{"_id":"public/2019/11/23/vim/colemak.png","hash":"cc10956b035b48ed48487a45654dbe92c0a96fe0","modified":1582542085741},{"_id":"public/2019/08/10/face-recognition-with-opencv/2.png","hash":"86fe9273c1a12a9ee29434fd4b52076924c59217","modified":1582542085741},{"_id":"public/2019/08/10/face-recognition-with-opencv/1.png","hash":"b99f2ff35370b03d14ef9a6f2a3dbfa87a6fad71","modified":1582542085741},{"_id":"public/2019/08/10/face-recognition-with-opencv/6.png","hash":"1b321511a5e298c4d7976d826d1f4c93b961be8d","modified":1582542085741},{"_id":"public/2019/08/10/face-recognition-with-opencv/5.png","hash":"59127cfb6ef84f22567f03816911317b1bc9c9a7","modified":1582542085741},{"_id":"public/2019/08/05/pca-yuan-li-fen-xi/01.png","hash":"8589b73b17a5b40615619ba7f8d76420315fa53d","modified":1582542085741},{"_id":"public/2019/08/05/pca-yuan-li-fen-xi/03.png","hash":"6cc32153244ba33af752159cb71ff7a0ac417d06","modified":1582542085741},{"_id":"public/2019/08/05/pca-yuan-li-fen-xi/02.png","hash":"03f787abd87e8ac5c51ef9951da4c0dbc360d4c5","modified":1582542085741},{"_id":"public/2019/08/05/pca-yuan-li-fen-xi/06.png","hash":"b4dce1b49516ac0527c9e1423c0d30138b345efd","modified":1582542085741},{"_id":"public/2019/09/21/bilibili-evolved/0.svg","hash":"aeb42106337f7542b7c620dfeec53e07f12149d9","modified":1582542085741},{"_id":"public/2019/08/05/pca-yuan-li-fen-xi/05.png","hash":"1acd87f837814fb46cfaa0b029445caa57fc9c12","modified":1582542085741},{"_id":"public/2019/08/05/pca-yuan-li-fen-xi/07.png","hash":"3accf1b5326def91e3698dd848bf5049a9e79094","modified":1582542085742},{"_id":"public/2019/09/21/bilibili-evolved/5.png","hash":"5f1b44939635c9d8ac6844dc1251fb2137577b94","modified":1582542085742},{"_id":"public/2020/02/04/about-proxy/2.png","hash":"c5fee3c7cfbc53e158191fbe9f634c8ee72b6df4","modified":1582542085742},{"_id":"public/2020/02/04/about-proxy/7.png","hash":"54c9527c0cc38c9e925408a522c486d8f504a705","modified":1582542085742},{"_id":"public/2020/02/04/about-proxy/6.png","hash":"77e0945934e4065c8e6866479d09e0cdb9782801","modified":1582542085742},{"_id":"public/2019/09/18/anaconda/0.jpeg","hash":"731484d90acf9f3fd59b0a5b2f27f21ec284bde6","modified":1582542085742},{"_id":"public/2020/02/04/about-proxy/8.png","hash":"c995a86890279a773f1ed1745ec087ac933d5737","modified":1582542085742},{"_id":"public/2019/09/18/anaconda/00.jpg","hash":"0fde2f7ae07bd2e5188fa74fd48fa00a84bce687","modified":1582542085742},{"_id":"public/2019/09/18/anaconda/1.png","hash":"4d5a6a0b4788a885a2b5df788080e035ecf05a46","modified":1582542085742},{"_id":"public/2019/09/18/anaconda/10.png","hash":"e1ed1e229b61fcc3838cabbf2773e2bfb7d71951","modified":1582542085742},{"_id":"public/2019/09/18/anaconda/2.png","hash":"07a14ac83a30e95ccc682709f030984403d5d367","modified":1582542085742},{"_id":"public/2019/09/18/anaconda/6.png","hash":"ea1c686f1cf988d566ef64093c0af64cd01c2d93","modified":1582542085742},{"_id":"public/2019/09/18/anaconda/5.png","hash":"04c0025e3ccdf19cd32220e47fc502cc6ac06d7c","modified":1582542085742},{"_id":"public/2019/09/18/anaconda/8.png","hash":"20e04e03665ca1a0386eb992fb256bdf7f7fdf7b","modified":1582542085742},{"_id":"public/2019/09/18/anaconda/9.png","hash":"a47985d996c54567c05384a0b385427c78a931b0","modified":1582542085742},{"_id":"public/2019/12/06/arch-linux/12.png","hash":"b7dcb082d48082b0988dde64f09486408f58f095","modified":1582542085742},{"_id":"public/2019/12/06/arch-linux/10.png","hash":"9d09fb65423dd01f766a18189211f2be954b3938","modified":1582542085743},{"_id":"public/2019/12/06/arch-linux/11.png","hash":"af21a5ea6f5667c5bc9dd5278622c5b61316c176","modified":1582542085743},{"_id":"public/2019/12/06/arch-linux/2.png","hash":"c6922ea6d2a61c14fca329ccc86e0a500fc36ff7","modified":1582542085743},{"_id":"public/2019/12/06/arch-linux/5.png","hash":"4f1f00d559d98aa9200a0f2f581da5232f77e579","modified":1582542085743},{"_id":"public/2019/12/06/arch-linux/9.png","hash":"38ac4551d75cb4bd58e4d5670401dc2a8dec245a","modified":1582542085743},{"_id":"public/2019/12/06/arch-linux/7.png","hash":"58e508a4331d903e92dd08e7d66935b42c9c81ed","modified":1582542085743},{"_id":"public/2019/12/06/arch-linux/8.png","hash":"5a0b1a47649f0bb26e935d844e5098f24eeaaadf","modified":1582542085743},{"_id":"public/2019/12/06/arch-linux/albert.png","hash":"ed031ad73d16735f3d737ef2db55e5d3848bbf6d","modified":1582542085743},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/1.png","hash":"8d85248771c37969ffae14603632e2936ba7fe33","modified":1582542085743},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/13.png","hash":"5744c5f4ba1707114dd8a3b7781ff4f19c6a0d16","modified":1582542085743},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/14.png","hash":"6b7ebd185a1a99e331c62f48b04160c762f26184","modified":1582542085743},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/2.png","hash":"0610d99a3ed7a01824a4edeb427972784b9ed206","modified":1582542085743},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/18.png","hash":"4a6e2c7e1d646f1a345758bc6f43607621ab23fc","modified":1582542085743},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/20.png","hash":"9b20d3e64540c37880c53d4c1e23e896f1f1212a","modified":1582542085744},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/4.png","hash":"74351b762dcf51ca05e06321086a79e181255668","modified":1582542085744},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/3.png","hash":"58dba86fdcb1c2939e4691ec247c0f42b6487744","modified":1582542085744},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/6.png","hash":"1b49e77c79e9bc683fc725dc3a0bd18ac22c0bc2","modified":1582542085744},{"_id":"public/css/prism-tomorrow.css","hash":"3b99487dfc9b4e51e9105a93743b92a761840e34","modified":1582542085744},{"_id":"public/medias/reward/wechat.jpg","hash":"20f7dc6b4753bec2a6367693ac0900334b8d2209","modified":1582542085755},{"_id":"public/medias/banner/2.jpg","hash":"8d3c8391ff161eec70f66d69e5545a9468cc52ef","modified":1582542085758},{"_id":"public/libs/awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1582542085761},{"_id":"public/medias/photo/2.jpg","hash":"8d3c8391ff161eec70f66d69e5545a9468cc52ef","modified":1582542085761},{"_id":"public/libs/awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1582542085761},{"_id":"public/2019/09/21/bilibili-evolved/6.png","hash":"add26a6a44128e11fa03c20300e5660f8f0dc277","modified":1582542085762},{"_id":"public/2019/09/21/bilibili-evolved/7.png","hash":"9b2539cd678f93fc7171a8befcb1ee0f730bf472","modified":1582542085762},{"_id":"public/2020/02/04/about-proxy/1.png","hash":"5ff8baf8e3480c3efe6593ccd2780d913d7b5652","modified":1582542085762},{"_id":"public/2020/02/04/about-proxy/5.png","hash":"728a7b8537909567f1de895bf2b5c58c66f1dc6f","modified":1582542085762},{"_id":"public/2020/02/04/about-proxy/4.png","hash":"6adf17c5912b198d9c8e788107dc5d41af9fbe3d","modified":1582542085762},{"_id":"public/2020/02/04/about-proxy/9.png","hash":"0158cde3b6ee4b6058613215bcb5ef476308e2de","modified":1582542085762},{"_id":"public/2019/09/18/anaconda/3.png","hash":"18bc4410f213dd3b2095fb2b7250a3bb1d8f5139","modified":1582542085762},{"_id":"public/2019/09/18/anaconda/7.png","hash":"51116906d1f8734f528c23f87fe988db810eb3bf","modified":1582542085763},{"_id":"public/2019/12/06/arch-linux/1.png","hash":"11398b9c0dbeb6754533db34bd6f0a8d01f3d5a8","modified":1582542085763},{"_id":"public/2019/12/06/arch-linux/4.png","hash":"fb75e1db2c27402f8d442d09d92996d72a5f0490","modified":1582542085763},{"_id":"public/2019/12/06/arch-linux/3.png","hash":"59bd77a5b1a3149059e652146bc8490c5990fc3e","modified":1582542085763},{"_id":"public/2019/12/06/arch-linux/6.png","hash":"a29171475409e9a52af969b65de5fffef5460014","modified":1582542085763},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/11.png","hash":"21d69575382f3577673a7ba2def20f9ffb93ae81","modified":1582542085763},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/12.png","hash":"5a8fd16cf99511f6a9c66f597a3abfcbf4a01355","modified":1582542085763},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/15.png","hash":"ca5521897aceb2bbf5e8273ec9c85dc2cfc7168f","modified":1582542085763},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/5.png","hash":"8f9d79c85f6424a7985ddb91c43f01ff228a0538","modified":1582542085763},{"_id":"public/css/gitment.css","hash":"2bd15cc17dca35ac3ecc0acf167a23a1dd362acd","modified":1582542085777},{"_id":"public/css/my-gitalk.css","hash":"eeda46a83d0db1cc239a9cd27d544faf663f9883","modified":1582542085777},{"_id":"public/css/my.css","hash":"497e50351f7838f8546cac76850a42e7e380a110","modified":1582542085780},{"_id":"public/js/search.js","hash":"499e11786efbb04815b54a1de317cc8606a37555","modified":1582542085780},{"_id":"public/js/matery.js","hash":"92f07106944f5ef7cd72e84bb3534513d00eebe1","modified":1582542085780},{"_id":"public/libs/aos/aos.js","hash":"02bfb40b0c4b6e9b0b4081218357145cbb327d74","modified":1582542085781},{"_id":"public/libs/aplayer/APlayer.min.css","hash":"07372a2ba507388d0fed166d761b1c2c2a659dce","modified":1582542085781},{"_id":"public/libs/jqcloud/jqcloud-1.0.4.min.js","hash":"257eaae3020599e4939f50d5008a743827f25b8c","modified":1582542085781},{"_id":"public/libs/jqcloud/jqcloud.css","hash":"20d9f11a19d95c70e27cb922e0d6dccbec4eae89","modified":1582542085781},{"_id":"public/libs/others/busuanzi.pure.mini.js","hash":"6e41f31100ae7eb3a6f23f2c168f6dd56e7f7a9a","modified":1582542085781},{"_id":"public/libs/others/clicklove.js","hash":"6a39b8c683ba5dcd92f70c6ab45d1cfac3213e8e","modified":1582542085781},{"_id":"public/libs/scrollprogress/scrollProgress.min.js","hash":"777ffe5d07e85a14fbe97d846f45ffc0087251cc","modified":1582542085781},{"_id":"public/libs/tocbot/tocbot.css","hash":"15601837bf8557c2fd111e4450ed4c8495fd11a0","modified":1582542085781},{"_id":"public/libs/tocbot/tocbot.min.js","hash":"5ec27317f0270b8cf6b884c6f12025700b9a565c","modified":1582542085781},{"_id":"public/libs/share/css/share.min.css","hash":"8a778a86f3ce9a042df6be63a9f1039631e351a5","modified":1582542085781},{"_id":"public/css/matery.css","hash":"fd5461b7924e3411ae5689dcc44c9d870df2b702","modified":1582542085781},{"_id":"public/libs/animate/animate.min.css","hash":"97afa151569f046b2e01f27c1871646e9cd87caf","modified":1582542085781},{"_id":"public/libs/gitalk/gitalk.css","hash":"3aac1db83b0135c521187254ff302d125cc30706","modified":1582542085781},{"_id":"public/libs/cryptojs/crypto-js.min.js","hash":"5989527a378b55011a59522f41eeb3981518325c","modified":1582542085781},{"_id":"public/libs/gitment/gitment-default.css","hash":"2903c59ee06b965bef32e937bd69f5b0b2190717","modified":1582542085781},{"_id":"public/libs/masonry/masonry.pkgd.min.js","hash":"ff940b4ea68368ca0e4d5560cbb79fb147dfc3c5","modified":1582542085781},{"_id":"public/libs/dplayer/DPlayer.min.css","hash":"f7d19655f873b813ffba5d1a17145c91f82631b8","modified":1582542085781},{"_id":"public/libs/aos/aos.css","hash":"191a3705a8f63e589a50a0ff2f2c5559f1a1b6b2","modified":1582542085781},{"_id":"public/libs/jquery/jquery-2.2.0.min.js","hash":"5d7e5bbfa540f0e53bd599e4305e1a4e815b5dd1","modified":1582542085781},{"_id":"public/libs/valine/Valine.min.js","hash":"031c1a5640d64ab3b829395ad5a7596b9fb122e6","modified":1582542085781},{"_id":"public/libs/awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1582542085781},{"_id":"public/libs/aplayer/APlayer.min.js","hash":"22caa28ff6b41a16ff40f15d38f1739e22359478","modified":1582542085781},{"_id":"public/libs/lightGallery/css/lightgallery.min.css","hash":"1b7227237f9785c66062a4811508916518e4132c","modified":1582542085781},{"_id":"public/libs/gitment/gitment.js","hash":"28c02c45ce568e084cd1041dc493f83f9c6c88c6","modified":1582542085782},{"_id":"public/libs/lightGallery/js/lightgallery-all.min.js","hash":"9f5ef4bc8a0a3c746ca4f3c3e6d64493b1a977d8","modified":1582542085782},{"_id":"public/libs/materialize/materialize.min.css","hash":"580459a012f556fba86438953062013a94b201af","modified":1582542085782},{"_id":"public/libs/share/js/jquery.share.min.js","hash":"16ce82901ca0e302cf47a35fb10f59009a5e7eb9","modified":1582542085782},{"_id":"public/libs/share/js/social-share.min.js","hash":"4df722bafde2c5d8faaace0d1f894798385a8793","modified":1582542085782},{"_id":"public/libs/dplayer/DPlayer.min.js","hash":"c3bad7b265574fab0ae4d45867422ea1cb9d6599","modified":1582542085782},{"_id":"public/libs/gitalk/gitalk.min.js","hash":"734f56442e62fe55f677e8ccae7f175445667767","modified":1582542085782},{"_id":"public/libs/valine/av-min.js","hash":"2577e72b52b736d99649f9e95be8976d58563333","modified":1582542085782},{"_id":"public/libs/materialize/materialize.min.js","hash":"c8b4c65651921d888cf5f27430dfe2ad190d35bf","modified":1582542085782},{"_id":"public/medias/cover.jpg","hash":"d4957ff7cc5e88555cd840f2956ab0561e6f1ccf","modified":1582542085782},{"_id":"public/libs/awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1582542085783},{"_id":"public/libs/awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1582542085783},{"_id":"public/libs/awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1582542085783},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/19.png","hash":"e9b763626294e8d67590305588389e399dfe304a","modified":1582542085783},{"_id":"public/2019/11/23/vim/vim.gif","hash":"029de04d3ebbcdb1d550f28ac6f981cb4ca58c00","modified":1582542085783},{"_id":"public/2020/02/04/about-proxy/3.png","hash":"a8fd5b9cb619289ce436b418133d78735e29403c","modified":1582542085783},{"_id":"public/2019/08/10/face-recognition-with-opencv/7.jpg","hash":"41bf0a58bd66f600dc331adc572685fb8609a99b","modified":1582542085783},{"_id":"public/2019/09/21/bilibili-evolved/4.png","hash":"4a3d4bd1c725a9a932a71e0ca877003b8469a12f","modified":1582542085784},{"_id":"public/2019/09/18/anaconda/4.png","hash":"be0239eac2c67e0472fa2a44720da5ed6f21213c","modified":1582542085784},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/7.png","hash":"9c161b5ce1ff149de8c02ffed3715745feb09582","modified":1582542085784},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/8.png","hash":"5ab59c39c45f80b8a138351e652625681d5ae8db","modified":1582542085784},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/9.png","hash":"24d857d824887cabd173bb38c139e5193ba356f7","modified":1582542085784},{"_id":"public/libs/echarts/echarts.min.js","hash":"9496f386a0da4601cad22c479cc5543913a4d67f","modified":1582542085793},{"_id":"public/medias/logo.png","hash":"9125f67111ebf310cf4ab95c00e992f378a24ba6","modified":1582542085793},{"_id":"public/2019/09/21/bilibili-evolved/1.png","hash":"80e4e58fd3839889593550eb9d38548e86ecde00","modified":1582542085794},{"_id":"public/2019/09/21/bilibili-evolved/2.png","hash":"dd4a5b7d53ef4b1db5caa0405d9ad7cca2fa8e69","modified":1582542085795},{"_id":"public/2019/09/21/bilibili-evolved/3.png","hash":"dffe0b98665e370493280f998c46e5263d2a24cc","modified":1582542085802},{"_id":"public/2020/01/29/sort/SELECT_SORT.gif","hash":"f39212fc6e2507830393342e216259b1284a5223","modified":1582542085808},{"_id":"public/2019/08/10/face-recognition-with-opencv/4.jpg","hash":"2340b6c5403623064b93f532c86eaffc514cd9eb","modified":1582542085808},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/17.png","hash":"d90d3841a1394f7a5822f7aebcf447f95cde03ab","modified":1582542085809},{"_id":"public/2020/01/29/sort/BUBBLE_SORT.gif","hash":"f6712a2189b0d16173644e3142634cc25b27cd72","modified":1582542085824},{"_id":"public/medias/banner/0.jpg","hash":"c8b89a0b0b8a5b75e24a14e2c5b5eed6242d3170","modified":1582542085847},{"_id":"public/2020/01/29/sort/MERGE_SORT.gif","hash":"2335402e8d7c498383680ccb0b582b11786a396d","modified":1582542085847},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/10.png","hash":"0307de15ac1915c71daa614c7da8deb80c492413","modified":1582542085848},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/paper.jpg","hash":"295d6013a8a18aa31f5a2e93fabe8eed3fcd9f37","modified":1582542085848},{"_id":"public/libs/awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1582542085853},{"_id":"public/2020/01/29/sort/INSERTION_SORT.gif","hash":"6b2fc2ae17627495b509f5b4f3400518da62feb5","modified":1582542085853},{"_id":"public/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/16.png","hash":"48abc9d2f4d80b240caf6be1fec8c926a3d3bcd6","modified":1582542085859},{"_id":"public/2019/08/07/pca-suan-fa-shi-xian/01.png","hash":"32e72c36f17cee27412c321469812ef99bc2b0b9","modified":1582542085869},{"_id":"public/medias/banner/6.jpg","hash":"04e60da4ae7625da3798052c22bcf1396f0ffc57","modified":1582542085903},{"_id":"public/2019/11/23/vim/vim_cheat_sheet.png","hash":"474b1b3d5a68b5fa0712904a57bf5e4fa08fc674","modified":1582542085905},{"_id":"public/medias/photo/6.jpg","hash":"04e60da4ae7625da3798052c22bcf1396f0ffc57","modified":1582542085907},{"_id":"public/2019/12/06/arch-linux/main.png","hash":"259ecf679cca97d956c77d2bfec4c1da28c188c4","modified":1582542085907},{"_id":"public/medias/photo/5.jpg","hash":"cea89ba2b56b36e33889ad4676aa1e06c57004ff","modified":1582542085916},{"_id":"public/medias/banner/5.jpg","hash":"cea89ba2b56b36e33889ad4676aa1e06c57004ff","modified":1582542085916},{"_id":"public/medias/photo/3.jpg","hash":"2376fd0a08925906fde4c67ade2cb2c0b853f38b","modified":1582542085921},{"_id":"public/medias/banner/3.jpg","hash":"2376fd0a08925906fde4c67ade2cb2c0b853f38b","modified":1582542085924},{"_id":"public/medias/banner/4.jpg","hash":"0ac255cfb6bbd62e09c15967828262bf450239bb","modified":1582542085927},{"_id":"public/medias/banner/1.jpg","hash":"2f384c9b7dc8a639ab73b7d33014f923c2540b9b","modified":1582542085929},{"_id":"public/medias/photo/1.jpg","hash":"2f384c9b7dc8a639ab73b7d33014f923c2540b9b","modified":1582542085929},{"_id":"public/medias/music/LeavingAkina.mp3","hash":"947133ccfa2d46745b859acce5a7bee974720b98","modified":1582542085939},{"_id":"public/2019/12/06/arch-linux/music.png","hash":"f27b0ba0ce342e0792a792523939768e920bdd4b","modified":1582542085942},{"_id":"public/2019/08/10/face-recognition-with-opencv/att_faces.zip","hash":"6c6d27116725c51910e639009c35117eaa8b0716","modified":1582542085955},{"_id":"public/2019/08/05/pca-yuan-li-fen-xi/PCA.pdf","hash":"5346883e784b16b146048413df0c647a518dbcee","modified":1582542085962},{"_id":"public/medias/music/wecantstop.mp3","hash":"ff63acedb5c200f53b7836b7471ea9ea5f8d9a41","modified":1582542085986},{"_id":"public/medias/banner/8.jpg","hash":"2b5dba18c130df5c69bf7c33f1cfef6eb576e789","modified":1582542085993},{"_id":"public/medias/photo/0.jpg","hash":"2b5dba18c130df5c69bf7c33f1cfef6eb576e789","modified":1582542085993}],"Category":[{"name":"教程","_id":"ck70cp0sp000c74jub3erjy33"},{"name":"Digital Image Processing","_id":"ck70cp0t1000m74jum3s14tlj"},{"name":"PyTorch Notes","_id":"ck70cp0t4000t74ju545f9ani"},{"name":"人脸检测","_id":"ck70cp0t8001574ju3g5w9vah"},{"name":"Face Recognition","_id":"ck70cp0tb001b74jutip213e4"},{"name":"Open Source","_id":"ck70cp0te001j74judtt5mntj"},{"name":"算法","_id":"ck70cp0tg001q74ju190z86a7"},{"name":"Algorithms","_id":"ck70cp0tn002974juk4gzu9xn"},{"name":"OpenCV学习笔记","_id":"ck70cp0tp002i74junvo9jsip"}],"Data":[{"_id":"friends","data":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}]},{"_id":"musics","data":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}],"Page":[{"title":"404","date":"2019-07-19T08:41:10.000Z","type":"404","layout":"404","description":"你来到了没有知识的荒原 :(","_content":"","source":"404.md","raw":"---\ntitle: 404\ndate: 2019-07-19 16:41:10\ntype: \"404\"\nlayout: \"404\"\ndescription: \"你来到了没有知识的荒原 :(\"\n---\n","updated":"2020-02-24T10:49:41.282Z","path":"404.html","comments":1,"_id":"ck70cp0qf000074juy91n4viv","content":"","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":""},{"_content":"[{\n    \"avatar\": \"http://image.luokangyuan.com/1_qq_27922023.jpg\",\n    \"name\": \"码酱\",\n    \"introduction\": \"我不是大佬，只是在追寻大佬的脚步\",\n    \"url\": \"http://luokangyuan.com/\",\n    \"title\": \"前去学习\"\n}, {\n    \"avatar\": \"http://image.luokangyuan.com/4027734.jpeg\",\n    \"name\": \"闪烁之狐\",\n    \"introduction\": \"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬\",\n    \"url\": \"https://blinkfox.github.io/\",\n    \"title\": \"前去学习\"\n}, {\n    \"avatar\": \"http://image.luokangyuan.com/avatar.jpg\",\n    \"name\": \"ja_rome\",\n    \"introduction\": \"平凡的脚步也可以走出伟大的行程\",\n    \"url\": \"ttps://me.csdn.net/jlh912008548\",\n    \"title\": \"前去学习\"\n}]\n","source":"friends.json","raw":"[{\n    \"avatar\": \"http://image.luokangyuan.com/1_qq_27922023.jpg\",\n    \"name\": \"码酱\",\n    \"introduction\": \"我不是大佬，只是在追寻大佬的脚步\",\n    \"url\": \"http://luokangyuan.com/\",\n    \"title\": \"前去学习\"\n}, {\n    \"avatar\": \"http://image.luokangyuan.com/4027734.jpeg\",\n    \"name\": \"闪烁之狐\",\n    \"introduction\": \"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬\",\n    \"url\": \"https://blinkfox.github.io/\",\n    \"title\": \"前去学习\"\n}, {\n    \"avatar\": \"http://image.luokangyuan.com/avatar.jpg\",\n    \"name\": \"ja_rome\",\n    \"introduction\": \"平凡的脚步也可以走出伟大的行程\",\n    \"url\": \"ttps://me.csdn.net/jlh912008548\",\n    \"title\": \"前去学习\"\n}]\n","date":"2020-02-24T10:49:41.451Z","updated":"2020-02-24T10:49:41.451Z","path":"friends.json","layout":"false","title":"","comments":1,"_id":"ck70cp0qg000174juogm66wmh","content":"[{\"avatar\":\"http://image.luokangyuan.com/1_qq_27922023.jpg\",\"name\":\"码酱\",\"introduction\":\"我不是大佬，只是在追寻大佬的脚步\",\"url\":\"http://luokangyuan.com/\",\"title\":\"前去学习\"},{\"avatar\":\"http://image.luokangyuan.com/4027734.jpeg\",\"name\":\"闪烁之狐\",\"introduction\":\"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬\",\"url\":\"https://blinkfox.github.io/\",\"title\":\"前去学习\"},{\"avatar\":\"http://image.luokangyuan.com/avatar.jpg\",\"name\":\"ja_rome\",\"introduction\":\"平凡的脚步也可以走出伟大的行程\",\"url\":\"ttps://me.csdn.net/jlh912008548\",\"title\":\"前去学习\"}]","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"[{\"avatar\":\"http://image.luokangyuan.com/1_qq_27922023.jpg\",\"name\":\"码酱\",\"introduction\":\"我不是大佬，只是在追寻大佬的脚步\",\"url\":\"http://luokangyuan.com/\",\"title\":\"前去学习\"},{\"avatar\":\"http://image.luokangyuan.com/4027734.jpeg\",\"name\":\"闪烁之狐\",\"introduction\":\"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬\",\"url\":\"https://blinkfox.github.io/\",\"title\":\"前去学习\"},{\"avatar\":\"http://image.luokangyuan.com/avatar.jpg\",\"name\":\"ja_rome\",\"introduction\":\"平凡的脚步也可以走出伟大的行程\",\"url\":\"ttps://me.csdn.net/jlh912008548\",\"title\":\"前去学习\"}]"},{"title":"categories","date":"2019-08-02T08:20:25.000Z","type":"categories","layout":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2019-08-02 16:20:25\ntype: \"categories\"\nlayout: \"categories\"\n---\n","updated":"2020-02-24T10:49:41.451Z","path":"categories/index.html","comments":1,"_id":"ck70cp0s1000274jun8gifv4y","content":"","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":""},{"title":"about","date":"2019-08-02T08:20:53.000Z","type":"about","layout":"about","_content":"","source":"about/index.md","raw":"---\ntitle: about\ndate: 2019-08-02 16:20:53\ntype: \"about\"\nlayout: \"about\"\n---\n","updated":"2020-02-24T10:49:41.451Z","path":"about/index.html","comments":1,"_id":"ck70cp0s8000474jutcg6enzz","content":"","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":""},{"title":"friends","date":"2019-08-02T08:21:09.000Z","type":"friends","layout":"friends","_content":"","source":"friends/index.md","raw":"---\ntitle: friends\ndate: 2019-08-02 16:21:09\ntype: \"friends\"\nlayout: \"friends\"\n---\n","updated":"2020-02-24T10:49:41.451Z","path":"friends/index.html","comments":1,"_id":"ck70cp0sc000674juus0t4rii","content":"","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":""},{"title":"tags","date":"2019-08-02T08:20:40.000Z","type":"tags","layout":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2019-08-02 16:20:40\ntype: \"tags\"\nlayout: \"tags\"\n---\n","updated":"2020-02-24T10:49:41.451Z","path":"tags/index.html","comments":1,"_id":"ck70cp0sj000974juqy70c0gl","content":"","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":""}],"Post":[{"title":"2020","top":false,"cover":false,"toc":true,"mathjax":false,"date":"2020-01-01T02:37:05.000Z","img":"https://i.loli.net/2020/01/01/XDj6b7rzsRCTQ8h.png","password":"1b40e7710b8596650c7348c76ac5b88bdc49fc3f4ffd076c1ebb1197b3417c05","summary":"Happy New Year!","_content":"\n## New Plan\n\n0. [ ] Love her!\n1. [ ] Python\n2. [ ] Math \n3. [ ] IELTS\n4. [ ] algorithm\n","source":"_posts/2020.md","raw":"---\ntitle: 2020\ntop: false\ncover: false\ntoc: true\nmathjax: false\ndate: 2020-01-01 10:37:05\nimg: https://i.loli.net/2020/01/01/XDj6b7rzsRCTQ8h.png\npassword: 1b40e7710b8596650c7348c76ac5b88bdc49fc3f4ffd076c1ebb1197b3417c05\nsummary: Happy New Year!\ntags:\ncategories:\n---\n\n## New Plan\n\n0. [ ] Love her!\n1. [ ] Python\n2. [ ] Math \n3. [ ] IELTS\n4. [ ] algorithm\n","slug":"2020","published":1,"updated":"2020-02-24T10:49:41.283Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0s1000374juhg2e5cd0","content":"<h2 id=\"New-Plan\"><a href=\"#New-Plan\" class=\"headerlink\" title=\"New Plan\"></a>New Plan</h2><ol start=\"0\">\n<li><input disabled type=\"checkbox\"> Love her!</li>\n<li><input disabled type=\"checkbox\"> Python</li>\n<li><input disabled type=\"checkbox\"> Math </li>\n<li><input disabled type=\"checkbox\"> IELTS</li>\n<li><input disabled type=\"checkbox\"> algorithm</li>\n</ol>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h2 id=\"New-Plan\"><a href=\"#New-Plan\" class=\"headerlink\" title=\"New Plan\"></a>New Plan</h2><ol start=\"0\">\n<li><input disabled type=\"checkbox\"> Love her!</li>\n<li><input disabled type=\"checkbox\"> Python</li>\n<li><input disabled type=\"checkbox\"> Math </li>\n<li><input disabled type=\"checkbox\"> IELTS</li>\n<li><input disabled type=\"checkbox\"> algorithm</li>\n</ol>\n"},{"title":"Arch Linux","top":true,"cover":true,"toc":true,"mathjax":false,"date":"2019-12-05T17:14:50.000Z","img":"https://i.loli.net/2019/12/07/ykIzuo8Z1PSGpLv.png","password":null,"summary":"Arch-linux Install and condig guide.","_content":"\n\n## Arch linux + i3\n\n![arch+i3](https://i.loli.net/2019/12/07/ykIzuo8Z1PSGpLv.png)\n![](main.png) \n![](albert.png) \n![](music.png) \n\n## Installation guide\n\n### 1. Boot the live environment\n\nThe live environment can be booted from a USB flash deive, an optical disc or a network with PXE. \n\n### 2. Connect the Internet\n\n```bash\nwifi-menu\n```\n\nUse `ping www.archlinux.org` to verify the connection.\n\n### 3. Update the system clock\n\nUse `tiledatectl` to ensure the system colck is accurate\n\n```bash\ntimedatectl set-ntp true\n```\n\nTo check the service status, use `timedatectl status`\n\n![timedate](1.png) \n\n### 4. Partition the disks\n\nWhen recognized by the live system, disks are assigned to a block device such as `/dev/sda` or `/dev/nvme0n1` . To identify these devices, use `lsblk` or `fdisk` .\n\n```bash\nfdisk -l\n```\n\nUse [fdisk](https://wiki.archlinux.org/index.php/Fdisk) or [parted](https://wiki.archlinux.org/index.php/Parted) to modify partition tables. \n\nfor example: \n\n```bash\n# parted /dev/sda\n(parted) mklabel\nNew disk label type? gpt\n(parted) exit\n```\n\nUse `cfdisk` to create partition.    \n\nIt should include **EFI** , **/** (root), **/home** , **/swap** .\n\n![Disks](2.png) \n\n### 5. Format the partitions\n\nNote the correct partitions\n\n- EFI partition\n\n```bash\nmkfs.vfat /dev/sda2\n```\n\n- root and home partition\n\n```bash\nmkfs.ext4 /dev/sda3\nmkfs.ext4 /dev/sda4\n```\n\n- swap partition\n\n```bash\nmkswap -f /dev/sda5\nswapon /dev/swap\n```\n\n### 6. Mount the file systems\n\nPay attention to the **order** of mounting partitions!\n\n- mount the file system on the root partition to `/mnt`\n\n```bash\nmount /dev/sda3 /mnt\n```\n\n- create **home** folder in `/mnt` folder and mount the file system on the home partition to `/mnt/home`\n\n```bash\nmkdir /mnt/home\nmount /dev/sda4 /mnt/home\n```\n\n- create **/mnt/boot/EFI** folder and mount the file system on the EFI partition to `/mnt/boot/EFI`\n\n```bash\nmkdir /mnt/boot\nmkdir /mnt/boot/EFI\nmount /dev/sda2 /mnt/boot/EFI\n```\n\n### 7. Select the mirrors\n\n```bash\nvim /etc/pacman.d/mirrorlist\n```\n\nPaste the China mirrors in the beginning\n\n![mirrorlist](3.png) \n\n### 8. Install essential packages\n\n```bash\npacstrap /mnt base linux linux-firmware\n```\n\n### 9. Generate an **fstab** file\n\n```bash\ngenfstab -U /mnt >> /mnt/etc/fstab\n```\n\nCheck the resulting `/mnt/etc/fstab` file, and edit it in case of errors.\n\n```bash\ncat /mnt/etc/fstab\n```\n\n![fstab](4.png) \n\n### 10. Change root into the new system\n\n```bash\narch-chroot /mnt\n```\n\n### 11. Time zone\n\n```bash\nln -sf /usr/share/zoneinfo/Asia/Shanghai /etc.localtime\nhwclock --systohc\n```\n\n### 12. Localozation(Language)\n\n- Uncomment `en_US.UTF-8 UTF-8` and others needed locals in `/etc/locale.gen` , and generate them with:\n\n```bash\nlocale-gen\n```\n\n- Create the `locale.conf` file, and set `LANG` variable accordingly:\n\n```bash\nvim /etc/locale.conf\nLANG=en_US.UTF-8\n```\n\n### 13. Initramfs\n\n```bash\nmkinitcpio -P\n```\n\n### 14. Root password\n\n```bash\npasswd root\n```\n\n### 15. [Network configuration](https://wiki.archlinux.org/index.php/Network_configuration) \n\n- Create the **hostname** file\n\n```bash\nvim /etc/hostname\n```\n\nEnter your hostname in this file.\n\n- Add matching entries to **hosts**\n\n```bash\nvim /etc/hosts\n```\n\n```\n127.0.0.1    localhost\n::1          localhost\n127.0.0.1    yourhostname.localdomain    yourhostname\n```\n\n- Install some software to ensure you can connect the Internet after reboot system.\n\n```bash\npacman -S iw wpa_supplicant dialog networkmanager\n```\n\n[Detailed configuration](#nm) \n\n### 16. [Microcode](https://wiki.archlinux.org/index.php/Microcode) \n\nMy computer is `Intel` processors.\n\n```bash\npacman -S intel-ucode\n```\n\n### 17. [Boot loader](https://wiki.archlinux.org/index.php/Arch_boot_process#Boot_loader) \n\n[**GRUB**](https://wiki.archlinux.org/index.php/GRUB) \n\n```bash\npacman -S grub efibootmgr\ngrub-install --target=x86_64-efi --efi-directory=/boot/EFI -bootloader-id=Archlinux\ngrub-mkconfig -o /boot/grub/grub.cfg\n```\n\nIf you can see some `img` file generated, it means the grub boot loader file are successful creatted.\n\n### 18. Reboot\n\n```bash\nexit\numount -R /mnt\nreboot\n```\nUse `uname -a` to view the Version of Arch linux.\n\n![Arch_linux Version](5.png) \n\n\n## My config recommendations\n\n### 1. Add users\n\n```bash\nuseradd -s -G wheel -s /bin/bash username\n```\nTo allow user to gain full root privileges when he precdeds a command with `sudo` , add the following line to `/etc/sudoers` .\n\n```bash\nUSER_NAME ALL=(ALL) ALL\n```\n\n`su username` to switch users.\n\n### 2. <a id = \"nm\">[NetworkManager](https://wiki.archlinux.org/index.php/NetworkManager) </a>\n\nNetworkManager(package `networkmanager` ) contains a daemon, a command line interface( `nmcli` ) and a curses-based interface( `nmtui` ). After installation, you should **enable the daemon**.\n\n```bash\nsystemctl enable NetworkManager.service\nsystemctl start NetworkManager.service\n```\n\nUse `ip link` to view the network interface.\n\n![Network interface](6.png) \n\n**Usage**\n\n- List nearby wifi networks\n\n```bash\nnmcli device wifi list\n```\n\n- Connect to a wifi network\n\n```bash\nnmcli device wifi connect SSID password password\n```\n\n- Disconnect an interface\n\n```bash\nnmcli device disconnect ifname eth0\n```\n\n- See a list of network devices and wheir state\n\n```bash\nnmcli device\n```\n\n- Turn off wifi\n\n```bash\nnmcli radio wifi off\n```\n\n`nm-applet` for a system tray applet\n\n```bash\nsudo pacman -S network-manager-applet\n```\n\n- Add `exec --no-startup-id nm-applet` to `~/.config/i3/config` fot autostart `nm-applet` .\n\n### 3. [Xorg](https://wiki.archlinux.org/index.php/Xorg) display server\n\n- Installation\n\n```bash\nsudo pacman -S xorg xorg-server xorg-apps\n```\n\n- Driver installation\n\n  1. First, identify your card:\n\n  ```bash\n  lspci | grep -e VGA -e 3D\n  ```\n\n  ![card](7.png) \n\n  ![](8.png) \n\n  2. Install an appropriate deiver\n\n  ```bash\n  pacman -Ss xf86-video\n  ```\n\n  **Note** : For NVIDIA Optimus enabled laptop which uses an integrated video card combined with a dedicated GPU, You  **can not** just install `xf86-video-intel` & `nvidia` , it will get a blcak screen. See [NVIDIA Optimus](https://wiki.archlinux.org/index.php/NVIDIA_Optimus) to get more informations. \n\n  I just install `xf86-video-vesa` . \n\n  ```bash\n  pacman -S xf86-video-vesa\n  ```\n\n  [Xorg: Driver_installtion](https://wiki.archlinux.org/index.php/Xorg#Driver_installation) \n\n- Use [xinit](https://wiki.archlinux.org/index.php/Xinit) to start Xorg display server.\n\n```bash\nsudo pacman -S xorg-xinit\n```\n\n- Create `.xinitrc` file(in common users)\n\n```bash\nsudo cp /etc/X11/xinit/xinitrc ~/.xinitrc\n```\n\n- Tap-to-click\n\n```bash\nsudo vim /etc/X11/xorg.conf.d/30-touchpad.conf\n```\n\nAdd the following lines to it.\n\n```\nSection \"InputClass\"\n  Identifier \"touchpad\"\n  Driver \"libinput\"\n  MatchIsTouchpad \"on\"\n  Option \"Tapping\" \"on\"\nEndSection\n```\n\n- Install Windows Manager (i3)\n\n\n```bash\nsudo pacman -S i3\n```\n\nIt include `i3-gaps` , `i3wm` , `i3blocks` , `i3lock` , `i3status`\n\n- Use i3\n\nAdd `exec i3` to the end of `~.xinitrc` .\n\n- Start Xorg server.\n\n```bash\nstartx\n```\n- Autostart X at login\n\nI'm a [fish](https://fishshell.com/) user, so i just need add the following to the bottom of my `~/.config/fish/config.fish` .\n\n```bash\n# Start X at login\nif status is-login\n    if test -z \"$DISPLAY\" -a $XDG_VTNR = 1\n        exec startx -- -keeptty\n    end\nend\n```\n\nOther shell user (like **bash** , **zsh** ), Please visit [here](https://wiki.archlinux.org/index.php/Xinit#Autostart_X_at_login) \n\n### 4. i3wm\n\n[i3wm](https://i3wm.org)  ,   [i3-ArchWiki](https://wiki.archlinux.org/index.php/I3) \n\n[My i3 config](https://github.com/liuyaanng/Arch_linux#i3-and-i3status) \n\n### 5. Some useful software\n\n- yaourt\n\nAdd the source to `/etc/pacman.conf`\n\n```\n[archlinuxcn]\n#The Chinese Arch Linux communities packages.\nSigLevel = Optional TrustAll\nServer = http://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch\n#Server   = http://repo.archlinuxcn.org/$arch\n#Server   = http://repo.archlinux.fr/$arch\n```\n\nSynchronized communities\n\n```bash\nsudo pacman -Syu\n```\n\nInsatll yaourt \n\n```bash\nsudo pacman -S yaourt\n```\n\n- [Software i use often](https://godliuyang.wang/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/#toc-heading-13)\n\n### 6. Fonts\n\n[Fonts-ArchWiki](https://wiki.archlinux.org/index.php/Fonts) , [Nerd-fonts](https://github.com/ryanoasis/nerd-fonts) , [Unicode-table]( https://unicode-table.com/en/ )  \n\n\n| adobe-source-code-pro | adobe-source-han-serif-cn-fonts | adobe-source-han-serif-tw-fonts |\n|:---------------------:|:-------------------------------:|:-------------------------------:|\n|      ttf-symbola      |       nerd-fonts-complete       |    nerd-fonts-dejavu-complete   |\n|      font-awesome     |         noto-fonts-emoji        |                                 |\n\n`fc-list` to show the fonts you have installed.\n\n### 7. Volume\n\n- ALSA is a set of built-in GNU/Linux modules. Therefore, manual insatllation is not necessary.\n\n- Install **pulseaudio**\n\n```bash\nsudo pacman -S pulseaudio\n```\n\n- Install **alsa-utils**\n\n```bash\nsudo pacman -S alsa-utils\n```\n\nUse `alsamixer` to manage the system volume\n\n- VoulmeIcon\n\n![VolumeIcon](9.png) \n\nIf you want a System volume tray, you can try **volumeicon**\n\n  1. Install volumeicon\n\n  ```bash\n  sudo pacman -S volumeicon\n  ```\n\n  2. Add `volumeicon` file in `~/.config/volumeicon`  , and add the following lines to it.\n\n  ```bash\n  [Alsa]\n  card=default\n\n  [Notification]\n  show_notification=true\n  notification_type=1\n\n  [StatusIcon]\n  stepsize=5\n  onclick=xterm -e 'alsamixer'\n  theme=White Gnome\n  use_panel_specific_icons=true\n  lmb_slider=true\n  mmb_mute=true\n  use_horizontal_slider=false\n  show_sound_level=true\n  use_transparent_bac<++>kground=true\n\n  [Hotkeys]\n  up_enabled=true\n  down_enabled=true\n  mute_enabled=true\n  up=XF86AudioRaiseVolume\n  down=XF86AudioLowerVolume\n  mute=XF86AudioMute\n  ```\n\n  3. Create `pulseaudio-ctl.desktop` in `~/.config/autostart` , and add the following lines to it.\n\n  ```bash\n  [Desktop Entry]\n  Encoding=UTF-8\n  Type=Application\n  Name=pulseaudio-ctl\n  comment=Set Volume to 70%\n  Exec=pulseaudio-ctl-normal\n  StartupNotify=true\n  Terminal=false\n  Hidden=false\n  ```\n\n  4. Add `exec --no-startup-id volumeicon` to `~/.config/i3/config` .\n\n  5. I wrote two scripts to control the volume of the system with `alsamixer` and `dunst` , put them to `/usr/bin/` .\n\n  [volume_up](https://github.com/liuyaanng/Arch_linux/blob/master/volume_up.sh)    \n  [volume_down](https://github.com/liuyaanng/Arch_linux/blob/master/volume_down.sh) \n\n### 8. Screen brightness\n\nA good advice for backlight management is `xorg-xbacklight` , but it seems not work on my computer. \n\n![xbacklight -error](12.png) \n\nIf you have the same problem, you can try the solution of Wiki, but it still can't work on my computer. Sad! So i try another way to control the screen brightness.    \nThe backlight can be controlled by the file `/sys/class/backlight/intel_backlight/brightness` 's value. So i wrote a script to control it. I named it `intel_brightness_control.sh`\n\n```bash\n#!/bin/bash\nset -e\nfile=\"/sys/class/backlight/intel_backlight/brightness\"\ncurrent=$(cat \"$file\")\nnew=\"$current\"\nif [ \"$1\" = \"-inc\" ]\nthen\n  new=$(( current + $2 ))\n  status=\"Up\"\nfi\nif [ \"$1\" = \"-dec\" ]\nthen\n  if [ current < 100 ]\n  then\n    new=\"50\"\n  else\n    new=$(( current - $2 ))\n  fi\n  status=\"Down\"\nfi\necho \"$new\" | tee \"$file\"\nbrightness=`light -G`\nnotify-send \"Brightness $status($brightness%)\"\n```\n\nRemember put it in your `/usr/bin/`.\n\nThen do `sudo chmod 777 /sys/class/backlight/intel_backlight/brightness` . The last thing is adding the following lines to `.config/i3/config` .\n\n```bash\n# Screen brightness controls\nbindsym XF86MonBrightnessUp exec \"intel_brightness_control.sh -inc 100\"\nbindsym XF86MonBrightnessDown exec \"intel_brightness_control.sh -dec 100\"\n```\n\n### 9. Bluetooth\n\n- Install **bluez** , **bluez-utils**\n\n```bash\nsudo pacman -S bluez bluez-utils\n```\n\n- The generic Bluetooth driver is the `btusb` Kernel module. Use `lsmod` to check whether that module is loaded. \n\n![btusb module](11.png)    \n  If it's not, do `modprobe btusb` to load the moudle.\n\n- Start / Enable\n\n```bash\nsystemctl enable bluetooth.service\nsystemctl start bluetooth.service\n```\n\n- Auto power-on after boot\n\nAdd the line `AutoEnable=true` in `/etc/bluetooth/main.conf` at the bottom in the `[Policy]` section.\n\n- Discoverable on startup\n\n```bash\n/etc/bluetooth/main.conf\n\n[General]\nDiscoverableTimeout = 0\nDiscoverable=true\n```\n\n- Install **pulseaudio-bluetooth** to use audio equipment like bluetooth headphones or speakers.\n\n[Bluetooth headset](https://wiki.archlinux.org/index.php/Bluetooth_headset) \n\n```bash\nsudo pacman -S pulseaudio-bluetooth\n```\n\n- Install [blueman](https://github.com/blueman-project/blueman) \n\n```bash\nsudo pacman -S blueman\n```\n  1. `blueman-applet` to use.\n  2. add `exec --no-startup-id blueman-applet` to `~/.config/i3/config` to auto start `blueman-applet` .\n\n### 10. Notify(Dunst)\n\n```bash\nsudo pacman -S libnotify dunst\n```\n\nCreate `org.freedesktop.Notifications.service` in `/usr/share/dbus-1/services/` folder. Add the following lines.\n\n```\n[D-BUS Service]\nName.org.freedesktop.Notifications\nExec=/usr/local/bin/dunst\n```\n\nAn example configuration file is included at `/usr/local/share/dunst/dunstrc` . Copy this file to `~/.config/dunst/dunstrc` and edit it accordingly.\n\n[My Dunstrc](https://github.com/liuyaanng/Arch_linux/tree/master/dunst) \n\nUse `notify-send \"Hello, world!\" ` to test.\n\n![Dunst](10.png) \n\n### 11. Shutdown Reboot LockScreen\n\n- Create a script named `i3exit` . Make sure you have `polkit` installed. \n\n```bash\n#!/bin/sh\nlock() {\n    i3lock\n}\n\ncase \"$1\" in\n    lock)\n        blurlock\n        ;;\n    logout)\n        i3-msg exit\n        ;;\n    suspend)\n        blurlock && systemctl suspend\n        ;;\n    hibernate)\n        blurlock && systemctl hibernate\n        ;;\n    reboot)\n        systemctl reboot\n        ;;\n    shutdown)\n        systemctl poweroff\n        ;;\n    *)\n        echo \"Usage: $0 {lock|logout|suspend|hibernate|reboot|shutdown}\"\n        exit 2\nesac\n\nexit 0\n```\n\nDo `chmod +x` and put it in `$PATH` ( `/usr/bin/` ) .\n\n- Add the following lines to `.config/i3/config`\n\n```bash\nset $mode_system System (l) lock, (e) logout, (s) suspend, (h) hibernate, (r) reboot, (Shift+s) shutdown\nmode \"$mode_system\" {\n    bindsym l exec --no-startup-id i3exit lock, mode \"default\"\n    bindsym e exec --no-startup-id i3exit logout, mode \"default\"\n    bindsym s exec --no-startup-id i3exit suspend, mode \"default\"\n    bindsym h exec --no-startup-id i3exit hibernate, mode \"default\"\n    bindsym r exec --no-startup-id i3exit reboot, mode \"default\"\n    bindsym Shift+s exec --no-startup-id i3exit shutdown, mode \"default\"  \n\n    # back to normal: Enter or Escape\n    bindsym Return mode \"default\"\n    bindsym Escape mode \"default\"\n}\nbindsym $mod+Pause mode \"$mode_system\"\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/Arch-Linux.md","raw":"---\ntitle: Arch Linux\ntop: true\ncover: true\ntoc: true\nmathjax: false\ndate: 2019-12-06 01:14:50\nimg: https://i.loli.net/2019/12/07/ykIzuo8Z1PSGpLv.png\npassword:\nsummary: Arch-linux Install and condig guide. \ntags:\n- Arch\n- linux\ncategories:\n---\n\n\n## Arch linux + i3\n\n![arch+i3](https://i.loli.net/2019/12/07/ykIzuo8Z1PSGpLv.png)\n![](main.png) \n![](albert.png) \n![](music.png) \n\n## Installation guide\n\n### 1. Boot the live environment\n\nThe live environment can be booted from a USB flash deive, an optical disc or a network with PXE. \n\n### 2. Connect the Internet\n\n```bash\nwifi-menu\n```\n\nUse `ping www.archlinux.org` to verify the connection.\n\n### 3. Update the system clock\n\nUse `tiledatectl` to ensure the system colck is accurate\n\n```bash\ntimedatectl set-ntp true\n```\n\nTo check the service status, use `timedatectl status`\n\n![timedate](1.png) \n\n### 4. Partition the disks\n\nWhen recognized by the live system, disks are assigned to a block device such as `/dev/sda` or `/dev/nvme0n1` . To identify these devices, use `lsblk` or `fdisk` .\n\n```bash\nfdisk -l\n```\n\nUse [fdisk](https://wiki.archlinux.org/index.php/Fdisk) or [parted](https://wiki.archlinux.org/index.php/Parted) to modify partition tables. \n\nfor example: \n\n```bash\n# parted /dev/sda\n(parted) mklabel\nNew disk label type? gpt\n(parted) exit\n```\n\nUse `cfdisk` to create partition.    \n\nIt should include **EFI** , **/** (root), **/home** , **/swap** .\n\n![Disks](2.png) \n\n### 5. Format the partitions\n\nNote the correct partitions\n\n- EFI partition\n\n```bash\nmkfs.vfat /dev/sda2\n```\n\n- root and home partition\n\n```bash\nmkfs.ext4 /dev/sda3\nmkfs.ext4 /dev/sda4\n```\n\n- swap partition\n\n```bash\nmkswap -f /dev/sda5\nswapon /dev/swap\n```\n\n### 6. Mount the file systems\n\nPay attention to the **order** of mounting partitions!\n\n- mount the file system on the root partition to `/mnt`\n\n```bash\nmount /dev/sda3 /mnt\n```\n\n- create **home** folder in `/mnt` folder and mount the file system on the home partition to `/mnt/home`\n\n```bash\nmkdir /mnt/home\nmount /dev/sda4 /mnt/home\n```\n\n- create **/mnt/boot/EFI** folder and mount the file system on the EFI partition to `/mnt/boot/EFI`\n\n```bash\nmkdir /mnt/boot\nmkdir /mnt/boot/EFI\nmount /dev/sda2 /mnt/boot/EFI\n```\n\n### 7. Select the mirrors\n\n```bash\nvim /etc/pacman.d/mirrorlist\n```\n\nPaste the China mirrors in the beginning\n\n![mirrorlist](3.png) \n\n### 8. Install essential packages\n\n```bash\npacstrap /mnt base linux linux-firmware\n```\n\n### 9. Generate an **fstab** file\n\n```bash\ngenfstab -U /mnt >> /mnt/etc/fstab\n```\n\nCheck the resulting `/mnt/etc/fstab` file, and edit it in case of errors.\n\n```bash\ncat /mnt/etc/fstab\n```\n\n![fstab](4.png) \n\n### 10. Change root into the new system\n\n```bash\narch-chroot /mnt\n```\n\n### 11. Time zone\n\n```bash\nln -sf /usr/share/zoneinfo/Asia/Shanghai /etc.localtime\nhwclock --systohc\n```\n\n### 12. Localozation(Language)\n\n- Uncomment `en_US.UTF-8 UTF-8` and others needed locals in `/etc/locale.gen` , and generate them with:\n\n```bash\nlocale-gen\n```\n\n- Create the `locale.conf` file, and set `LANG` variable accordingly:\n\n```bash\nvim /etc/locale.conf\nLANG=en_US.UTF-8\n```\n\n### 13. Initramfs\n\n```bash\nmkinitcpio -P\n```\n\n### 14. Root password\n\n```bash\npasswd root\n```\n\n### 15. [Network configuration](https://wiki.archlinux.org/index.php/Network_configuration) \n\n- Create the **hostname** file\n\n```bash\nvim /etc/hostname\n```\n\nEnter your hostname in this file.\n\n- Add matching entries to **hosts**\n\n```bash\nvim /etc/hosts\n```\n\n```\n127.0.0.1    localhost\n::1          localhost\n127.0.0.1    yourhostname.localdomain    yourhostname\n```\n\n- Install some software to ensure you can connect the Internet after reboot system.\n\n```bash\npacman -S iw wpa_supplicant dialog networkmanager\n```\n\n[Detailed configuration](#nm) \n\n### 16. [Microcode](https://wiki.archlinux.org/index.php/Microcode) \n\nMy computer is `Intel` processors.\n\n```bash\npacman -S intel-ucode\n```\n\n### 17. [Boot loader](https://wiki.archlinux.org/index.php/Arch_boot_process#Boot_loader) \n\n[**GRUB**](https://wiki.archlinux.org/index.php/GRUB) \n\n```bash\npacman -S grub efibootmgr\ngrub-install --target=x86_64-efi --efi-directory=/boot/EFI -bootloader-id=Archlinux\ngrub-mkconfig -o /boot/grub/grub.cfg\n```\n\nIf you can see some `img` file generated, it means the grub boot loader file are successful creatted.\n\n### 18. Reboot\n\n```bash\nexit\numount -R /mnt\nreboot\n```\nUse `uname -a` to view the Version of Arch linux.\n\n![Arch_linux Version](5.png) \n\n\n## My config recommendations\n\n### 1. Add users\n\n```bash\nuseradd -s -G wheel -s /bin/bash username\n```\nTo allow user to gain full root privileges when he precdeds a command with `sudo` , add the following line to `/etc/sudoers` .\n\n```bash\nUSER_NAME ALL=(ALL) ALL\n```\n\n`su username` to switch users.\n\n### 2. <a id = \"nm\">[NetworkManager](https://wiki.archlinux.org/index.php/NetworkManager) </a>\n\nNetworkManager(package `networkmanager` ) contains a daemon, a command line interface( `nmcli` ) and a curses-based interface( `nmtui` ). After installation, you should **enable the daemon**.\n\n```bash\nsystemctl enable NetworkManager.service\nsystemctl start NetworkManager.service\n```\n\nUse `ip link` to view the network interface.\n\n![Network interface](6.png) \n\n**Usage**\n\n- List nearby wifi networks\n\n```bash\nnmcli device wifi list\n```\n\n- Connect to a wifi network\n\n```bash\nnmcli device wifi connect SSID password password\n```\n\n- Disconnect an interface\n\n```bash\nnmcli device disconnect ifname eth0\n```\n\n- See a list of network devices and wheir state\n\n```bash\nnmcli device\n```\n\n- Turn off wifi\n\n```bash\nnmcli radio wifi off\n```\n\n`nm-applet` for a system tray applet\n\n```bash\nsudo pacman -S network-manager-applet\n```\n\n- Add `exec --no-startup-id nm-applet` to `~/.config/i3/config` fot autostart `nm-applet` .\n\n### 3. [Xorg](https://wiki.archlinux.org/index.php/Xorg) display server\n\n- Installation\n\n```bash\nsudo pacman -S xorg xorg-server xorg-apps\n```\n\n- Driver installation\n\n  1. First, identify your card:\n\n  ```bash\n  lspci | grep -e VGA -e 3D\n  ```\n\n  ![card](7.png) \n\n  ![](8.png) \n\n  2. Install an appropriate deiver\n\n  ```bash\n  pacman -Ss xf86-video\n  ```\n\n  **Note** : For NVIDIA Optimus enabled laptop which uses an integrated video card combined with a dedicated GPU, You  **can not** just install `xf86-video-intel` & `nvidia` , it will get a blcak screen. See [NVIDIA Optimus](https://wiki.archlinux.org/index.php/NVIDIA_Optimus) to get more informations. \n\n  I just install `xf86-video-vesa` . \n\n  ```bash\n  pacman -S xf86-video-vesa\n  ```\n\n  [Xorg: Driver_installtion](https://wiki.archlinux.org/index.php/Xorg#Driver_installation) \n\n- Use [xinit](https://wiki.archlinux.org/index.php/Xinit) to start Xorg display server.\n\n```bash\nsudo pacman -S xorg-xinit\n```\n\n- Create `.xinitrc` file(in common users)\n\n```bash\nsudo cp /etc/X11/xinit/xinitrc ~/.xinitrc\n```\n\n- Tap-to-click\n\n```bash\nsudo vim /etc/X11/xorg.conf.d/30-touchpad.conf\n```\n\nAdd the following lines to it.\n\n```\nSection \"InputClass\"\n  Identifier \"touchpad\"\n  Driver \"libinput\"\n  MatchIsTouchpad \"on\"\n  Option \"Tapping\" \"on\"\nEndSection\n```\n\n- Install Windows Manager (i3)\n\n\n```bash\nsudo pacman -S i3\n```\n\nIt include `i3-gaps` , `i3wm` , `i3blocks` , `i3lock` , `i3status`\n\n- Use i3\n\nAdd `exec i3` to the end of `~.xinitrc` .\n\n- Start Xorg server.\n\n```bash\nstartx\n```\n- Autostart X at login\n\nI'm a [fish](https://fishshell.com/) user, so i just need add the following to the bottom of my `~/.config/fish/config.fish` .\n\n```bash\n# Start X at login\nif status is-login\n    if test -z \"$DISPLAY\" -a $XDG_VTNR = 1\n        exec startx -- -keeptty\n    end\nend\n```\n\nOther shell user (like **bash** , **zsh** ), Please visit [here](https://wiki.archlinux.org/index.php/Xinit#Autostart_X_at_login) \n\n### 4. i3wm\n\n[i3wm](https://i3wm.org)  ,   [i3-ArchWiki](https://wiki.archlinux.org/index.php/I3) \n\n[My i3 config](https://github.com/liuyaanng/Arch_linux#i3-and-i3status) \n\n### 5. Some useful software\n\n- yaourt\n\nAdd the source to `/etc/pacman.conf`\n\n```\n[archlinuxcn]\n#The Chinese Arch Linux communities packages.\nSigLevel = Optional TrustAll\nServer = http://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch\n#Server   = http://repo.archlinuxcn.org/$arch\n#Server   = http://repo.archlinux.fr/$arch\n```\n\nSynchronized communities\n\n```bash\nsudo pacman -Syu\n```\n\nInsatll yaourt \n\n```bash\nsudo pacman -S yaourt\n```\n\n- [Software i use often](https://godliuyang.wang/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/#toc-heading-13)\n\n### 6. Fonts\n\n[Fonts-ArchWiki](https://wiki.archlinux.org/index.php/Fonts) , [Nerd-fonts](https://github.com/ryanoasis/nerd-fonts) , [Unicode-table]( https://unicode-table.com/en/ )  \n\n\n| adobe-source-code-pro | adobe-source-han-serif-cn-fonts | adobe-source-han-serif-tw-fonts |\n|:---------------------:|:-------------------------------:|:-------------------------------:|\n|      ttf-symbola      |       nerd-fonts-complete       |    nerd-fonts-dejavu-complete   |\n|      font-awesome     |         noto-fonts-emoji        |                                 |\n\n`fc-list` to show the fonts you have installed.\n\n### 7. Volume\n\n- ALSA is a set of built-in GNU/Linux modules. Therefore, manual insatllation is not necessary.\n\n- Install **pulseaudio**\n\n```bash\nsudo pacman -S pulseaudio\n```\n\n- Install **alsa-utils**\n\n```bash\nsudo pacman -S alsa-utils\n```\n\nUse `alsamixer` to manage the system volume\n\n- VoulmeIcon\n\n![VolumeIcon](9.png) \n\nIf you want a System volume tray, you can try **volumeicon**\n\n  1. Install volumeicon\n\n  ```bash\n  sudo pacman -S volumeicon\n  ```\n\n  2. Add `volumeicon` file in `~/.config/volumeicon`  , and add the following lines to it.\n\n  ```bash\n  [Alsa]\n  card=default\n\n  [Notification]\n  show_notification=true\n  notification_type=1\n\n  [StatusIcon]\n  stepsize=5\n  onclick=xterm -e 'alsamixer'\n  theme=White Gnome\n  use_panel_specific_icons=true\n  lmb_slider=true\n  mmb_mute=true\n  use_horizontal_slider=false\n  show_sound_level=true\n  use_transparent_bac<++>kground=true\n\n  [Hotkeys]\n  up_enabled=true\n  down_enabled=true\n  mute_enabled=true\n  up=XF86AudioRaiseVolume\n  down=XF86AudioLowerVolume\n  mute=XF86AudioMute\n  ```\n\n  3. Create `pulseaudio-ctl.desktop` in `~/.config/autostart` , and add the following lines to it.\n\n  ```bash\n  [Desktop Entry]\n  Encoding=UTF-8\n  Type=Application\n  Name=pulseaudio-ctl\n  comment=Set Volume to 70%\n  Exec=pulseaudio-ctl-normal\n  StartupNotify=true\n  Terminal=false\n  Hidden=false\n  ```\n\n  4. Add `exec --no-startup-id volumeicon` to `~/.config/i3/config` .\n\n  5. I wrote two scripts to control the volume of the system with `alsamixer` and `dunst` , put them to `/usr/bin/` .\n\n  [volume_up](https://github.com/liuyaanng/Arch_linux/blob/master/volume_up.sh)    \n  [volume_down](https://github.com/liuyaanng/Arch_linux/blob/master/volume_down.sh) \n\n### 8. Screen brightness\n\nA good advice for backlight management is `xorg-xbacklight` , but it seems not work on my computer. \n\n![xbacklight -error](12.png) \n\nIf you have the same problem, you can try the solution of Wiki, but it still can't work on my computer. Sad! So i try another way to control the screen brightness.    \nThe backlight can be controlled by the file `/sys/class/backlight/intel_backlight/brightness` 's value. So i wrote a script to control it. I named it `intel_brightness_control.sh`\n\n```bash\n#!/bin/bash\nset -e\nfile=\"/sys/class/backlight/intel_backlight/brightness\"\ncurrent=$(cat \"$file\")\nnew=\"$current\"\nif [ \"$1\" = \"-inc\" ]\nthen\n  new=$(( current + $2 ))\n  status=\"Up\"\nfi\nif [ \"$1\" = \"-dec\" ]\nthen\n  if [ current < 100 ]\n  then\n    new=\"50\"\n  else\n    new=$(( current - $2 ))\n  fi\n  status=\"Down\"\nfi\necho \"$new\" | tee \"$file\"\nbrightness=`light -G`\nnotify-send \"Brightness $status($brightness%)\"\n```\n\nRemember put it in your `/usr/bin/`.\n\nThen do `sudo chmod 777 /sys/class/backlight/intel_backlight/brightness` . The last thing is adding the following lines to `.config/i3/config` .\n\n```bash\n# Screen brightness controls\nbindsym XF86MonBrightnessUp exec \"intel_brightness_control.sh -inc 100\"\nbindsym XF86MonBrightnessDown exec \"intel_brightness_control.sh -dec 100\"\n```\n\n### 9. Bluetooth\n\n- Install **bluez** , **bluez-utils**\n\n```bash\nsudo pacman -S bluez bluez-utils\n```\n\n- The generic Bluetooth driver is the `btusb` Kernel module. Use `lsmod` to check whether that module is loaded. \n\n![btusb module](11.png)    \n  If it's not, do `modprobe btusb` to load the moudle.\n\n- Start / Enable\n\n```bash\nsystemctl enable bluetooth.service\nsystemctl start bluetooth.service\n```\n\n- Auto power-on after boot\n\nAdd the line `AutoEnable=true` in `/etc/bluetooth/main.conf` at the bottom in the `[Policy]` section.\n\n- Discoverable on startup\n\n```bash\n/etc/bluetooth/main.conf\n\n[General]\nDiscoverableTimeout = 0\nDiscoverable=true\n```\n\n- Install **pulseaudio-bluetooth** to use audio equipment like bluetooth headphones or speakers.\n\n[Bluetooth headset](https://wiki.archlinux.org/index.php/Bluetooth_headset) \n\n```bash\nsudo pacman -S pulseaudio-bluetooth\n```\n\n- Install [blueman](https://github.com/blueman-project/blueman) \n\n```bash\nsudo pacman -S blueman\n```\n  1. `blueman-applet` to use.\n  2. add `exec --no-startup-id blueman-applet` to `~/.config/i3/config` to auto start `blueman-applet` .\n\n### 10. Notify(Dunst)\n\n```bash\nsudo pacman -S libnotify dunst\n```\n\nCreate `org.freedesktop.Notifications.service` in `/usr/share/dbus-1/services/` folder. Add the following lines.\n\n```\n[D-BUS Service]\nName.org.freedesktop.Notifications\nExec=/usr/local/bin/dunst\n```\n\nAn example configuration file is included at `/usr/local/share/dunst/dunstrc` . Copy this file to `~/.config/dunst/dunstrc` and edit it accordingly.\n\n[My Dunstrc](https://github.com/liuyaanng/Arch_linux/tree/master/dunst) \n\nUse `notify-send \"Hello, world!\" ` to test.\n\n![Dunst](10.png) \n\n### 11. Shutdown Reboot LockScreen\n\n- Create a script named `i3exit` . Make sure you have `polkit` installed. \n\n```bash\n#!/bin/sh\nlock() {\n    i3lock\n}\n\ncase \"$1\" in\n    lock)\n        blurlock\n        ;;\n    logout)\n        i3-msg exit\n        ;;\n    suspend)\n        blurlock && systemctl suspend\n        ;;\n    hibernate)\n        blurlock && systemctl hibernate\n        ;;\n    reboot)\n        systemctl reboot\n        ;;\n    shutdown)\n        systemctl poweroff\n        ;;\n    *)\n        echo \"Usage: $0 {lock|logout|suspend|hibernate|reboot|shutdown}\"\n        exit 2\nesac\n\nexit 0\n```\n\nDo `chmod +x` and put it in `$PATH` ( `/usr/bin/` ) .\n\n- Add the following lines to `.config/i3/config`\n\n```bash\nset $mode_system System (l) lock, (e) logout, (s) suspend, (h) hibernate, (r) reboot, (Shift+s) shutdown\nmode \"$mode_system\" {\n    bindsym l exec --no-startup-id i3exit lock, mode \"default\"\n    bindsym e exec --no-startup-id i3exit logout, mode \"default\"\n    bindsym s exec --no-startup-id i3exit suspend, mode \"default\"\n    bindsym h exec --no-startup-id i3exit hibernate, mode \"default\"\n    bindsym r exec --no-startup-id i3exit reboot, mode \"default\"\n    bindsym Shift+s exec --no-startup-id i3exit shutdown, mode \"default\"  \n\n    # back to normal: Enter or Escape\n    bindsym Return mode \"default\"\n    bindsym Escape mode \"default\"\n}\nbindsym $mod+Pause mode \"$mode_system\"\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","slug":"Arch-Linux","published":1,"updated":"2020-02-24T10:49:41.294Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0s9000574ju0n4l3s0j","content":"<h2 id=\"Arch-linux-i3\"><a href=\"#Arch-linux-i3\" class=\"headerlink\" title=\"Arch linux + i3\"></a>Arch linux + i3</h2><p><img src=\"https://i.loli.net/2019/12/07/ykIzuo8Z1PSGpLv.png\" alt=\"arch+i3\"><br><img src=\"main.png\" alt><br><img src=\"albert.png\" alt><br><img src=\"music.png\" alt> </p>\n<h2 id=\"Installation-guide\"><a href=\"#Installation-guide\" class=\"headerlink\" title=\"Installation guide\"></a>Installation guide</h2><h3 id=\"1-Boot-the-live-environment\"><a href=\"#1-Boot-the-live-environment\" class=\"headerlink\" title=\"1. Boot the live environment\"></a>1. Boot the live environment</h3><p>The live environment can be booted from a USB flash deive, an optical disc or a network with PXE. </p>\n<h3 id=\"2-Connect-the-Internet\"><a href=\"#2-Connect-the-Internet\" class=\"headerlink\" title=\"2. Connect the Internet\"></a>2. Connect the Internet</h3><pre class=\" language-bash\"><code class=\"language-bash\">wifi-menu</code></pre>\n<p>Use <code>ping www.archlinux.org</code> to verify the connection.</p>\n<h3 id=\"3-Update-the-system-clock\"><a href=\"#3-Update-the-system-clock\" class=\"headerlink\" title=\"3. Update the system clock\"></a>3. Update the system clock</h3><p>Use <code>tiledatectl</code> to ensure the system colck is accurate</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">timedatectl set-ntp <span class=\"token boolean\">true</span></code></pre>\n<p>To check the service status, use <code>timedatectl status</code></p>\n<p><img src=\"1.png\" alt=\"timedate\"> </p>\n<h3 id=\"4-Partition-the-disks\"><a href=\"#4-Partition-the-disks\" class=\"headerlink\" title=\"4. Partition the disks\"></a>4. Partition the disks</h3><p>When recognized by the live system, disks are assigned to a block device such as <code>/dev/sda</code> or <code>/dev/nvme0n1</code> . To identify these devices, use <code>lsblk</code> or <code>fdisk</code> .</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">fdisk</span> -l</code></pre>\n<p>Use <a href=\"https://wiki.archlinux.org/index.php/Fdisk\" target=\"_blank\" rel=\"noopener\">fdisk</a> or <a href=\"https://wiki.archlinux.org/index.php/Parted\" target=\"_blank\" rel=\"noopener\">parted</a> to modify partition tables. </p>\n<p>for example: </p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token comment\" spellcheck=\"true\"># parted /dev/sda</span>\n<span class=\"token punctuation\">(</span>parted<span class=\"token punctuation\">)</span> mklabel\nNew disk label type? gpt\n<span class=\"token punctuation\">(</span>parted<span class=\"token punctuation\">)</span> <span class=\"token keyword\">exit</span></code></pre>\n<p>Use <code>cfdisk</code> to create partition.    </p>\n<p>It should include <strong>EFI</strong> , <strong>/</strong> (root), <strong>/home</strong> , <strong>/swap</strong> .</p>\n<p><img src=\"2.png\" alt=\"Disks\"> </p>\n<h3 id=\"5-Format-the-partitions\"><a href=\"#5-Format-the-partitions\" class=\"headerlink\" title=\"5. Format the partitions\"></a>5. Format the partitions</h3><p>Note the correct partitions</p>\n<ul>\n<li>EFI partition</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">mkfs.vfat /dev/sda2</code></pre>\n<ul>\n<li>root and home partition</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">mkfs.ext4 /dev/sda3\nmkfs.ext4 /dev/sda4</code></pre>\n<ul>\n<li>swap partition</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">mkswap -f /dev/sda5\nswapon /dev/swap</code></pre>\n<h3 id=\"6-Mount-the-file-systems\"><a href=\"#6-Mount-the-file-systems\" class=\"headerlink\" title=\"6. Mount the file systems\"></a>6. Mount the file systems</h3><p>Pay attention to the <strong>order</strong> of mounting partitions!</p>\n<ul>\n<li>mount the file system on the root partition to <code>/mnt</code></li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">mount</span> /dev/sda3 /mnt</code></pre>\n<ul>\n<li>create <strong>home</strong> folder in <code>/mnt</code> folder and mount the file system on the home partition to <code>/mnt/home</code></li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> /mnt/home\n<span class=\"token function\">mount</span> /dev/sda4 /mnt/home</code></pre>\n<ul>\n<li>create <strong>/mnt/boot/EFI</strong> folder and mount the file system on the EFI partition to <code>/mnt/boot/EFI</code></li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> /mnt/boot\n<span class=\"token function\">mkdir</span> /mnt/boot/EFI\n<span class=\"token function\">mount</span> /dev/sda2 /mnt/boot/EFI</code></pre>\n<h3 id=\"7-Select-the-mirrors\"><a href=\"#7-Select-the-mirrors\" class=\"headerlink\" title=\"7. Select the mirrors\"></a>7. Select the mirrors</h3><pre class=\" language-bash\"><code class=\"language-bash\">vim /etc/pacman.d/mirrorlist</code></pre>\n<p>Paste the China mirrors in the beginning</p>\n<p><img src=\"3.png\" alt=\"mirrorlist\"> </p>\n<h3 id=\"8-Install-essential-packages\"><a href=\"#8-Install-essential-packages\" class=\"headerlink\" title=\"8. Install essential packages\"></a>8. Install essential packages</h3><pre class=\" language-bash\"><code class=\"language-bash\">pacstrap /mnt base linux linux-firmware</code></pre>\n<h3 id=\"9-Generate-an-fstab-file\"><a href=\"#9-Generate-an-fstab-file\" class=\"headerlink\" title=\"9. Generate an fstab file\"></a>9. Generate an <strong>fstab</strong> file</h3><pre class=\" language-bash\"><code class=\"language-bash\">genfstab -U /mnt <span class=\"token operator\">>></span> /mnt/etc/fstab</code></pre>\n<p>Check the resulting <code>/mnt/etc/fstab</code> file, and edit it in case of errors.</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> /mnt/etc/fstab</code></pre>\n<p><img src=\"4.png\" alt=\"fstab\"> </p>\n<h3 id=\"10-Change-root-into-the-new-system\"><a href=\"#10-Change-root-into-the-new-system\" class=\"headerlink\" title=\"10. Change root into the new system\"></a>10. Change root into the new system</h3><pre class=\" language-bash\"><code class=\"language-bash\">arch-chroot /mnt</code></pre>\n<h3 id=\"11-Time-zone\"><a href=\"#11-Time-zone\" class=\"headerlink\" title=\"11. Time zone\"></a>11. Time zone</h3><pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">ln</span> -sf /usr/share/zoneinfo/Asia/Shanghai /etc.localtime\nhwclock --systohc</code></pre>\n<h3 id=\"12-Localozation-Language\"><a href=\"#12-Localozation-Language\" class=\"headerlink\" title=\"12. Localozation(Language)\"></a>12. Localozation(Language)</h3><ul>\n<li>Uncomment <code>en_US.UTF-8 UTF-8</code> and others needed locals in <code>/etc/locale.gen</code> , and generate them with:</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">locale-gen</code></pre>\n<ul>\n<li>Create the <code>locale.conf</code> file, and set <code>LANG</code> variable accordingly:</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">vim /etc/locale.conf\nLANG<span class=\"token operator\">=</span>en_US.UTF-8</code></pre>\n<h3 id=\"13-Initramfs\"><a href=\"#13-Initramfs\" class=\"headerlink\" title=\"13. Initramfs\"></a>13. Initramfs</h3><pre class=\" language-bash\"><code class=\"language-bash\">mkinitcpio -P</code></pre>\n<h3 id=\"14-Root-password\"><a href=\"#14-Root-password\" class=\"headerlink\" title=\"14. Root password\"></a>14. Root password</h3><pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">passwd</span> root</code></pre>\n<h3 id=\"15-Network-configuration\"><a href=\"#15-Network-configuration\" class=\"headerlink\" title=\"15. Network configuration\"></a>15. <a href=\"https://wiki.archlinux.org/index.php/Network_configuration\" target=\"_blank\" rel=\"noopener\">Network configuration</a></h3><ul>\n<li>Create the <strong>hostname</strong> file</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">vim /etc/hostname</code></pre>\n<p>Enter your hostname in this file.</p>\n<ul>\n<li>Add matching entries to <strong>hosts</strong></li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">vim /etc/hosts</code></pre>\n<pre><code>127.0.0.1    localhost\n::1          localhost\n127.0.0.1    yourhostname.localdomain    yourhostname</code></pre><ul>\n<li>Install some software to ensure you can connect the Internet after reboot system.</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">pacman -S iw wpa_supplicant dialog networkmanager</code></pre>\n<p><a href=\"#nm\">Detailed configuration</a> </p>\n<h3 id=\"16-Microcode\"><a href=\"#16-Microcode\" class=\"headerlink\" title=\"16. Microcode\"></a>16. <a href=\"https://wiki.archlinux.org/index.php/Microcode\" target=\"_blank\" rel=\"noopener\">Microcode</a></h3><p>My computer is <code>Intel</code> processors.</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">pacman -S intel-ucode</code></pre>\n<h3 id=\"17-Boot-loader\"><a href=\"#17-Boot-loader\" class=\"headerlink\" title=\"17. Boot loader\"></a>17. <a href=\"https://wiki.archlinux.org/index.php/Arch_boot_process#Boot_loader\" target=\"_blank\" rel=\"noopener\">Boot loader</a></h3><p><a href=\"https://wiki.archlinux.org/index.php/GRUB\" target=\"_blank\" rel=\"noopener\"><strong>GRUB</strong></a> </p>\n<pre class=\" language-bash\"><code class=\"language-bash\">pacman -S grub efibootmgr\ngrub-install --target<span class=\"token operator\">=</span>x86_64-efi --efi-directory<span class=\"token operator\">=</span>/boot/EFI -bootloader-id<span class=\"token operator\">=</span>Archlinux\ngrub-mkconfig -o /boot/grub/grub.cfg</code></pre>\n<p>If you can see some <code>img</code> file generated, it means the grub boot loader file are successful creatted.</p>\n<h3 id=\"18-Reboot\"><a href=\"#18-Reboot\" class=\"headerlink\" title=\"18. Reboot\"></a>18. Reboot</h3><pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token keyword\">exit</span>\n<span class=\"token function\">umount</span> -R /mnt\n<span class=\"token function\">reboot</span></code></pre>\n<p>Use <code>uname -a</code> to view the Version of Arch linux.</p>\n<p><img src=\"5.png\" alt=\"Arch_linux Version\"> </p>\n<h2 id=\"My-config-recommendations\"><a href=\"#My-config-recommendations\" class=\"headerlink\" title=\"My config recommendations\"></a>My config recommendations</h2><h3 id=\"1-Add-users\"><a href=\"#1-Add-users\" class=\"headerlink\" title=\"1. Add users\"></a>1. Add users</h3><pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">useradd</span> -s -G wheel -s /bin/bash username</code></pre>\n<p>To allow user to gain full root privileges when he precdeds a command with <code>sudo</code> , add the following line to <code>/etc/sudoers</code> .</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">USER_NAME ALL<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ALL<span class=\"token punctuation\">)</span> ALL</code></pre>\n<p><code>su username</code> to switch users.</p>\n<h3 id=\"2-NetworkManager\"><a href=\"#2-NetworkManager\" class=\"headerlink\" title=\"2. NetworkManager \"></a>2. <a id=\"nm\"><a href=\"https://wiki.archlinux.org/index.php/NetworkManager\" target=\"_blank\" rel=\"noopener\">NetworkManager</a> </a></h3><p>NetworkManager(package <code>networkmanager</code> ) contains a daemon, a command line interface( <code>nmcli</code> ) and a curses-based interface( <code>nmtui</code> ). After installation, you should <strong>enable the daemon</strong>.</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">systemctl <span class=\"token function\">enable</span> NetworkManager.service\nsystemctl start NetworkManager.service</code></pre>\n<p>Use <code>ip link</code> to view the network interface.</p>\n<p><img src=\"6.png\" alt=\"Network interface\"> </p>\n<p><strong>Usage</strong></p>\n<ul>\n<li>List nearby wifi networks</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">nmcli device wifi list</code></pre>\n<ul>\n<li>Connect to a wifi network</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">nmcli device wifi connect SSID password password</code></pre>\n<ul>\n<li>Disconnect an interface</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">nmcli device disconnect ifname eth0</code></pre>\n<ul>\n<li>See a list of network devices and wheir state</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">nmcli device</code></pre>\n<ul>\n<li>Turn off wifi</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">nmcli radio wifi off</code></pre>\n<p><code>nm-applet</code> for a system tray applet</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S network-manager-applet</code></pre>\n<ul>\n<li>Add <code>exec --no-startup-id nm-applet</code> to <code>~/.config/i3/config</code> fot autostart <code>nm-applet</code> .</li>\n</ul>\n<h3 id=\"3-Xorg-display-server\"><a href=\"#3-Xorg-display-server\" class=\"headerlink\" title=\"3. Xorg display server\"></a>3. <a href=\"https://wiki.archlinux.org/index.php/Xorg\" target=\"_blank\" rel=\"noopener\">Xorg</a> display server</h3><ul>\n<li>Installation</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S xorg xorg-server xorg-apps</code></pre>\n<ul>\n<li><p>Driver installation</p>\n<ol>\n<li>First, identify your card:</li>\n</ol>\n<pre class=\" language-bash\"><code class=\"language-bash\">lspci <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -e VGA -e 3D</code></pre>\n<p><img src=\"7.png\" alt=\"card\"> </p>\n<p><img src=\"8.png\" alt> </p>\n<ol start=\"2\">\n<li>Install an appropriate deiver</li>\n</ol>\n<pre class=\" language-bash\"><code class=\"language-bash\">pacman -Ss xf86-video</code></pre>\n<p><strong>Note</strong> : For NVIDIA Optimus enabled laptop which uses an integrated video card combined with a dedicated GPU, You  <strong>can not</strong> just install <code>xf86-video-intel</code> &amp; <code>nvidia</code> , it will get a blcak screen. See <a href=\"https://wiki.archlinux.org/index.php/NVIDIA_Optimus\" target=\"_blank\" rel=\"noopener\">NVIDIA Optimus</a> to get more informations. </p>\n<p>I just install <code>xf86-video-vesa</code> . </p>\n<pre class=\" language-bash\"><code class=\"language-bash\">pacman -S xf86-video-vesa</code></pre>\n<p><a href=\"https://wiki.archlinux.org/index.php/Xorg#Driver_installation\" target=\"_blank\" rel=\"noopener\">Xorg: Driver_installtion</a> </p>\n</li>\n<li><p>Use <a href=\"https://wiki.archlinux.org/index.php/Xinit\" target=\"_blank\" rel=\"noopener\">xinit</a> to start Xorg display server.</p>\n</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S xorg-xinit</code></pre>\n<ul>\n<li>Create <code>.xinitrc</code> file(in common users)</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> /etc/X11/xinit/xinitrc ~/.xinitrc</code></pre>\n<ul>\n<li>Tap-to-click</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> vim /etc/X11/xorg.conf.d/30-touchpad.conf</code></pre>\n<p>Add the following lines to it.</p>\n<pre><code>Section &quot;InputClass&quot;\n  Identifier &quot;touchpad&quot;\n  Driver &quot;libinput&quot;\n  MatchIsTouchpad &quot;on&quot;\n  Option &quot;Tapping&quot; &quot;on&quot;\nEndSection</code></pre><ul>\n<li>Install Windows Manager (i3)</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S i3</code></pre>\n<p>It include <code>i3-gaps</code> , <code>i3wm</code> , <code>i3blocks</code> , <code>i3lock</code> , <code>i3status</code></p>\n<ul>\n<li>Use i3</li>\n</ul>\n<p>Add <code>exec i3</code> to the end of <code>~.xinitrc</code> .</p>\n<ul>\n<li>Start Xorg server.</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">startx</code></pre>\n<ul>\n<li>Autostart X at login</li>\n</ul>\n<p>I’m a <a href=\"https://fishshell.com/\" target=\"_blank\" rel=\"noopener\">fish</a> user, so i just need add the following to the bottom of my <code>~/.config/fish/config.fish</code> .</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token comment\" spellcheck=\"true\"># Start X at login</span>\n<span class=\"token keyword\">if</span> status is-login\n    <span class=\"token keyword\">if</span> <span class=\"token function\">test</span> -z <span class=\"token string\">\"<span class=\"token variable\">$DISPLAY</span>\"</span> -a <span class=\"token variable\">$XDG_VTNR</span> <span class=\"token operator\">=</span> 1\n        <span class=\"token function\">exec</span> startx -- -keeptty\n    end\nend</code></pre>\n<p>Other shell user (like <strong>bash</strong> , <strong>zsh</strong> ), Please visit <a href=\"https://wiki.archlinux.org/index.php/Xinit#Autostart_X_at_login\" target=\"_blank\" rel=\"noopener\">here</a> </p>\n<h3 id=\"4-i3wm\"><a href=\"#4-i3wm\" class=\"headerlink\" title=\"4. i3wm\"></a>4. i3wm</h3><p><a href=\"https://i3wm.org\" target=\"_blank\" rel=\"noopener\">i3wm</a>  ,   <a href=\"https://wiki.archlinux.org/index.php/I3\" target=\"_blank\" rel=\"noopener\">i3-ArchWiki</a> </p>\n<p><a href=\"https://github.com/liuyaanng/Arch_linux#i3-and-i3status\" target=\"_blank\" rel=\"noopener\">My i3 config</a> </p>\n<h3 id=\"5-Some-useful-software\"><a href=\"#5-Some-useful-software\" class=\"headerlink\" title=\"5. Some useful software\"></a>5. Some useful software</h3><ul>\n<li>yaourt</li>\n</ul>\n<p>Add the source to <code>/etc/pacman.conf</code></p>\n<pre><code>[archlinuxcn]\n#The Chinese Arch Linux communities packages.\nSigLevel = Optional TrustAll\nServer = http://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch\n#Server   = http://repo.archlinuxcn.org/$arch\n#Server   = http://repo.archlinux.fr/$arch</code></pre><p>Synchronized communities</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -Syu</code></pre>\n<p>Insatll yaourt </p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S yaourt</code></pre>\n<ul>\n<li><a href=\"https://godliuyang.wang/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/#toc-heading-13\" target=\"_blank\" rel=\"noopener\">Software i use often</a></li>\n</ul>\n<h3 id=\"6-Fonts\"><a href=\"#6-Fonts\" class=\"headerlink\" title=\"6. Fonts\"></a>6. Fonts</h3><p><a href=\"https://wiki.archlinux.org/index.php/Fonts\" target=\"_blank\" rel=\"noopener\">Fonts-ArchWiki</a> , <a href=\"https://github.com/ryanoasis/nerd-fonts\" target=\"_blank\" rel=\"noopener\">Nerd-fonts</a> , <a href=\"https://unicode-table.com/en/\" target=\"_blank\" rel=\"noopener\">Unicode-table</a>  </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">adobe-source-code-pro</th>\n<th align=\"center\">adobe-source-han-serif-cn-fonts</th>\n<th align=\"center\">adobe-source-han-serif-tw-fonts</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">ttf-symbola</td>\n<td align=\"center\">nerd-fonts-complete</td>\n<td align=\"center\">nerd-fonts-dejavu-complete</td>\n</tr>\n<tr>\n<td align=\"center\">font-awesome</td>\n<td align=\"center\">noto-fonts-emoji</td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<p><code>fc-list</code> to show the fonts you have installed.</p>\n<h3 id=\"7-Volume\"><a href=\"#7-Volume\" class=\"headerlink\" title=\"7. Volume\"></a>7. Volume</h3><ul>\n<li><p>ALSA is a set of built-in GNU/Linux modules. Therefore, manual insatllation is not necessary.</p>\n</li>\n<li><p>Install <strong>pulseaudio</strong></p>\n</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S pulseaudio</code></pre>\n<ul>\n<li>Install <strong>alsa-utils</strong></li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S alsa-utils</code></pre>\n<p>Use <code>alsamixer</code> to manage the system volume</p>\n<ul>\n<li>VoulmeIcon</li>\n</ul>\n<p><img src=\"9.png\" alt=\"VolumeIcon\"> </p>\n<p>If you want a System volume tray, you can try <strong>volumeicon</strong></p>\n<ol>\n<li><p>Install volumeicon</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S volumeicon</code></pre>\n</li>\n<li><p>Add <code>volumeicon</code> file in <code>~/.config/volumeicon</code>  , and add the following lines to it.</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span>Alsa<span class=\"token punctuation\">]</span>\ncard<span class=\"token operator\">=</span>default\n\n<span class=\"token punctuation\">[</span>Notification<span class=\"token punctuation\">]</span>\nshow_notification<span class=\"token operator\">=</span>true\nnotification_type<span class=\"token operator\">=</span>1\n\n<span class=\"token punctuation\">[</span>StatusIcon<span class=\"token punctuation\">]</span>\nstepsize<span class=\"token operator\">=</span>5\nonclick<span class=\"token operator\">=</span>xterm -e <span class=\"token string\">'alsamixer'</span>\ntheme<span class=\"token operator\">=</span>White Gnome\nuse_panel_specific_icons<span class=\"token operator\">=</span>true\nlmb_slider<span class=\"token operator\">=</span>true\nmmb_mute<span class=\"token operator\">=</span>true\nuse_horizontal_slider<span class=\"token operator\">=</span>false\nshow_sound_level<span class=\"token operator\">=</span>true\nuse_transparent_bac<span class=\"token operator\">&lt;</span>++<span class=\"token operator\">></span>kground<span class=\"token operator\">=</span>true\n\n<span class=\"token punctuation\">[</span>Hotkeys<span class=\"token punctuation\">]</span>\nup_enabled<span class=\"token operator\">=</span>true\ndown_enabled<span class=\"token operator\">=</span>true\nmute_enabled<span class=\"token operator\">=</span>true\nup<span class=\"token operator\">=</span>XF86AudioRaiseVolume\ndown<span class=\"token operator\">=</span>XF86AudioLowerVolume\nmute<span class=\"token operator\">=</span>XF86AudioMute</code></pre>\n</li>\n<li><p>Create <code>pulseaudio-ctl.desktop</code> in <code>~/.config/autostart</code> , and add the following lines to it.</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span>Desktop Entry<span class=\"token punctuation\">]</span>\nEncoding<span class=\"token operator\">=</span>UTF-8\nType<span class=\"token operator\">=</span>Application\nName<span class=\"token operator\">=</span>pulseaudio-ctl\ncomment<span class=\"token operator\">=</span>Set Volume to 70%\nExec<span class=\"token operator\">=</span>pulseaudio-ctl-normal\nStartupNotify<span class=\"token operator\">=</span>true\nTerminal<span class=\"token operator\">=</span>false\nHidden<span class=\"token operator\">=</span>false</code></pre>\n</li>\n<li><p>Add <code>exec --no-startup-id volumeicon</code> to <code>~/.config/i3/config</code> .</p>\n</li>\n<li><p>I wrote two scripts to control the volume of the system with <code>alsamixer</code> and <code>dunst</code> , put them to <code>/usr/bin/</code> .</p>\n<p><a href=\"https://github.com/liuyaanng/Arch_linux/blob/master/volume_up.sh\" target=\"_blank\" rel=\"noopener\">volume_up</a><br><a href=\"https://github.com/liuyaanng/Arch_linux/blob/master/volume_down.sh\" target=\"_blank\" rel=\"noopener\">volume_down</a> </p>\n</li>\n</ol>\n<h3 id=\"8-Screen-brightness\"><a href=\"#8-Screen-brightness\" class=\"headerlink\" title=\"8. Screen brightness\"></a>8. Screen brightness</h3><p>A good advice for backlight management is <code>xorg-xbacklight</code> , but it seems not work on my computer. </p>\n<p><img src=\"12.png\" alt=\"xbacklight -error\"> </p>\n<p>If you have the same problem, you can try the solution of Wiki, but it still can’t work on my computer. Sad! So i try another way to control the screen brightness.<br>The backlight can be controlled by the file <code>/sys/class/backlight/intel_backlight/brightness</code> ‘s value. So i wrote a script to control it. I named it <code>intel_brightness_control.sh</code></p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n<span class=\"token keyword\">set</span> -e\nfile<span class=\"token operator\">=</span><span class=\"token string\">\"/sys/class/backlight/intel_backlight/brightness\"</span>\ncurrent<span class=\"token operator\">=</span><span class=\"token punctuation\">$(</span>cat <span class=\"token string\">\"<span class=\"token variable\">$file</span>\"</span><span class=\"token punctuation\">)</span>\nnew<span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\">$current</span>\"</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"-inc\"</span> <span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">then</span>\n  new<span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$((</span> current <span class=\"token operator\">+</span> $<span class=\"token number\">2</span> <span class=\"token variable\">))</span></span>\n  status<span class=\"token operator\">=</span><span class=\"token string\">\"Up\"</span>\n<span class=\"token keyword\">fi</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"-dec\"</span> <span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">then</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> current <span class=\"token operator\">&lt;</span> 100 <span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">then</span>\n    new<span class=\"token operator\">=</span><span class=\"token string\">\"50\"</span>\n  <span class=\"token keyword\">else</span>\n    new<span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$((</span> current <span class=\"token operator\">-</span> $<span class=\"token number\">2</span> <span class=\"token variable\">))</span></span>\n  <span class=\"token keyword\">fi</span>\n  status<span class=\"token operator\">=</span><span class=\"token string\">\"Down\"</span>\n<span class=\"token keyword\">fi</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string\">\"<span class=\"token variable\">$new</span>\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">tee</span> <span class=\"token string\">\"<span class=\"token variable\">$file</span>\"</span>\nbrightness<span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">`</span>light -G<span class=\"token variable\">`</span></span>\n<span class=\"token function\">notify-send</span> <span class=\"token string\">\"Brightness <span class=\"token variable\">$status</span>(<span class=\"token variable\">$brightness</span>%)\"</span></code></pre>\n<p>Remember put it in your <code>/usr/bin/</code>.</p>\n<p>Then do <code>sudo chmod 777 /sys/class/backlight/intel_backlight/brightness</code> . The last thing is adding the following lines to <code>.config/i3/config</code> .</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token comment\" spellcheck=\"true\"># Screen brightness controls</span>\nbindsym XF86MonBrightnessUp <span class=\"token function\">exec</span> <span class=\"token string\">\"intel_brightness_control.sh -inc 100\"</span>\nbindsym XF86MonBrightnessDown <span class=\"token function\">exec</span> <span class=\"token string\">\"intel_brightness_control.sh -dec 100\"</span></code></pre>\n<h3 id=\"9-Bluetooth\"><a href=\"#9-Bluetooth\" class=\"headerlink\" title=\"9. Bluetooth\"></a>9. Bluetooth</h3><ul>\n<li>Install <strong>bluez</strong> , <strong>bluez-utils</strong></li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S bluez bluez-utils</code></pre>\n<ul>\n<li>The generic Bluetooth driver is the <code>btusb</code> Kernel module. Use <code>lsmod</code> to check whether that module is loaded. </li>\n</ul>\n<p><img src=\"11.png\" alt=\"btusb module\"><br>  If it’s not, do <code>modprobe btusb</code> to load the moudle.</p>\n<ul>\n<li>Start / Enable</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">systemctl <span class=\"token function\">enable</span> bluetooth.service\nsystemctl start bluetooth.service</code></pre>\n<ul>\n<li>Auto power-on after boot</li>\n</ul>\n<p>Add the line <code>AutoEnable=true</code> in <code>/etc/bluetooth/main.conf</code> at the bottom in the <code>[Policy]</code> section.</p>\n<ul>\n<li>Discoverable on startup</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">/etc/bluetooth/main.conf\n\n<span class=\"token punctuation\">[</span>General<span class=\"token punctuation\">]</span>\nDiscoverableTimeout <span class=\"token operator\">=</span> 0\nDiscoverable<span class=\"token operator\">=</span>true</code></pre>\n<ul>\n<li>Install <strong>pulseaudio-bluetooth</strong> to use audio equipment like bluetooth headphones or speakers.</li>\n</ul>\n<p><a href=\"https://wiki.archlinux.org/index.php/Bluetooth_headset\" target=\"_blank\" rel=\"noopener\">Bluetooth headset</a> </p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S pulseaudio-bluetooth</code></pre>\n<ul>\n<li>Install <a href=\"https://github.com/blueman-project/blueman\" target=\"_blank\" rel=\"noopener\">blueman</a> </li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S blueman</code></pre>\n<ol>\n<li><code>blueman-applet</code> to use.</li>\n<li>add <code>exec --no-startup-id blueman-applet</code> to <code>~/.config/i3/config</code> to auto start <code>blueman-applet</code> .</li>\n</ol>\n<h3 id=\"10-Notify-Dunst\"><a href=\"#10-Notify-Dunst\" class=\"headerlink\" title=\"10. Notify(Dunst)\"></a>10. Notify(Dunst)</h3><pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S libnotify dunst</code></pre>\n<p>Create <code>org.freedesktop.Notifications.service</code> in <code>/usr/share/dbus-1/services/</code> folder. Add the following lines.</p>\n<pre><code>[D-BUS Service]\nName.org.freedesktop.Notifications\nExec=/usr/local/bin/dunst</code></pre><p>An example configuration file is included at <code>/usr/local/share/dunst/dunstrc</code> . Copy this file to <code>~/.config/dunst/dunstrc</code> and edit it accordingly.</p>\n<p><a href=\"https://github.com/liuyaanng/Arch_linux/tree/master/dunst\" target=\"_blank\" rel=\"noopener\">My Dunstrc</a> </p>\n<p>Use <code>notify-send &quot;Hello, world!&quot;</code> to test.</p>\n<p><img src=\"10.png\" alt=\"Dunst\"> </p>\n<h3 id=\"11-Shutdown-Reboot-LockScreen\"><a href=\"#11-Shutdown-Reboot-LockScreen\" class=\"headerlink\" title=\"11. Shutdown Reboot LockScreen\"></a>11. Shutdown Reboot LockScreen</h3><ul>\n<li>Create a script named <code>i3exit</code> . Make sure you have <code>polkit</code> installed. </li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/sh</span>\nlock<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    i3lock\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">case</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token keyword\">in</span>\n    lock<span class=\"token punctuation\">)</span>\n        blurlock\n        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    logout<span class=\"token punctuation\">)</span>\n        i3-msg <span class=\"token keyword\">exit</span>\n        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    suspend<span class=\"token punctuation\">)</span>\n        blurlock <span class=\"token operator\">&amp;&amp;</span> systemctl <span class=\"token function\">suspend</span>\n        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    hibernate<span class=\"token punctuation\">)</span>\n        blurlock <span class=\"token operator\">&amp;&amp;</span> systemctl hibernate\n        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    reboot<span class=\"token punctuation\">)</span>\n        systemctl <span class=\"token function\">reboot</span>\n        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    shutdown<span class=\"token punctuation\">)</span>\n        systemctl poweroff\n        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    *<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string\">\"Usage: <span class=\"token variable\">$0</span> {lock|logout|suspend|hibernate|reboot|shutdown}\"</span>\n        <span class=\"token keyword\">exit</span> 2\nesac\n\n<span class=\"token keyword\">exit</span> 0</code></pre>\n<p>Do <code>chmod +x</code> and put it in <code>$PATH</code> ( <code>/usr/bin/</code> ) .</p>\n<ul>\n<li>Add the following lines to <code>.config/i3/config</code></li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token keyword\">set</span> <span class=\"token variable\">$mode_system</span> System <span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span> lock, <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> logout, <span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> suspend, <span class=\"token punctuation\">(</span>h<span class=\"token punctuation\">)</span> hibernate, <span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">)</span> reboot, <span class=\"token punctuation\">(</span>Shift+s<span class=\"token punctuation\">)</span> <span class=\"token function\">shutdown</span>\nmode <span class=\"token string\">\"<span class=\"token variable\">$mode_system</span>\"</span> <span class=\"token punctuation\">{</span>\n    bindsym l <span class=\"token function\">exec</span> --no-startup-id i3exit lock, mode <span class=\"token string\">\"default\"</span>\n    bindsym e <span class=\"token function\">exec</span> --no-startup-id i3exit logout, mode <span class=\"token string\">\"default\"</span>\n    bindsym s <span class=\"token function\">exec</span> --no-startup-id i3exit suspend, mode <span class=\"token string\">\"default\"</span>\n    bindsym h <span class=\"token function\">exec</span> --no-startup-id i3exit hibernate, mode <span class=\"token string\">\"default\"</span>\n    bindsym r <span class=\"token function\">exec</span> --no-startup-id i3exit reboot, mode <span class=\"token string\">\"default\"</span>\n    bindsym Shift+s <span class=\"token function\">exec</span> --no-startup-id i3exit shutdown, mode <span class=\"token string\">\"default\"</span>  \n\n    <span class=\"token comment\" spellcheck=\"true\"># back to normal: Enter or Escape</span>\n    bindsym Return mode <span class=\"token string\">\"default\"</span>\n    bindsym Escape mode <span class=\"token string\">\"default\"</span>\n<span class=\"token punctuation\">}</span>\nbindsym <span class=\"token variable\">$mod</span>+Pause mode <span class=\"token string\">\"<span class=\"token variable\">$mode_system</span>\"</span></code></pre>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h2 id=\"Arch-linux-i3\"><a href=\"#Arch-linux-i3\" class=\"headerlink\" title=\"Arch linux + i3\"></a>Arch linux + i3</h2><p><img src=\"https://i.loli.net/2019/12/07/ykIzuo8Z1PSGpLv.png\" alt=\"arch+i3\"><br><img src=\"main.png\" alt><br><img src=\"albert.png\" alt><br><img src=\"music.png\" alt> </p>\n<h2 id=\"Installation-guide\"><a href=\"#Installation-guide\" class=\"headerlink\" title=\"Installation guide\"></a>Installation guide</h2><h3 id=\"1-Boot-the-live-environment\"><a href=\"#1-Boot-the-live-environment\" class=\"headerlink\" title=\"1. Boot the live environment\"></a>1. Boot the live environment</h3><p>The live environment can be booted from a USB flash deive, an optical disc or a network with PXE. </p>\n<h3 id=\"2-Connect-the-Internet\"><a href=\"#2-Connect-the-Internet\" class=\"headerlink\" title=\"2. Connect the Internet\"></a>2. Connect the Internet</h3><pre><code class=\"bash\">wifi-menu</code></pre>\n<p>Use <code>ping www.archlinux.org</code> to verify the connection.</p>\n<h3 id=\"3-Update-the-system-clock\"><a href=\"#3-Update-the-system-clock\" class=\"headerlink\" title=\"3. Update the system clock\"></a>3. Update the system clock</h3><p>Use <code>tiledatectl</code> to ensure the system colck is accurate</p>\n<pre><code class=\"bash\">timedatectl set-ntp true</code></pre>\n<p>To check the service status, use <code>timedatectl status</code></p>\n<p><img src=\"1.png\" alt=\"timedate\"> </p>\n<h3 id=\"4-Partition-the-disks\"><a href=\"#4-Partition-the-disks\" class=\"headerlink\" title=\"4. Partition the disks\"></a>4. Partition the disks</h3><p>When recognized by the live system, disks are assigned to a block device such as <code>/dev/sda</code> or <code>/dev/nvme0n1</code> . To identify these devices, use <code>lsblk</code> or <code>fdisk</code> .</p>\n<pre><code class=\"bash\">fdisk -l</code></pre>\n<p>Use <a href=\"https://wiki.archlinux.org/index.php/Fdisk\" target=\"_blank\" rel=\"noopener\">fdisk</a> or <a href=\"https://wiki.archlinux.org/index.php/Parted\" target=\"_blank\" rel=\"noopener\">parted</a> to modify partition tables. </p>\n<p>for example: </p>\n<pre><code class=\"bash\"># parted /dev/sda\n(parted) mklabel\nNew disk label type? gpt\n(parted) exit</code></pre>\n<p>Use <code>cfdisk</code> to create partition.    </p>\n<p>It should include <strong>EFI</strong> , <strong>/</strong> (root), <strong>/home</strong> , <strong>/swap</strong> .</p>\n<p><img src=\"2.png\" alt=\"Disks\"> </p>\n<h3 id=\"5-Format-the-partitions\"><a href=\"#5-Format-the-partitions\" class=\"headerlink\" title=\"5. Format the partitions\"></a>5. Format the partitions</h3><p>Note the correct partitions</p>\n<ul>\n<li>EFI partition</li>\n</ul>\n<pre><code class=\"bash\">mkfs.vfat /dev/sda2</code></pre>\n<ul>\n<li>root and home partition</li>\n</ul>\n<pre><code class=\"bash\">mkfs.ext4 /dev/sda3\nmkfs.ext4 /dev/sda4</code></pre>\n<ul>\n<li>swap partition</li>\n</ul>\n<pre><code class=\"bash\">mkswap -f /dev/sda5\nswapon /dev/swap</code></pre>\n<h3 id=\"6-Mount-the-file-systems\"><a href=\"#6-Mount-the-file-systems\" class=\"headerlink\" title=\"6. Mount the file systems\"></a>6. Mount the file systems</h3><p>Pay attention to the <strong>order</strong> of mounting partitions!</p>\n<ul>\n<li>mount the file system on the root partition to <code>/mnt</code></li>\n</ul>\n<pre><code class=\"bash\">mount /dev/sda3 /mnt</code></pre>\n<ul>\n<li>create <strong>home</strong> folder in <code>/mnt</code> folder and mount the file system on the home partition to <code>/mnt/home</code></li>\n</ul>\n<pre><code class=\"bash\">mkdir /mnt/home\nmount /dev/sda4 /mnt/home</code></pre>\n<ul>\n<li>create <strong>/mnt/boot/EFI</strong> folder and mount the file system on the EFI partition to <code>/mnt/boot/EFI</code></li>\n</ul>\n<pre><code class=\"bash\">mkdir /mnt/boot\nmkdir /mnt/boot/EFI\nmount /dev/sda2 /mnt/boot/EFI</code></pre>\n<h3 id=\"7-Select-the-mirrors\"><a href=\"#7-Select-the-mirrors\" class=\"headerlink\" title=\"7. Select the mirrors\"></a>7. Select the mirrors</h3><pre><code class=\"bash\">vim /etc/pacman.d/mirrorlist</code></pre>\n<p>Paste the China mirrors in the beginning</p>\n<p><img src=\"3.png\" alt=\"mirrorlist\"> </p>\n<h3 id=\"8-Install-essential-packages\"><a href=\"#8-Install-essential-packages\" class=\"headerlink\" title=\"8. Install essential packages\"></a>8. Install essential packages</h3><pre><code class=\"bash\">pacstrap /mnt base linux linux-firmware</code></pre>\n<h3 id=\"9-Generate-an-fstab-file\"><a href=\"#9-Generate-an-fstab-file\" class=\"headerlink\" title=\"9. Generate an fstab file\"></a>9. Generate an <strong>fstab</strong> file</h3><pre><code class=\"bash\">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab</code></pre>\n<p>Check the resulting <code>/mnt/etc/fstab</code> file, and edit it in case of errors.</p>\n<pre><code class=\"bash\">cat /mnt/etc/fstab</code></pre>\n<p><img src=\"4.png\" alt=\"fstab\"> </p>\n<h3 id=\"10-Change-root-into-the-new-system\"><a href=\"#10-Change-root-into-the-new-system\" class=\"headerlink\" title=\"10. Change root into the new system\"></a>10. Change root into the new system</h3><pre><code class=\"bash\">arch-chroot /mnt</code></pre>\n<h3 id=\"11-Time-zone\"><a href=\"#11-Time-zone\" class=\"headerlink\" title=\"11. Time zone\"></a>11. Time zone</h3><pre><code class=\"bash\">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc.localtime\nhwclock --systohc</code></pre>\n<h3 id=\"12-Localozation-Language\"><a href=\"#12-Localozation-Language\" class=\"headerlink\" title=\"12. Localozation(Language)\"></a>12. Localozation(Language)</h3><ul>\n<li>Uncomment <code>en_US.UTF-8 UTF-8</code> and others needed locals in <code>/etc/locale.gen</code> , and generate them with:</li>\n</ul>\n<pre><code class=\"bash\">locale-gen</code></pre>\n<ul>\n<li>Create the <code>locale.conf</code> file, and set <code>LANG</code> variable accordingly:</li>\n</ul>\n<pre><code class=\"bash\">vim /etc/locale.conf\nLANG=en_US.UTF-8</code></pre>\n<h3 id=\"13-Initramfs\"><a href=\"#13-Initramfs\" class=\"headerlink\" title=\"13. Initramfs\"></a>13. Initramfs</h3><pre><code class=\"bash\">mkinitcpio -P</code></pre>\n<h3 id=\"14-Root-password\"><a href=\"#14-Root-password\" class=\"headerlink\" title=\"14. Root password\"></a>14. Root password</h3><pre><code class=\"bash\">passwd root</code></pre>\n<h3 id=\"15-Network-configuration\"><a href=\"#15-Network-configuration\" class=\"headerlink\" title=\"15. Network configuration\"></a>15. <a href=\"https://wiki.archlinux.org/index.php/Network_configuration\" target=\"_blank\" rel=\"noopener\">Network configuration</a></h3><ul>\n<li>Create the <strong>hostname</strong> file</li>\n</ul>\n<pre><code class=\"bash\">vim /etc/hostname</code></pre>\n<p>Enter your hostname in this file.</p>\n<ul>\n<li>Add matching entries to <strong>hosts</strong></li>\n</ul>\n<pre><code class=\"bash\">vim /etc/hosts</code></pre>\n<pre><code>127.0.0.1    localhost\n::1          localhost\n127.0.0.1    yourhostname.localdomain    yourhostname</code></pre><ul>\n<li>Install some software to ensure you can connect the Internet after reboot system.</li>\n</ul>\n<pre><code class=\"bash\">pacman -S iw wpa_supplicant dialog networkmanager</code></pre>\n<p><a href=\"#nm\">Detailed configuration</a> </p>\n<h3 id=\"16-Microcode\"><a href=\"#16-Microcode\" class=\"headerlink\" title=\"16. Microcode\"></a>16. <a href=\"https://wiki.archlinux.org/index.php/Microcode\" target=\"_blank\" rel=\"noopener\">Microcode</a></h3><p>My computer is <code>Intel</code> processors.</p>\n<pre><code class=\"bash\">pacman -S intel-ucode</code></pre>\n<h3 id=\"17-Boot-loader\"><a href=\"#17-Boot-loader\" class=\"headerlink\" title=\"17. Boot loader\"></a>17. <a href=\"https://wiki.archlinux.org/index.php/Arch_boot_process#Boot_loader\" target=\"_blank\" rel=\"noopener\">Boot loader</a></h3><p><a href=\"https://wiki.archlinux.org/index.php/GRUB\" target=\"_blank\" rel=\"noopener\"><strong>GRUB</strong></a> </p>\n<pre><code class=\"bash\">pacman -S grub efibootmgr\ngrub-install --target=x86_64-efi --efi-directory=/boot/EFI -bootloader-id=Archlinux\ngrub-mkconfig -o /boot/grub/grub.cfg</code></pre>\n<p>If you can see some <code>img</code> file generated, it means the grub boot loader file are successful creatted.</p>\n<h3 id=\"18-Reboot\"><a href=\"#18-Reboot\" class=\"headerlink\" title=\"18. Reboot\"></a>18. Reboot</h3><pre><code class=\"bash\">exit\numount -R /mnt\nreboot</code></pre>\n<p>Use <code>uname -a</code> to view the Version of Arch linux.</p>\n<p><img src=\"5.png\" alt=\"Arch_linux Version\"> </p>\n<h2 id=\"My-config-recommendations\"><a href=\"#My-config-recommendations\" class=\"headerlink\" title=\"My config recommendations\"></a>My config recommendations</h2><h3 id=\"1-Add-users\"><a href=\"#1-Add-users\" class=\"headerlink\" title=\"1. Add users\"></a>1. Add users</h3><pre><code class=\"bash\">useradd -s -G wheel -s /bin/bash username</code></pre>\n<p>To allow user to gain full root privileges when he precdeds a command with <code>sudo</code> , add the following line to <code>/etc/sudoers</code> .</p>\n<pre><code class=\"bash\">USER_NAME ALL=(ALL) ALL</code></pre>\n<p><code>su username</code> to switch users.</p>\n<h3 id=\"2-NetworkManager\"><a href=\"#2-NetworkManager\" class=\"headerlink\" title=\"2. NetworkManager \"></a>2. <a id=\"nm\"><a href=\"https://wiki.archlinux.org/index.php/NetworkManager\" target=\"_blank\" rel=\"noopener\">NetworkManager</a> </a></h3><p>NetworkManager(package <code>networkmanager</code> ) contains a daemon, a command line interface( <code>nmcli</code> ) and a curses-based interface( <code>nmtui</code> ). After installation, you should <strong>enable the daemon</strong>.</p>\n<pre><code class=\"bash\">systemctl enable NetworkManager.service\nsystemctl start NetworkManager.service</code></pre>\n<p>Use <code>ip link</code> to view the network interface.</p>\n<p><img src=\"6.png\" alt=\"Network interface\"> </p>\n<p><strong>Usage</strong></p>\n<ul>\n<li>List nearby wifi networks</li>\n</ul>\n<pre><code class=\"bash\">nmcli device wifi list</code></pre>\n<ul>\n<li>Connect to a wifi network</li>\n</ul>\n<pre><code class=\"bash\">nmcli device wifi connect SSID password password</code></pre>\n<ul>\n<li>Disconnect an interface</li>\n</ul>\n<pre><code class=\"bash\">nmcli device disconnect ifname eth0</code></pre>\n<ul>\n<li>See a list of network devices and wheir state</li>\n</ul>\n<pre><code class=\"bash\">nmcli device</code></pre>\n<ul>\n<li>Turn off wifi</li>\n</ul>\n<pre><code class=\"bash\">nmcli radio wifi off</code></pre>\n<p><code>nm-applet</code> for a system tray applet</p>\n<pre><code class=\"bash\">sudo pacman -S network-manager-applet</code></pre>\n<ul>\n<li>Add <code>exec --no-startup-id nm-applet</code> to <code>~/.config/i3/config</code> fot autostart <code>nm-applet</code> .</li>\n</ul>\n<h3 id=\"3-Xorg-display-server\"><a href=\"#3-Xorg-display-server\" class=\"headerlink\" title=\"3. Xorg display server\"></a>3. <a href=\"https://wiki.archlinux.org/index.php/Xorg\" target=\"_blank\" rel=\"noopener\">Xorg</a> display server</h3><ul>\n<li>Installation</li>\n</ul>\n<pre><code class=\"bash\">sudo pacman -S xorg xorg-server xorg-apps</code></pre>\n<ul>\n<li><p>Driver installation</p>\n<ol>\n<li>First, identify your card:</li>\n</ol>\n<pre><code class=\"bash\">lspci | grep -e VGA -e 3D</code></pre>\n<p><img src=\"7.png\" alt=\"card\"> </p>\n<p><img src=\"8.png\" alt> </p>\n<ol start=\"2\">\n<li>Install an appropriate deiver</li>\n</ol>\n<pre><code class=\"bash\">pacman -Ss xf86-video</code></pre>\n<p><strong>Note</strong> : For NVIDIA Optimus enabled laptop which uses an integrated video card combined with a dedicated GPU, You  <strong>can not</strong> just install <code>xf86-video-intel</code> &amp; <code>nvidia</code> , it will get a blcak screen. See <a href=\"https://wiki.archlinux.org/index.php/NVIDIA_Optimus\" target=\"_blank\" rel=\"noopener\">NVIDIA Optimus</a> to get more informations. </p>\n<p>I just install <code>xf86-video-vesa</code> . </p>\n<pre><code class=\"bash\">pacman -S xf86-video-vesa</code></pre>\n<p><a href=\"https://wiki.archlinux.org/index.php/Xorg#Driver_installation\" target=\"_blank\" rel=\"noopener\">Xorg: Driver_installtion</a> </p>\n</li>\n<li><p>Use <a href=\"https://wiki.archlinux.org/index.php/Xinit\" target=\"_blank\" rel=\"noopener\">xinit</a> to start Xorg display server.</p>\n</li>\n</ul>\n<pre><code class=\"bash\">sudo pacman -S xorg-xinit</code></pre>\n<ul>\n<li>Create <code>.xinitrc</code> file(in common users)</li>\n</ul>\n<pre><code class=\"bash\">sudo cp /etc/X11/xinit/xinitrc ~/.xinitrc</code></pre>\n<ul>\n<li>Tap-to-click</li>\n</ul>\n<pre><code class=\"bash\">sudo vim /etc/X11/xorg.conf.d/30-touchpad.conf</code></pre>\n<p>Add the following lines to it.</p>\n<pre><code>Section &quot;InputClass&quot;\n  Identifier &quot;touchpad&quot;\n  Driver &quot;libinput&quot;\n  MatchIsTouchpad &quot;on&quot;\n  Option &quot;Tapping&quot; &quot;on&quot;\nEndSection</code></pre><ul>\n<li>Install Windows Manager (i3)</li>\n</ul>\n<pre><code class=\"bash\">sudo pacman -S i3</code></pre>\n<p>It include <code>i3-gaps</code> , <code>i3wm</code> , <code>i3blocks</code> , <code>i3lock</code> , <code>i3status</code></p>\n<ul>\n<li>Use i3</li>\n</ul>\n<p>Add <code>exec i3</code> to the end of <code>~.xinitrc</code> .</p>\n<ul>\n<li>Start Xorg server.</li>\n</ul>\n<pre><code class=\"bash\">startx</code></pre>\n<ul>\n<li>Autostart X at login</li>\n</ul>\n<p>I’m a <a href=\"https://fishshell.com/\" target=\"_blank\" rel=\"noopener\">fish</a> user, so i just need add the following to the bottom of my <code>~/.config/fish/config.fish</code> .</p>\n<pre><code class=\"bash\"># Start X at login\nif status is-login\n    if test -z &quot;$DISPLAY&quot; -a $XDG_VTNR = 1\n        exec startx -- -keeptty\n    end\nend</code></pre>\n<p>Other shell user (like <strong>bash</strong> , <strong>zsh</strong> ), Please visit <a href=\"https://wiki.archlinux.org/index.php/Xinit#Autostart_X_at_login\" target=\"_blank\" rel=\"noopener\">here</a> </p>\n<h3 id=\"4-i3wm\"><a href=\"#4-i3wm\" class=\"headerlink\" title=\"4. i3wm\"></a>4. i3wm</h3><p><a href=\"https://i3wm.org\" target=\"_blank\" rel=\"noopener\">i3wm</a>  ,   <a href=\"https://wiki.archlinux.org/index.php/I3\" target=\"_blank\" rel=\"noopener\">i3-ArchWiki</a> </p>\n<p><a href=\"https://github.com/liuyaanng/Arch_linux#i3-and-i3status\" target=\"_blank\" rel=\"noopener\">My i3 config</a> </p>\n<h3 id=\"5-Some-useful-software\"><a href=\"#5-Some-useful-software\" class=\"headerlink\" title=\"5. Some useful software\"></a>5. Some useful software</h3><ul>\n<li>yaourt</li>\n</ul>\n<p>Add the source to <code>/etc/pacman.conf</code></p>\n<pre><code>[archlinuxcn]\n#The Chinese Arch Linux communities packages.\nSigLevel = Optional TrustAll\nServer = http://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch\n#Server   = http://repo.archlinuxcn.org/$arch\n#Server   = http://repo.archlinux.fr/$arch</code></pre><p>Synchronized communities</p>\n<pre><code class=\"bash\">sudo pacman -Syu</code></pre>\n<p>Insatll yaourt </p>\n<pre><code class=\"bash\">sudo pacman -S yaourt</code></pre>\n<ul>\n<li><a href=\"https://godliuyang.wang/2019/08/24/manjaro-i3wm-huan-jing-pei-zhi-pian/#toc-heading-13\" target=\"_blank\" rel=\"noopener\">Software i use often</a></li>\n</ul>\n<h3 id=\"6-Fonts\"><a href=\"#6-Fonts\" class=\"headerlink\" title=\"6. Fonts\"></a>6. Fonts</h3><p><a href=\"https://wiki.archlinux.org/index.php/Fonts\" target=\"_blank\" rel=\"noopener\">Fonts-ArchWiki</a> , <a href=\"https://github.com/ryanoasis/nerd-fonts\" target=\"_blank\" rel=\"noopener\">Nerd-fonts</a> , <a href=\"https://unicode-table.com/en/\" target=\"_blank\" rel=\"noopener\">Unicode-table</a>  </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">adobe-source-code-pro</th>\n<th align=\"center\">adobe-source-han-serif-cn-fonts</th>\n<th align=\"center\">adobe-source-han-serif-tw-fonts</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">ttf-symbola</td>\n<td align=\"center\">nerd-fonts-complete</td>\n<td align=\"center\">nerd-fonts-dejavu-complete</td>\n</tr>\n<tr>\n<td align=\"center\">font-awesome</td>\n<td align=\"center\">noto-fonts-emoji</td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<p><code>fc-list</code> to show the fonts you have installed.</p>\n<h3 id=\"7-Volume\"><a href=\"#7-Volume\" class=\"headerlink\" title=\"7. Volume\"></a>7. Volume</h3><ul>\n<li><p>ALSA is a set of built-in GNU/Linux modules. Therefore, manual insatllation is not necessary.</p>\n</li>\n<li><p>Install <strong>pulseaudio</strong></p>\n</li>\n</ul>\n<pre><code class=\"bash\">sudo pacman -S pulseaudio</code></pre>\n<ul>\n<li>Install <strong>alsa-utils</strong></li>\n</ul>\n<pre><code class=\"bash\">sudo pacman -S alsa-utils</code></pre>\n<p>Use <code>alsamixer</code> to manage the system volume</p>\n<ul>\n<li>VoulmeIcon</li>\n</ul>\n<p><img src=\"9.png\" alt=\"VolumeIcon\"> </p>\n<p>If you want a System volume tray, you can try <strong>volumeicon</strong></p>\n<ol>\n<li><p>Install volumeicon</p>\n<pre><code class=\"bash\">sudo pacman -S volumeicon</code></pre>\n</li>\n<li><p>Add <code>volumeicon</code> file in <code>~/.config/volumeicon</code>  , and add the following lines to it.</p>\n<pre><code class=\"bash\">[Alsa]\ncard=default\n\n[Notification]\nshow_notification=true\nnotification_type=1\n\n[StatusIcon]\nstepsize=5\nonclick=xterm -e &#39;alsamixer&#39;\ntheme=White Gnome\nuse_panel_specific_icons=true\nlmb_slider=true\nmmb_mute=true\nuse_horizontal_slider=false\nshow_sound_level=true\nuse_transparent_bac&lt;++&gt;kground=true\n\n[Hotkeys]\nup_enabled=true\ndown_enabled=true\nmute_enabled=true\nup=XF86AudioRaiseVolume\ndown=XF86AudioLowerVolume\nmute=XF86AudioMute</code></pre>\n</li>\n<li><p>Create <code>pulseaudio-ctl.desktop</code> in <code>~/.config/autostart</code> , and add the following lines to it.</p>\n<pre><code class=\"bash\">[Desktop Entry]\nEncoding=UTF-8\nType=Application\nName=pulseaudio-ctl\ncomment=Set Volume to 70%\nExec=pulseaudio-ctl-normal\nStartupNotify=true\nTerminal=false\nHidden=false</code></pre>\n</li>\n<li><p>Add <code>exec --no-startup-id volumeicon</code> to <code>~/.config/i3/config</code> .</p>\n</li>\n<li><p>I wrote two scripts to control the volume of the system with <code>alsamixer</code> and <code>dunst</code> , put them to <code>/usr/bin/</code> .</p>\n<p><a href=\"https://github.com/liuyaanng/Arch_linux/blob/master/volume_up.sh\" target=\"_blank\" rel=\"noopener\">volume_up</a><br><a href=\"https://github.com/liuyaanng/Arch_linux/blob/master/volume_down.sh\" target=\"_blank\" rel=\"noopener\">volume_down</a> </p>\n</li>\n</ol>\n<h3 id=\"8-Screen-brightness\"><a href=\"#8-Screen-brightness\" class=\"headerlink\" title=\"8. Screen brightness\"></a>8. Screen brightness</h3><p>A good advice for backlight management is <code>xorg-xbacklight</code> , but it seems not work on my computer. </p>\n<p><img src=\"12.png\" alt=\"xbacklight -error\"> </p>\n<p>If you have the same problem, you can try the solution of Wiki, but it still can’t work on my computer. Sad! So i try another way to control the screen brightness.<br>The backlight can be controlled by the file <code>/sys/class/backlight/intel_backlight/brightness</code> ‘s value. So i wrote a script to control it. I named it <code>intel_brightness_control.sh</code></p>\n<pre><code class=\"bash\">#!/bin/bash\nset -e\nfile=&quot;/sys/class/backlight/intel_backlight/brightness&quot;\ncurrent=$(cat &quot;$file&quot;)\nnew=&quot;$current&quot;\nif [ &quot;$1&quot; = &quot;-inc&quot; ]\nthen\n  new=$(( current + $2 ))\n  status=&quot;Up&quot;\nfi\nif [ &quot;$1&quot; = &quot;-dec&quot; ]\nthen\n  if [ current &lt; 100 ]\n  then\n    new=&quot;50&quot;\n  else\n    new=$(( current - $2 ))\n  fi\n  status=&quot;Down&quot;\nfi\necho &quot;$new&quot; | tee &quot;$file&quot;\nbrightness=`light -G`\nnotify-send &quot;Brightness $status($brightness%)&quot;</code></pre>\n<p>Remember put it in your <code>/usr/bin/</code>.</p>\n<p>Then do <code>sudo chmod 777 /sys/class/backlight/intel_backlight/brightness</code> . The last thing is adding the following lines to <code>.config/i3/config</code> .</p>\n<pre><code class=\"bash\"># Screen brightness controls\nbindsym XF86MonBrightnessUp exec &quot;intel_brightness_control.sh -inc 100&quot;\nbindsym XF86MonBrightnessDown exec &quot;intel_brightness_control.sh -dec 100&quot;</code></pre>\n<h3 id=\"9-Bluetooth\"><a href=\"#9-Bluetooth\" class=\"headerlink\" title=\"9. Bluetooth\"></a>9. Bluetooth</h3><ul>\n<li>Install <strong>bluez</strong> , <strong>bluez-utils</strong></li>\n</ul>\n<pre><code class=\"bash\">sudo pacman -S bluez bluez-utils</code></pre>\n<ul>\n<li>The generic Bluetooth driver is the <code>btusb</code> Kernel module. Use <code>lsmod</code> to check whether that module is loaded. </li>\n</ul>\n<p><img src=\"11.png\" alt=\"btusb module\"><br>  If it’s not, do <code>modprobe btusb</code> to load the moudle.</p>\n<ul>\n<li>Start / Enable</li>\n</ul>\n<pre><code class=\"bash\">systemctl enable bluetooth.service\nsystemctl start bluetooth.service</code></pre>\n<ul>\n<li>Auto power-on after boot</li>\n</ul>\n<p>Add the line <code>AutoEnable=true</code> in <code>/etc/bluetooth/main.conf</code> at the bottom in the <code>[Policy]</code> section.</p>\n<ul>\n<li>Discoverable on startup</li>\n</ul>\n<pre><code class=\"bash\">/etc/bluetooth/main.conf\n\n[General]\nDiscoverableTimeout = 0\nDiscoverable=true</code></pre>\n<ul>\n<li>Install <strong>pulseaudio-bluetooth</strong> to use audio equipment like bluetooth headphones or speakers.</li>\n</ul>\n<p><a href=\"https://wiki.archlinux.org/index.php/Bluetooth_headset\" target=\"_blank\" rel=\"noopener\">Bluetooth headset</a> </p>\n<pre><code class=\"bash\">sudo pacman -S pulseaudio-bluetooth</code></pre>\n<ul>\n<li>Install <a href=\"https://github.com/blueman-project/blueman\" target=\"_blank\" rel=\"noopener\">blueman</a> </li>\n</ul>\n<pre><code class=\"bash\">sudo pacman -S blueman</code></pre>\n<ol>\n<li><code>blueman-applet</code> to use.</li>\n<li>add <code>exec --no-startup-id blueman-applet</code> to <code>~/.config/i3/config</code> to auto start <code>blueman-applet</code> .</li>\n</ol>\n<h3 id=\"10-Notify-Dunst\"><a href=\"#10-Notify-Dunst\" class=\"headerlink\" title=\"10. Notify(Dunst)\"></a>10. Notify(Dunst)</h3><pre><code class=\"bash\">sudo pacman -S libnotify dunst</code></pre>\n<p>Create <code>org.freedesktop.Notifications.service</code> in <code>/usr/share/dbus-1/services/</code> folder. Add the following lines.</p>\n<pre><code>[D-BUS Service]\nName.org.freedesktop.Notifications\nExec=/usr/local/bin/dunst</code></pre><p>An example configuration file is included at <code>/usr/local/share/dunst/dunstrc</code> . Copy this file to <code>~/.config/dunst/dunstrc</code> and edit it accordingly.</p>\n<p><a href=\"https://github.com/liuyaanng/Arch_linux/tree/master/dunst\" target=\"_blank\" rel=\"noopener\">My Dunstrc</a> </p>\n<p>Use <code>notify-send &quot;Hello, world!&quot;</code> to test.</p>\n<p><img src=\"10.png\" alt=\"Dunst\"> </p>\n<h3 id=\"11-Shutdown-Reboot-LockScreen\"><a href=\"#11-Shutdown-Reboot-LockScreen\" class=\"headerlink\" title=\"11. Shutdown Reboot LockScreen\"></a>11. Shutdown Reboot LockScreen</h3><ul>\n<li>Create a script named <code>i3exit</code> . Make sure you have <code>polkit</code> installed. </li>\n</ul>\n<pre><code class=\"bash\">#!/bin/sh\nlock() {\n    i3lock\n}\n\ncase &quot;$1&quot; in\n    lock)\n        blurlock\n        ;;\n    logout)\n        i3-msg exit\n        ;;\n    suspend)\n        blurlock &amp;&amp; systemctl suspend\n        ;;\n    hibernate)\n        blurlock &amp;&amp; systemctl hibernate\n        ;;\n    reboot)\n        systemctl reboot\n        ;;\n    shutdown)\n        systemctl poweroff\n        ;;\n    *)\n        echo &quot;Usage: $0 {lock|logout|suspend|hibernate|reboot|shutdown}&quot;\n        exit 2\nesac\n\nexit 0</code></pre>\n<p>Do <code>chmod +x</code> and put it in <code>$PATH</code> ( <code>/usr/bin/</code> ) .</p>\n<ul>\n<li>Add the following lines to <code>.config/i3/config</code></li>\n</ul>\n<pre><code class=\"bash\">set $mode_system System (l) lock, (e) logout, (s) suspend, (h) hibernate, (r) reboot, (Shift+s) shutdown\nmode &quot;$mode_system&quot; {\n    bindsym l exec --no-startup-id i3exit lock, mode &quot;default&quot;\n    bindsym e exec --no-startup-id i3exit logout, mode &quot;default&quot;\n    bindsym s exec --no-startup-id i3exit suspend, mode &quot;default&quot;\n    bindsym h exec --no-startup-id i3exit hibernate, mode &quot;default&quot;\n    bindsym r exec --no-startup-id i3exit reboot, mode &quot;default&quot;\n    bindsym Shift+s exec --no-startup-id i3exit shutdown, mode &quot;default&quot;  \n\n    # back to normal: Enter or Escape\n    bindsym Return mode &quot;default&quot;\n    bindsym Escape mode &quot;default&quot;\n}\nbindsym $mod+Pause mode &quot;$mode_system&quot;</code></pre>\n"},{"title":"About Proxy","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-02-04T07:00:57.000Z","img":"https://i.loli.net/2020/02/02/HvfDTFuE48MARon.png","password":null,"summary":"SSR OR V2RAY?","_content":"\n\n# About Proxy\n\n\n~~Script: [SSR](https://github.com/liuyaanng/SSR)~~  SSR seems very unstable, i use **v2ray** now.\n\nPing test: [ping](http://ping.chinaz.com/) \n\n![Youtube speed](1.png) \n\n## V2Ray\n\nPreconditions:\n- a VPS: [vultr](https://www.vultr.com/)( \\$5/m , i uesd now) , [VIRMACH](https://billing.virmach.com/cart.php)( \\$1.25/m)\n- a Domain: ([Namesilo](https://www.namesilo.com/)($0.99), [Freenom](https://www.freenom.com/)(free) )\n- VPS OS version: Debian 9+ / Ubuntu 18.04+ / CentOS 7+\n\n### 1. Resolve the domain to the IP of your VPS\n\n[Cloudflare](https://www.cloudflare.com/) \n\n#### 1. Add site\n\n![](2.png) \n\n#### 2. Change your domain NS\n\n![](5.png) \n\n![](3.png) \n\n![](4.png) \n\n#### 3. Add record\n\n![](6.png) \n\n~~You can light the cloud icon to use a proxy which can hidden real ip. ~~ it is possible to make v2ray doesn't work.\n\nNOTE: **Do it after installed V2Ray if u need it**\n\n#### 4. Ping\n\n![](7.png) \n\nit works.\n\n### 2. Set BBR lotserver\n\n```bash\nwget --no-check-certificate https://raw.githubusercontent.com/liuyaanng/SSR/master/tcp.sh && chmod +x tcp.sh && ./tcp.sh\n```\n\n![](8.png) \n\n### 3. Install V2Ray\n\nThere are two way to install V2Ray use different methods.\n\n- Vmess+websocket+TLS+Nginx+Website\n\n```bash\nbash <(curl -L -s https://raw.githubusercontent.com/wulabing/V2Ray_ws-tls_bash_onekey/master/install.sh) | tee v2ray_ins.log\n```\n\n- Vmess + HTTP2 over TLS\n\n```bash\nbash <(curl -L -s https://raw.githubusercontent.com/wulabing/V2Ray_ws-tls_bash_onekey/master/install_h2.sh) | tee v2ray_ins_h2.log\n```\n\n![](9.png) \n\nSELF TESTING\n\n### 4. Run V2Ray\n\n- start v2ray: `systemctl start v2ray`\n- stop v2ray: `systemctl stop v2ray`\n- start nginx: `systemctl start nginx`\n- stop nginx: `systemctl stop nginx`\n\n\n### 5. V2Ray client\n\n- Windows: \n  - [V2RayN](https://tlanyan.me/download.php?filename=/v2/windows/v2rayN-v3.5.zip) \n- MacOS:\n  - [V2RayU](https://tlanyan.me/download.php?filename=/v2/macos/v2rayU-v1.5.1.dmg) \n- Linux:\n  - [link](https://www.jianshu.com/p/a5b6d9dc0441) \n  - [Snap](https://snapcraft.io/install/v2ray-core/arch#install)\n  - Configuration V2Ray\n  \n   config file is located in `/etc/v2ray/config.json`\n```bash\n{\n  \"policy\": null,\n  \"log\": {\n    \"access\": \"\",\n    \"error\": \"\",\n    \"loglevel\": \"warning\"\n  },\n  \"inbounds\": [\n    {\n      \"tag\": \"proxy\",\n      \"port\": 1080,\n      \"listen\": \"127.0.0.1\",\n      \"protocol\": \"socks\",\n      \"sniffing\": {\n        \"enabled\": true,\n        \"destOverride\": [\n          \"http\",\n          \"tls\"\n        ]\n      },\n      \"settings\": {\n        \"auth\": \"noauth\",\n        \"udp\": true,\n        \"ip\": null,\n        \"address\": null,\n        \"clients\": null\n      },\n      \"streamSettings\": null\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"tag\": \"proxy\",\n      \"protocol\": \"vmess\",\n      \"settings\": {\n        \"vnext\": [\n          {\n            \"address\": \" \", //your domain address\n            \"port\":  ,   //port\n            \"users\": [\n              {\n                \"id\": \" \",   //id\n                \"alterId\": 2,\n                \"email\": \"t@t.tt\",\n                \"security\": \"auto\"\n              }\n            ]\n          }\n        ],\n        \"servers\": null,\n        \"response\": null\n      },\n        \"streamSettings\": {\n        \"network\": \"ws\",\n        \"security\": \"tls\",\n        \"tlsSettings\": {\n          \"allowInsecure\": true,\n          \"serverName\": \" \"    //domain address\n        },\n        \"tcpSettings\": null,\n        \"kcpSettings\": null,\n        \"wsSettings\": {\n          \"connectionReuse\": true,\n          \"path\": \"/e3137ae7/\",   //path\n          \"headers\": {\n            \"Host\": \" \"  //domain address\n          }\n        },\n        \"httpSettings\": null,\n        \"quicSettings\": null\n      },\n      \"mux\": {\n        \"enabled\": true,\n        \"concurrency\": 8\n      }\n    },\n    {\n      \"tag\": \"direct\",\n      \"protocol\": \"freedom\",\n      \"settings\": {\n        \"vnext\": null,\n        \"servers\": null,\n        \"response\": null\n      },\n      \"streamSettings\": null,\n      \"mux\": null\n    },\n    {\n      \"tag\": \"block\",\n      \"protocol\": \"blackhole\",\n      \"settings\": {\n        \"vnext\": null,\n        \"servers\": null,\n        \"response\": {\n          \"type\": \"http\"\n        }\n      },\n      \"streamSettings\": null,\n      \"mux\": null\n    }\n  ],\n  \"stats\": null,\n  \"api\": null,\n  \"dns\": null,\n  \"routing\": {\n    \"domainStrategy\": \"IPIfNonMatch\",\n    \"rules\": [\n      {\n        \"type\": \"field\",\n        \"port\": null,\n        \"inboundTag\": [\n          \"api\"\n        ],\n        \"outboundTag\": \"api\",\n        \"ip\": null,\n        \"domain\": null\n      }\n    ]\n  }\n}\n```\n\n  \n## Terminal Proxy\n\n### proxychains\n\ni can make some terminal commands run with proxy. But it seems can't work on my computer. Sad. Anyway, i still share the way to install and configure.\n\n- Installation\n\n```bash\nsudo pacman -S proxychains\n```\n\nOr you can install it from source code. (make sure your `gcc` installed)\n\n\n```bash\ngit clone https://github.com/rofl0r/proxychains-ng\ncd proxychains-ng\n./configure\nsudo make && make install\nsudo make install-config(generate config file)\n```\n\n- Configuration\nconfig file is saved in `/etc/proxychains.conf`\n\nAdd `socks5  127.0.0.1 1080` to the end. note the space!\n\n- Use\n\nAdd `proxychains` before the terminal commands.\n\n```bash\nproxychains git clone https://github.com/rofl0r/proxychains-ng\n```\n\nyou can run `npm` , `docker` ... But `ping` command is not suitable, because proxychains can only proxy **TCP**, and `ping` is use **ICMP**.\n\n### git\n\nYou may need to configure a proxy server if you're having trouble cloning or fetching from a remote repository or getting an error like unable to access `Couldn't resolve host`.\n\nConsider something like:\n\n```bash\ngit config --global http.proxy http://proxyUsername:proxyPassword@proxy.server.com:port\n```\n\ni use ` git config --global http.proxy 'socks5://127.0.0.1:1080' ` to set my git cause i use socks5.\n\ni also use ` git config --local http.proxy 'socks5://127.0.0.1:1080'` to set my local config that can only work in 'git clone' repositories.\n\nCheck global proxy:\n\n```bash\ngit config --global http.proxy\n```\n\nCheck local proxy:\n\n```bash\ngit config --local http.proxy\n```\n\nCancel proxy:\n\n```bash\ngit config --global --unset http.proxy\n```\n\n```bash\ngit config --local --unset http.proxy\n```\n\n### wget\n\nCreate `.wgetrc` file in home directory.\n\n```bash\nuse_proxy=yes\nhttp_proxy=127.0.0.1:1080\nhttps_proxy=127.0.0.1:1080\n```\n\nit can only use http proxy.\n\n\n\n\n","source":"_posts/About-Proxy.md","raw":"---\ntitle: About Proxy\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-02-04 15:00:57\nimg: https://i.loli.net/2020/02/02/HvfDTFuE48MARon.png\npassword:\nsummary: SSR OR V2RAY?\ntags:\ncategories:\n---\n\n\n# About Proxy\n\n\n~~Script: [SSR](https://github.com/liuyaanng/SSR)~~  SSR seems very unstable, i use **v2ray** now.\n\nPing test: [ping](http://ping.chinaz.com/) \n\n![Youtube speed](1.png) \n\n## V2Ray\n\nPreconditions:\n- a VPS: [vultr](https://www.vultr.com/)( \\$5/m , i uesd now) , [VIRMACH](https://billing.virmach.com/cart.php)( \\$1.25/m)\n- a Domain: ([Namesilo](https://www.namesilo.com/)($0.99), [Freenom](https://www.freenom.com/)(free) )\n- VPS OS version: Debian 9+ / Ubuntu 18.04+ / CentOS 7+\n\n### 1. Resolve the domain to the IP of your VPS\n\n[Cloudflare](https://www.cloudflare.com/) \n\n#### 1. Add site\n\n![](2.png) \n\n#### 2. Change your domain NS\n\n![](5.png) \n\n![](3.png) \n\n![](4.png) \n\n#### 3. Add record\n\n![](6.png) \n\n~~You can light the cloud icon to use a proxy which can hidden real ip. ~~ it is possible to make v2ray doesn't work.\n\nNOTE: **Do it after installed V2Ray if u need it**\n\n#### 4. Ping\n\n![](7.png) \n\nit works.\n\n### 2. Set BBR lotserver\n\n```bash\nwget --no-check-certificate https://raw.githubusercontent.com/liuyaanng/SSR/master/tcp.sh && chmod +x tcp.sh && ./tcp.sh\n```\n\n![](8.png) \n\n### 3. Install V2Ray\n\nThere are two way to install V2Ray use different methods.\n\n- Vmess+websocket+TLS+Nginx+Website\n\n```bash\nbash <(curl -L -s https://raw.githubusercontent.com/wulabing/V2Ray_ws-tls_bash_onekey/master/install.sh) | tee v2ray_ins.log\n```\n\n- Vmess + HTTP2 over TLS\n\n```bash\nbash <(curl -L -s https://raw.githubusercontent.com/wulabing/V2Ray_ws-tls_bash_onekey/master/install_h2.sh) | tee v2ray_ins_h2.log\n```\n\n![](9.png) \n\nSELF TESTING\n\n### 4. Run V2Ray\n\n- start v2ray: `systemctl start v2ray`\n- stop v2ray: `systemctl stop v2ray`\n- start nginx: `systemctl start nginx`\n- stop nginx: `systemctl stop nginx`\n\n\n### 5. V2Ray client\n\n- Windows: \n  - [V2RayN](https://tlanyan.me/download.php?filename=/v2/windows/v2rayN-v3.5.zip) \n- MacOS:\n  - [V2RayU](https://tlanyan.me/download.php?filename=/v2/macos/v2rayU-v1.5.1.dmg) \n- Linux:\n  - [link](https://www.jianshu.com/p/a5b6d9dc0441) \n  - [Snap](https://snapcraft.io/install/v2ray-core/arch#install)\n  - Configuration V2Ray\n  \n   config file is located in `/etc/v2ray/config.json`\n```bash\n{\n  \"policy\": null,\n  \"log\": {\n    \"access\": \"\",\n    \"error\": \"\",\n    \"loglevel\": \"warning\"\n  },\n  \"inbounds\": [\n    {\n      \"tag\": \"proxy\",\n      \"port\": 1080,\n      \"listen\": \"127.0.0.1\",\n      \"protocol\": \"socks\",\n      \"sniffing\": {\n        \"enabled\": true,\n        \"destOverride\": [\n          \"http\",\n          \"tls\"\n        ]\n      },\n      \"settings\": {\n        \"auth\": \"noauth\",\n        \"udp\": true,\n        \"ip\": null,\n        \"address\": null,\n        \"clients\": null\n      },\n      \"streamSettings\": null\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"tag\": \"proxy\",\n      \"protocol\": \"vmess\",\n      \"settings\": {\n        \"vnext\": [\n          {\n            \"address\": \" \", //your domain address\n            \"port\":  ,   //port\n            \"users\": [\n              {\n                \"id\": \" \",   //id\n                \"alterId\": 2,\n                \"email\": \"t@t.tt\",\n                \"security\": \"auto\"\n              }\n            ]\n          }\n        ],\n        \"servers\": null,\n        \"response\": null\n      },\n        \"streamSettings\": {\n        \"network\": \"ws\",\n        \"security\": \"tls\",\n        \"tlsSettings\": {\n          \"allowInsecure\": true,\n          \"serverName\": \" \"    //domain address\n        },\n        \"tcpSettings\": null,\n        \"kcpSettings\": null,\n        \"wsSettings\": {\n          \"connectionReuse\": true,\n          \"path\": \"/e3137ae7/\",   //path\n          \"headers\": {\n            \"Host\": \" \"  //domain address\n          }\n        },\n        \"httpSettings\": null,\n        \"quicSettings\": null\n      },\n      \"mux\": {\n        \"enabled\": true,\n        \"concurrency\": 8\n      }\n    },\n    {\n      \"tag\": \"direct\",\n      \"protocol\": \"freedom\",\n      \"settings\": {\n        \"vnext\": null,\n        \"servers\": null,\n        \"response\": null\n      },\n      \"streamSettings\": null,\n      \"mux\": null\n    },\n    {\n      \"tag\": \"block\",\n      \"protocol\": \"blackhole\",\n      \"settings\": {\n        \"vnext\": null,\n        \"servers\": null,\n        \"response\": {\n          \"type\": \"http\"\n        }\n      },\n      \"streamSettings\": null,\n      \"mux\": null\n    }\n  ],\n  \"stats\": null,\n  \"api\": null,\n  \"dns\": null,\n  \"routing\": {\n    \"domainStrategy\": \"IPIfNonMatch\",\n    \"rules\": [\n      {\n        \"type\": \"field\",\n        \"port\": null,\n        \"inboundTag\": [\n          \"api\"\n        ],\n        \"outboundTag\": \"api\",\n        \"ip\": null,\n        \"domain\": null\n      }\n    ]\n  }\n}\n```\n\n  \n## Terminal Proxy\n\n### proxychains\n\ni can make some terminal commands run with proxy. But it seems can't work on my computer. Sad. Anyway, i still share the way to install and configure.\n\n- Installation\n\n```bash\nsudo pacman -S proxychains\n```\n\nOr you can install it from source code. (make sure your `gcc` installed)\n\n\n```bash\ngit clone https://github.com/rofl0r/proxychains-ng\ncd proxychains-ng\n./configure\nsudo make && make install\nsudo make install-config(generate config file)\n```\n\n- Configuration\nconfig file is saved in `/etc/proxychains.conf`\n\nAdd `socks5  127.0.0.1 1080` to the end. note the space!\n\n- Use\n\nAdd `proxychains` before the terminal commands.\n\n```bash\nproxychains git clone https://github.com/rofl0r/proxychains-ng\n```\n\nyou can run `npm` , `docker` ... But `ping` command is not suitable, because proxychains can only proxy **TCP**, and `ping` is use **ICMP**.\n\n### git\n\nYou may need to configure a proxy server if you're having trouble cloning or fetching from a remote repository or getting an error like unable to access `Couldn't resolve host`.\n\nConsider something like:\n\n```bash\ngit config --global http.proxy http://proxyUsername:proxyPassword@proxy.server.com:port\n```\n\ni use ` git config --global http.proxy 'socks5://127.0.0.1:1080' ` to set my git cause i use socks5.\n\ni also use ` git config --local http.proxy 'socks5://127.0.0.1:1080'` to set my local config that can only work in 'git clone' repositories.\n\nCheck global proxy:\n\n```bash\ngit config --global http.proxy\n```\n\nCheck local proxy:\n\n```bash\ngit config --local http.proxy\n```\n\nCancel proxy:\n\n```bash\ngit config --global --unset http.proxy\n```\n\n```bash\ngit config --local --unset http.proxy\n```\n\n### wget\n\nCreate `.wgetrc` file in home directory.\n\n```bash\nuse_proxy=yes\nhttp_proxy=127.0.0.1:1080\nhttps_proxy=127.0.0.1:1080\n```\n\nit can only use http proxy.\n\n\n\n\n","slug":"About-Proxy","published":1,"updated":"2020-02-24T10:49:41.283Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0sd000774juhkjworx0","content":"<h1 id=\"About-Proxy\"><a href=\"#About-Proxy\" class=\"headerlink\" title=\"About Proxy\"></a>About Proxy</h1><p><del>Script: <a href=\"https://github.com/liuyaanng/SSR\" target=\"_blank\" rel=\"noopener\">SSR</a></del>  SSR seems very unstable, i use <strong>v2ray</strong> now.</p>\n<p>Ping test: <a href=\"http://ping.chinaz.com/\" target=\"_blank\" rel=\"noopener\">ping</a> </p>\n<p><img src=\"1.png\" alt=\"Youtube speed\"> </p>\n<h2 id=\"V2Ray\"><a href=\"#V2Ray\" class=\"headerlink\" title=\"V2Ray\"></a>V2Ray</h2><p>Preconditions:</p>\n<ul>\n<li>a VPS: <a href=\"https://www.vultr.com/\" target=\"_blank\" rel=\"noopener\">vultr</a>( $5/m , i uesd now) , <a href=\"https://billing.virmach.com/cart.php\" target=\"_blank\" rel=\"noopener\">VIRMACH</a>( $1.25/m)</li>\n<li>a Domain: (<a href=\"https://www.namesilo.com/\" target=\"_blank\" rel=\"noopener\">Namesilo</a>($0.99), <a href=\"https://www.freenom.com/\" target=\"_blank\" rel=\"noopener\">Freenom</a>free) )</li>\n<li>VPS OS version: Debian 9+ / Ubuntu 18.04+ / CentOS 7+</li>\n</ul>\n<h3 id=\"1-Resolve-the-domain-to-the-IP-of-your-VPS\"><a href=\"#1-Resolve-the-domain-to-the-IP-of-your-VPS\" class=\"headerlink\" title=\"1. Resolve the domain to the IP of your VPS\"></a>1. Resolve the domain to the IP of your VPS</h3><p><a href=\"https://www.cloudflare.com/\" target=\"_blank\" rel=\"noopener\">Cloudflare</a> </p>\n<h4 id=\"1-Add-site\"><a href=\"#1-Add-site\" class=\"headerlink\" title=\"1. Add site\"></a>1. Add site</h4><p><img src=\"2.png\" alt> </p>\n<h4 id=\"2-Change-your-domain-NS\"><a href=\"#2-Change-your-domain-NS\" class=\"headerlink\" title=\"2. Change your domain NS\"></a>2. Change your domain NS</h4><p><img src=\"5.png\" alt> </p>\n<p><img src=\"3.png\" alt> </p>\n<p><img src=\"4.png\" alt> </p>\n<h4 id=\"3-Add-record\"><a href=\"#3-Add-record\" class=\"headerlink\" title=\"3. Add record\"></a>3. Add record</h4><p><img src=\"6.png\" alt> </p>\n<p><del>You can light the cloud icon to use a proxy which can hidden real ip. ~</del> it is possible to make v2ray doesn’t work.</p>\n<p>NOTE: <strong>Do it after installed V2Ray if u need it</strong></p>\n<h4 id=\"4-Ping\"><a href=\"#4-Ping\" class=\"headerlink\" title=\"4. Ping\"></a>4. Ping</h4><p><img src=\"7.png\" alt> </p>\n<p>it works.</p>\n<h3 id=\"2-Set-BBR-lotserver\"><a href=\"#2-Set-BBR-lotserver\" class=\"headerlink\" title=\"2. Set BBR lotserver\"></a>2. Set BBR lotserver</h3><pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> --no-check-certificate https://raw.githubusercontent.com/liuyaanng/SSR/master/tcp.sh <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">chmod</span> +x tcp.sh <span class=\"token operator\">&amp;&amp;</span> ./tcp.sh</code></pre>\n<p><img src=\"8.png\" alt> </p>\n<h3 id=\"3-Install-V2Ray\"><a href=\"#3-Install-V2Ray\" class=\"headerlink\" title=\"3. Install V2Ray\"></a>3. Install V2Ray</h3><p>There are two way to install V2Ray use different methods.</p>\n<ul>\n<li>Vmess+websocket+TLS+Nginx+Website</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">bash</span> <span class=\"token operator\">&lt;</span><span class=\"token punctuation\">(</span>curl -L -s https://raw.githubusercontent.com/wulabing/V2Ray_ws-tls_bash_onekey/master/install.sh<span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token function\">tee</span> v2ray_ins.log</code></pre>\n<ul>\n<li>Vmess + HTTP2 over TLS</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">bash</span> <span class=\"token operator\">&lt;</span><span class=\"token punctuation\">(</span>curl -L -s https://raw.githubusercontent.com/wulabing/V2Ray_ws-tls_bash_onekey/master/install_h2.sh<span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token function\">tee</span> v2ray_ins_h2.log</code></pre>\n<p><img src=\"9.png\" alt> </p>\n<p>SELF TESTING</p>\n<h3 id=\"4-Run-V2Ray\"><a href=\"#4-Run-V2Ray\" class=\"headerlink\" title=\"4. Run V2Ray\"></a>4. Run V2Ray</h3><ul>\n<li>start v2ray: <code>systemctl start v2ray</code></li>\n<li>stop v2ray: <code>systemctl stop v2ray</code></li>\n<li>start nginx: <code>systemctl start nginx</code></li>\n<li>stop nginx: <code>systemctl stop nginx</code></li>\n</ul>\n<h3 id=\"5-V2Ray-client\"><a href=\"#5-V2Ray-client\" class=\"headerlink\" title=\"5. V2Ray client\"></a>5. V2Ray client</h3><ul>\n<li><p>Windows: </p>\n<ul>\n<li><a href=\"https://tlanyan.me/download.php?filename=/v2/windows/v2rayN-v3.5.zip\" target=\"_blank\" rel=\"noopener\">V2RayN</a> </li>\n</ul>\n</li>\n<li><p>MacOS:</p>\n<ul>\n<li><a href=\"https://tlanyan.me/download.php?filename=/v2/macos/v2rayU-v1.5.1.dmg\" target=\"_blank\" rel=\"noopener\">V2RayU</a> </li>\n</ul>\n</li>\n<li><p>Linux:</p>\n<ul>\n<li><p><a href=\"https://www.jianshu.com/p/a5b6d9dc0441\" target=\"_blank\" rel=\"noopener\">link</a> </p>\n</li>\n<li><p><a href=\"https://snapcraft.io/install/v2ray-core/arch#install\" target=\"_blank\" rel=\"noopener\">Snap</a></p>\n</li>\n<li><p>Configuration V2Ray</p>\n<p>config file is located in <code>/etc/v2ray/config.json</code></p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">{</span>\n<span class=\"token string\">\"policy\"</span><span class=\"token keyword\">:</span> null,\n<span class=\"token string\">\"log\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"token string\">\"access\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"\"</span>,\n<span class=\"token string\">\"error\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"\"</span>,\n<span class=\"token string\">\"loglevel\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"warning\"</span>\n<span class=\"token punctuation\">}</span>,\n<span class=\"token string\">\"inbounds\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"tag\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"proxy\"</span>,\n  <span class=\"token string\">\"port\"</span><span class=\"token keyword\">:</span> 1080,\n  <span class=\"token string\">\"listen\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"127.0.0.1\"</span>,\n  <span class=\"token string\">\"protocol\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"socks\"</span>,\n  <span class=\"token string\">\"sniffing\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"enabled\"</span><span class=\"token keyword\">:</span> true,\n    <span class=\"token string\">\"destOverride\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"http\"</span>,\n      <span class=\"token string\">\"tls\"</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>,\n  <span class=\"token string\">\"settings\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"auth\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"noauth\"</span>,\n    <span class=\"token string\">\"udp\"</span><span class=\"token keyword\">:</span> true,\n    <span class=\"token string\">\"ip\"</span><span class=\"token keyword\">:</span> null,\n    <span class=\"token string\">\"address\"</span><span class=\"token keyword\">:</span> null,\n    <span class=\"token string\">\"clients\"</span><span class=\"token keyword\">:</span> null\n  <span class=\"token punctuation\">}</span>,\n  <span class=\"token string\">\"streamSettings\"</span><span class=\"token keyword\">:</span> null\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span>,\n<span class=\"token string\">\"outbounds\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"tag\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"proxy\"</span>,\n  <span class=\"token string\">\"protocol\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"vmess\"</span>,\n  <span class=\"token string\">\"settings\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"vnext\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"address\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\" \"</span>, //your domain address\n        <span class=\"token string\">\"port\"</span><span class=\"token keyword\">:</span>  ,   //port\n        <span class=\"token string\">\"users\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"id\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\" \"</span>,   //id\n            <span class=\"token string\">\"alterId\"</span><span class=\"token keyword\">:</span> 2,\n            <span class=\"token string\">\"email\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"t@t.tt\"</span>,\n            <span class=\"token string\">\"security\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"auto\"</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"servers\"</span><span class=\"token keyword\">:</span> null,\n    <span class=\"token string\">\"response\"</span><span class=\"token keyword\">:</span> null\n  <span class=\"token punctuation\">}</span>,\n    <span class=\"token string\">\"streamSettings\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"network\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"ws\"</span>,\n    <span class=\"token string\">\"security\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"tls\"</span>,\n    <span class=\"token string\">\"tlsSettings\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string\">\"allowInsecure\"</span><span class=\"token keyword\">:</span> true,\n      <span class=\"token string\">\"serverName\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\" \"</span>    //domain address\n    <span class=\"token punctuation\">}</span>,\n    <span class=\"token string\">\"tcpSettings\"</span><span class=\"token keyword\">:</span> null,\n    <span class=\"token string\">\"kcpSettings\"</span><span class=\"token keyword\">:</span> null,\n    <span class=\"token string\">\"wsSettings\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string\">\"connectionReuse\"</span><span class=\"token keyword\">:</span> true,\n      <span class=\"token string\">\"path\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"/e3137ae7/\"</span>,   //path\n      <span class=\"token string\">\"headers\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"Host\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\" \"</span>  //domain address\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>,\n    <span class=\"token string\">\"httpSettings\"</span><span class=\"token keyword\">:</span> null,\n    <span class=\"token string\">\"quicSettings\"</span><span class=\"token keyword\">:</span> null\n  <span class=\"token punctuation\">}</span>,\n  <span class=\"token string\">\"mux\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"enabled\"</span><span class=\"token keyword\">:</span> true,\n    <span class=\"token string\">\"concurrency\"</span><span class=\"token keyword\">:</span> 8\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>,\n<span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"tag\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"direct\"</span>,\n  <span class=\"token string\">\"protocol\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"freedom\"</span>,\n  <span class=\"token string\">\"settings\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"vnext\"</span><span class=\"token keyword\">:</span> null,\n    <span class=\"token string\">\"servers\"</span><span class=\"token keyword\">:</span> null,\n    <span class=\"token string\">\"response\"</span><span class=\"token keyword\">:</span> null\n  <span class=\"token punctuation\">}</span>,\n  <span class=\"token string\">\"streamSettings\"</span><span class=\"token keyword\">:</span> null,\n  <span class=\"token string\">\"mux\"</span><span class=\"token keyword\">:</span> null\n<span class=\"token punctuation\">}</span>,\n<span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"tag\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"block\"</span>,\n  <span class=\"token string\">\"protocol\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"blackhole\"</span>,\n  <span class=\"token string\">\"settings\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"vnext\"</span><span class=\"token keyword\">:</span> null,\n    <span class=\"token string\">\"servers\"</span><span class=\"token keyword\">:</span> null,\n    <span class=\"token string\">\"response\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string\">\"type\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"http\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>,\n  <span class=\"token string\">\"streamSettings\"</span><span class=\"token keyword\">:</span> null,\n  <span class=\"token string\">\"mux\"</span><span class=\"token keyword\">:</span> null\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span>,\n<span class=\"token string\">\"stats\"</span><span class=\"token keyword\">:</span> null,\n<span class=\"token string\">\"api\"</span><span class=\"token keyword\">:</span> null,\n<span class=\"token string\">\"dns\"</span><span class=\"token keyword\">:</span> null,\n<span class=\"token string\">\"routing\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"token string\">\"domainStrategy\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"IPIfNonMatch\"</span>,\n<span class=\"token string\">\"rules\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"type\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"field\"</span>,\n    <span class=\"token string\">\"port\"</span><span class=\"token keyword\">:</span> null,\n    <span class=\"token string\">\"inboundTag\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"api\"</span>\n    <span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"outboundTag\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"api\"</span>,\n    <span class=\"token string\">\"ip\"</span><span class=\"token keyword\">:</span> null,\n    <span class=\"token string\">\"domain\"</span><span class=\"token keyword\">:</span> null\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Terminal-Proxy\"><a href=\"#Terminal-Proxy\" class=\"headerlink\" title=\"Terminal Proxy\"></a>Terminal Proxy</h2><h3 id=\"proxychains\"><a href=\"#proxychains\" class=\"headerlink\" title=\"proxychains\"></a>proxychains</h3><p>i can make some terminal commands run with proxy. But it seems can’t work on my computer. Sad. Anyway, i still share the way to install and configure.</p>\n<ul>\n<li>Installation</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S proxychains</code></pre>\n<p>Or you can install it from source code. (make sure your <code>gcc</code> installed)</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone https://github.com/rofl0r/proxychains-ng\n<span class=\"token function\">cd</span> proxychains-ng\n./configure\n<span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">make</span> install-config<span class=\"token punctuation\">(</span>generate config file<span class=\"token punctuation\">)</span></code></pre>\n<ul>\n<li>Configuration<br>config file is saved in <code>/etc/proxychains.conf</code></li>\n</ul>\n<p>Add <code>socks5  127.0.0.1 1080</code> to the end. note the space!</p>\n<ul>\n<li>Use</li>\n</ul>\n<p>Add <code>proxychains</code> before the terminal commands.</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">proxychains <span class=\"token function\">git</span> clone https://github.com/rofl0r/proxychains-ng</code></pre>\n<p>you can run <code>npm</code> , <code>docker</code> … But <code>ping</code> command is not suitable, because proxychains can only proxy <strong>TCP</strong>, and <code>ping</code> is use <strong>ICMP</strong>.</p>\n<h3 id=\"git\"><a href=\"#git\" class=\"headerlink\" title=\"git\"></a>git</h3><p>You may need to configure a proxy server if you’re having trouble cloning or fetching from a remote repository or getting an error like unable to access <code>Couldn&#39;t resolve host</code>.</p>\n<p>Consider something like:</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> config --global http.proxy http://proxyUsername:proxyPassword@proxy.server.com:port</code></pre>\n<p>i use <code>git config --global http.proxy &#39;socks5://127.0.0.1:1080&#39;</code> to set my git cause i use socks5.</p>\n<p>i also use <code>git config --local http.proxy &#39;socks5://127.0.0.1:1080&#39;</code> to set my local config that can only work in ‘git clone’ repositories.</p>\n<p>Check global proxy:</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> config --global http.proxy</code></pre>\n<p>Check local proxy:</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> config --local http.proxy</code></pre>\n<p>Cancel proxy:</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> config --global --unset http.proxy</code></pre>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> config --local --unset http.proxy</code></pre>\n<h3 id=\"wget\"><a href=\"#wget\" class=\"headerlink\" title=\"wget\"></a>wget</h3><p>Create <code>.wgetrc</code> file in home directory.</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">use_proxy<span class=\"token operator\">=</span>yes\nhttp_proxy<span class=\"token operator\">=</span>127.0.0.1:1080\nhttps_proxy<span class=\"token operator\">=</span>127.0.0.1:1080</code></pre>\n<p>it can only use http proxy.</p>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"About-Proxy\"><a href=\"#About-Proxy\" class=\"headerlink\" title=\"About Proxy\"></a>About Proxy</h1><p><del>Script: <a href=\"https://github.com/liuyaanng/SSR\" target=\"_blank\" rel=\"noopener\">SSR</a></del>  SSR seems very unstable, i use <strong>v2ray</strong> now.</p>\n<p>Ping test: <a href=\"http://ping.chinaz.com/\" target=\"_blank\" rel=\"noopener\">ping</a> </p>\n<p><img src=\"1.png\" alt=\"Youtube speed\"> </p>\n<h2 id=\"V2Ray\"><a href=\"#V2Ray\" class=\"headerlink\" title=\"V2Ray\"></a>V2Ray</h2><p>Preconditions:</p>\n<ul>\n<li>a VPS: <a href=\"https://www.vultr.com/\" target=\"_blank\" rel=\"noopener\">vultr</a>( $5/m , i uesd now) , <a href=\"https://billing.virmach.com/cart.php\" target=\"_blank\" rel=\"noopener\">VIRMACH</a>( $1.25/m)</li>\n<li>a Domain: (<a href=\"https://www.namesilo.com/\" target=\"_blank\" rel=\"noopener\">Namesilo</a>($0.99), <a href=\"https://www.freenom.com/\" target=\"_blank\" rel=\"noopener\">Freenom</a>free) )</li>\n<li>VPS OS version: Debian 9+ / Ubuntu 18.04+ / CentOS 7+</li>\n</ul>\n<h3 id=\"1-Resolve-the-domain-to-the-IP-of-your-VPS\"><a href=\"#1-Resolve-the-domain-to-the-IP-of-your-VPS\" class=\"headerlink\" title=\"1. Resolve the domain to the IP of your VPS\"></a>1. Resolve the domain to the IP of your VPS</h3><p><a href=\"https://www.cloudflare.com/\" target=\"_blank\" rel=\"noopener\">Cloudflare</a> </p>\n<h4 id=\"1-Add-site\"><a href=\"#1-Add-site\" class=\"headerlink\" title=\"1. Add site\"></a>1. Add site</h4><p><img src=\"2.png\" alt> </p>\n<h4 id=\"2-Change-your-domain-NS\"><a href=\"#2-Change-your-domain-NS\" class=\"headerlink\" title=\"2. Change your domain NS\"></a>2. Change your domain NS</h4><p><img src=\"5.png\" alt> </p>\n<p><img src=\"3.png\" alt> </p>\n<p><img src=\"4.png\" alt> </p>\n<h4 id=\"3-Add-record\"><a href=\"#3-Add-record\" class=\"headerlink\" title=\"3. Add record\"></a>3. Add record</h4><p><img src=\"6.png\" alt> </p>\n<p><del>You can light the cloud icon to use a proxy which can hidden real ip. ~</del> it is possible to make v2ray doesn’t work.</p>\n<p>NOTE: <strong>Do it after installed V2Ray if u need it</strong></p>\n<h4 id=\"4-Ping\"><a href=\"#4-Ping\" class=\"headerlink\" title=\"4. Ping\"></a>4. Ping</h4><p><img src=\"7.png\" alt> </p>\n<p>it works.</p>\n<h3 id=\"2-Set-BBR-lotserver\"><a href=\"#2-Set-BBR-lotserver\" class=\"headerlink\" title=\"2. Set BBR lotserver\"></a>2. Set BBR lotserver</h3><pre><code class=\"bash\">wget --no-check-certificate https://raw.githubusercontent.com/liuyaanng/SSR/master/tcp.sh &amp;&amp; chmod +x tcp.sh &amp;&amp; ./tcp.sh</code></pre>\n<p><img src=\"8.png\" alt> </p>\n<h3 id=\"3-Install-V2Ray\"><a href=\"#3-Install-V2Ray\" class=\"headerlink\" title=\"3. Install V2Ray\"></a>3. Install V2Ray</h3><p>There are two way to install V2Ray use different methods.</p>\n<ul>\n<li>Vmess+websocket+TLS+Nginx+Website</li>\n</ul>\n<pre><code class=\"bash\">bash &lt;(curl -L -s https://raw.githubusercontent.com/wulabing/V2Ray_ws-tls_bash_onekey/master/install.sh) | tee v2ray_ins.log</code></pre>\n<ul>\n<li>Vmess + HTTP2 over TLS</li>\n</ul>\n<pre><code class=\"bash\">bash &lt;(curl -L -s https://raw.githubusercontent.com/wulabing/V2Ray_ws-tls_bash_onekey/master/install_h2.sh) | tee v2ray_ins_h2.log</code></pre>\n<p><img src=\"9.png\" alt> </p>\n<p>SELF TESTING</p>\n<h3 id=\"4-Run-V2Ray\"><a href=\"#4-Run-V2Ray\" class=\"headerlink\" title=\"4. Run V2Ray\"></a>4. Run V2Ray</h3><ul>\n<li>start v2ray: <code>systemctl start v2ray</code></li>\n<li>stop v2ray: <code>systemctl stop v2ray</code></li>\n<li>start nginx: <code>systemctl start nginx</code></li>\n<li>stop nginx: <code>systemctl stop nginx</code></li>\n</ul>\n<h3 id=\"5-V2Ray-client\"><a href=\"#5-V2Ray-client\" class=\"headerlink\" title=\"5. V2Ray client\"></a>5. V2Ray client</h3><ul>\n<li><p>Windows: </p>\n<ul>\n<li><a href=\"https://tlanyan.me/download.php?filename=/v2/windows/v2rayN-v3.5.zip\" target=\"_blank\" rel=\"noopener\">V2RayN</a> </li>\n</ul>\n</li>\n<li><p>MacOS:</p>\n<ul>\n<li><a href=\"https://tlanyan.me/download.php?filename=/v2/macos/v2rayU-v1.5.1.dmg\" target=\"_blank\" rel=\"noopener\">V2RayU</a> </li>\n</ul>\n</li>\n<li><p>Linux:</p>\n<ul>\n<li><p><a href=\"https://www.jianshu.com/p/a5b6d9dc0441\" target=\"_blank\" rel=\"noopener\">link</a> </p>\n</li>\n<li><p><a href=\"https://snapcraft.io/install/v2ray-core/arch#install\" target=\"_blank\" rel=\"noopener\">Snap</a></p>\n</li>\n<li><p>Configuration V2Ray</p>\n<p>config file is located in <code>/etc/v2ray/config.json</code></p>\n<pre><code class=\"bash\">{\n&quot;policy&quot;: null,\n&quot;log&quot;: {\n&quot;access&quot;: &quot;&quot;,\n&quot;error&quot;: &quot;&quot;,\n&quot;loglevel&quot;: &quot;warning&quot;\n},\n&quot;inbounds&quot;: [\n{\n  &quot;tag&quot;: &quot;proxy&quot;,\n  &quot;port&quot;: 1080,\n  &quot;listen&quot;: &quot;127.0.0.1&quot;,\n  &quot;protocol&quot;: &quot;socks&quot;,\n  &quot;sniffing&quot;: {\n    &quot;enabled&quot;: true,\n    &quot;destOverride&quot;: [\n      &quot;http&quot;,\n      &quot;tls&quot;\n    ]\n  },\n  &quot;settings&quot;: {\n    &quot;auth&quot;: &quot;noauth&quot;,\n    &quot;udp&quot;: true,\n    &quot;ip&quot;: null,\n    &quot;address&quot;: null,\n    &quot;clients&quot;: null\n  },\n  &quot;streamSettings&quot;: null\n}\n],\n&quot;outbounds&quot;: [\n{\n  &quot;tag&quot;: &quot;proxy&quot;,\n  &quot;protocol&quot;: &quot;vmess&quot;,\n  &quot;settings&quot;: {\n    &quot;vnext&quot;: [\n      {\n        &quot;address&quot;: &quot; &quot;, //your domain address\n        &quot;port&quot;:  ,   //port\n        &quot;users&quot;: [\n          {\n            &quot;id&quot;: &quot; &quot;,   //id\n            &quot;alterId&quot;: 2,\n            &quot;email&quot;: &quot;t@t.tt&quot;,\n            &quot;security&quot;: &quot;auto&quot;\n          }\n        ]\n      }\n    ],\n    &quot;servers&quot;: null,\n    &quot;response&quot;: null\n  },\n    &quot;streamSettings&quot;: {\n    &quot;network&quot;: &quot;ws&quot;,\n    &quot;security&quot;: &quot;tls&quot;,\n    &quot;tlsSettings&quot;: {\n      &quot;allowInsecure&quot;: true,\n      &quot;serverName&quot;: &quot; &quot;    //domain address\n    },\n    &quot;tcpSettings&quot;: null,\n    &quot;kcpSettings&quot;: null,\n    &quot;wsSettings&quot;: {\n      &quot;connectionReuse&quot;: true,\n      &quot;path&quot;: &quot;/e3137ae7/&quot;,   //path\n      &quot;headers&quot;: {\n        &quot;Host&quot;: &quot; &quot;  //domain address\n      }\n    },\n    &quot;httpSettings&quot;: null,\n    &quot;quicSettings&quot;: null\n  },\n  &quot;mux&quot;: {\n    &quot;enabled&quot;: true,\n    &quot;concurrency&quot;: 8\n  }\n},\n{\n  &quot;tag&quot;: &quot;direct&quot;,\n  &quot;protocol&quot;: &quot;freedom&quot;,\n  &quot;settings&quot;: {\n    &quot;vnext&quot;: null,\n    &quot;servers&quot;: null,\n    &quot;response&quot;: null\n  },\n  &quot;streamSettings&quot;: null,\n  &quot;mux&quot;: null\n},\n{\n  &quot;tag&quot;: &quot;block&quot;,\n  &quot;protocol&quot;: &quot;blackhole&quot;,\n  &quot;settings&quot;: {\n    &quot;vnext&quot;: null,\n    &quot;servers&quot;: null,\n    &quot;response&quot;: {\n      &quot;type&quot;: &quot;http&quot;\n    }\n  },\n  &quot;streamSettings&quot;: null,\n  &quot;mux&quot;: null\n}\n],\n&quot;stats&quot;: null,\n&quot;api&quot;: null,\n&quot;dns&quot;: null,\n&quot;routing&quot;: {\n&quot;domainStrategy&quot;: &quot;IPIfNonMatch&quot;,\n&quot;rules&quot;: [\n  {\n    &quot;type&quot;: &quot;field&quot;,\n    &quot;port&quot;: null,\n    &quot;inboundTag&quot;: [\n      &quot;api&quot;\n    ],\n    &quot;outboundTag&quot;: &quot;api&quot;,\n    &quot;ip&quot;: null,\n    &quot;domain&quot;: null\n  }\n]\n}\n}</code></pre>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Terminal-Proxy\"><a href=\"#Terminal-Proxy\" class=\"headerlink\" title=\"Terminal Proxy\"></a>Terminal Proxy</h2><h3 id=\"proxychains\"><a href=\"#proxychains\" class=\"headerlink\" title=\"proxychains\"></a>proxychains</h3><p>i can make some terminal commands run with proxy. But it seems can’t work on my computer. Sad. Anyway, i still share the way to install and configure.</p>\n<ul>\n<li>Installation</li>\n</ul>\n<pre><code class=\"bash\">sudo pacman -S proxychains</code></pre>\n<p>Or you can install it from source code. (make sure your <code>gcc</code> installed)</p>\n<pre><code class=\"bash\">git clone https://github.com/rofl0r/proxychains-ng\ncd proxychains-ng\n./configure\nsudo make &amp;&amp; make install\nsudo make install-config(generate config file)</code></pre>\n<ul>\n<li>Configuration<br>config file is saved in <code>/etc/proxychains.conf</code></li>\n</ul>\n<p>Add <code>socks5  127.0.0.1 1080</code> to the end. note the space!</p>\n<ul>\n<li>Use</li>\n</ul>\n<p>Add <code>proxychains</code> before the terminal commands.</p>\n<pre><code class=\"bash\">proxychains git clone https://github.com/rofl0r/proxychains-ng</code></pre>\n<p>you can run <code>npm</code> , <code>docker</code> … But <code>ping</code> command is not suitable, because proxychains can only proxy <strong>TCP</strong>, and <code>ping</code> is use <strong>ICMP</strong>.</p>\n<h3 id=\"git\"><a href=\"#git\" class=\"headerlink\" title=\"git\"></a>git</h3><p>You may need to configure a proxy server if you’re having trouble cloning or fetching from a remote repository or getting an error like unable to access <code>Couldn&#39;t resolve host</code>.</p>\n<p>Consider something like:</p>\n<pre><code class=\"bash\">git config --global http.proxy http://proxyUsername:proxyPassword@proxy.server.com:port</code></pre>\n<p>i use <code>git config --global http.proxy &#39;socks5://127.0.0.1:1080&#39;</code> to set my git cause i use socks5.</p>\n<p>i also use <code>git config --local http.proxy &#39;socks5://127.0.0.1:1080&#39;</code> to set my local config that can only work in ‘git clone’ repositories.</p>\n<p>Check global proxy:</p>\n<pre><code class=\"bash\">git config --global http.proxy</code></pre>\n<p>Check local proxy:</p>\n<pre><code class=\"bash\">git config --local http.proxy</code></pre>\n<p>Cancel proxy:</p>\n<pre><code class=\"bash\">git config --global --unset http.proxy</code></pre>\n<pre><code class=\"bash\">git config --local --unset http.proxy</code></pre>\n<h3 id=\"wget\"><a href=\"#wget\" class=\"headerlink\" title=\"wget\"></a>wget</h3><p>Create <code>.wgetrc</code> file in home directory.</p>\n<pre><code class=\"bash\">use_proxy=yes\nhttp_proxy=127.0.0.1:1080\nhttps_proxy=127.0.0.1:1080</code></pre>\n<p>it can only use http proxy.</p>\n"},{"title":"Anaconda","top":false,"cover":false,"toc":true,"mathjax":false,"img":"https://i.loli.net/2019/09/19/PLeZNEwcsvzlUSn.jpg","date":"2019-09-18T02:27:45.000Z","password":null,"summary":null,"_content":"\n## Install Anaconda and use it to manage your python.\n\n### 1. Download `Anaconda`\n\nClick here to download [Anaconda](https://www.anaconda.com/distribution/)\n\n### 2. Install `Anaconda`\n\n```bash\nbash ~/Downloads/Anaconda3-2019.07-Linux-x86_64.sh\n```\n\n![](3.png)\n\nPress ENTER\n\n![](4.png)\n\ninput yes \n\n![](5.png)\n\nPress ENTER    \nA few minutes later.......\n\n![](6.png)\n\ninput yes\n\n![](7.png)\n\nsuccessful installation.\n\nYou can use `conda -V` to check the version of anaconda.\n\n### 3. Bash user\n\n```bash\nvim ~/.bashrc\n```\nadd the following line to your ~/.bashrc.\n\n```bash\nexport PATH=\"/home/xupp/anaconda3/bin:$PATH\"\n```\nReboot your terminal.\n\n### 4. Fish user\n\nIf your shell is **fish**, you probably need to configure your environment variable.\n\n![](8.png)\n\nI use `set` command to do this.\n\n```bash\nset -xg\n```\n\nPrints all global, exported variables.\n\n![](1.png)\n\nI find the user name of anaconda path in PATH is wrong.\nI don't know why it is, but i know i should correct it.\n\n```bash\nset PATH[1] /home/kevin/anaconda3/bin\n```\nit works.\n\n![](9.png)\n\n![](10.png)\n","source":"_posts/Anaconda.md","raw":"---\ntitle: Anaconda\ntop: false\ncover: false\ntoc: true\nmathjax: false\nimg: https://i.loli.net/2019/09/19/PLeZNEwcsvzlUSn.jpg\ndate: 2019-09-18 10:27:45\npassword:\nsummary:\ntags:\n- Python\n- Anaconda3\n\ncategories:\n- 教程\n---\n\n## Install Anaconda and use it to manage your python.\n\n### 1. Download `Anaconda`\n\nClick here to download [Anaconda](https://www.anaconda.com/distribution/)\n\n### 2. Install `Anaconda`\n\n```bash\nbash ~/Downloads/Anaconda3-2019.07-Linux-x86_64.sh\n```\n\n![](3.png)\n\nPress ENTER\n\n![](4.png)\n\ninput yes \n\n![](5.png)\n\nPress ENTER    \nA few minutes later.......\n\n![](6.png)\n\ninput yes\n\n![](7.png)\n\nsuccessful installation.\n\nYou can use `conda -V` to check the version of anaconda.\n\n### 3. Bash user\n\n```bash\nvim ~/.bashrc\n```\nadd the following line to your ~/.bashrc.\n\n```bash\nexport PATH=\"/home/xupp/anaconda3/bin:$PATH\"\n```\nReboot your terminal.\n\n### 4. Fish user\n\nIf your shell is **fish**, you probably need to configure your environment variable.\n\n![](8.png)\n\nI use `set` command to do this.\n\n```bash\nset -xg\n```\n\nPrints all global, exported variables.\n\n![](1.png)\n\nI find the user name of anaconda path in PATH is wrong.\nI don't know why it is, but i know i should correct it.\n\n```bash\nset PATH[1] /home/kevin/anaconda3/bin\n```\nit works.\n\n![](9.png)\n\n![](10.png)\n","slug":"Anaconda","published":1,"updated":"2020-02-24T10:49:41.288Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0sk000a74juz6n971kp","content":"<h2 id=\"Install-Anaconda-and-use-it-to-manage-your-python\"><a href=\"#Install-Anaconda-and-use-it-to-manage-your-python\" class=\"headerlink\" title=\"Install Anaconda and use it to manage your python.\"></a>Install Anaconda and use it to manage your python.</h2><h3 id=\"1-Download-Anaconda\"><a href=\"#1-Download-Anaconda\" class=\"headerlink\" title=\"1. Download Anaconda\"></a>1. Download <code>Anaconda</code></h3><p>Click here to download <a href=\"https://www.anaconda.com/distribution/\" target=\"_blank\" rel=\"noopener\">Anaconda</a></p>\n<h3 id=\"2-Install-Anaconda\"><a href=\"#2-Install-Anaconda\" class=\"headerlink\" title=\"2. Install Anaconda\"></a>2. Install <code>Anaconda</code></h3><pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">bash</span> ~/Downloads/Anaconda3-2019.07-Linux-x86_64.sh</code></pre>\n<p><img src=\"3.png\" alt></p>\n<p>Press ENTER</p>\n<p><img src=\"4.png\" alt></p>\n<p>input yes </p>\n<p><img src=\"5.png\" alt></p>\n<p>Press ENTER<br>A few minutes later…….</p>\n<p><img src=\"6.png\" alt></p>\n<p>input yes</p>\n<p><img src=\"7.png\" alt></p>\n<p>successful installation.</p>\n<p>You can use <code>conda -V</code> to check the version of anaconda.</p>\n<h3 id=\"3-Bash-user\"><a href=\"#3-Bash-user\" class=\"headerlink\" title=\"3. Bash user\"></a>3. Bash user</h3><pre class=\" language-bash\"><code class=\"language-bash\">vim ~/.bashrc</code></pre>\n<p>add the following line to your ~/.bashrc.</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">export</span> PATH<span class=\"token operator\">=</span><span class=\"token string\">\"/home/xupp/anaconda3/bin:<span class=\"token variable\">$PATH</span>\"</span></code></pre>\n<p>Reboot your terminal.</p>\n<h3 id=\"4-Fish-user\"><a href=\"#4-Fish-user\" class=\"headerlink\" title=\"4. Fish user\"></a>4. Fish user</h3><p>If your shell is <strong>fish</strong>, you probably need to configure your environment variable.</p>\n<p><img src=\"8.png\" alt></p>\n<p>I use <code>set</code> command to do this.</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token keyword\">set</span> -xg</code></pre>\n<p>Prints all global, exported variables.</p>\n<p><img src=\"1.png\" alt></p>\n<p>I find the user name of anaconda path in PATH is wrong.<br>I don’t know why it is, but i know i should correct it.</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token keyword\">set</span> PATH<span class=\"token punctuation\">[</span>1<span class=\"token punctuation\">]</span> /home/kevin/anaconda3/bin</code></pre>\n<p>it works.</p>\n<p><img src=\"9.png\" alt></p>\n<p><img src=\"10.png\" alt></p>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h2 id=\"Install-Anaconda-and-use-it-to-manage-your-python\"><a href=\"#Install-Anaconda-and-use-it-to-manage-your-python\" class=\"headerlink\" title=\"Install Anaconda and use it to manage your python.\"></a>Install Anaconda and use it to manage your python.</h2><h3 id=\"1-Download-Anaconda\"><a href=\"#1-Download-Anaconda\" class=\"headerlink\" title=\"1. Download Anaconda\"></a>1. Download <code>Anaconda</code></h3><p>Click here to download <a href=\"https://www.anaconda.com/distribution/\" target=\"_blank\" rel=\"noopener\">Anaconda</a></p>\n<h3 id=\"2-Install-Anaconda\"><a href=\"#2-Install-Anaconda\" class=\"headerlink\" title=\"2. Install Anaconda\"></a>2. Install <code>Anaconda</code></h3><pre><code class=\"bash\">bash ~/Downloads/Anaconda3-2019.07-Linux-x86_64.sh</code></pre>\n<p><img src=\"3.png\" alt></p>\n<p>Press ENTER</p>\n<p><img src=\"4.png\" alt></p>\n<p>input yes </p>\n<p><img src=\"5.png\" alt></p>\n<p>Press ENTER<br>A few minutes later…….</p>\n<p><img src=\"6.png\" alt></p>\n<p>input yes</p>\n<p><img src=\"7.png\" alt></p>\n<p>successful installation.</p>\n<p>You can use <code>conda -V</code> to check the version of anaconda.</p>\n<h3 id=\"3-Bash-user\"><a href=\"#3-Bash-user\" class=\"headerlink\" title=\"3. Bash user\"></a>3. Bash user</h3><pre><code class=\"bash\">vim ~/.bashrc</code></pre>\n<p>add the following line to your ~/.bashrc.</p>\n<pre><code class=\"bash\">export PATH=&quot;/home/xupp/anaconda3/bin:$PATH&quot;</code></pre>\n<p>Reboot your terminal.</p>\n<h3 id=\"4-Fish-user\"><a href=\"#4-Fish-user\" class=\"headerlink\" title=\"4. Fish user\"></a>4. Fish user</h3><p>If your shell is <strong>fish</strong>, you probably need to configure your environment variable.</p>\n<p><img src=\"8.png\" alt></p>\n<p>I use <code>set</code> command to do this.</p>\n<pre><code class=\"bash\">set -xg</code></pre>\n<p>Prints all global, exported variables.</p>\n<p><img src=\"1.png\" alt></p>\n<p>I find the user name of anaconda path in PATH is wrong.<br>I don’t know why it is, but i know i should correct it.</p>\n<pre><code class=\"bash\">set PATH[1] /home/kevin/anaconda3/bin</code></pre>\n<p>it works.</p>\n<p><img src=\"9.png\" alt></p>\n<p><img src=\"10.png\" alt></p>\n"},{"title":"Day14","date":"2019-07-27T17:51:51.000Z","cover":false,"img":"https://i.loli.net/2019/07/17/5d2e73bb14bd344648.png","_content":"# High-quality-ellipse-detection\n\n高精度椭圆检测    \n参考[High-quality-ellipse-detection](https://github.com/AlanLuSun/High-quality-ellipse-detection)\n\n关于椭圆检测的部分，实在是看不懂，我只做了得到椭圆参数绘制椭圆的部分\n\n## OpenCV椭圆绘制\n\n### ellipse函数\n\n语法\n\n```\nvoid cvEllipse( CvArr* img, CvPoint center, CvSize axes, double angle,\n                double start_angle, double end_angle, CvScalar color,\n                int thickness=1, int line_type=8, int shift=0 );\n```\n参数:    \nimg:图像。    \ncenter:椭圆圆心坐标。    \naxes:轴的长度。    \nangle:偏转的角度。    \nstart_angle:圆弧起始角的角度。    \nend_angle:圆弧终结角的角度。    \ncolor:线条的颜色。    \nthickness:线条的粗细程度。    \nline_type:线条的类型,见CVLINE的描述。    \nshift:圆心坐标点和数轴的精度。    \n\nC++代码实现\n\n```cpp\n#include<opencv2/opencv.hpp>#include<opencv2/core/core.hpp> // 核心组件\n#include<opencv2/highgui/highgui.hpp>  // GUI\n#include<opencv2/imgproc/imgproc.hpp>  // 图像处理\nusing namespace cv;\nusing namespace std;\n// 定义存储椭圆参数的数据结构\nstruct Ellipse {\n\tint x0, y0, a, b;\n\tdouble alpha;\n};\nint drawEllipse(Ellipse ellipses_para, Mat im);\nint drawEllipse(Ellipse ellipses_para, Mat im) {\n// Draw Ellipse after detection\n//x0 - x coordinate of the center of the ellipse\n//y0 - y coordinate of the center of the ellipse\n//a - length of semimajor axis\n//b - length of semiminor axis\n//alpha - angle of orientation of semimajor axis\n\tif (im.empty()) {\n\t\tprintf(\"imread error!\");\n\t\treturn -1;\n\t}\n\tint x0, y0, a, b;\n\tdouble alpha;\n\tint thickness = 3;\n\tint lineType = 8;\n\tx0 = ellipses_para.x0;\n\ty0 = ellipses_para.y0;\n\ta = ellipses_para.a;\n\tb = ellipses_para.b;\n\talpha = ellipses_para.alpha;\n\tellipse(im, Point(x0, y0), Size(a, b), alpha, 0, 360, Scalar(255, 255, 0), thickness, lineType);\n\timshow(\"原图\", im);\n\twaitKey();}\nint main() {\n\tEllipse ellipses_para;\n\tMat im = imread(\"11.bmp\");\n\t/*test\n        ellipses_para.x0 = 100;\n\tellipses_para.y0 = 100;\n\tellipses_para.a = 90;\n\tellipses_para.b = 60;\n\tellipses_para.alpha = 80.0;*/\n\tdrawEllipse(ellipses_para, im);\n\treturn 0;\n}\n\n```\n\n\n","source":"_posts/Day14.md","raw":"---\ntitle: Day14\ndate: 2019-07-28 01:51:51\ntags: 实习\ncover: false\nimg: https://i.loli.net/2019/07/17/5d2e73bb14bd344648.png\n---\n# High-quality-ellipse-detection\n\n高精度椭圆检测    \n参考[High-quality-ellipse-detection](https://github.com/AlanLuSun/High-quality-ellipse-detection)\n\n关于椭圆检测的部分，实在是看不懂，我只做了得到椭圆参数绘制椭圆的部分\n\n## OpenCV椭圆绘制\n\n### ellipse函数\n\n语法\n\n```\nvoid cvEllipse( CvArr* img, CvPoint center, CvSize axes, double angle,\n                double start_angle, double end_angle, CvScalar color,\n                int thickness=1, int line_type=8, int shift=0 );\n```\n参数:    \nimg:图像。    \ncenter:椭圆圆心坐标。    \naxes:轴的长度。    \nangle:偏转的角度。    \nstart_angle:圆弧起始角的角度。    \nend_angle:圆弧终结角的角度。    \ncolor:线条的颜色。    \nthickness:线条的粗细程度。    \nline_type:线条的类型,见CVLINE的描述。    \nshift:圆心坐标点和数轴的精度。    \n\nC++代码实现\n\n```cpp\n#include<opencv2/opencv.hpp>#include<opencv2/core/core.hpp> // 核心组件\n#include<opencv2/highgui/highgui.hpp>  // GUI\n#include<opencv2/imgproc/imgproc.hpp>  // 图像处理\nusing namespace cv;\nusing namespace std;\n// 定义存储椭圆参数的数据结构\nstruct Ellipse {\n\tint x0, y0, a, b;\n\tdouble alpha;\n};\nint drawEllipse(Ellipse ellipses_para, Mat im);\nint drawEllipse(Ellipse ellipses_para, Mat im) {\n// Draw Ellipse after detection\n//x0 - x coordinate of the center of the ellipse\n//y0 - y coordinate of the center of the ellipse\n//a - length of semimajor axis\n//b - length of semiminor axis\n//alpha - angle of orientation of semimajor axis\n\tif (im.empty()) {\n\t\tprintf(\"imread error!\");\n\t\treturn -1;\n\t}\n\tint x0, y0, a, b;\n\tdouble alpha;\n\tint thickness = 3;\n\tint lineType = 8;\n\tx0 = ellipses_para.x0;\n\ty0 = ellipses_para.y0;\n\ta = ellipses_para.a;\n\tb = ellipses_para.b;\n\talpha = ellipses_para.alpha;\n\tellipse(im, Point(x0, y0), Size(a, b), alpha, 0, 360, Scalar(255, 255, 0), thickness, lineType);\n\timshow(\"原图\", im);\n\twaitKey();}\nint main() {\n\tEllipse ellipses_para;\n\tMat im = imread(\"11.bmp\");\n\t/*test\n        ellipses_para.x0 = 100;\n\tellipses_para.y0 = 100;\n\tellipses_para.a = 90;\n\tellipses_para.b = 60;\n\tellipses_para.alpha = 80.0;*/\n\tdrawEllipse(ellipses_para, im);\n\treturn 0;\n}\n\n```\n\n\n","slug":"Day14","published":1,"updated":"2020-02-24T10:49:41.327Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0sn000b74juah2ndrjd","content":"<h1 id=\"High-quality-ellipse-detection\"><a href=\"#High-quality-ellipse-detection\" class=\"headerlink\" title=\"High-quality-ellipse-detection\"></a>High-quality-ellipse-detection</h1><p>高精度椭圆检测<br>参考<a href=\"https://github.com/AlanLuSun/High-quality-ellipse-detection\" target=\"_blank\" rel=\"noopener\">High-quality-ellipse-detection</a></p>\n<p>关于椭圆检测的部分，实在是看不懂，我只做了得到椭圆参数绘制椭圆的部分</p>\n<h2 id=\"OpenCV椭圆绘制\"><a href=\"#OpenCV椭圆绘制\" class=\"headerlink\" title=\"OpenCV椭圆绘制\"></a>OpenCV椭圆绘制</h2><h3 id=\"ellipse函数\"><a href=\"#ellipse函数\" class=\"headerlink\" title=\"ellipse函数\"></a>ellipse函数</h3><p>语法</p>\n<pre><code>void cvEllipse( CvArr* img, CvPoint center, CvSize axes, double angle,\n                double start_angle, double end_angle, CvScalar color,\n                int thickness=1, int line_type=8, int shift=0 );</code></pre><p>参数:<br>img:图像。<br>center:椭圆圆心坐标。<br>axes:轴的长度。<br>angle:偏转的角度。<br>start_angle:圆弧起始角的角度。<br>end_angle:圆弧终结角的角度。<br>color:线条的颜色。<br>thickness:线条的粗细程度。<br>line_type:线条的类型,见CVLINE的描述。<br>shift:圆心坐标点和数轴的精度。    </p>\n<p>C++代码实现</p>\n<pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;opencv2/opencv.hpp></span>#<span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;opencv2/core/core.hpp></span> </span><span class=\"token comment\" spellcheck=\"true\">// 核心组件</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;opencv2/highgui/highgui.hpp></span>  </span><span class=\"token comment\" spellcheck=\"true\">// GUI</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;opencv2/imgproc/imgproc.hpp></span>  </span><span class=\"token comment\" spellcheck=\"true\">// 图像处理</span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> cv<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> std<span class=\"token punctuation\">;</span>\n<span class=\"token comment\" spellcheck=\"true\">// 定义存储椭圆参数的数据结构</span>\n<span class=\"token keyword\">struct</span> Ellipse <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> x0<span class=\"token punctuation\">,</span> y0<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">double</span> alpha<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">int</span> <span class=\"token function\">drawEllipse</span><span class=\"token punctuation\">(</span>Ellipse ellipses_para<span class=\"token punctuation\">,</span> Mat im<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">int</span> <span class=\"token function\">drawEllipse</span><span class=\"token punctuation\">(</span>Ellipse ellipses_para<span class=\"token punctuation\">,</span> Mat im<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token comment\" spellcheck=\"true\">// Draw Ellipse after detection</span>\n<span class=\"token comment\" spellcheck=\"true\">//x0 - x coordinate of the center of the ellipse</span>\n<span class=\"token comment\" spellcheck=\"true\">//y0 - y coordinate of the center of the ellipse</span>\n<span class=\"token comment\" spellcheck=\"true\">//a - length of semimajor axis</span>\n<span class=\"token comment\" spellcheck=\"true\">//b - length of semiminor axis</span>\n<span class=\"token comment\" spellcheck=\"true\">//alpha - angle of orientation of semimajor axis</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"imread error!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">int</span> x0<span class=\"token punctuation\">,</span> y0<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">double</span> alpha<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> thickness <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> lineType <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\n    x0 <span class=\"token operator\">=</span> ellipses_para<span class=\"token punctuation\">.</span>x0<span class=\"token punctuation\">;</span>\n    y0 <span class=\"token operator\">=</span> ellipses_para<span class=\"token punctuation\">.</span>y0<span class=\"token punctuation\">;</span>\n    a <span class=\"token operator\">=</span> ellipses_para<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">;</span>\n    b <span class=\"token operator\">=</span> ellipses_para<span class=\"token punctuation\">.</span>b<span class=\"token punctuation\">;</span>\n    alpha <span class=\"token operator\">=</span> ellipses_para<span class=\"token punctuation\">.</span>alpha<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">ellipse</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">,</span> <span class=\"token function\">Point</span><span class=\"token punctuation\">(</span>x0<span class=\"token punctuation\">,</span> y0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Size</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> alpha<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">360</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Scalar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> thickness<span class=\"token punctuation\">,</span> lineType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"原图\"</span><span class=\"token punctuation\">,</span> im<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">waitKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    Ellipse ellipses_para<span class=\"token punctuation\">;</span>\n    Mat im <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"11.bmp\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">/*test\n        ellipses_para.x0 = 100;\n    ellipses_para.y0 = 100;\n    ellipses_para.a = 90;\n    ellipses_para.b = 60;\n    ellipses_para.alpha = 80.0;*/</span>\n    <span class=\"token function\">drawEllipse</span><span class=\"token punctuation\">(</span>ellipses_para<span class=\"token punctuation\">,</span> im<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"High-quality-ellipse-detection\"><a href=\"#High-quality-ellipse-detection\" class=\"headerlink\" title=\"High-quality-ellipse-detection\"></a>High-quality-ellipse-detection</h1><p>高精度椭圆检测<br>参考<a href=\"https://github.com/AlanLuSun/High-quality-ellipse-detection\" target=\"_blank\" rel=\"noopener\">High-quality-ellipse-detection</a></p>\n<p>关于椭圆检测的部分，实在是看不懂，我只做了得到椭圆参数绘制椭圆的部分</p>\n<h2 id=\"OpenCV椭圆绘制\"><a href=\"#OpenCV椭圆绘制\" class=\"headerlink\" title=\"OpenCV椭圆绘制\"></a>OpenCV椭圆绘制</h2><h3 id=\"ellipse函数\"><a href=\"#ellipse函数\" class=\"headerlink\" title=\"ellipse函数\"></a>ellipse函数</h3><p>语法</p>\n<pre><code>void cvEllipse( CvArr* img, CvPoint center, CvSize axes, double angle,\n                double start_angle, double end_angle, CvScalar color,\n                int thickness=1, int line_type=8, int shift=0 );</code></pre><p>参数:<br>img:图像。<br>center:椭圆圆心坐标。<br>axes:轴的长度。<br>angle:偏转的角度。<br>start_angle:圆弧起始角的角度。<br>end_angle:圆弧终结角的角度。<br>color:线条的颜色。<br>thickness:线条的粗细程度。<br>line_type:线条的类型,见CVLINE的描述。<br>shift:圆心坐标点和数轴的精度。    </p>\n<p>C++代码实现</p>\n<pre><code class=\"cpp\">#include&lt;opencv2/opencv.hpp&gt;#include&lt;opencv2/core/core.hpp&gt; // 核心组件\n#include&lt;opencv2/highgui/highgui.hpp&gt;  // GUI\n#include&lt;opencv2/imgproc/imgproc.hpp&gt;  // 图像处理\nusing namespace cv;\nusing namespace std;\n// 定义存储椭圆参数的数据结构\nstruct Ellipse {\n    int x0, y0, a, b;\n    double alpha;\n};\nint drawEllipse(Ellipse ellipses_para, Mat im);\nint drawEllipse(Ellipse ellipses_para, Mat im) {\n// Draw Ellipse after detection\n//x0 - x coordinate of the center of the ellipse\n//y0 - y coordinate of the center of the ellipse\n//a - length of semimajor axis\n//b - length of semiminor axis\n//alpha - angle of orientation of semimajor axis\n    if (im.empty()) {\n        printf(&quot;imread error!&quot;);\n        return -1;\n    }\n    int x0, y0, a, b;\n    double alpha;\n    int thickness = 3;\n    int lineType = 8;\n    x0 = ellipses_para.x0;\n    y0 = ellipses_para.y0;\n    a = ellipses_para.a;\n    b = ellipses_para.b;\n    alpha = ellipses_para.alpha;\n    ellipse(im, Point(x0, y0), Size(a, b), alpha, 0, 360, Scalar(255, 255, 0), thickness, lineType);\n    imshow(&quot;原图&quot;, im);\n    waitKey();}\nint main() {\n    Ellipse ellipses_para;\n    Mat im = imread(&quot;11.bmp&quot;);\n    /*test\n        ellipses_para.x0 = 100;\n    ellipses_para.y0 = 100;\n    ellipses_para.a = 90;\n    ellipses_para.b = 60;\n    ellipses_para.alpha = 80.0;*/\n    drawEllipse(ellipses_para, im);\n    return 0;\n}\n</code></pre>\n"},{"title":"Bilibili-Evolved","top":false,"cover":false,"img":"https://github.com/the1812/Bilibili-Evolved/raw/master/images/bilibili-evolved-wide-color.svg?sanitize=true<Paste>","toc":true,"mathjax":false,"date":"2019-09-20T16:40:43.000Z","password":null,"summary":"A powerful script in Bilibili.com","_content":"\n## Bilibili-Evolved\n\n![](1.png)\n![](2.png)\n![](3.png)\n![](4.png)\n\n### 1. Install\n\n- You should install [Tampermonkey](https://www.tampermonkey.net) first.\n\n- [Bilibili-Evolved](https://greasyfork.org/en/scripts/373563-bilibili-evolved)\n\nPlease access [GitHub](https://github.com/the1812/Bilibili-Evolved) to view how to use it.\n\n### 2. Download videos\n\n#### 2.1 Download single video.\n\n![](5.png)\n![](6.png)\n\n#### 2.2 Batch export(with aria2).\n\n- Install aria2.\n\n```bash\nsudo pacman -S aria2\n```\n- export aria2(a txt file)\n\n![](7.png)\n\n- Download videos in current directory.\n\n```bash\naria2c -i Download.txt\n```\n\n### 3. Convert video files.\n\nThe default video files format is `flv`. \nI recommend using [ffmpeg](http://ffmpeg.org/) to convert video files format on Linux.\n\n```bash\nffmpeg -i input.flv output.mp4\n```\n\n","source":"_posts/Bilibili-Evolved.md","raw":"---\ntitle: Bilibili-Evolved\ntop: false\ncover: false\nimg: https://github.com/the1812/Bilibili-Evolved/raw/master/images/bilibili-evolved-wide-color.svg?sanitize=true<Paste>\ntoc: true\nmathjax: false\ndate: 2019-09-21 00:40:43\npassword:\nsummary: A powerful script in Bilibili.com\ntags:\n- Bilibili.com\n- Script\n\ncategories:\n- 教程\n\n---\n\n## Bilibili-Evolved\n\n![](1.png)\n![](2.png)\n![](3.png)\n![](4.png)\n\n### 1. Install\n\n- You should install [Tampermonkey](https://www.tampermonkey.net) first.\n\n- [Bilibili-Evolved](https://greasyfork.org/en/scripts/373563-bilibili-evolved)\n\nPlease access [GitHub](https://github.com/the1812/Bilibili-Evolved) to view how to use it.\n\n### 2. Download videos\n\n#### 2.1 Download single video.\n\n![](5.png)\n![](6.png)\n\n#### 2.2 Batch export(with aria2).\n\n- Install aria2.\n\n```bash\nsudo pacman -S aria2\n```\n- export aria2(a txt file)\n\n![](7.png)\n\n- Download videos in current directory.\n\n```bash\naria2c -i Download.txt\n```\n\n### 3. Convert video files.\n\nThe default video files format is `flv`. \nI recommend using [ffmpeg](http://ffmpeg.org/) to convert video files format on Linux.\n\n```bash\nffmpeg -i input.flv output.mp4\n```\n\n","slug":"Bilibili-Evolved","published":1,"updated":"2020-02-24T10:49:41.321Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0sp000d74ju7wuw0k3s","content":"<h2 id=\"Bilibili-Evolved\"><a href=\"#Bilibili-Evolved\" class=\"headerlink\" title=\"Bilibili-Evolved\"></a>Bilibili-Evolved</h2><p><img src=\"1.png\" alt><br><img src=\"2.png\" alt><br><img src=\"3.png\" alt><br><img src=\"4.png\" alt></p>\n<h3 id=\"1-Install\"><a href=\"#1-Install\" class=\"headerlink\" title=\"1. Install\"></a>1. Install</h3><ul>\n<li><p>You should install <a href=\"https://www.tampermonkey.net\" target=\"_blank\" rel=\"noopener\">Tampermonkey</a> first.</p>\n</li>\n<li><p><a href=\"https://greasyfork.org/en/scripts/373563-bilibili-evolved\" target=\"_blank\" rel=\"noopener\">Bilibili-Evolved</a></p>\n</li>\n</ul>\n<p>Please access <a href=\"https://github.com/the1812/Bilibili-Evolved\" target=\"_blank\" rel=\"noopener\">GitHub</a> to view how to use it.</p>\n<h3 id=\"2-Download-videos\"><a href=\"#2-Download-videos\" class=\"headerlink\" title=\"2. Download videos\"></a>2. Download videos</h3><h4 id=\"2-1-Download-single-video\"><a href=\"#2-1-Download-single-video\" class=\"headerlink\" title=\"2.1 Download single video.\"></a>2.1 Download single video.</h4><p><img src=\"5.png\" alt><br><img src=\"6.png\" alt></p>\n<h4 id=\"2-2-Batch-export-with-aria2\"><a href=\"#2-2-Batch-export-with-aria2\" class=\"headerlink\" title=\"2.2 Batch export(with aria2).\"></a>2.2 Batch export(with aria2).</h4><ul>\n<li>Install aria2.</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S aria2</code></pre>\n<ul>\n<li>export aria2(a txt file)</li>\n</ul>\n<p><img src=\"7.png\" alt></p>\n<ul>\n<li>Download videos in current directory.</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">aria2c -i Download.txt</code></pre>\n<h3 id=\"3-Convert-video-files\"><a href=\"#3-Convert-video-files\" class=\"headerlink\" title=\"3. Convert video files.\"></a>3. Convert video files.</h3><p>The default video files format is <code>flv</code>.<br>I recommend using <a href=\"http://ffmpeg.org/\" target=\"_blank\" rel=\"noopener\">ffmpeg</a> to convert video files format on Linux.</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">ffmpeg -i input.flv output.mp4</code></pre>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h2 id=\"Bilibili-Evolved\"><a href=\"#Bilibili-Evolved\" class=\"headerlink\" title=\"Bilibili-Evolved\"></a>Bilibili-Evolved</h2><p><img src=\"1.png\" alt><br><img src=\"2.png\" alt><br><img src=\"3.png\" alt><br><img src=\"4.png\" alt></p>\n<h3 id=\"1-Install\"><a href=\"#1-Install\" class=\"headerlink\" title=\"1. Install\"></a>1. Install</h3><ul>\n<li><p>You should install <a href=\"https://www.tampermonkey.net\" target=\"_blank\" rel=\"noopener\">Tampermonkey</a> first.</p>\n</li>\n<li><p><a href=\"https://greasyfork.org/en/scripts/373563-bilibili-evolved\" target=\"_blank\" rel=\"noopener\">Bilibili-Evolved</a></p>\n</li>\n</ul>\n<p>Please access <a href=\"https://github.com/the1812/Bilibili-Evolved\" target=\"_blank\" rel=\"noopener\">GitHub</a> to view how to use it.</p>\n<h3 id=\"2-Download-videos\"><a href=\"#2-Download-videos\" class=\"headerlink\" title=\"2. Download videos\"></a>2. Download videos</h3><h4 id=\"2-1-Download-single-video\"><a href=\"#2-1-Download-single-video\" class=\"headerlink\" title=\"2.1 Download single video.\"></a>2.1 Download single video.</h4><p><img src=\"5.png\" alt><br><img src=\"6.png\" alt></p>\n<h4 id=\"2-2-Batch-export-with-aria2\"><a href=\"#2-2-Batch-export-with-aria2\" class=\"headerlink\" title=\"2.2 Batch export(with aria2).\"></a>2.2 Batch export(with aria2).</h4><ul>\n<li>Install aria2.</li>\n</ul>\n<pre><code class=\"bash\">sudo pacman -S aria2</code></pre>\n<ul>\n<li>export aria2(a txt file)</li>\n</ul>\n<p><img src=\"7.png\" alt></p>\n<ul>\n<li>Download videos in current directory.</li>\n</ul>\n<pre><code class=\"bash\">aria2c -i Download.txt</code></pre>\n<h3 id=\"3-Convert-video-files\"><a href=\"#3-Convert-video-files\" class=\"headerlink\" title=\"3. Convert video files.\"></a>3. Convert video files.</h3><p>The default video files format is <code>flv</code>.<br>I recommend using <a href=\"http://ffmpeg.org/\" target=\"_blank\" rel=\"noopener\">ffmpeg</a> to convert video files format on Linux.</p>\n<pre><code class=\"bash\">ffmpeg -i input.flv output.mp4</code></pre>\n"},{"title":"Digital Image Processing","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-07-15T01:25:32.000Z","password":null,"summary":"Digital Image Processing Notes.","img":"https://i.loli.net/2019/07/17/5d2e73bb14bd344648.png","_content":"\n## Digital Image Processing notes:\n- 图像处理的步骤：\n    1. 图像获取 包括图像预处理\n    2. 图像滤波与增强 使之适用于 **特定应用**\n    3. 图像复原 倾向于以图像退化的数学或概率模型为基础\n    4. 彩色图像处理\n    5. 压缩 减少图像存储量或降低传输图像带宽 \n    6. 形态学处理\n    7. 图像分割\n    8. 目标识别\n### 数字图像基础\n- 灰度概念\n    灰度是表明图像明暗的数值，即黑白图像中点的颜色深度，范围一般是0-255,白色为255,黑色为0,归一化处理之后[0,1],0代表黑色，1代表白色。\n- 图像取样与量化\n  \n    - 对坐标值数字化称为取样，对幅度值数字化称为量化\n- 数字的图像表示       \n    将连续图像取样表示为一个二维阵列 $f(x,y)$\n    1. 函数图表示：用x和y两个坐标轴来表示空间位置，第三个坐标为f(灰度)值，即 $f(x,y,z)$，\n    2. 一般的表示：显示的是 $f(x,y)$在监视器或照片上的情况，每个点的灰度与该点处的f值成正比，例如归一化[0,1],三个等间隔点分别为0,0.5,1\n    3. 矩阵： 将 $f(x,y)$的值打印成矩阵     \n    注意坐标为右手笛卡尔系\n- 对比度： 最高和最低的灰度级的差\n- 典型灰度级：\n$$2^k$$\n称为一副'k bit图像'\n\n- 图像内插\n    - 最邻近内插\n    - 双线性内插\n    - 双三次内插\n- 图像处理的算术操作\n    - 图片相加  平均 -> 降噪\n    - 图片相减  增强图像差别\n    - 图片想乘除  校正阴影\n- 灰度变换\n    - s = T(r)\n    - Matlab中的灰度变换函数     \n      `imadjust(f,[LOW_IN,HIGH_IN],[LOW_OUT,HIGH_OUT],grmma)`\n- 直方图的处理和函数绘图\n    - 生成图像的直方图\n    \n      ```matlab\n        >> h = imhist(f)\n      ```\n    - 也可以用条形图来表示\n    \n        ```matlab\n        >> h = imhist(f,25);\n        >> horz = linespace(0,255,25);\n        >> bar(horz,h)\n        >> axis(0 255 0 60000);\n        >> set(gca, 'xtick', 0:50:255)\n        >> set(gca, 'ytick', 0:20000:60000)\n        ```\n    - 杆状图    \n    `stem(horz, z , 'LineSpec', 'fill')`\n    - plot函数    \n    `plot(horz, z, 'LineSpec')`\n    - 当处理函数句柄时     \n    `fplot(fhandle, limits, 'LineSpec')`\n\n\n","source":"_posts/Digital-Image-Processing.md","raw":"---\ntitle: Digital Image Processing\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-07-15 09:25:32\npassword:\nsummary: Digital Image Processing Notes.\nimg: https://i.loli.net/2019/07/17/5d2e73bb14bd344648.png\ntags:\n- 图像处理\n- Matlab\ncategories:\n- Digital Image Processing\n---\n\n## Digital Image Processing notes:\n- 图像处理的步骤：\n    1. 图像获取 包括图像预处理\n    2. 图像滤波与增强 使之适用于 **特定应用**\n    3. 图像复原 倾向于以图像退化的数学或概率模型为基础\n    4. 彩色图像处理\n    5. 压缩 减少图像存储量或降低传输图像带宽 \n    6. 形态学处理\n    7. 图像分割\n    8. 目标识别\n### 数字图像基础\n- 灰度概念\n    灰度是表明图像明暗的数值，即黑白图像中点的颜色深度，范围一般是0-255,白色为255,黑色为0,归一化处理之后[0,1],0代表黑色，1代表白色。\n- 图像取样与量化\n  \n    - 对坐标值数字化称为取样，对幅度值数字化称为量化\n- 数字的图像表示       \n    将连续图像取样表示为一个二维阵列 $f(x,y)$\n    1. 函数图表示：用x和y两个坐标轴来表示空间位置，第三个坐标为f(灰度)值，即 $f(x,y,z)$，\n    2. 一般的表示：显示的是 $f(x,y)$在监视器或照片上的情况，每个点的灰度与该点处的f值成正比，例如归一化[0,1],三个等间隔点分别为0,0.5,1\n    3. 矩阵： 将 $f(x,y)$的值打印成矩阵     \n    注意坐标为右手笛卡尔系\n- 对比度： 最高和最低的灰度级的差\n- 典型灰度级：\n$$2^k$$\n称为一副'k bit图像'\n\n- 图像内插\n    - 最邻近内插\n    - 双线性内插\n    - 双三次内插\n- 图像处理的算术操作\n    - 图片相加  平均 -> 降噪\n    - 图片相减  增强图像差别\n    - 图片想乘除  校正阴影\n- 灰度变换\n    - s = T(r)\n    - Matlab中的灰度变换函数     \n      `imadjust(f,[LOW_IN,HIGH_IN],[LOW_OUT,HIGH_OUT],grmma)`\n- 直方图的处理和函数绘图\n    - 生成图像的直方图\n    \n      ```matlab\n        >> h = imhist(f)\n      ```\n    - 也可以用条形图来表示\n    \n        ```matlab\n        >> h = imhist(f,25);\n        >> horz = linespace(0,255,25);\n        >> bar(horz,h)\n        >> axis(0 255 0 60000);\n        >> set(gca, 'xtick', 0:50:255)\n        >> set(gca, 'ytick', 0:20000:60000)\n        ```\n    - 杆状图    \n    `stem(horz, z , 'LineSpec', 'fill')`\n    - plot函数    \n    `plot(horz, z, 'LineSpec')`\n    - 当处理函数句柄时     \n    `fplot(fhandle, limits, 'LineSpec')`\n\n\n","slug":"Digital-Image-Processing","published":1,"updated":"2020-02-24T10:49:41.327Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0ss000f74juw30izqln","content":"<h2 id=\"Digital-Image-Processing-notes\"><a href=\"#Digital-Image-Processing-notes\" class=\"headerlink\" title=\"Digital Image Processing notes:\"></a>Digital Image Processing notes:</h2><ul>\n<li><p>图像处理的步骤：</p>\n<ol>\n<li>图像获取 包括图像预处理</li>\n<li>图像滤波与增强 使之适用于 <strong>特定应用</strong></li>\n<li>图像复原 倾向于以图像退化的数学或概率模型为基础</li>\n<li>彩色图像处理</li>\n<li>压缩 减少图像存储量或降低传输图像带宽 </li>\n<li>形态学处理</li>\n<li>图像分割</li>\n<li>目标识别<h3 id=\"数字图像基础\"><a href=\"#数字图像基础\" class=\"headerlink\" title=\"数字图像基础\"></a>数字图像基础</h3></li>\n</ol>\n</li>\n<li><p>灰度概念<br>  灰度是表明图像明暗的数值，即黑白图像中点的颜色深度，范围一般是0-255,白色为255,黑色为0,归一化处理之后[0,1],0代表黑色，1代表白色。</p>\n</li>\n<li><p>图像取样与量化</p>\n<ul>\n<li>对坐标值数字化称为取样，对幅度值数字化称为量化</li>\n</ul>\n</li>\n<li><p>数字的图像表示<br>  将连续图像取样表示为一个二维阵列 $f(x,y)$</p>\n<ol>\n<li>函数图表示：用x和y两个坐标轴来表示空间位置，第三个坐标为f(灰度)值，即 $f(x,y,z)$，</li>\n<li>一般的表示：显示的是 $f(x,y)$在监视器或照片上的情况，每个点的灰度与该点处的f值成正比，例如归一化[0,1],三个等间隔点分别为0,0.5,1</li>\n<li>矩阵： 将 $f(x,y)$的值打印成矩阵<br>注意坐标为右手笛卡尔系</li>\n</ol>\n</li>\n<li><p>对比度： 最高和最低的灰度级的差</p>\n</li>\n<li><p>典型灰度级：<br>$$2^k$$<br>称为一副’k bit图像’</p>\n</li>\n<li><p>图像内插</p>\n<ul>\n<li>最邻近内插</li>\n<li>双线性内插</li>\n<li>双三次内插</li>\n</ul>\n</li>\n<li><p>图像处理的算术操作</p>\n<ul>\n<li>图片相加  平均 -&gt; 降噪</li>\n<li>图片相减  增强图像差别</li>\n<li>图片想乘除  校正阴影</li>\n</ul>\n</li>\n<li><p>灰度变换</p>\n<ul>\n<li>s = T(r)</li>\n<li>Matlab中的灰度变换函数<br><code>imadjust(f,[LOW_IN,HIGH_IN],[LOW_OUT,HIGH_OUT],grmma)</code></li>\n</ul>\n</li>\n<li><p>直方图的处理和函数绘图</p>\n<ul>\n<li><p>生成图像的直方图</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">  <span class=\"token operator\">></span><span class=\"token operator\">></span> h <span class=\"token operator\">=</span> <span class=\"token function\">imhist</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span></code></pre>\n</li>\n<li><p>也可以用条形图来表示</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">  <span class=\"token operator\">></span><span class=\"token operator\">></span> h <span class=\"token operator\">=</span> <span class=\"token function\">imhist</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token operator\">></span><span class=\"token operator\">></span> horz <span class=\"token operator\">=</span> <span class=\"token function\">linespace</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token operator\">></span><span class=\"token operator\">></span> <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span>horz<span class=\"token punctuation\">,</span>h<span class=\"token punctuation\">)</span>\n  <span class=\"token operator\">></span><span class=\"token operator\">></span> <span class=\"token function\">axis</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token number\">255</span> <span class=\"token number\">0</span> <span class=\"token number\">60000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token operator\">></span><span class=\"token operator\">></span> <span class=\"token function\">set</span><span class=\"token punctuation\">(</span>gca<span class=\"token punctuation\">,</span> <span class=\"token string\">'xtick'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">50</span><span class=\"token operator\">:</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span>\n  <span class=\"token operator\">></span><span class=\"token operator\">></span> <span class=\"token function\">set</span><span class=\"token punctuation\">(</span>gca<span class=\"token punctuation\">,</span> <span class=\"token string\">'ytick'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">20000</span><span class=\"token operator\">:</span><span class=\"token number\">60000</span><span class=\"token punctuation\">)</span></code></pre>\n</li>\n<li><p>杆状图<br><code>stem(horz, z , &#39;LineSpec&#39;, &#39;fill&#39;)</code></p>\n</li>\n<li><p>plot函数<br><code>plot(horz, z, &#39;LineSpec&#39;)</code></p>\n</li>\n<li><p>当处理函数句柄时<br><code>fplot(fhandle, limits, &#39;LineSpec&#39;)</code></p>\n</li>\n</ul>\n</li>\n</ul>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h2 id=\"Digital-Image-Processing-notes\"><a href=\"#Digital-Image-Processing-notes\" class=\"headerlink\" title=\"Digital Image Processing notes:\"></a>Digital Image Processing notes:</h2><ul>\n<li><p>图像处理的步骤：</p>\n<ol>\n<li>图像获取 包括图像预处理</li>\n<li>图像滤波与增强 使之适用于 <strong>特定应用</strong></li>\n<li>图像复原 倾向于以图像退化的数学或概率模型为基础</li>\n<li>彩色图像处理</li>\n<li>压缩 减少图像存储量或降低传输图像带宽 </li>\n<li>形态学处理</li>\n<li>图像分割</li>\n<li>目标识别<h3 id=\"数字图像基础\"><a href=\"#数字图像基础\" class=\"headerlink\" title=\"数字图像基础\"></a>数字图像基础</h3></li>\n</ol>\n</li>\n<li><p>灰度概念<br>  灰度是表明图像明暗的数值，即黑白图像中点的颜色深度，范围一般是0-255,白色为255,黑色为0,归一化处理之后[0,1],0代表黑色，1代表白色。</p>\n</li>\n<li><p>图像取样与量化</p>\n<ul>\n<li>对坐标值数字化称为取样，对幅度值数字化称为量化</li>\n</ul>\n</li>\n<li><p>数字的图像表示<br>  将连续图像取样表示为一个二维阵列 $f(x,y)$</p>\n<ol>\n<li>函数图表示：用x和y两个坐标轴来表示空间位置，第三个坐标为f(灰度)值，即 $f(x,y,z)$，</li>\n<li>一般的表示：显示的是 $f(x,y)$在监视器或照片上的情况，每个点的灰度与该点处的f值成正比，例如归一化[0,1],三个等间隔点分别为0,0.5,1</li>\n<li>矩阵： 将 $f(x,y)$的值打印成矩阵<br>注意坐标为右手笛卡尔系</li>\n</ol>\n</li>\n<li><p>对比度： 最高和最低的灰度级的差</p>\n</li>\n<li><p>典型灰度级：<br>$$2^k$$<br>称为一副’k bit图像’</p>\n</li>\n<li><p>图像内插</p>\n<ul>\n<li>最邻近内插</li>\n<li>双线性内插</li>\n<li>双三次内插</li>\n</ul>\n</li>\n<li><p>图像处理的算术操作</p>\n<ul>\n<li>图片相加  平均 -&gt; 降噪</li>\n<li>图片相减  增强图像差别</li>\n<li>图片想乘除  校正阴影</li>\n</ul>\n</li>\n<li><p>灰度变换</p>\n<ul>\n<li>s = T(r)</li>\n<li>Matlab中的灰度变换函数<br><code>imadjust(f,[LOW_IN,HIGH_IN],[LOW_OUT,HIGH_OUT],grmma)</code></li>\n</ul>\n</li>\n<li><p>直方图的处理和函数绘图</p>\n<ul>\n<li><p>生成图像的直方图</p>\n<pre><code class=\"matlab\">  &gt;&gt; h = imhist(f)</code></pre>\n</li>\n<li><p>也可以用条形图来表示</p>\n<pre><code class=\"matlab\">  &gt;&gt; h = imhist(f,25);\n  &gt;&gt; horz = linespace(0,255,25);\n  &gt;&gt; bar(horz,h)\n  &gt;&gt; axis(0 255 0 60000);\n  &gt;&gt; set(gca, &#39;xtick&#39;, 0:50:255)\n  &gt;&gt; set(gca, &#39;ytick&#39;, 0:20000:60000)</code></pre>\n</li>\n<li><p>杆状图<br><code>stem(horz, z , &#39;LineSpec&#39;, &#39;fill&#39;)</code></p>\n</li>\n<li><p>plot函数<br><code>plot(horz, z, &#39;LineSpec&#39;)</code></p>\n</li>\n<li><p>当处理函数句柄时<br><code>fplot(fhandle, limits, &#39;LineSpec&#39;)</code></p>\n</li>\n</ul>\n</li>\n</ul>\n"},{"title":"Enjoy PyTorch-Task1","top":false,"cover":false,"toc":true,"mathjax":false,"date":"2019-08-07T05:11:13.000Z","password":null,"summary":"My notes of PyTorch","_content":"\n# Installing PyTorch with Anaconda and Conda\n\nMy Particular Environment:\n- OS: Ubuntu 16.04\n- Package Manager: conda\n- Python: 3.6\n- CUDA: None\n\nGetting started with PyTorch is very easy. The recommended best option is to use the Anaconda Pythob package manager.\n\n1. [Download and install Anaconda](https://www.anaconda.com/distribution/)(Go with the latest Python version)    \nYou can download the `.sh` package from the Anaconda website, but it's very slowly for me. So i find another choice.    \nYou can find it in [Tsinghua university open source mirror station](https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/), which i download is `Anaconda3-5.2.0-Linux-x86_64.sh`. Or if you already get the \"wget\", you can run this command in the terminal.\n```bash\nwget https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda3-5.2.0-Linux-x86_64.sh\n```\nUse `conda -V` to check the Version of Anaconda after open a new terminal.\nIf it isn't work, try,\n```bash\necho 'export PATH=\"~/anaconda3/bin:$PATH\"' >> ~/.bashrc\nsource ./bashrc\n```\n2. Go to the Getting Started section on the [Pytorch website](https://pytorch.org/).\n3. Specify the appropriate configuration options for your particular environment.\n![](1.png)\n4. Run the presented command in the terminal to install Pytorch.\n```bash\nconda install pytorch-cpu torchvision-cpu -c pytorch\n```\n\n```python\nimport torch\nimport torch.nn as nn\nimport torchvision\nimport torch.utils.data as Data\n\n# Hyper Parameters\nEPOCH = 1  \nBATCH_SIZE = 50\nLR = 0.001  \nDOWNLOAD_MNIST = True  \n\n# Mnist\ntrain_data = torchvision.datasets.MNIST(\n    root='./mnist/',  \n    train=True,  # this is training data\n    transform=torchvision.transforms.ToTensor(),  # exchange PIL.Image or numpy.ndarray to torch.FloatTensor (C x H x W)\n    download=DOWNLOAD_MNIST,  \n)\n\ntest_data = torchvision.datasets.MNIST(\n    root='./mnist/',\n    train=False\n)\n\n# BATCH_SIZE\ntrain_loader = Data.DataLoader(\n    dataset=train_data,\n    batch_size=BATCH_SIZE,\n    shuffle=True  \n)\n\n# test_data\ntest_x = torch.unsqueeze(test_data.test_data, dim=1).type(torch.FloatTensor)\ntest_y = test_data.test_labels\n\n\n# cnn\n\nclass CNN(nn.Module):\n    def __init__(self):\n        super(CNN, self).__init__()\n        self.layer1 = nn.Sequential(\n            # (1, 28, 28)\n            nn.Conv2d(\n                in_channels=1,\n                out_channels=16,\n                kernel_size=5,  \n                stride=1,  \n                padding=2,\n                groups=1\n            ),\n            # (16, 28, 38)\n            nn.ReLU(),\n            nn.MaxPool2d(kernel_size=2)\n            # (16, 14, 14)\n        )\n        self.layer2 = nn.Sequential(\n\n            nn.Conv2d(\n                in_channels=16,\n                out_channels=32,\n                kernel_size=5,\n                stride=1,\n                padding=2\n            ),\n            nn.ReLU(),\n            nn.MaxPool2d(kernel_size=2)\n        )\n        self.layer3 = nn.Linear(32 * 7 * 7, 10)\n\n    def forward(self, x):\n        # print(x.shape)\n        x = self.layer1(x)\n        # print(x.shape)\n        x = self.layer2(x)\n        # print(x.shape)\n        x = x.view(x.size(0), -1)\n        # print(x.shape)\n        x = self.layer3(x)\n        # print(x.shape)\n        return x\n\n\ncnn = CNN()\n\noptimizer = torch.optim.Adam(cnn.parameters(), lr=LR)\nloss_function = nn.CrossEntropyLoss()\nfor epoch in range(EPOCH):\n    for step, (b_x, b_y) in enumerate(train_loader):\n        output = cnn(b_x)\n        loss = loss_function(output, b_y)\n        optimizer.zero_grad()\n        loss.backward()\n        optimizer.step()\n\nprint('finished training')\ntest_out = cnn(test_x)\npredict_y = torch.argmax(test_out, 1).data.numpy()\nprint('Accuracy in Test : %.4f%%' % (sum(predict_y == test_y.data.numpy()) * 100/ len(predict_y)))\n```\n\n","source":"_posts/Enjoy-PyTorch-Task1.md","raw":"---\ntitle: Enjoy PyTorch-Task1\ntop: false\ncover: false\ntoc: true\nmathjax: false\ndate: 2019-08-07 13:11:13\npassword:\nsummary: My notes of PyTorch\ntags:\n- PyTorch\n- Deep Learning\ncategories:\n- PyTorch Notes\n---\n\n# Installing PyTorch with Anaconda and Conda\n\nMy Particular Environment:\n- OS: Ubuntu 16.04\n- Package Manager: conda\n- Python: 3.6\n- CUDA: None\n\nGetting started with PyTorch is very easy. The recommended best option is to use the Anaconda Pythob package manager.\n\n1. [Download and install Anaconda](https://www.anaconda.com/distribution/)(Go with the latest Python version)    \nYou can download the `.sh` package from the Anaconda website, but it's very slowly for me. So i find another choice.    \nYou can find it in [Tsinghua university open source mirror station](https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/), which i download is `Anaconda3-5.2.0-Linux-x86_64.sh`. Or if you already get the \"wget\", you can run this command in the terminal.\n```bash\nwget https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda3-5.2.0-Linux-x86_64.sh\n```\nUse `conda -V` to check the Version of Anaconda after open a new terminal.\nIf it isn't work, try,\n```bash\necho 'export PATH=\"~/anaconda3/bin:$PATH\"' >> ~/.bashrc\nsource ./bashrc\n```\n2. Go to the Getting Started section on the [Pytorch website](https://pytorch.org/).\n3. Specify the appropriate configuration options for your particular environment.\n![](1.png)\n4. Run the presented command in the terminal to install Pytorch.\n```bash\nconda install pytorch-cpu torchvision-cpu -c pytorch\n```\n\n```python\nimport torch\nimport torch.nn as nn\nimport torchvision\nimport torch.utils.data as Data\n\n# Hyper Parameters\nEPOCH = 1  \nBATCH_SIZE = 50\nLR = 0.001  \nDOWNLOAD_MNIST = True  \n\n# Mnist\ntrain_data = torchvision.datasets.MNIST(\n    root='./mnist/',  \n    train=True,  # this is training data\n    transform=torchvision.transforms.ToTensor(),  # exchange PIL.Image or numpy.ndarray to torch.FloatTensor (C x H x W)\n    download=DOWNLOAD_MNIST,  \n)\n\ntest_data = torchvision.datasets.MNIST(\n    root='./mnist/',\n    train=False\n)\n\n# BATCH_SIZE\ntrain_loader = Data.DataLoader(\n    dataset=train_data,\n    batch_size=BATCH_SIZE,\n    shuffle=True  \n)\n\n# test_data\ntest_x = torch.unsqueeze(test_data.test_data, dim=1).type(torch.FloatTensor)\ntest_y = test_data.test_labels\n\n\n# cnn\n\nclass CNN(nn.Module):\n    def __init__(self):\n        super(CNN, self).__init__()\n        self.layer1 = nn.Sequential(\n            # (1, 28, 28)\n            nn.Conv2d(\n                in_channels=1,\n                out_channels=16,\n                kernel_size=5,  \n                stride=1,  \n                padding=2,\n                groups=1\n            ),\n            # (16, 28, 38)\n            nn.ReLU(),\n            nn.MaxPool2d(kernel_size=2)\n            # (16, 14, 14)\n        )\n        self.layer2 = nn.Sequential(\n\n            nn.Conv2d(\n                in_channels=16,\n                out_channels=32,\n                kernel_size=5,\n                stride=1,\n                padding=2\n            ),\n            nn.ReLU(),\n            nn.MaxPool2d(kernel_size=2)\n        )\n        self.layer3 = nn.Linear(32 * 7 * 7, 10)\n\n    def forward(self, x):\n        # print(x.shape)\n        x = self.layer1(x)\n        # print(x.shape)\n        x = self.layer2(x)\n        # print(x.shape)\n        x = x.view(x.size(0), -1)\n        # print(x.shape)\n        x = self.layer3(x)\n        # print(x.shape)\n        return x\n\n\ncnn = CNN()\n\noptimizer = torch.optim.Adam(cnn.parameters(), lr=LR)\nloss_function = nn.CrossEntropyLoss()\nfor epoch in range(EPOCH):\n    for step, (b_x, b_y) in enumerate(train_loader):\n        output = cnn(b_x)\n        loss = loss_function(output, b_y)\n        optimizer.zero_grad()\n        loss.backward()\n        optimizer.step()\n\nprint('finished training')\ntest_out = cnn(test_x)\npredict_y = torch.argmax(test_out, 1).data.numpy()\nprint('Accuracy in Test : %.4f%%' % (sum(predict_y == test_y.data.numpy()) * 100/ len(predict_y)))\n```\n\n","slug":"Enjoy-PyTorch-Task1","published":1,"updated":"2020-02-24T10:49:41.327Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0sv000g74jukv5uesns","content":"<h1 id=\"Installing-PyTorch-with-Anaconda-and-Conda\"><a href=\"#Installing-PyTorch-with-Anaconda-and-Conda\" class=\"headerlink\" title=\"Installing PyTorch with Anaconda and Conda\"></a>Installing PyTorch with Anaconda and Conda</h1><p>My Particular Environment:</p>\n<ul>\n<li>OS: Ubuntu 16.04</li>\n<li>Package Manager: conda</li>\n<li>Python: 3.6</li>\n<li>CUDA: None</li>\n</ul>\n<p>Getting started with PyTorch is very easy. The recommended best option is to use the Anaconda Pythob package manager.</p>\n<ol>\n<li><a href=\"https://www.anaconda.com/distribution/\" target=\"_blank\" rel=\"noopener\">Download and install Anaconda</a>(Go with the latest Python version)<br>You can download the <code>.sh</code> package from the Anaconda website, but it’s very slowly for me. So i find another choice.<br>You can find it in <a href=\"https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/\" target=\"_blank\" rel=\"noopener\">Tsinghua university open source mirror station</a>, which i download is <code>Anaconda3-5.2.0-Linux-x86_64.sh</code>. Or if you already get the “wget”, you can run this command in the terminal.<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda3-5.2.0-Linux-x86_64.sh</code></pre>\nUse <code>conda -V</code> to check the Version of Anaconda after open a new terminal.<br>If it isn’t work, try,<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token keyword\">echo</span> <span class=\"token string\">'export PATH=\"~/anaconda3/bin:<span class=\"token variable\">$PATH</span>\"'</span> <span class=\"token operator\">>></span> ~/.bashrc\n<span class=\"token function\">source</span> ./bashrc</code></pre>\n</li>\n<li>Go to the Getting Started section on the <a href=\"https://pytorch.org/\" target=\"_blank\" rel=\"noopener\">Pytorch website</a>.</li>\n<li>Specify the appropriate configuration options for your particular environment.<br><img src=\"1.png\" alt></li>\n<li>Run the presented command in the terminal to install Pytorch.<pre class=\" language-bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> pytorch-cpu torchvision-cpu -c pytorch</code></pre>\n</li>\n</ol>\n<pre class=\" language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> torch\n<span class=\"token keyword\">import</span> torch<span class=\"token punctuation\">.</span>nn <span class=\"token keyword\">as</span> nn\n<span class=\"token keyword\">import</span> torchvision\n<span class=\"token keyword\">import</span> torch<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span>data <span class=\"token keyword\">as</span> Data\n\n<span class=\"token comment\" spellcheck=\"true\"># Hyper Parameters</span>\nEPOCH <span class=\"token operator\">=</span> <span class=\"token number\">1</span>  \nBATCH_SIZE <span class=\"token operator\">=</span> <span class=\"token number\">50</span>\nLR <span class=\"token operator\">=</span> <span class=\"token number\">0.001</span>  \nDOWNLOAD_MNIST <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>  \n\n<span class=\"token comment\" spellcheck=\"true\"># Mnist</span>\ntrain_data <span class=\"token operator\">=</span> torchvision<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>MNIST<span class=\"token punctuation\">(</span>\n    root<span class=\"token operator\">=</span><span class=\"token string\">'./mnist/'</span><span class=\"token punctuation\">,</span>  \n    train<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\" spellcheck=\"true\"># this is training data</span>\n    transform<span class=\"token operator\">=</span>torchvision<span class=\"token punctuation\">.</span>transforms<span class=\"token punctuation\">.</span>ToTensor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\" spellcheck=\"true\"># exchange PIL.Image or numpy.ndarray to torch.FloatTensor (C x H x W)</span>\n    download<span class=\"token operator\">=</span>DOWNLOAD_MNIST<span class=\"token punctuation\">,</span>  \n<span class=\"token punctuation\">)</span>\n\ntest_data <span class=\"token operator\">=</span> torchvision<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>MNIST<span class=\"token punctuation\">(</span>\n    root<span class=\"token operator\">=</span><span class=\"token string\">'./mnist/'</span><span class=\"token punctuation\">,</span>\n    train<span class=\"token operator\">=</span><span class=\"token boolean\">False</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\" spellcheck=\"true\"># BATCH_SIZE</span>\ntrain_loader <span class=\"token operator\">=</span> Data<span class=\"token punctuation\">.</span>DataLoader<span class=\"token punctuation\">(</span>\n    dataset<span class=\"token operator\">=</span>train_data<span class=\"token punctuation\">,</span>\n    batch_size<span class=\"token operator\">=</span>BATCH_SIZE<span class=\"token punctuation\">,</span>\n    shuffle<span class=\"token operator\">=</span><span class=\"token boolean\">True</span>  \n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\" spellcheck=\"true\"># test_data</span>\ntest_x <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>unsqueeze<span class=\"token punctuation\">(</span>test_data<span class=\"token punctuation\">.</span>test_data<span class=\"token punctuation\">,</span> dim<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">(</span>torch<span class=\"token punctuation\">.</span>FloatTensor<span class=\"token punctuation\">)</span>\ntest_y <span class=\"token operator\">=</span> test_data<span class=\"token punctuation\">.</span>test_labels\n\n\n<span class=\"token comment\" spellcheck=\"true\"># cnn</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">CNN</span><span class=\"token punctuation\">(</span>nn<span class=\"token punctuation\">.</span>Module<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        super<span class=\"token punctuation\">(</span>CNN<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>layer1 <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span>\n            <span class=\"token comment\" spellcheck=\"true\"># (1, 28, 28)</span>\n            nn<span class=\"token punctuation\">.</span>Conv2d<span class=\"token punctuation\">(</span>\n                in_channels<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n                out_channels<span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span>\n                kernel_size<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span>  \n                stride<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>  \n                padding<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n                groups<span class=\"token operator\">=</span><span class=\"token number\">1</span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token comment\" spellcheck=\"true\"># (16, 28, 38)</span>\n            nn<span class=\"token punctuation\">.</span>ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            nn<span class=\"token punctuation\">.</span>MaxPool2d<span class=\"token punctuation\">(</span>kernel_size<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n            <span class=\"token comment\" spellcheck=\"true\"># (16, 14, 14)</span>\n        <span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>layer2 <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span>\n\n            nn<span class=\"token punctuation\">.</span>Conv2d<span class=\"token punctuation\">(</span>\n                in_channels<span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span>\n                out_channels<span class=\"token operator\">=</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n                kernel_size<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span>\n                stride<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n                padding<span class=\"token operator\">=</span><span class=\"token number\">2</span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            nn<span class=\"token punctuation\">.</span>ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            nn<span class=\"token punctuation\">.</span>MaxPool2d<span class=\"token punctuation\">(</span>kernel_size<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>layer3 <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>Linear<span class=\"token punctuation\">(</span><span class=\"token number\">32</span> <span class=\"token operator\">*</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">forward</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\" spellcheck=\"true\"># print(x.shape)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>layer1<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\" spellcheck=\"true\"># print(x.shape)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>layer2<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\" spellcheck=\"true\"># print(x.shape)</span>\n        x <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span>view<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\" spellcheck=\"true\"># print(x.shape)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>layer3<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\" spellcheck=\"true\"># print(x.shape)</span>\n        <span class=\"token keyword\">return</span> x\n\n\ncnn <span class=\"token operator\">=</span> CNN<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\noptimizer <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>optim<span class=\"token punctuation\">.</span>Adam<span class=\"token punctuation\">(</span>cnn<span class=\"token punctuation\">.</span>parameters<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> lr<span class=\"token operator\">=</span>LR<span class=\"token punctuation\">)</span>\nloss_function <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>CrossEntropyLoss<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> epoch <span class=\"token keyword\">in</span> range<span class=\"token punctuation\">(</span>EPOCH<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> step<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>b_x<span class=\"token punctuation\">,</span> b_y<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> enumerate<span class=\"token punctuation\">(</span>train_loader<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        output <span class=\"token operator\">=</span> cnn<span class=\"token punctuation\">(</span>b_x<span class=\"token punctuation\">)</span>\n        loss <span class=\"token operator\">=</span> loss_function<span class=\"token punctuation\">(</span>output<span class=\"token punctuation\">,</span> b_y<span class=\"token punctuation\">)</span>\n        optimizer<span class=\"token punctuation\">.</span>zero_grad<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        loss<span class=\"token punctuation\">.</span>backward<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        optimizer<span class=\"token punctuation\">.</span>step<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'finished training'</span><span class=\"token punctuation\">)</span>\ntest_out <span class=\"token operator\">=</span> cnn<span class=\"token punctuation\">(</span>test_x<span class=\"token punctuation\">)</span>\npredict_y <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>test_out<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>numpy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Accuracy in Test : %.4f%%'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>sum<span class=\"token punctuation\">(</span>predict_y <span class=\"token operator\">==</span> test_y<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>numpy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">100</span><span class=\"token operator\">/</span> len<span class=\"token punctuation\">(</span>predict_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"Installing-PyTorch-with-Anaconda-and-Conda\"><a href=\"#Installing-PyTorch-with-Anaconda-and-Conda\" class=\"headerlink\" title=\"Installing PyTorch with Anaconda and Conda\"></a>Installing PyTorch with Anaconda and Conda</h1><p>My Particular Environment:</p>\n<ul>\n<li>OS: Ubuntu 16.04</li>\n<li>Package Manager: conda</li>\n<li>Python: 3.6</li>\n<li>CUDA: None</li>\n</ul>\n<p>Getting started with PyTorch is very easy. The recommended best option is to use the Anaconda Pythob package manager.</p>\n<ol>\n<li><a href=\"https://www.anaconda.com/distribution/\" target=\"_blank\" rel=\"noopener\">Download and install Anaconda</a>(Go with the latest Python version)<br>You can download the <code>.sh</code> package from the Anaconda website, but it’s very slowly for me. So i find another choice.<br>You can find it in <a href=\"https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/\" target=\"_blank\" rel=\"noopener\">Tsinghua university open source mirror station</a>, which i download is <code>Anaconda3-5.2.0-Linux-x86_64.sh</code>. Or if you already get the “wget”, you can run this command in the terminal.<pre><code class=\"bash\">wget https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda3-5.2.0-Linux-x86_64.sh</code></pre>\nUse <code>conda -V</code> to check the Version of Anaconda after open a new terminal.<br>If it isn’t work, try,<pre><code class=\"bash\">echo &#39;export PATH=&quot;~/anaconda3/bin:$PATH&quot;&#39; &gt;&gt; ~/.bashrc\nsource ./bashrc</code></pre>\n</li>\n<li>Go to the Getting Started section on the <a href=\"https://pytorch.org/\" target=\"_blank\" rel=\"noopener\">Pytorch website</a>.</li>\n<li>Specify the appropriate configuration options for your particular environment.<br><img src=\"1.png\" alt></li>\n<li>Run the presented command in the terminal to install Pytorch.<pre><code class=\"bash\">conda install pytorch-cpu torchvision-cpu -c pytorch</code></pre>\n</li>\n</ol>\n<pre><code class=\"python\">import torch\nimport torch.nn as nn\nimport torchvision\nimport torch.utils.data as Data\n\n# Hyper Parameters\nEPOCH = 1  \nBATCH_SIZE = 50\nLR = 0.001  \nDOWNLOAD_MNIST = True  \n\n# Mnist\ntrain_data = torchvision.datasets.MNIST(\n    root=&#39;./mnist/&#39;,  \n    train=True,  # this is training data\n    transform=torchvision.transforms.ToTensor(),  # exchange PIL.Image or numpy.ndarray to torch.FloatTensor (C x H x W)\n    download=DOWNLOAD_MNIST,  \n)\n\ntest_data = torchvision.datasets.MNIST(\n    root=&#39;./mnist/&#39;,\n    train=False\n)\n\n# BATCH_SIZE\ntrain_loader = Data.DataLoader(\n    dataset=train_data,\n    batch_size=BATCH_SIZE,\n    shuffle=True  \n)\n\n# test_data\ntest_x = torch.unsqueeze(test_data.test_data, dim=1).type(torch.FloatTensor)\ntest_y = test_data.test_labels\n\n\n# cnn\n\nclass CNN(nn.Module):\n    def __init__(self):\n        super(CNN, self).__init__()\n        self.layer1 = nn.Sequential(\n            # (1, 28, 28)\n            nn.Conv2d(\n                in_channels=1,\n                out_channels=16,\n                kernel_size=5,  \n                stride=1,  \n                padding=2,\n                groups=1\n            ),\n            # (16, 28, 38)\n            nn.ReLU(),\n            nn.MaxPool2d(kernel_size=2)\n            # (16, 14, 14)\n        )\n        self.layer2 = nn.Sequential(\n\n            nn.Conv2d(\n                in_channels=16,\n                out_channels=32,\n                kernel_size=5,\n                stride=1,\n                padding=2\n            ),\n            nn.ReLU(),\n            nn.MaxPool2d(kernel_size=2)\n        )\n        self.layer3 = nn.Linear(32 * 7 * 7, 10)\n\n    def forward(self, x):\n        # print(x.shape)\n        x = self.layer1(x)\n        # print(x.shape)\n        x = self.layer2(x)\n        # print(x.shape)\n        x = x.view(x.size(0), -1)\n        # print(x.shape)\n        x = self.layer3(x)\n        # print(x.shape)\n        return x\n\n\ncnn = CNN()\n\noptimizer = torch.optim.Adam(cnn.parameters(), lr=LR)\nloss_function = nn.CrossEntropyLoss()\nfor epoch in range(EPOCH):\n    for step, (b_x, b_y) in enumerate(train_loader):\n        output = cnn(b_x)\n        loss = loss_function(output, b_y)\n        optimizer.zero_grad()\n        loss.backward()\n        optimizer.step()\n\nprint(&#39;finished training&#39;)\ntest_out = cnn(test_x)\npredict_y = torch.argmax(test_out, 1).data.numpy()\nprint(&#39;Accuracy in Test : %.4f%%&#39; % (sum(predict_y == test_y.data.numpy()) * 100/ len(predict_y)))</code></pre>\n"},{"title":"Enjoy PyTorch","top":false,"cover":false,"toc":true,"mathjax":false,"date":"2019-08-07T04:56:29.000Z","password":null,"img":"https://i.loli.net/2019/08/07/qwgZ9yezahmipo2.png","summary":null,"_content":"","source":"_posts/Enjoy-PyTorch.md","raw":"---\ntitle: Enjoy PyTorch\ntop: false\ncover: false\ntoc: true\nmathjax: false\ndate: 2019-08-07 12:56:29\npassword:\nimg: https://i.loli.net/2019/08/07/qwgZ9yezahmipo2.png\nsummary:\ntags:\n- PyTorch\n- Deep Learing\ncategories:\n- PyTorch Notes\n---\n","slug":"Enjoy-PyTorch","published":1,"updated":"2020-02-24T10:49:41.328Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0t0000j74ju7b8ava4v","content":"","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":""},{"title":"Face Detection","top":false,"cover":false,"img":"https://i.loli.net/2019/08/15/HGSkhArtKw89uqJ.jpg","toc":true,"mathjax":false,"date":"2019-08-03T06:15:02.000Z","password":null,"summary":"基于LBP的人脸检测","_content":"\n# 人脸检测\n\n## OpenCV模块\n- core：简洁核心模块，基本函数，基本数据结构\n- imgproc：图像处理模块，线性和非线性图像滤波，几何图像转换，颜色空间转换，直方图等。\n- video：视频分析模块，运动估计，背景消除，物体跟踪算法\n- calib3d：基本多视角几何算法，单体和立体相机的标定，对象姿势估计，双目立体匹配算法和元素的三维重建\n- features2d：包含了显著特征检测算法，描述算子和算子匹配算法\n- objdetect：物体检测和一些预定义的物体的检测（如人脸，眼睛，杯子，人，汽车等)\n- ml：多种机器学习算法，如K均值，支持向量机和神经网络\n- highgui：简单易用接口，有视频捕捉，图像和视频编码功能，简单UI接口，iOS的是其中一个子集\n- gpu：GPU加速算法，iOS不可用\n- ocl：OpenCL通用算法，iOS不可用\n- 其它辅助模块，如用户贡献的算法\n\n## 人脸检测\n\n## 检测图片中的人脸\n在OpenCV中，主要使用两种特征进行人脸检测，Haar特征和LBP特征，下面使用的是LBP特征。    \n实现人脸检测主要依赖于detectMultiScale()函数\n\n``` cpp\nCV_WRAP virtual void detectMultiScale\n( const Mat& image,\n  CV_OUT vector<Rect>& objects,\n  double scaleFactor=1.1,\n  int minNeighbors=3, int flags=0,\n  Size minSize=Size(),\n  Size maxSize=Size() );\n```\n\n各参数含义如下：\n**const Mat& image**: 需要被检测的图像（灰度图）。\n**vector<Rect>& objects**: 保存被检测出的人脸位置坐标序列。\n**double scaleFactor**: 每次图片缩放的比例。\n**int minNeighbors**: 每一个人脸至少要检测到多少次才算是真的人脸。\n**doubleint flags**： 决定是缩放分类器来检测，还是缩放图像。\n**Size()**: 表示人脸的最大最小尺寸。\n\n具体实现代码如下:\n\n``` cpp\n#include<opencv2/highgui/highgui.hpp>\n#include<opencv2/imgproc/imgproc.hpp>\n#include<opencv2/objdetect/objdetect.hpp>\n#include<iostream>\n#include<opencv2/core.hpp>\n \n\nusing namespace std;\nusing namespace cv;\n \n#define CV_COLOR_GREEN cv::Scalar(0, 255, 0)\nCascadeClassifier faceCascade;\nint main(int argc, char* argv[])\n{\n Mat img;\n\n CascadeClassifier faceDetector(\"lbpcascade_frontalface.xml\");//读取分类器\n img = imread(argv[1]);  //读取检测的图片原图\n vector<Rect> objects;  //存放检测的对象\n faceDetector.detectMultiScale(img, objects);  //执行检测\n for (int i = 0; i < objects.size(); i++) //遍历检测到的脸\n {\n  rectangle(img, objects[i], CV_COLOR_RED);  //画出检测到的脸\n }\n imshow(\"result\", img);  //显示结果\n waitKey(0);\n\n return 0;\n}\n```\n\n检测结果:\n![](https://i.loli.net/2019/08/01/5d42b5d26727057681.png)\n![](https://i.loli.net/2019/08/01/5d42b5d26fea564434.png)\n![](https://i.loli.net/2019/08/01/5d42b5d2b360c81753.png)\n\n### 检测视频中的人脸\n原理就是对视频逐帧处理，1s大约分为30帧。\n\n```cpp\n#include <opencv2/highgui/highgui.hpp>\n#include <opencv2/imgproc/imgproc.hpp>\n#include <opencv2/core/core.hpp>\n#include <opencv2/objdetect/objdetect.hpp>\n#include <iostream>\n\nusing namespace std;\nusing namespace cv;\n\n#define CV_COLOR_GREEN cv::Scalar(0, 255, 0)\nCascadeClassifier faceCascade;\n\n\nint main(int argc, char** argv)\n{\n  //打开摄像头\n  VideoCapture cap(0);\n  if(!cap.isOpened())\n  {\n    return -1;\n  }\n  //读取分类器\n  CascadeClassifier faceDetector(\"lbpcascade_frontalface.xml\");\n  vector<Rect> objects;\n  Mat frame;\n  Mat edges;\n  bool stop = false;\n  while(!stop){\n    cap >> frame;\n    if (frame.empty())\n      stop = true;\n    double scaleFactor=1.1;\n    int minNeighbors = 3;\n    //int flags = 1;\n    //cvtColor(frame, edges, CV_BGR2GRAY);\n    //GaussianBlur(edges, edges, Size(7,7), 1.5, 1.5);\n    faceDetector.detectMultiScale(frame, objects,scaleFactor, minNeighbors);\n    for(int i = 0; i < objects.size(); i++){\n      rectangle(frame, objects[i], CV_COLOR_GREEN);\n      rectangle(edges, objects[i], CV_COLOR_GREEN);\n    }\n    //imshow(\"edge\", edges);\n    imshow(\"frame\", frame);\n    if (waitKey(30) >= 0)\n      stop = true;\n  }\n  return 0;\n}\n```\n\n识别结果:\n\n![](https://i.loli.net/2019/08/02/5d43e017d9e1227148.png)\n![](https://i.loli.net/2019/08/02/5d43e017f281538470.png)\n\n","source":"_posts/Face-Detection.md","raw":"---\ntitle: Face Detection\ntop: false\ncover: false\nimg: https://i.loli.net/2019/08/15/HGSkhArtKw89uqJ.jpg\ntoc: true\nmathjax: false\ndate: 2019-08-03 14:15:02\npassword:\nsummary: 基于LBP的人脸检测\ntags:\n- Face_Detection\n- OpenCV\n- c++\ncategories:\n- 人脸检测\n---\n\n# 人脸检测\n\n## OpenCV模块\n- core：简洁核心模块，基本函数，基本数据结构\n- imgproc：图像处理模块，线性和非线性图像滤波，几何图像转换，颜色空间转换，直方图等。\n- video：视频分析模块，运动估计，背景消除，物体跟踪算法\n- calib3d：基本多视角几何算法，单体和立体相机的标定，对象姿势估计，双目立体匹配算法和元素的三维重建\n- features2d：包含了显著特征检测算法，描述算子和算子匹配算法\n- objdetect：物体检测和一些预定义的物体的检测（如人脸，眼睛，杯子，人，汽车等)\n- ml：多种机器学习算法，如K均值，支持向量机和神经网络\n- highgui：简单易用接口，有视频捕捉，图像和视频编码功能，简单UI接口，iOS的是其中一个子集\n- gpu：GPU加速算法，iOS不可用\n- ocl：OpenCL通用算法，iOS不可用\n- 其它辅助模块，如用户贡献的算法\n\n## 人脸检测\n\n## 检测图片中的人脸\n在OpenCV中，主要使用两种特征进行人脸检测，Haar特征和LBP特征，下面使用的是LBP特征。    \n实现人脸检测主要依赖于detectMultiScale()函数\n\n``` cpp\nCV_WRAP virtual void detectMultiScale\n( const Mat& image,\n  CV_OUT vector<Rect>& objects,\n  double scaleFactor=1.1,\n  int minNeighbors=3, int flags=0,\n  Size minSize=Size(),\n  Size maxSize=Size() );\n```\n\n各参数含义如下：\n**const Mat& image**: 需要被检测的图像（灰度图）。\n**vector<Rect>& objects**: 保存被检测出的人脸位置坐标序列。\n**double scaleFactor**: 每次图片缩放的比例。\n**int minNeighbors**: 每一个人脸至少要检测到多少次才算是真的人脸。\n**doubleint flags**： 决定是缩放分类器来检测，还是缩放图像。\n**Size()**: 表示人脸的最大最小尺寸。\n\n具体实现代码如下:\n\n``` cpp\n#include<opencv2/highgui/highgui.hpp>\n#include<opencv2/imgproc/imgproc.hpp>\n#include<opencv2/objdetect/objdetect.hpp>\n#include<iostream>\n#include<opencv2/core.hpp>\n \n\nusing namespace std;\nusing namespace cv;\n \n#define CV_COLOR_GREEN cv::Scalar(0, 255, 0)\nCascadeClassifier faceCascade;\nint main(int argc, char* argv[])\n{\n Mat img;\n\n CascadeClassifier faceDetector(\"lbpcascade_frontalface.xml\");//读取分类器\n img = imread(argv[1]);  //读取检测的图片原图\n vector<Rect> objects;  //存放检测的对象\n faceDetector.detectMultiScale(img, objects);  //执行检测\n for (int i = 0; i < objects.size(); i++) //遍历检测到的脸\n {\n  rectangle(img, objects[i], CV_COLOR_RED);  //画出检测到的脸\n }\n imshow(\"result\", img);  //显示结果\n waitKey(0);\n\n return 0;\n}\n```\n\n检测结果:\n![](https://i.loli.net/2019/08/01/5d42b5d26727057681.png)\n![](https://i.loli.net/2019/08/01/5d42b5d26fea564434.png)\n![](https://i.loli.net/2019/08/01/5d42b5d2b360c81753.png)\n\n### 检测视频中的人脸\n原理就是对视频逐帧处理，1s大约分为30帧。\n\n```cpp\n#include <opencv2/highgui/highgui.hpp>\n#include <opencv2/imgproc/imgproc.hpp>\n#include <opencv2/core/core.hpp>\n#include <opencv2/objdetect/objdetect.hpp>\n#include <iostream>\n\nusing namespace std;\nusing namespace cv;\n\n#define CV_COLOR_GREEN cv::Scalar(0, 255, 0)\nCascadeClassifier faceCascade;\n\n\nint main(int argc, char** argv)\n{\n  //打开摄像头\n  VideoCapture cap(0);\n  if(!cap.isOpened())\n  {\n    return -1;\n  }\n  //读取分类器\n  CascadeClassifier faceDetector(\"lbpcascade_frontalface.xml\");\n  vector<Rect> objects;\n  Mat frame;\n  Mat edges;\n  bool stop = false;\n  while(!stop){\n    cap >> frame;\n    if (frame.empty())\n      stop = true;\n    double scaleFactor=1.1;\n    int minNeighbors = 3;\n    //int flags = 1;\n    //cvtColor(frame, edges, CV_BGR2GRAY);\n    //GaussianBlur(edges, edges, Size(7,7), 1.5, 1.5);\n    faceDetector.detectMultiScale(frame, objects,scaleFactor, minNeighbors);\n    for(int i = 0; i < objects.size(); i++){\n      rectangle(frame, objects[i], CV_COLOR_GREEN);\n      rectangle(edges, objects[i], CV_COLOR_GREEN);\n    }\n    //imshow(\"edge\", edges);\n    imshow(\"frame\", frame);\n    if (waitKey(30) >= 0)\n      stop = true;\n  }\n  return 0;\n}\n```\n\n识别结果:\n\n![](https://i.loli.net/2019/08/02/5d43e017d9e1227148.png)\n![](https://i.loli.net/2019/08/02/5d43e017f281538470.png)\n\n","slug":"Face-Detection","published":1,"updated":"2020-02-24T10:49:41.330Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0t1000l74ju3dz5awgk","content":"<h1 id=\"人脸检测\"><a href=\"#人脸检测\" class=\"headerlink\" title=\"人脸检测\"></a>人脸检测</h1><h2 id=\"OpenCV模块\"><a href=\"#OpenCV模块\" class=\"headerlink\" title=\"OpenCV模块\"></a>OpenCV模块</h2><ul>\n<li>core：简洁核心模块，基本函数，基本数据结构</li>\n<li>imgproc：图像处理模块，线性和非线性图像滤波，几何图像转换，颜色空间转换，直方图等。</li>\n<li>video：视频分析模块，运动估计，背景消除，物体跟踪算法</li>\n<li>calib3d：基本多视角几何算法，单体和立体相机的标定，对象姿势估计，双目立体匹配算法和元素的三维重建</li>\n<li>features2d：包含了显著特征检测算法，描述算子和算子匹配算法</li>\n<li>objdetect：物体检测和一些预定义的物体的检测（如人脸，眼睛，杯子，人，汽车等)</li>\n<li>ml：多种机器学习算法，如K均值，支持向量机和神经网络</li>\n<li>highgui：简单易用接口，有视频捕捉，图像和视频编码功能，简单UI接口，iOS的是其中一个子集</li>\n<li>gpu：GPU加速算法，iOS不可用</li>\n<li>ocl：OpenCL通用算法，iOS不可用</li>\n<li>其它辅助模块，如用户贡献的算法</li>\n</ul>\n<h2 id=\"人脸检测-1\"><a href=\"#人脸检测-1\" class=\"headerlink\" title=\"人脸检测\"></a>人脸检测</h2><h2 id=\"检测图片中的人脸\"><a href=\"#检测图片中的人脸\" class=\"headerlink\" title=\"检测图片中的人脸\"></a>检测图片中的人脸</h2><p>在OpenCV中，主要使用两种特征进行人脸检测，Haar特征和LBP特征，下面使用的是LBP特征。<br>实现人脸检测主要依赖于detectMultiScale()函数</p>\n<pre class=\" language-cpp\"><code class=\"language-cpp\">CV_WRAP <span class=\"token keyword\">virtual</span> <span class=\"token keyword\">void</span> <span class=\"token function\">detectMultiScale</span>\n<span class=\"token punctuation\">(</span> <span class=\"token keyword\">const</span> Mat<span class=\"token operator\">&amp;</span> image<span class=\"token punctuation\">,</span>\n  CV_OUT vector<span class=\"token operator\">&lt;</span>Rect<span class=\"token operator\">></span><span class=\"token operator\">&amp;</span> objects<span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">double</span> scaleFactor<span class=\"token operator\">=</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">int</span> minNeighbors<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> flags<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  Size minSize<span class=\"token operator\">=</span><span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  Size maxSize<span class=\"token operator\">=</span><span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>各参数含义如下：<br><strong>const Mat&amp; image</strong>: 需要被检测的图像（灰度图）。<br><strong>vector<rect>&amp; objects</rect></strong>: 保存被检测出的人脸位置坐标序列。<br><strong>double scaleFactor</strong>: 每次图片缩放的比例。<br><strong>int minNeighbors</strong>: 每一个人脸至少要检测到多少次才算是真的人脸。<br><strong>doubleint flags</strong>： 决定是缩放分类器来检测，还是缩放图像。<br><strong>Size()</strong>: 表示人脸的最大最小尺寸。</p>\n<p>具体实现代码如下:</p>\n<pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;opencv2/highgui/highgui.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;opencv2/imgproc/imgproc.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;opencv2/objdetect/objdetect.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;iostream></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;opencv2/core.hpp></span></span>\n\n\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> std<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> cv<span class=\"token punctuation\">;</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> CV_COLOR_GREEN cv::Scalar(0, 255, 0)</span>\nCascadeClassifier faceCascade<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n Mat img<span class=\"token punctuation\">;</span>\n\n CascadeClassifier <span class=\"token function\">faceDetector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"lbpcascade_frontalface.xml\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\" spellcheck=\"true\">//读取分类器</span>\n img <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">//读取检测的图片原图</span>\n vector<span class=\"token operator\">&lt;</span>Rect<span class=\"token operator\">></span> objects<span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">//存放检测的对象</span>\n faceDetector<span class=\"token punctuation\">.</span><span class=\"token function\">detectMultiScale</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> objects<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">//执行检测</span>\n <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> objects<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token comment\" spellcheck=\"true\">//遍历检测到的脸</span>\n <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">rectangle</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> objects<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> CV_COLOR_RED<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">//画出检测到的脸</span>\n <span class=\"token punctuation\">}</span>\n <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"result\"</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">//显示结果</span>\n <span class=\"token function\">waitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>检测结果:<br><img src=\"https://i.loli.net/2019/08/01/5d42b5d26727057681.png\" alt><br><img src=\"https://i.loli.net/2019/08/01/5d42b5d26fea564434.png\" alt><br><img src=\"https://i.loli.net/2019/08/01/5d42b5d2b360c81753.png\" alt></p>\n<h3 id=\"检测视频中的人脸\"><a href=\"#检测视频中的人脸\" class=\"headerlink\" title=\"检测视频中的人脸\"></a>检测视频中的人脸</h3><p>原理就是对视频逐帧处理，1s大约分为30帧。</p>\n<pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/highgui/highgui.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/imgproc/imgproc.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/core/core.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/objdetect/objdetect.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream></span></span>\n\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> std<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> cv<span class=\"token punctuation\">;</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> CV_COLOR_GREEN cv::Scalar(0, 255, 0)</span>\nCascadeClassifier faceCascade<span class=\"token punctuation\">;</span>\n\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> argv<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token comment\" spellcheck=\"true\">//打开摄像头</span>\n  VideoCapture <span class=\"token function\">cap</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>cap<span class=\"token punctuation\">.</span><span class=\"token function\">isOpened</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\" spellcheck=\"true\">//读取分类器</span>\n  CascadeClassifier <span class=\"token function\">faceDetector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"lbpcascade_frontalface.xml\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  vector<span class=\"token operator\">&lt;</span>Rect<span class=\"token operator\">></span> objects<span class=\"token punctuation\">;</span>\n  Mat frame<span class=\"token punctuation\">;</span>\n  Mat edges<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">bool</span> stop <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>stop<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    cap <span class=\"token operator\">>></span> frame<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      stop <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">double</span> scaleFactor<span class=\"token operator\">=</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> minNeighbors <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">//int flags = 1;</span>\n    <span class=\"token comment\" spellcheck=\"true\">//cvtColor(frame, edges, CV_BGR2GRAY);</span>\n    <span class=\"token comment\" spellcheck=\"true\">//GaussianBlur(edges, edges, Size(7,7), 1.5, 1.5);</span>\n    faceDetector<span class=\"token punctuation\">.</span><span class=\"token function\">detectMultiScale</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">,</span> objects<span class=\"token punctuation\">,</span>scaleFactor<span class=\"token punctuation\">,</span> minNeighbors<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> objects<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      <span class=\"token function\">rectangle</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">,</span> objects<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> CV_COLOR_GREEN<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">rectangle</span><span class=\"token punctuation\">(</span>edges<span class=\"token punctuation\">,</span> objects<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> CV_COLOR_GREEN<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\" spellcheck=\"true\">//imshow(\"edge\", edges);</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"frame\"</span><span class=\"token punctuation\">,</span> frame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">waitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n      stop <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>识别结果:</p>\n<p><img src=\"https://i.loli.net/2019/08/02/5d43e017d9e1227148.png\" alt><br><img src=\"https://i.loli.net/2019/08/02/5d43e017f281538470.png\" alt></p>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"人脸检测\"><a href=\"#人脸检测\" class=\"headerlink\" title=\"人脸检测\"></a>人脸检测</h1><h2 id=\"OpenCV模块\"><a href=\"#OpenCV模块\" class=\"headerlink\" title=\"OpenCV模块\"></a>OpenCV模块</h2><ul>\n<li>core：简洁核心模块，基本函数，基本数据结构</li>\n<li>imgproc：图像处理模块，线性和非线性图像滤波，几何图像转换，颜色空间转换，直方图等。</li>\n<li>video：视频分析模块，运动估计，背景消除，物体跟踪算法</li>\n<li>calib3d：基本多视角几何算法，单体和立体相机的标定，对象姿势估计，双目立体匹配算法和元素的三维重建</li>\n<li>features2d：包含了显著特征检测算法，描述算子和算子匹配算法</li>\n<li>objdetect：物体检测和一些预定义的物体的检测（如人脸，眼睛，杯子，人，汽车等)</li>\n<li>ml：多种机器学习算法，如K均值，支持向量机和神经网络</li>\n<li>highgui：简单易用接口，有视频捕捉，图像和视频编码功能，简单UI接口，iOS的是其中一个子集</li>\n<li>gpu：GPU加速算法，iOS不可用</li>\n<li>ocl：OpenCL通用算法，iOS不可用</li>\n<li>其它辅助模块，如用户贡献的算法</li>\n</ul>\n<h2 id=\"人脸检测-1\"><a href=\"#人脸检测-1\" class=\"headerlink\" title=\"人脸检测\"></a>人脸检测</h2><h2 id=\"检测图片中的人脸\"><a href=\"#检测图片中的人脸\" class=\"headerlink\" title=\"检测图片中的人脸\"></a>检测图片中的人脸</h2><p>在OpenCV中，主要使用两种特征进行人脸检测，Haar特征和LBP特征，下面使用的是LBP特征。<br>实现人脸检测主要依赖于detectMultiScale()函数</p>\n<pre><code class=\"cpp\">CV_WRAP virtual void detectMultiScale\n( const Mat&amp; image,\n  CV_OUT vector&lt;Rect&gt;&amp; objects,\n  double scaleFactor=1.1,\n  int minNeighbors=3, int flags=0,\n  Size minSize=Size(),\n  Size maxSize=Size() );</code></pre>\n<p>各参数含义如下：<br><strong>const Mat&amp; image</strong>: 需要被检测的图像（灰度图）。<br><strong>vector<rect>&amp; objects</rect></strong>: 保存被检测出的人脸位置坐标序列。<br><strong>double scaleFactor</strong>: 每次图片缩放的比例。<br><strong>int minNeighbors</strong>: 每一个人脸至少要检测到多少次才算是真的人脸。<br><strong>doubleint flags</strong>： 决定是缩放分类器来检测，还是缩放图像。<br><strong>Size()</strong>: 表示人脸的最大最小尺寸。</p>\n<p>具体实现代码如下:</p>\n<pre><code class=\"cpp\">#include&lt;opencv2/highgui/highgui.hpp&gt;\n#include&lt;opencv2/imgproc/imgproc.hpp&gt;\n#include&lt;opencv2/objdetect/objdetect.hpp&gt;\n#include&lt;iostream&gt;\n#include&lt;opencv2/core.hpp&gt;\n\n\nusing namespace std;\nusing namespace cv;\n\n#define CV_COLOR_GREEN cv::Scalar(0, 255, 0)\nCascadeClassifier faceCascade;\nint main(int argc, char* argv[])\n{\n Mat img;\n\n CascadeClassifier faceDetector(&quot;lbpcascade_frontalface.xml&quot;);//读取分类器\n img = imread(argv[1]);  //读取检测的图片原图\n vector&lt;Rect&gt; objects;  //存放检测的对象\n faceDetector.detectMultiScale(img, objects);  //执行检测\n for (int i = 0; i &lt; objects.size(); i++) //遍历检测到的脸\n {\n  rectangle(img, objects[i], CV_COLOR_RED);  //画出检测到的脸\n }\n imshow(&quot;result&quot;, img);  //显示结果\n waitKey(0);\n\n return 0;\n}</code></pre>\n<p>检测结果:<br><img src=\"https://i.loli.net/2019/08/01/5d42b5d26727057681.png\" alt><br><img src=\"https://i.loli.net/2019/08/01/5d42b5d26fea564434.png\" alt><br><img src=\"https://i.loli.net/2019/08/01/5d42b5d2b360c81753.png\" alt></p>\n<h3 id=\"检测视频中的人脸\"><a href=\"#检测视频中的人脸\" class=\"headerlink\" title=\"检测视频中的人脸\"></a>检测视频中的人脸</h3><p>原理就是对视频逐帧处理，1s大约分为30帧。</p>\n<pre><code class=\"cpp\">#include &lt;opencv2/highgui/highgui.hpp&gt;\n#include &lt;opencv2/imgproc/imgproc.hpp&gt;\n#include &lt;opencv2/core/core.hpp&gt;\n#include &lt;opencv2/objdetect/objdetect.hpp&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\nusing namespace cv;\n\n#define CV_COLOR_GREEN cv::Scalar(0, 255, 0)\nCascadeClassifier faceCascade;\n\n\nint main(int argc, char** argv)\n{\n  //打开摄像头\n  VideoCapture cap(0);\n  if(!cap.isOpened())\n  {\n    return -1;\n  }\n  //读取分类器\n  CascadeClassifier faceDetector(&quot;lbpcascade_frontalface.xml&quot;);\n  vector&lt;Rect&gt; objects;\n  Mat frame;\n  Mat edges;\n  bool stop = false;\n  while(!stop){\n    cap &gt;&gt; frame;\n    if (frame.empty())\n      stop = true;\n    double scaleFactor=1.1;\n    int minNeighbors = 3;\n    //int flags = 1;\n    //cvtColor(frame, edges, CV_BGR2GRAY);\n    //GaussianBlur(edges, edges, Size(7,7), 1.5, 1.5);\n    faceDetector.detectMultiScale(frame, objects,scaleFactor, minNeighbors);\n    for(int i = 0; i &lt; objects.size(); i++){\n      rectangle(frame, objects[i], CV_COLOR_GREEN);\n      rectangle(edges, objects[i], CV_COLOR_GREEN);\n    }\n    //imshow(&quot;edge&quot;, edges);\n    imshow(&quot;frame&quot;, frame);\n    if (waitKey(30) &gt;= 0)\n      stop = true;\n  }\n  return 0;\n}</code></pre>\n<p>识别结果:</p>\n<p><img src=\"https://i.loli.net/2019/08/02/5d43e017d9e1227148.png\" alt><br><img src=\"https://i.loli.net/2019/08/02/5d43e017f281538470.png\" alt></p>\n"},{"title":"Face Recognition","top":false,"cover":true,"img":"https://i.loli.net/2019/08/15/hegwoqsdjiZf2rN.jpg","toc":true,"mathjax":false,"date":"2019-08-10T04:00:00.000Z","password":null,"summary":"Face Recognition","_content":"\n# Face Recognition with OpenCV\n\n# Preface\nMy Particular Environment:    \nUbuntu16.04 + OpenCV3.3.0 + OpenCV_contrib3.3.0\n\n## 1. Image Acquisition and Face Database Creation\n\n### 1.1 Image Acquisition\n\n#### 1.1.1 Steps and methods\n1. Open the camera and capture images;\n2. Loading the face classifier;\n3. Start face detection, frame the face part and display;\n4. Under the condition that the face is detected, take a picture with one button;\n5. For the face part, resize and write the image file in the specified directory;\n\n#### 1.1.2 Code\n\n```cpp\n#include <opencv2/highgui/highgui.hpp>\n#include <opencv2/imgproc/imgproc.hpp>\n#include <opencv2/core/core.hpp>\n#include <opencv2/objdetect/objdetect.hpp>\n#include <stdio.h>\n#include <opencv2/face.hpp>\n#include <iostream>\n#include <fstream>\n#include <sstream> \nusing namespace cv;\nusing namespace std;\nusing namespace cv::face;\n\n#define CV_COLOR_GREEN cv::Scalar(0, 255, 0)\n\nint resize_save(Mat& faceIn, char* path, int  faceseq);\n//Input: current image, the path of file, the name or faceseq of images.\n//Output: None\n//Function: resize the current image to (92, 112), which is same to the train data.\nint get_face(char* path);\n//Input: the path of file.\n//Output: None\n//Function: Use face_cascade to detect if there are faces in the window, and save the faces through function reszie_save.\n\n\nint resize_save(Mat& faceIn, char* path, int  faceseq){\n  string strname;\n  Mat faceOut;\n  bool ret;\n  if(faceIn.empty()){\n    printf(\"FaceIn is empty.\\n\");\n    return -1;\n  }\n\n  if(faceIn.cols > 100){\n    resize(faceIn, faceOut, Size(92, 112));\n    //Resize and Keep a match with the train database.\n    strname = format(\"%s/%d.jpg\", path, faceseq); //mkdir\n    ret = imwrite(strname, faceOut); //save image. Note the file suffix.\n    if(ret == false){\n      printf(\"Image write failed!\\n\");\n      printf(\"Please check filename[%s] is legal!\\n\", strname.c_str());\n      return -1;\n    }\n    imshow(strname, faceOut);\n  }\n  waitKey(20);\n  return 0;\n}\n\nint get_face(char* path){\n  CascadeClassifier face_cascade;\n  VideoCapture camera;\n  int ret;\n  Mat frame;  //camera frame\n  vector<Rect> objects; //The faces coordinates.\n  Mat img_gary; //Gradation pictures.\n  Mat faceImg;\n  int faceNum = 1; //\n  char key;\n  camera.open(0);\n  if(!camera.isOpened()){\n    cout << \"Open camera failed.\" << endl;\n    return -1;\n  }\n  cout << \"Open camera succeed. \" << endl;\n\n  //Load the face cascadeclassifier.\n  ret = face_cascade.load(\"haarcascade_frontalface_alt2.xml\");\n  if(!ret){\n    cout << \"Load xml failed.\" << endl;\n    return -1;\n  }\n  cout << \"Load xml succeed.\" << endl;\n  \n  while(1){\n    camera >> frame;\n    if(frame.empty()){\n      continue;\n    }\n    cvtColor(frame, img_gary, COLOR_BGR2GRAY); //Transform frame as the gradation picture, note imshow is still the original frame.\n    equalizeHist(img_gary, img_gary); //Histogram equalization, which is helpful to improve the quality of pictures.\n\n    //Face detection\n    face_cascade.detectMultiScale(img_gary, objects, 1.1,3 , 0, Size(50,50));\n    for(size_t i = 0; i < objects.size(); i++){\n      rectangle(frame, objects[i], CV_COLOR_GREEN);\n    }\n    imshow(\"Camera\", frame);\n    key = waitKey(1);\n    switch (key){\n      case 'p': //tap 'P' to save.\n        if(objects.size() == 1){\n          faceImg = frame(objects[0]);\n          ret = resize_save(faceImg, path, faceNum);\n          if(ret == 0){\n            cout << \"resize_save succeed.\\n\" << endl;\n            faceNum++;\n          }\n        }\n        break;\n      case 27:   //switch to ESC\n        cout << \"Esc ...\" << endl;\n        return 0;\n      default:\n        break;\n    }\n  }\n}\n\n\n\nint main(int argc, char* argv[]){\n  if(argc != 2)\n  \t{\n\t\tprintf(\"usage: %s <path>\\n\", argv[0]);\n\t\treturn -1;\n  \t}\n  get_face(argv[1]);\n  return 0;\n}\n```\n\n![](4.jpg)\nNote:    \n\n1. After the compilation is successful, the execution executable file must provide parameters, which are the directories for storing the face image, and it must be an existing directory.(E.g: ./program_name Img/s41)    \n2. Press the “P” button to take a photo and save the face. Press the “Esc” button to exit.\n\n\n### 1.2 Face Database Creation\nThe official document provides a download of the face database, and i use the [AT&T Facedatabase](http://www.cl.cam.ac.uk/research/dtg/attarchive/facedatabase.html) to create my face database. I have updated this zip file to my github, you can download it from [here](att_faces.zip) faster.\nAT&T Face Database is also known as the OCR face database, 40 people, 10 photos per person. The photos are token at different times, different lighting, different expressions(closed eyes, laughing or not laughing), different face details(with or without glasses). All images were captured on a dark , even background with a vertical face o the front(some with a slight rotation).    \nYou can download the compressed package from the website, and first extract the att_faces folder. There are 40 folders under the folder, which named from \"s1\" to \"s40\". Each folder has the same person's photos with different expressions, and there are 10 face photos.    \nThe format of these images is \".pgm\"\n![](1.png)\n![](2.png)\n\nNote:    \nIf you want to add your own photos to the face database through the program, the number of added pictures must be no less than 2.\n\n## 2. Face Recognition Model training\n\n### 2.1 Create a label file CSV\nWith the face database data, we need to read it in the program, here we need to use csv file to read the image data in the face database.    \nThe format of a csv file: image path name + label, such as /Img/s1/image.jpg;1    \nAssume the face image path is: /Img/s1/01..jpg    \nAnd we give this face image a label \"1\", this label represents the person's name. One person's face image label must be the same.    \nYou can create a csv file manually and then enter the data one by one. But if you use python, you don't have to do this tedious and boring work.    \nThe following is a piece of code which can write data in the CSV file automatically.\n\n```python\n#!/usr/bin/env python\n \nimport sys\nimport os.path\n \n# This is a tiny script to help you creating a CSV file from a face\n# database with a similar hierarchie:\n#\n#  \n#  \n#  |-- s1\n#  |   |-- 1.pgm\n#  |   |-- ...\n#  |   |-- 10.pgm\n#  |-- s2\n#  |   |-- 1.pgm\n#  |   |-- ...\n#  |   |-- 10.pgm\n#  ...\n#  |-- s40\n#  |   |-- 1.pgm\n#  |   |-- ...\n#  |   |-- 10.pgm\n#\n \nif __name__ == \"__main__\":\n \n    if len(sys.argv) != 2:\n        print \"usage: create_csv <base_path>\"\n        sys.exit(1)\n \n    BASE_PATH=sys.argv[1]        \n    SEPARATOR=\";\"\n    # This is output csv file.\n    fh = open(\"../at.csv\",'w')\n \n    for dirname, dirnames, filenames in os.walk(BASE_PATH):\n        for subdirname in dirnames:\n            subject_path = os.path.join(dirname, subdirname)\n            for filename in os.listdir(subject_path):\n                abs_path = \"%s/%s\" % (subject_path, filename)\n                print(\"%s%s%s\" % (abs_path, SEPARATOR, subdirname[1:]))\n                fh.write(abs_path)\n                fh.write(SEPARATOR)\n                fh.write(subdirname[1:])\n                fh.write(\"\\n\")\n    fh.close()\n```\n\nYou should set the image path parameter (absolute path) when running.(E.g: **python filename.py /home/kevin/OpenCV/face_rec/Img** ) and you can get a CSV file like this:\n![](5.png)\nThis CSV file is created.\n\n### 2.2 Model training\nThis is the official example of OpenCV: [Click here](https://docs.opencv.org/3.2.0/da/d60/tutorial_face_main.html)\nThey offer three models: Eigenfaces, Fisherfaces and Local Binary Patterns Histograms(LBPH)    \n\nThen I will train my own face database based on these models on the first step.\n\n```cpp\nstatic Mat norm_0_255(InputArray _src){\n  Mat src = _src.getMat();\n  Mat dst; //Create and return a normalized image matrix:\n  switch(src.channels()) {\n    case 1:\n        cv::normalize(_src, dst, 0, 255, NORM_MINMAX, CV_8UC1);\n        break;\n    case 3:\n        cv::normalize(_src, dst, 0, 255, NORM_MINMAX, CV_8UC3);\n        break;\n    default:\n        src.copyTo(dst);\n        break;\n  }\n  return dst;\n}\n//load CSV file\nstatic void read_csv(const string& filename, vector<Mat>& images, vector<int>& labels, char separator = ';'){\n  std::ifstream file(filename.c_str(), ifstream::in);\n    if (!file) {\n        string error_message = \"No valid input file was given, please check the given filename.\";\n        CV_Error(Error::StsBadArg, error_message);\n    }\n    string line, path, classlabel;\n    while (getline(file, line)) {\n        stringstream liness(line);\n        getline(liness, path, separator);\n        getline(liness, classlabel);\n        if(!path.empty() && !classlabel.empty()) {\n            images.push_back(imread(path, 0));\n            labels.push_back(atoi(classlabel.c_str()));\n        }\n    }\n}\n\nvoid train_model(const string& fn_csv){\n  // 2 containers to store image data and corresponding labels\n    vector<Mat> images;\n    vector<int> labels;\n    // load data\n    try\n    {\n        read_csv(fn_csv, images, labels);\n    }\n    catch (cv::Exception& e)\n    {\n        cerr << \"Error opening file \\\"\" << fn_csv << \"\\\". Reason: \" << e.msg << endl;\n        exit(1);\n    }\n    if (images.size() <= 1) {\n        string error_message = \"This demo needs at least 2 images to work. Please add more images to your data set!\";\n        CV_Error(CV_StsError, error_message);\n    }\n\n    Mat testSample = images[images.size() - 1];\n    int testLabel = labels[labels.size() - 1];\n    images.pop_back();\n    labels.pop_back();\n    // The following lines create a feature face model for face recognition.\n     // Train it with images and tags read from a CSV file.\n     // Here is a complete PCA transform\n     //If you only want to keep 10 principal components, use the following code\n     // cv::EigenFaceRecognizer::create(10);\n     // cv::FisherFaceRecognizer::create(10);\n     //\n     // If you also want to initialize with a confidence threshold, use the following statement:\n     // cv::EigenFaceRecognizer::create(10, 123.0);\n     //\n     // If you use all features and use a threshold, use the following statement:\n     // cv::EigenFaceRecognizer::create(0, 123.0);\n     // cv::FisherFaceRecognizer::create(0, 123.0);\n\n    Ptr<BasicFaceRecognizer> model0 = EigenFaceRecognizer::create();\n    model0->train(images, labels);\n    model0->write(\"MyFacePCAModel.xml\");\n\n    Ptr<BasicFaceRecognizer> model1 = FisherFaceRecognizer::create();\n    model1->train(images, labels);\n    model1->write(\"MyFaceFisherModel.xml\");\n\n     Ptr<LBPHFaceRecognizer> model2 = LBPHFaceRecognizer::create();\n    model2->train(images, labels);\n    model2->write(\"MyFaceLBPHModel.xml\");\n\n\n    // The test image is predicted below, predictedLabel is the predicted label result\n    int predictedLabel0 = model0->predict(testSample);\n    int predictedLabel1 = model1->predict(testSample);\n    int predictedLabel2 = model2->predict(testSample);\n\n    // There is also a way to get the result and get the threshold:\n    //      int predictedLabel = -1;\n    //      double confidence = 0.0;\n    //      model->predict(testSample, predictedLabel, confidence);\n\n    string result_message0 = format(\"Predicted class = %d / Actual class = %d.\", predictedLabel0, testLabel);\n    string result_message1 = format(\"Predicted class = %d / Actual class = %d.\", predictedLabel1, testLabel);\n    string result_message2 = format(\"Predicted class = %d / Actual class = %d.\", predictedLabel2, testLabel);\n    cout << result_message0 << endl;\n    cout << result_message1 << endl;\n    cout << result_message2 << endl;\n\n    waitKey(0);\n}\n\nint main(int argc, char* argv[]){\n  if(argc != 2)\n  \t{\n\t\tprintf(\"usage: %s <csv_file>\\n\", argv[0]);\n\t\treturn -1;\n  \t}\n  string fn_csv = string(argv[1]);\n  train_model(fn_csv);\n  return 0;\n}\n```\n\nAt this point, we have completed the training of the face model. And we get three files:     \n\n`MyFaceFisherModel.xml、MyFaceLBPHModel.xml、MyFacePCAModel.xml`\n\n![](6.png)\nNote:    \n\n1. Changes to the API of the OpenCV3.3 Face Recognition Module\n\n   a. Facerec.hpp before opencv3.3\n\n   ```cpp\n   #ifndef __OPENCV_FACEREC_HPP__\n   #define __OPENCV_FACEREC_HPP__\n   \n   #include \"opencv2/face.hpp\"\n   #include \"opencv2/core.hpp\"\n   \n   namespace cv { namespace face {\n   \n   // base for two classes\n   class CV_EXPORTS_W BasicFaceRecognizer : public FaceRecognizer\n   {\n   public:\n       /** @see setNumComponents */\n       CV_WRAP virtual int getNumComponents() const = 0;\n       // ----------- ...... -----------\n   \n       CV_WRAP virtual cv::Mat getEigenValues() const = 0;\n       CV_WRAP virtual cv::Mat getEigenVectors() const = 0;\n       CV_WRAP virtual cv::Mat getMean() const = 0;\n   };\n   \n   CV_EXPORTS_W Ptr<BasicFaceRecognizer> createEigenFaceRecognizer(int num_components = 0, double threshold = DBL_MAX);\n   \n   CV_EXPORTS_W Ptr<BasicFaceRecognizer> createFisherFaceRecognizer(int num_components = 0, double threshold = DBL_MAX);\n   \n   class CV_EXPORTS_W LBPHFaceRecognizer : public FaceRecognizer\n   {\n   public:\n       /** @see setGridX */\n       CV_WRAP virtual int getGridX() const = 0;\n       /** @copybrief getGridX @see getGridX */\n       CV_WRAP virtual void setGridX(int val) = 0;\n       // ----------- ...... -----------\n       CV_WRAP virtual cv::Mat getLabels() const = 0;\n   };\n   \n   CV_EXPORTS_W Ptr<LBPHFaceRecognizer> createLBPHFaceRecognizer(int radius=1, int neighbors=8, int grid_x=8, int grid_y=8, double threshold = DBL_MAX);\n   \n   }} //namespace cv::face\n   \n   #endif //__OPENCV_FACEREC_HPP__\n   ```\n\n   - Comment section of the ninth line: `// base for two classes`,  This shows that BasicFaceRecognizer is the base class of two classes: EigenFaceRecognizer and FisherFaceRecognizer. With LBPHFaceRecognizer is irrelevant. Even the new API is still the case.\n\n   - Method of creating three face recognizers.\n\n     ```cpp\n     Ptr<BasicFaceRecognizer> model =  createEigenFaceRecognizer();\n     Ptr<BasicFaceRecognizer> model =  createFisherFaceRecognizer();\n     Ptr<LBPHFaceRecognizer> model  =  createLBPHFaceRecognizer();\n     ```\n\n   b. Facerec.hpp after opencv3.3\n\t\n```cpp\n#ifndef __OPENCV_FACEREC_HPP__\n#define __OPENCV_FACEREC_HPP__\n\t\n#include \"opencv2/face.hpp\"\n#include \"opencv2/core.hpp\"\n\t\nnamespace cv { namespace face {\n\t\n// base for two classes\nclass CV_EXPORTS_W BasicFaceRecognizer : public FaceRecognizer\n{\npublic:\n\t/** @see setNumComponents */\n\tCV_WRAP int getNumComponents() const;\n\t// ----------- ...... -----------\n\tCV_WRAP cv::Mat getEigenValues() const;\n\tCV_WRAP cv::Mat getEigenVectors() const;\n\tCV_WRAP cv::Mat getMean() const;\n\t\n\tvirtual void read(const FileNode& fn);\n\tvirtual void write(FileStorage& fs) const;\n\tvirtual bool empty() const;\n\t\n\tusing FaceRecognizer::read;\n\tusing FaceRecognizer::write;\n\nprotected:\n\tint _num_components;\n\tdouble _threshold;\n\tstd::vector<Mat> _projections;\n\tMat _labels;\n\tMat _eigenvectors;\n\tMat _eigenvalues;\n\tMat _mean;\n};\nclass CV_EXPORTS_W EigenFaceRecognizer : public BasicFaceRecognizer\n{\npublic:\n\tCV_WRAP static Ptr<EigenFaceRecognizer> create(int num_components = 0, double threshold = DBL_MAX);\n};\n\nclass CV_EXPORTS_W FisherFaceRecognizer : public BasicFaceRecognizer\n{\npublic:\n\tCV_WRAP static Ptr<FisherFaceRecognizer> create(int num_components = 0, double threshold = DBL_MAX);\n};\nclass CV_EXPORTS_W LBPHFaceRecognizer : public FaceRecognizer\n{\npublic:\n\t/** @see setGridX */\n\tCV_WRAP virtual int getGridX() const = 0;\n\t// ----------- ...... -----------\n\tCV_WRAP virtual cv::Mat getLabels() const = 0;\n\tCV_WRAP static Ptr<LBPHFaceRecognizer> create(int radius=1, int neighbors=8, int grid_x=8, int grid_y=8, double threshold = DBL_MAX);\n};\n}} //namespace cv::face\n\t\n#endif //__OPENCV_FACEREC_HPP__\n```\n\n   - Both EigenFaceRecognizer and FisherFaceRecognizer are inherited from BasicFaceRecognizer. However, the LBFPHaceRecognizer, like the BasicFaceRecognizer, inherits from FaceRecognizer.\t\n   - Method of creating three face recognizer\n\n```cpp\nPtr<EigenFaceRecognizer> model  = EigenFaceRecognizer::create();\nPtr<FisherFaceRecognizer> model = FisherFaceRecognizer::create();\nPtr<LBPHFaceRecognizer> model   = LBPHFaceRecognizer::create();\n```\n\n## 3. Identify faces in the video stream (camera)\n\n### 3.1 Ready to work.\n#### 3.1.1 Copy the training file obtained in the second step to the current folder.\n#### 3.1.2 The process or method of Face Recognition \nThis step has a similar part to the creation of a face recognition database.\n   - Open the camera\n   - Loading face detector, face model\n   - Scale the image (for efficiency)\n   - Face recognition (compare to face model)\n   - Label faces with rectangular wireframes and add text labels\n\n#### 3.2 Code\n\n```cpp\n#include <opencv2/opencv.hpp>  \n#include \"opencv2/core.hpp\"\n#include \"opencv2/face.hpp\"\n#include \"opencv2/highgui.hpp\"\n#include \"opencv2/imgproc.hpp\"\n#include <iostream>\n#include <fstream>\n#include <sstream>\n \nusing namespace cv;\nusing namespace cv::face;\nusing namespace std;\n \n#define ROW_MIN\t\t45\n \nint exitFlag = 0;\n\nint Recognition_And_Draw();\n\nint Recognition_And_Draw(){\n  int ret = 0; //\n  double scale = 4; //Zoom factor\n  double fx = 1 / scale;\n  Mat frame;  //Video frame\n  VideoCapture cap(0);    //Open the camera\n  if(!cap.isOpened()){\n    cout << \"Open camera failed.\\n\" << endl;\n    return -1;\n  }\n\n  //Load cascade classifier\n  CascadeClassifier cascade;\n  ret = cascade.load(\"haarcascade_frontalface_alt2.xml\");\n\n  if(!ret){\n    printf(\"Load xml failed[ret = %d]. \\n\", ret);\n    return -1;\n  }\n  cout << \"Load xml succeed.\" << endl;\n\n  // Loading trained face models\n  Ptr<BasicFaceRecognizer> modelPCA = EigenFaceRecognizer::create();  \n  modelPCA->read(\"MyFacePCAModel.xml\");  \n  Ptr<BasicFaceRecognizer> modelFisher = FisherFaceRecognizer::create();\n  modelFisher->read(\"MyFaceFisherModel.xml\");  \n  Ptr<LBPHFaceRecognizer> modelLBPH = LBPHFaceRecognizer::create();  \n  modelLBPH->read(\"MyFaceLBPHModel.xml\");  \n\n  while(!exitFlag){\n    cap >> frame;\n    if(frame.empty())\n      continue;\n  \n    Mat facesImg;  //\n    vector<Rect> faces;  //Create a vector container for storing faces\n    Mat gary_img; //grayscale image\n    Mat scl_gary_img; //Scaled grayscale image\n  \n    cvtColor(frame, gary_img, COLOR_BGR2GRAY); //Convert the original image to a grayscale image\n    resize(gary_img, scl_gary_img, Size(), fx, fx, INTER_LINEAR); //resize img\n    equalizeHist( scl_gary_img, scl_gary_img );\n\n  //face detection\n    cascade.detectMultiScale(scl_gary_img, faces, 1.1, 2, 0|CASCADE_SCALE_IMAGE,Size(30, 30));\n    printf(\"Face.size = %ld\\n\", faces.size());\n  //facesImg = scl_gary_img(faces[0]);\n  \n    Mat face_resize;  //To prevent the picture is too small (that is, people too far away from the camera)\n    int predictPCA = 0;  \n    int predictFisher = 0;  \n    int predictLBPH = 0;\n    for(size_t i = 0; i < faces.size(); i++){\n      \n      Rect rectFace = faces[i];\n      facesImg = scl_gary_img(faces[i]);\n      if(facesImg.rows >= ROW_MIN){\n        resize(facesImg, face_resize, Size(92, 112));\n      }\n      else{\n        printf(\"faceImg.rows[%d] < %d \\n\", facesImg.rows, ROW_MIN);\n        continue;\n      }\n      if(!face_resize.empty()){\n        predictPCA = modelPCA->predict(face_resize);  \n        predictFisher = modelFisher->predict(face_resize);  \n        predictLBPH = modelLBPH->predict(face_resize); \n      }\n      cout << \"predictPCA   : \" << predictPCA    << endl;\n      cout << \"predictFisher: \" << predictFisher << endl;\n      cout << \"predictLBPH  : \" << predictLBPH   << endl;\n      rectangle(frame, Point(rectFace.x, rectFace.y) * scale, Point(rectFace.x + rectFace.width, rectFace.y + rectFace.height) * scale, Scalar(0, 255, 0), 2, 8);\n      if (predictPCA == 41){\n        putText(frame, \"Liuyang\", Point(faces[i].x, faces[i].y) * scale, FONT_HERSHEY_SIMPLEX, 1, Scalar(0, 0, 255), 2);\n      }\n      else{\n        putText(frame, \"X\", Point(faces[i].x, faces[i].y) * scale, FONT_HERSHEY_SIMPLEX, 1.5, Scalar(0, 0, 255), 2);\n      }\n      \n  // if(faces.size() <= 0){\n  //  cout << \"There are no faces in the camera.\\n\" << endl;\n // }\n    }\n    imshow(\"frame\", frame);\n      if (waitKey(1) == 27){\n\t\t\t    exitFlag = 1;\n\t\t\t    cout << \"Esc...\" << endl;\n\t\t\t    break;\n      }\n  }\n}\n\nint main(){\n  Recognition_And_Draw();\n  return 0;\n}\n```\n\n![](7.jpg)\n\nNote:    \n1. This program supports multiple face recognition at the same time\n2. Face recognition accuracy is not high, and it is susceptible to environmental factors such as light.\n","source":"_posts/Face-Recognition-with-OpenCV.md","raw":"---\ntitle: Face Recognition\ntop: false\ncover: true\nimg: https://i.loli.net/2019/08/15/hegwoqsdjiZf2rN.jpg\ntoc: true\nmathjax: false\ndate: 2019-08-10 12:00:00\npassword:\nsummary: Face Recognition\ntags: \n- OpenCV\n- Face Recongnition\n- c++\n- python\ncategories: \n- Face Recognition\n---\n\n# Face Recognition with OpenCV\n\n# Preface\nMy Particular Environment:    \nUbuntu16.04 + OpenCV3.3.0 + OpenCV_contrib3.3.0\n\n## 1. Image Acquisition and Face Database Creation\n\n### 1.1 Image Acquisition\n\n#### 1.1.1 Steps and methods\n1. Open the camera and capture images;\n2. Loading the face classifier;\n3. Start face detection, frame the face part and display;\n4. Under the condition that the face is detected, take a picture with one button;\n5. For the face part, resize and write the image file in the specified directory;\n\n#### 1.1.2 Code\n\n```cpp\n#include <opencv2/highgui/highgui.hpp>\n#include <opencv2/imgproc/imgproc.hpp>\n#include <opencv2/core/core.hpp>\n#include <opencv2/objdetect/objdetect.hpp>\n#include <stdio.h>\n#include <opencv2/face.hpp>\n#include <iostream>\n#include <fstream>\n#include <sstream> \nusing namespace cv;\nusing namespace std;\nusing namespace cv::face;\n\n#define CV_COLOR_GREEN cv::Scalar(0, 255, 0)\n\nint resize_save(Mat& faceIn, char* path, int  faceseq);\n//Input: current image, the path of file, the name or faceseq of images.\n//Output: None\n//Function: resize the current image to (92, 112), which is same to the train data.\nint get_face(char* path);\n//Input: the path of file.\n//Output: None\n//Function: Use face_cascade to detect if there are faces in the window, and save the faces through function reszie_save.\n\n\nint resize_save(Mat& faceIn, char* path, int  faceseq){\n  string strname;\n  Mat faceOut;\n  bool ret;\n  if(faceIn.empty()){\n    printf(\"FaceIn is empty.\\n\");\n    return -1;\n  }\n\n  if(faceIn.cols > 100){\n    resize(faceIn, faceOut, Size(92, 112));\n    //Resize and Keep a match with the train database.\n    strname = format(\"%s/%d.jpg\", path, faceseq); //mkdir\n    ret = imwrite(strname, faceOut); //save image. Note the file suffix.\n    if(ret == false){\n      printf(\"Image write failed!\\n\");\n      printf(\"Please check filename[%s] is legal!\\n\", strname.c_str());\n      return -1;\n    }\n    imshow(strname, faceOut);\n  }\n  waitKey(20);\n  return 0;\n}\n\nint get_face(char* path){\n  CascadeClassifier face_cascade;\n  VideoCapture camera;\n  int ret;\n  Mat frame;  //camera frame\n  vector<Rect> objects; //The faces coordinates.\n  Mat img_gary; //Gradation pictures.\n  Mat faceImg;\n  int faceNum = 1; //\n  char key;\n  camera.open(0);\n  if(!camera.isOpened()){\n    cout << \"Open camera failed.\" << endl;\n    return -1;\n  }\n  cout << \"Open camera succeed. \" << endl;\n\n  //Load the face cascadeclassifier.\n  ret = face_cascade.load(\"haarcascade_frontalface_alt2.xml\");\n  if(!ret){\n    cout << \"Load xml failed.\" << endl;\n    return -1;\n  }\n  cout << \"Load xml succeed.\" << endl;\n  \n  while(1){\n    camera >> frame;\n    if(frame.empty()){\n      continue;\n    }\n    cvtColor(frame, img_gary, COLOR_BGR2GRAY); //Transform frame as the gradation picture, note imshow is still the original frame.\n    equalizeHist(img_gary, img_gary); //Histogram equalization, which is helpful to improve the quality of pictures.\n\n    //Face detection\n    face_cascade.detectMultiScale(img_gary, objects, 1.1,3 , 0, Size(50,50));\n    for(size_t i = 0; i < objects.size(); i++){\n      rectangle(frame, objects[i], CV_COLOR_GREEN);\n    }\n    imshow(\"Camera\", frame);\n    key = waitKey(1);\n    switch (key){\n      case 'p': //tap 'P' to save.\n        if(objects.size() == 1){\n          faceImg = frame(objects[0]);\n          ret = resize_save(faceImg, path, faceNum);\n          if(ret == 0){\n            cout << \"resize_save succeed.\\n\" << endl;\n            faceNum++;\n          }\n        }\n        break;\n      case 27:   //switch to ESC\n        cout << \"Esc ...\" << endl;\n        return 0;\n      default:\n        break;\n    }\n  }\n}\n\n\n\nint main(int argc, char* argv[]){\n  if(argc != 2)\n  \t{\n\t\tprintf(\"usage: %s <path>\\n\", argv[0]);\n\t\treturn -1;\n  \t}\n  get_face(argv[1]);\n  return 0;\n}\n```\n\n![](4.jpg)\nNote:    \n\n1. After the compilation is successful, the execution executable file must provide parameters, which are the directories for storing the face image, and it must be an existing directory.(E.g: ./program_name Img/s41)    \n2. Press the “P” button to take a photo and save the face. Press the “Esc” button to exit.\n\n\n### 1.2 Face Database Creation\nThe official document provides a download of the face database, and i use the [AT&T Facedatabase](http://www.cl.cam.ac.uk/research/dtg/attarchive/facedatabase.html) to create my face database. I have updated this zip file to my github, you can download it from [here](att_faces.zip) faster.\nAT&T Face Database is also known as the OCR face database, 40 people, 10 photos per person. The photos are token at different times, different lighting, different expressions(closed eyes, laughing or not laughing), different face details(with or without glasses). All images were captured on a dark , even background with a vertical face o the front(some with a slight rotation).    \nYou can download the compressed package from the website, and first extract the att_faces folder. There are 40 folders under the folder, which named from \"s1\" to \"s40\". Each folder has the same person's photos with different expressions, and there are 10 face photos.    \nThe format of these images is \".pgm\"\n![](1.png)\n![](2.png)\n\nNote:    \nIf you want to add your own photos to the face database through the program, the number of added pictures must be no less than 2.\n\n## 2. Face Recognition Model training\n\n### 2.1 Create a label file CSV\nWith the face database data, we need to read it in the program, here we need to use csv file to read the image data in the face database.    \nThe format of a csv file: image path name + label, such as /Img/s1/image.jpg;1    \nAssume the face image path is: /Img/s1/01..jpg    \nAnd we give this face image a label \"1\", this label represents the person's name. One person's face image label must be the same.    \nYou can create a csv file manually and then enter the data one by one. But if you use python, you don't have to do this tedious and boring work.    \nThe following is a piece of code which can write data in the CSV file automatically.\n\n```python\n#!/usr/bin/env python\n \nimport sys\nimport os.path\n \n# This is a tiny script to help you creating a CSV file from a face\n# database with a similar hierarchie:\n#\n#  \n#  \n#  |-- s1\n#  |   |-- 1.pgm\n#  |   |-- ...\n#  |   |-- 10.pgm\n#  |-- s2\n#  |   |-- 1.pgm\n#  |   |-- ...\n#  |   |-- 10.pgm\n#  ...\n#  |-- s40\n#  |   |-- 1.pgm\n#  |   |-- ...\n#  |   |-- 10.pgm\n#\n \nif __name__ == \"__main__\":\n \n    if len(sys.argv) != 2:\n        print \"usage: create_csv <base_path>\"\n        sys.exit(1)\n \n    BASE_PATH=sys.argv[1]        \n    SEPARATOR=\";\"\n    # This is output csv file.\n    fh = open(\"../at.csv\",'w')\n \n    for dirname, dirnames, filenames in os.walk(BASE_PATH):\n        for subdirname in dirnames:\n            subject_path = os.path.join(dirname, subdirname)\n            for filename in os.listdir(subject_path):\n                abs_path = \"%s/%s\" % (subject_path, filename)\n                print(\"%s%s%s\" % (abs_path, SEPARATOR, subdirname[1:]))\n                fh.write(abs_path)\n                fh.write(SEPARATOR)\n                fh.write(subdirname[1:])\n                fh.write(\"\\n\")\n    fh.close()\n```\n\nYou should set the image path parameter (absolute path) when running.(E.g: **python filename.py /home/kevin/OpenCV/face_rec/Img** ) and you can get a CSV file like this:\n![](5.png)\nThis CSV file is created.\n\n### 2.2 Model training\nThis is the official example of OpenCV: [Click here](https://docs.opencv.org/3.2.0/da/d60/tutorial_face_main.html)\nThey offer three models: Eigenfaces, Fisherfaces and Local Binary Patterns Histograms(LBPH)    \n\nThen I will train my own face database based on these models on the first step.\n\n```cpp\nstatic Mat norm_0_255(InputArray _src){\n  Mat src = _src.getMat();\n  Mat dst; //Create and return a normalized image matrix:\n  switch(src.channels()) {\n    case 1:\n        cv::normalize(_src, dst, 0, 255, NORM_MINMAX, CV_8UC1);\n        break;\n    case 3:\n        cv::normalize(_src, dst, 0, 255, NORM_MINMAX, CV_8UC3);\n        break;\n    default:\n        src.copyTo(dst);\n        break;\n  }\n  return dst;\n}\n//load CSV file\nstatic void read_csv(const string& filename, vector<Mat>& images, vector<int>& labels, char separator = ';'){\n  std::ifstream file(filename.c_str(), ifstream::in);\n    if (!file) {\n        string error_message = \"No valid input file was given, please check the given filename.\";\n        CV_Error(Error::StsBadArg, error_message);\n    }\n    string line, path, classlabel;\n    while (getline(file, line)) {\n        stringstream liness(line);\n        getline(liness, path, separator);\n        getline(liness, classlabel);\n        if(!path.empty() && !classlabel.empty()) {\n            images.push_back(imread(path, 0));\n            labels.push_back(atoi(classlabel.c_str()));\n        }\n    }\n}\n\nvoid train_model(const string& fn_csv){\n  // 2 containers to store image data and corresponding labels\n    vector<Mat> images;\n    vector<int> labels;\n    // load data\n    try\n    {\n        read_csv(fn_csv, images, labels);\n    }\n    catch (cv::Exception& e)\n    {\n        cerr << \"Error opening file \\\"\" << fn_csv << \"\\\". Reason: \" << e.msg << endl;\n        exit(1);\n    }\n    if (images.size() <= 1) {\n        string error_message = \"This demo needs at least 2 images to work. Please add more images to your data set!\";\n        CV_Error(CV_StsError, error_message);\n    }\n\n    Mat testSample = images[images.size() - 1];\n    int testLabel = labels[labels.size() - 1];\n    images.pop_back();\n    labels.pop_back();\n    // The following lines create a feature face model for face recognition.\n     // Train it with images and tags read from a CSV file.\n     // Here is a complete PCA transform\n     //If you only want to keep 10 principal components, use the following code\n     // cv::EigenFaceRecognizer::create(10);\n     // cv::FisherFaceRecognizer::create(10);\n     //\n     // If you also want to initialize with a confidence threshold, use the following statement:\n     // cv::EigenFaceRecognizer::create(10, 123.0);\n     //\n     // If you use all features and use a threshold, use the following statement:\n     // cv::EigenFaceRecognizer::create(0, 123.0);\n     // cv::FisherFaceRecognizer::create(0, 123.0);\n\n    Ptr<BasicFaceRecognizer> model0 = EigenFaceRecognizer::create();\n    model0->train(images, labels);\n    model0->write(\"MyFacePCAModel.xml\");\n\n    Ptr<BasicFaceRecognizer> model1 = FisherFaceRecognizer::create();\n    model1->train(images, labels);\n    model1->write(\"MyFaceFisherModel.xml\");\n\n     Ptr<LBPHFaceRecognizer> model2 = LBPHFaceRecognizer::create();\n    model2->train(images, labels);\n    model2->write(\"MyFaceLBPHModel.xml\");\n\n\n    // The test image is predicted below, predictedLabel is the predicted label result\n    int predictedLabel0 = model0->predict(testSample);\n    int predictedLabel1 = model1->predict(testSample);\n    int predictedLabel2 = model2->predict(testSample);\n\n    // There is also a way to get the result and get the threshold:\n    //      int predictedLabel = -1;\n    //      double confidence = 0.0;\n    //      model->predict(testSample, predictedLabel, confidence);\n\n    string result_message0 = format(\"Predicted class = %d / Actual class = %d.\", predictedLabel0, testLabel);\n    string result_message1 = format(\"Predicted class = %d / Actual class = %d.\", predictedLabel1, testLabel);\n    string result_message2 = format(\"Predicted class = %d / Actual class = %d.\", predictedLabel2, testLabel);\n    cout << result_message0 << endl;\n    cout << result_message1 << endl;\n    cout << result_message2 << endl;\n\n    waitKey(0);\n}\n\nint main(int argc, char* argv[]){\n  if(argc != 2)\n  \t{\n\t\tprintf(\"usage: %s <csv_file>\\n\", argv[0]);\n\t\treturn -1;\n  \t}\n  string fn_csv = string(argv[1]);\n  train_model(fn_csv);\n  return 0;\n}\n```\n\nAt this point, we have completed the training of the face model. And we get three files:     \n\n`MyFaceFisherModel.xml、MyFaceLBPHModel.xml、MyFacePCAModel.xml`\n\n![](6.png)\nNote:    \n\n1. Changes to the API of the OpenCV3.3 Face Recognition Module\n\n   a. Facerec.hpp before opencv3.3\n\n   ```cpp\n   #ifndef __OPENCV_FACEREC_HPP__\n   #define __OPENCV_FACEREC_HPP__\n   \n   #include \"opencv2/face.hpp\"\n   #include \"opencv2/core.hpp\"\n   \n   namespace cv { namespace face {\n   \n   // base for two classes\n   class CV_EXPORTS_W BasicFaceRecognizer : public FaceRecognizer\n   {\n   public:\n       /** @see setNumComponents */\n       CV_WRAP virtual int getNumComponents() const = 0;\n       // ----------- ...... -----------\n   \n       CV_WRAP virtual cv::Mat getEigenValues() const = 0;\n       CV_WRAP virtual cv::Mat getEigenVectors() const = 0;\n       CV_WRAP virtual cv::Mat getMean() const = 0;\n   };\n   \n   CV_EXPORTS_W Ptr<BasicFaceRecognizer> createEigenFaceRecognizer(int num_components = 0, double threshold = DBL_MAX);\n   \n   CV_EXPORTS_W Ptr<BasicFaceRecognizer> createFisherFaceRecognizer(int num_components = 0, double threshold = DBL_MAX);\n   \n   class CV_EXPORTS_W LBPHFaceRecognizer : public FaceRecognizer\n   {\n   public:\n       /** @see setGridX */\n       CV_WRAP virtual int getGridX() const = 0;\n       /** @copybrief getGridX @see getGridX */\n       CV_WRAP virtual void setGridX(int val) = 0;\n       // ----------- ...... -----------\n       CV_WRAP virtual cv::Mat getLabels() const = 0;\n   };\n   \n   CV_EXPORTS_W Ptr<LBPHFaceRecognizer> createLBPHFaceRecognizer(int radius=1, int neighbors=8, int grid_x=8, int grid_y=8, double threshold = DBL_MAX);\n   \n   }} //namespace cv::face\n   \n   #endif //__OPENCV_FACEREC_HPP__\n   ```\n\n   - Comment section of the ninth line: `// base for two classes`,  This shows that BasicFaceRecognizer is the base class of two classes: EigenFaceRecognizer and FisherFaceRecognizer. With LBPHFaceRecognizer is irrelevant. Even the new API is still the case.\n\n   - Method of creating three face recognizers.\n\n     ```cpp\n     Ptr<BasicFaceRecognizer> model =  createEigenFaceRecognizer();\n     Ptr<BasicFaceRecognizer> model =  createFisherFaceRecognizer();\n     Ptr<LBPHFaceRecognizer> model  =  createLBPHFaceRecognizer();\n     ```\n\n   b. Facerec.hpp after opencv3.3\n\t\n```cpp\n#ifndef __OPENCV_FACEREC_HPP__\n#define __OPENCV_FACEREC_HPP__\n\t\n#include \"opencv2/face.hpp\"\n#include \"opencv2/core.hpp\"\n\t\nnamespace cv { namespace face {\n\t\n// base for two classes\nclass CV_EXPORTS_W BasicFaceRecognizer : public FaceRecognizer\n{\npublic:\n\t/** @see setNumComponents */\n\tCV_WRAP int getNumComponents() const;\n\t// ----------- ...... -----------\n\tCV_WRAP cv::Mat getEigenValues() const;\n\tCV_WRAP cv::Mat getEigenVectors() const;\n\tCV_WRAP cv::Mat getMean() const;\n\t\n\tvirtual void read(const FileNode& fn);\n\tvirtual void write(FileStorage& fs) const;\n\tvirtual bool empty() const;\n\t\n\tusing FaceRecognizer::read;\n\tusing FaceRecognizer::write;\n\nprotected:\n\tint _num_components;\n\tdouble _threshold;\n\tstd::vector<Mat> _projections;\n\tMat _labels;\n\tMat _eigenvectors;\n\tMat _eigenvalues;\n\tMat _mean;\n};\nclass CV_EXPORTS_W EigenFaceRecognizer : public BasicFaceRecognizer\n{\npublic:\n\tCV_WRAP static Ptr<EigenFaceRecognizer> create(int num_components = 0, double threshold = DBL_MAX);\n};\n\nclass CV_EXPORTS_W FisherFaceRecognizer : public BasicFaceRecognizer\n{\npublic:\n\tCV_WRAP static Ptr<FisherFaceRecognizer> create(int num_components = 0, double threshold = DBL_MAX);\n};\nclass CV_EXPORTS_W LBPHFaceRecognizer : public FaceRecognizer\n{\npublic:\n\t/** @see setGridX */\n\tCV_WRAP virtual int getGridX() const = 0;\n\t// ----------- ...... -----------\n\tCV_WRAP virtual cv::Mat getLabels() const = 0;\n\tCV_WRAP static Ptr<LBPHFaceRecognizer> create(int radius=1, int neighbors=8, int grid_x=8, int grid_y=8, double threshold = DBL_MAX);\n};\n}} //namespace cv::face\n\t\n#endif //__OPENCV_FACEREC_HPP__\n```\n\n   - Both EigenFaceRecognizer and FisherFaceRecognizer are inherited from BasicFaceRecognizer. However, the LBFPHaceRecognizer, like the BasicFaceRecognizer, inherits from FaceRecognizer.\t\n   - Method of creating three face recognizer\n\n```cpp\nPtr<EigenFaceRecognizer> model  = EigenFaceRecognizer::create();\nPtr<FisherFaceRecognizer> model = FisherFaceRecognizer::create();\nPtr<LBPHFaceRecognizer> model   = LBPHFaceRecognizer::create();\n```\n\n## 3. Identify faces in the video stream (camera)\n\n### 3.1 Ready to work.\n#### 3.1.1 Copy the training file obtained in the second step to the current folder.\n#### 3.1.2 The process or method of Face Recognition \nThis step has a similar part to the creation of a face recognition database.\n   - Open the camera\n   - Loading face detector, face model\n   - Scale the image (for efficiency)\n   - Face recognition (compare to face model)\n   - Label faces with rectangular wireframes and add text labels\n\n#### 3.2 Code\n\n```cpp\n#include <opencv2/opencv.hpp>  \n#include \"opencv2/core.hpp\"\n#include \"opencv2/face.hpp\"\n#include \"opencv2/highgui.hpp\"\n#include \"opencv2/imgproc.hpp\"\n#include <iostream>\n#include <fstream>\n#include <sstream>\n \nusing namespace cv;\nusing namespace cv::face;\nusing namespace std;\n \n#define ROW_MIN\t\t45\n \nint exitFlag = 0;\n\nint Recognition_And_Draw();\n\nint Recognition_And_Draw(){\n  int ret = 0; //\n  double scale = 4; //Zoom factor\n  double fx = 1 / scale;\n  Mat frame;  //Video frame\n  VideoCapture cap(0);    //Open the camera\n  if(!cap.isOpened()){\n    cout << \"Open camera failed.\\n\" << endl;\n    return -1;\n  }\n\n  //Load cascade classifier\n  CascadeClassifier cascade;\n  ret = cascade.load(\"haarcascade_frontalface_alt2.xml\");\n\n  if(!ret){\n    printf(\"Load xml failed[ret = %d]. \\n\", ret);\n    return -1;\n  }\n  cout << \"Load xml succeed.\" << endl;\n\n  // Loading trained face models\n  Ptr<BasicFaceRecognizer> modelPCA = EigenFaceRecognizer::create();  \n  modelPCA->read(\"MyFacePCAModel.xml\");  \n  Ptr<BasicFaceRecognizer> modelFisher = FisherFaceRecognizer::create();\n  modelFisher->read(\"MyFaceFisherModel.xml\");  \n  Ptr<LBPHFaceRecognizer> modelLBPH = LBPHFaceRecognizer::create();  \n  modelLBPH->read(\"MyFaceLBPHModel.xml\");  \n\n  while(!exitFlag){\n    cap >> frame;\n    if(frame.empty())\n      continue;\n  \n    Mat facesImg;  //\n    vector<Rect> faces;  //Create a vector container for storing faces\n    Mat gary_img; //grayscale image\n    Mat scl_gary_img; //Scaled grayscale image\n  \n    cvtColor(frame, gary_img, COLOR_BGR2GRAY); //Convert the original image to a grayscale image\n    resize(gary_img, scl_gary_img, Size(), fx, fx, INTER_LINEAR); //resize img\n    equalizeHist( scl_gary_img, scl_gary_img );\n\n  //face detection\n    cascade.detectMultiScale(scl_gary_img, faces, 1.1, 2, 0|CASCADE_SCALE_IMAGE,Size(30, 30));\n    printf(\"Face.size = %ld\\n\", faces.size());\n  //facesImg = scl_gary_img(faces[0]);\n  \n    Mat face_resize;  //To prevent the picture is too small (that is, people too far away from the camera)\n    int predictPCA = 0;  \n    int predictFisher = 0;  \n    int predictLBPH = 0;\n    for(size_t i = 0; i < faces.size(); i++){\n      \n      Rect rectFace = faces[i];\n      facesImg = scl_gary_img(faces[i]);\n      if(facesImg.rows >= ROW_MIN){\n        resize(facesImg, face_resize, Size(92, 112));\n      }\n      else{\n        printf(\"faceImg.rows[%d] < %d \\n\", facesImg.rows, ROW_MIN);\n        continue;\n      }\n      if(!face_resize.empty()){\n        predictPCA = modelPCA->predict(face_resize);  \n        predictFisher = modelFisher->predict(face_resize);  \n        predictLBPH = modelLBPH->predict(face_resize); \n      }\n      cout << \"predictPCA   : \" << predictPCA    << endl;\n      cout << \"predictFisher: \" << predictFisher << endl;\n      cout << \"predictLBPH  : \" << predictLBPH   << endl;\n      rectangle(frame, Point(rectFace.x, rectFace.y) * scale, Point(rectFace.x + rectFace.width, rectFace.y + rectFace.height) * scale, Scalar(0, 255, 0), 2, 8);\n      if (predictPCA == 41){\n        putText(frame, \"Liuyang\", Point(faces[i].x, faces[i].y) * scale, FONT_HERSHEY_SIMPLEX, 1, Scalar(0, 0, 255), 2);\n      }\n      else{\n        putText(frame, \"X\", Point(faces[i].x, faces[i].y) * scale, FONT_HERSHEY_SIMPLEX, 1.5, Scalar(0, 0, 255), 2);\n      }\n      \n  // if(faces.size() <= 0){\n  //  cout << \"There are no faces in the camera.\\n\" << endl;\n // }\n    }\n    imshow(\"frame\", frame);\n      if (waitKey(1) == 27){\n\t\t\t    exitFlag = 1;\n\t\t\t    cout << \"Esc...\" << endl;\n\t\t\t    break;\n      }\n  }\n}\n\nint main(){\n  Recognition_And_Draw();\n  return 0;\n}\n```\n\n![](7.jpg)\n\nNote:    \n1. This program supports multiple face recognition at the same time\n2. Face recognition accuracy is not high, and it is susceptible to environmental factors such as light.\n","slug":"Face-Recognition-with-OpenCV","published":1,"updated":"2020-02-24T10:49:41.331Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0t2000q74jukkrx91ez","content":"<h1 id=\"Face-Recognition-with-OpenCV\"><a href=\"#Face-Recognition-with-OpenCV\" class=\"headerlink\" title=\"Face Recognition with OpenCV\"></a>Face Recognition with OpenCV</h1><h1 id=\"Preface\"><a href=\"#Preface\" class=\"headerlink\" title=\"Preface\"></a>Preface</h1><p>My Particular Environment:<br>Ubuntu16.04 + OpenCV3.3.0 + OpenCV_contrib3.3.0</p>\n<h2 id=\"1-Image-Acquisition-and-Face-Database-Creation\"><a href=\"#1-Image-Acquisition-and-Face-Database-Creation\" class=\"headerlink\" title=\"1. Image Acquisition and Face Database Creation\"></a>1. Image Acquisition and Face Database Creation</h2><h3 id=\"1-1-Image-Acquisition\"><a href=\"#1-1-Image-Acquisition\" class=\"headerlink\" title=\"1.1 Image Acquisition\"></a>1.1 Image Acquisition</h3><h4 id=\"1-1-1-Steps-and-methods\"><a href=\"#1-1-1-Steps-and-methods\" class=\"headerlink\" title=\"1.1.1 Steps and methods\"></a>1.1.1 Steps and methods</h4><ol>\n<li>Open the camera and capture images;</li>\n<li>Loading the face classifier;</li>\n<li>Start face detection, frame the face part and display;</li>\n<li>Under the condition that the face is detected, take a picture with one button;</li>\n<li>For the face part, resize and write the image file in the specified directory;</li>\n</ol>\n<h4 id=\"1-1-2-Code\"><a href=\"#1-1-2-Code\" class=\"headerlink\" title=\"1.1.2 Code\"></a>1.1.2 Code</h4><pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/highgui/highgui.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/imgproc/imgproc.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/core/core.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/objdetect/objdetect.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/face.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;fstream></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sstream></span> </span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> cv<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> std<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> cv<span class=\"token operator\">::</span>face<span class=\"token punctuation\">;</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> CV_COLOR_GREEN cv::Scalar(0, 255, 0)</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">resize_save</span><span class=\"token punctuation\">(</span>Mat<span class=\"token operator\">&amp;</span> faceIn<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> path<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span>  faceseq<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\" spellcheck=\"true\">//Input: current image, the path of file, the name or faceseq of images.</span>\n<span class=\"token comment\" spellcheck=\"true\">//Output: None</span>\n<span class=\"token comment\" spellcheck=\"true\">//Function: resize the current image to (92, 112), which is same to the train data.</span>\n<span class=\"token keyword\">int</span> <span class=\"token function\">get_face</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span> path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\" spellcheck=\"true\">//Input: the path of file.</span>\n<span class=\"token comment\" spellcheck=\"true\">//Output: None</span>\n<span class=\"token comment\" spellcheck=\"true\">//Function: Use face_cascade to detect if there are faces in the window, and save the faces through function reszie_save.</span>\n\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">resize_save</span><span class=\"token punctuation\">(</span>Mat<span class=\"token operator\">&amp;</span> faceIn<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> path<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span>  faceseq<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  string strname<span class=\"token punctuation\">;</span>\n  Mat faceOut<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">bool</span> ret<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>faceIn<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FaceIn is empty.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>faceIn<span class=\"token punctuation\">.</span>cols <span class=\"token operator\">></span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token function\">resize</span><span class=\"token punctuation\">(</span>faceIn<span class=\"token punctuation\">,</span> faceOut<span class=\"token punctuation\">,</span> <span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">92</span><span class=\"token punctuation\">,</span> <span class=\"token number\">112</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">//Resize and Keep a match with the train database.</span>\n    strname <span class=\"token operator\">=</span> <span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s/%d.jpg\"</span><span class=\"token punctuation\">,</span> path<span class=\"token punctuation\">,</span> faceseq<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//mkdir</span>\n    ret <span class=\"token operator\">=</span> <span class=\"token function\">imwrite</span><span class=\"token punctuation\">(</span>strname<span class=\"token punctuation\">,</span> faceOut<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//save image. Note the file suffix.</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>ret <span class=\"token operator\">==</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Image write failed!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Please check filename[%s] is legal!\\n\"</span><span class=\"token punctuation\">,</span> strname<span class=\"token punctuation\">.</span><span class=\"token function\">c_str</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>strname<span class=\"token punctuation\">,</span> faceOut<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">waitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">get_face</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span> path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  CascadeClassifier face_cascade<span class=\"token punctuation\">;</span>\n  VideoCapture camera<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">int</span> ret<span class=\"token punctuation\">;</span>\n  Mat frame<span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">//camera frame</span>\n  vector<span class=\"token operator\">&lt;</span>Rect<span class=\"token operator\">></span> objects<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//The faces coordinates.</span>\n  Mat img_gary<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//Gradation pictures.</span>\n  Mat faceImg<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">int</span> faceNum <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//</span>\n  <span class=\"token keyword\">char</span> key<span class=\"token punctuation\">;</span>\n  camera<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>camera<span class=\"token punctuation\">.</span><span class=\"token function\">isOpened</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"Open camera failed.\"</span> <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"Open camera succeed. \"</span> <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">//Load the face cascadeclassifier.</span>\n  ret <span class=\"token operator\">=</span> face_cascade<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"haarcascade_frontalface_alt2.xml\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>ret<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"Load xml failed.\"</span> <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"Load xml succeed.\"</span> <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    camera <span class=\"token operator\">>></span> frame<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">cvtColor</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">,</span> img_gary<span class=\"token punctuation\">,</span> COLOR_BGR2GRAY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//Transform frame as the gradation picture, note imshow is still the original frame.</span>\n    <span class=\"token function\">equalizeHist</span><span class=\"token punctuation\">(</span>img_gary<span class=\"token punctuation\">,</span> img_gary<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//Histogram equalization, which is helpful to improve the quality of pictures.</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//Face detection</span>\n    face_cascade<span class=\"token punctuation\">.</span><span class=\"token function\">detectMultiScale</span><span class=\"token punctuation\">(</span>img_gary<span class=\"token punctuation\">,</span> objects<span class=\"token punctuation\">,</span> <span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span> <span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>size_t i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> objects<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      <span class=\"token function\">rectangle</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">,</span> objects<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> CV_COLOR_GREEN<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Camera\"</span><span class=\"token punctuation\">,</span> frame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    key <span class=\"token operator\">=</span> <span class=\"token function\">waitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">case</span> <span class=\"token string\">'p'</span><span class=\"token operator\">:</span> <span class=\"token comment\" spellcheck=\"true\">//tap 'P' to save.</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>objects<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n          faceImg <span class=\"token operator\">=</span> <span class=\"token function\">frame</span><span class=\"token punctuation\">(</span>objects<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          ret <span class=\"token operator\">=</span> <span class=\"token function\">resize_save</span><span class=\"token punctuation\">(</span>faceImg<span class=\"token punctuation\">,</span> path<span class=\"token punctuation\">,</span> faceNum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>ret <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"resize_save succeed.\\n\"</span> <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n            faceNum<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">case</span> <span class=\"token number\">27</span><span class=\"token operator\">:</span>   <span class=\"token comment\" spellcheck=\"true\">//switch to ESC</span>\n        cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"Esc ...\"</span> <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">!=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"usage: %s &lt;path>\\n\"</span><span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">get_face</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p><img src=\"4.jpg\" alt><br>Note:    </p>\n<ol>\n<li>After the compilation is successful, the execution executable file must provide parameters, which are the directories for storing the face image, and it must be an existing directory.(E.g: ./program_name Img/s41)    </li>\n<li>Press the “P” button to take a photo and save the face. Press the “Esc” button to exit.</li>\n</ol>\n<h3 id=\"1-2-Face-Database-Creation\"><a href=\"#1-2-Face-Database-Creation\" class=\"headerlink\" title=\"1.2 Face Database Creation\"></a>1.2 Face Database Creation</h3><p>The official document provides a download of the face database, and i use the <a href=\"http://www.cl.cam.ac.uk/research/dtg/attarchive/facedatabase.html\" target=\"_blank\" rel=\"noopener\">AT&amp;T Facedatabase</a> to create my face database. I have updated this zip file to my github, you can download it from <a href=\"att_faces.zip\">here</a> faster.<br>AT&amp;T Face Database is also known as the OCR face database, 40 people, 10 photos per person. The photos are token at different times, different lighting, different expressions(closed eyes, laughing or not laughing), different face details(with or without glasses). All images were captured on a dark , even background with a vertical face o the front(some with a slight rotation).<br>You can download the compressed package from the website, and first extract the att_faces folder. There are 40 folders under the folder, which named from “s1” to “s40”. Each folder has the same person’s photos with different expressions, and there are 10 face photos.<br>The format of these images is “.pgm”<br><img src=\"1.png\" alt><br><img src=\"2.png\" alt></p>\n<p>Note:<br>If you want to add your own photos to the face database through the program, the number of added pictures must be no less than 2.</p>\n<h2 id=\"2-Face-Recognition-Model-training\"><a href=\"#2-Face-Recognition-Model-training\" class=\"headerlink\" title=\"2. Face Recognition Model training\"></a>2. Face Recognition Model training</h2><h3 id=\"2-1-Create-a-label-file-CSV\"><a href=\"#2-1-Create-a-label-file-CSV\" class=\"headerlink\" title=\"2.1 Create a label file CSV\"></a>2.1 Create a label file CSV</h3><p>With the face database data, we need to read it in the program, here we need to use csv file to read the image data in the face database.<br>The format of a csv file: image path name + label, such as /Img/s1/image.jpg;1<br>Assume the face image path is: /Img/s1/01..jpg<br>And we give this face image a label “1”, this label represents the person’s name. One person’s face image label must be the same.<br>You can create a csv file manually and then enter the data one by one. But if you use python, you don’t have to do this tedious and boring work.<br>The following is a piece of code which can write data in the CSV file automatically.</p>\n<pre class=\" language-python\"><code class=\"language-python\"><span class=\"token comment\" spellcheck=\"true\">#!/usr/bin/env python</span>\n\n<span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">import</span> os<span class=\"token punctuation\">.</span>path\n\n<span class=\"token comment\" spellcheck=\"true\"># This is a tiny script to help you creating a CSV file from a face</span>\n<span class=\"token comment\" spellcheck=\"true\"># database with a similar hierarchie:</span>\n<span class=\"token comment\" spellcheck=\"true\">#</span>\n<span class=\"token comment\" spellcheck=\"true\">#  </span>\n<span class=\"token comment\" spellcheck=\"true\">#  </span>\n<span class=\"token comment\" spellcheck=\"true\">#  |-- s1</span>\n<span class=\"token comment\" spellcheck=\"true\">#  |   |-- 1.pgm</span>\n<span class=\"token comment\" spellcheck=\"true\">#  |   |-- ...</span>\n<span class=\"token comment\" spellcheck=\"true\">#  |   |-- 10.pgm</span>\n<span class=\"token comment\" spellcheck=\"true\">#  |-- s2</span>\n<span class=\"token comment\" spellcheck=\"true\">#  |   |-- 1.pgm</span>\n<span class=\"token comment\" spellcheck=\"true\">#  |   |-- ...</span>\n<span class=\"token comment\" spellcheck=\"true\">#  |   |-- 10.pgm</span>\n<span class=\"token comment\" spellcheck=\"true\">#  ...</span>\n<span class=\"token comment\" spellcheck=\"true\">#  |-- s40</span>\n<span class=\"token comment\" spellcheck=\"true\">#  |   |-- 1.pgm</span>\n<span class=\"token comment\" spellcheck=\"true\">#  |   |-- ...</span>\n<span class=\"token comment\" spellcheck=\"true\">#  |   |-- 10.pgm</span>\n<span class=\"token comment\" spellcheck=\"true\">#</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token keyword\">if</span> len<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span> <span class=\"token string\">\"usage: create_csv &lt;base_path>\"</span>\n        sys<span class=\"token punctuation\">.</span>exit<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n    BASE_PATH<span class=\"token operator\">=</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>        \n    SEPARATOR<span class=\"token operator\">=</span><span class=\"token string\">\";\"</span>\n    <span class=\"token comment\" spellcheck=\"true\"># This is output csv file.</span>\n    fh <span class=\"token operator\">=</span> open<span class=\"token punctuation\">(</span><span class=\"token string\">\"../at.csv\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">for</span> dirname<span class=\"token punctuation\">,</span> dirnames<span class=\"token punctuation\">,</span> filenames <span class=\"token keyword\">in</span> os<span class=\"token punctuation\">.</span>walk<span class=\"token punctuation\">(</span>BASE_PATH<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> subdirname <span class=\"token keyword\">in</span> dirnames<span class=\"token punctuation\">:</span>\n            subject_path <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>dirname<span class=\"token punctuation\">,</span> subdirname<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">for</span> filename <span class=\"token keyword\">in</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>subject_path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                abs_path <span class=\"token operator\">=</span> <span class=\"token string\">\"%s/%s\"</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>subject_path<span class=\"token punctuation\">,</span> filename<span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s%s%s\"</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>abs_path<span class=\"token punctuation\">,</span> SEPARATOR<span class=\"token punctuation\">,</span> subdirname<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                fh<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>abs_path<span class=\"token punctuation\">)</span>\n                fh<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>SEPARATOR<span class=\"token punctuation\">)</span>\n                fh<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>subdirname<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n                fh<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">)</span>\n    fh<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre>\n<p>You should set the image path parameter (absolute path) when running.(E.g: <strong>python filename.py /home/kevin/OpenCV/face_rec/Img</strong> ) and you can get a CSV file like this:<br><img src=\"5.png\" alt><br>This CSV file is created.</p>\n<h3 id=\"2-2-Model-training\"><a href=\"#2-2-Model-training\" class=\"headerlink\" title=\"2.2 Model training\"></a>2.2 Model training</h3><p>This is the official example of OpenCV: <a href=\"https://docs.opencv.org/3.2.0/da/d60/tutorial_face_main.html\" target=\"_blank\" rel=\"noopener\">Click here</a><br>They offer three models: Eigenfaces, Fisherfaces and Local Binary Patterns Histograms(LBPH)    </p>\n<p>Then I will train my own face database based on these models on the first step.</p>\n<pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">static</span> Mat <span class=\"token function\">norm_0_255</span><span class=\"token punctuation\">(</span>InputArray _src<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  Mat src <span class=\"token operator\">=</span> _src<span class=\"token punctuation\">.</span><span class=\"token function\">getMat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Mat dst<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//Create and return a normalized image matrix:</span>\n  <span class=\"token keyword\">switch</span><span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">.</span><span class=\"token function\">channels</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span>\n        cv<span class=\"token operator\">::</span><span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span>_src<span class=\"token punctuation\">,</span> dst<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> NORM_MINMAX<span class=\"token punctuation\">,</span> CV_8UC1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span>\n        cv<span class=\"token operator\">::</span><span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span>_src<span class=\"token punctuation\">,</span> dst<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> NORM_MINMAX<span class=\"token punctuation\">,</span> CV_8UC3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n        src<span class=\"token punctuation\">.</span><span class=\"token function\">copyTo</span><span class=\"token punctuation\">(</span>dst<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> dst<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\" spellcheck=\"true\">//load CSV file</span>\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">read_csv</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> string<span class=\"token operator\">&amp;</span> filename<span class=\"token punctuation\">,</span> vector<span class=\"token operator\">&lt;</span>Mat<span class=\"token operator\">></span><span class=\"token operator\">&amp;</span> images<span class=\"token punctuation\">,</span> vector<span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token operator\">&amp;</span> labels<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> separator <span class=\"token operator\">=</span> <span class=\"token string\">';'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  std<span class=\"token operator\">::</span>ifstream <span class=\"token function\">file</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">.</span><span class=\"token function\">c_str</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ifstream<span class=\"token operator\">::</span>in<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        string error_message <span class=\"token operator\">=</span> <span class=\"token string\">\"No valid input file was given, please check the given filename.\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">CV_Error</span><span class=\"token punctuation\">(</span>Error<span class=\"token operator\">::</span>StsBadArg<span class=\"token punctuation\">,</span> error_message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    string line<span class=\"token punctuation\">,</span> path<span class=\"token punctuation\">,</span> classlabel<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token function\">getline</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">,</span> line<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        stringstream <span class=\"token function\">liness</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">getline</span><span class=\"token punctuation\">(</span>liness<span class=\"token punctuation\">,</span> path<span class=\"token punctuation\">,</span> separator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">getline</span><span class=\"token punctuation\">(</span>liness<span class=\"token punctuation\">,</span> classlabel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>classlabel<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            images<span class=\"token punctuation\">.</span><span class=\"token function\">push_back</span><span class=\"token punctuation\">(</span><span class=\"token function\">imread</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            labels<span class=\"token punctuation\">.</span><span class=\"token function\">push_back</span><span class=\"token punctuation\">(</span><span class=\"token function\">atoi</span><span class=\"token punctuation\">(</span>classlabel<span class=\"token punctuation\">.</span><span class=\"token function\">c_str</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">train_model</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> string<span class=\"token operator\">&amp;</span> fn_csv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\" spellcheck=\"true\">// 2 containers to store image data and corresponding labels</span>\n    vector<span class=\"token operator\">&lt;</span>Mat<span class=\"token operator\">></span> images<span class=\"token punctuation\">;</span>\n    vector<span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span> labels<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">// load data</span>\n    <span class=\"token keyword\">try</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">read_csv</span><span class=\"token punctuation\">(</span>fn_csv<span class=\"token punctuation\">,</span> images<span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>cv<span class=\"token operator\">::</span>Exception<span class=\"token operator\">&amp;</span> e<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        cerr <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"Error opening file \\\"\"</span> <span class=\"token operator\">&lt;&lt;</span> fn_csv <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"\\\". Reason: \"</span> <span class=\"token operator\">&lt;&lt;</span> e<span class=\"token punctuation\">.</span>msg <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n        <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>images<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        string error_message <span class=\"token operator\">=</span> <span class=\"token string\">\"This demo needs at least 2 images to work. Please add more images to your data set!\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">CV_Error</span><span class=\"token punctuation\">(</span>CV_StsError<span class=\"token punctuation\">,</span> error_message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    Mat testSample <span class=\"token operator\">=</span> images<span class=\"token punctuation\">[</span>images<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> testLabel <span class=\"token operator\">=</span> labels<span class=\"token punctuation\">[</span>labels<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    images<span class=\"token punctuation\">.</span><span class=\"token function\">pop_back</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    labels<span class=\"token punctuation\">.</span><span class=\"token function\">pop_back</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">// The following lines create a feature face model for face recognition.</span>\n     <span class=\"token comment\" spellcheck=\"true\">// Train it with images and tags read from a CSV file.</span>\n     <span class=\"token comment\" spellcheck=\"true\">// Here is a complete PCA transform</span>\n     <span class=\"token comment\" spellcheck=\"true\">//If you only want to keep 10 principal components, use the following code</span>\n     <span class=\"token comment\" spellcheck=\"true\">// cv::EigenFaceRecognizer::create(10);</span>\n     <span class=\"token comment\" spellcheck=\"true\">// cv::FisherFaceRecognizer::create(10);</span>\n     <span class=\"token comment\" spellcheck=\"true\">//</span>\n     <span class=\"token comment\" spellcheck=\"true\">// If you also want to initialize with a confidence threshold, use the following statement:</span>\n     <span class=\"token comment\" spellcheck=\"true\">// cv::EigenFaceRecognizer::create(10, 123.0);</span>\n     <span class=\"token comment\" spellcheck=\"true\">//</span>\n     <span class=\"token comment\" spellcheck=\"true\">// If you use all features and use a threshold, use the following statement:</span>\n     <span class=\"token comment\" spellcheck=\"true\">// cv::EigenFaceRecognizer::create(0, 123.0);</span>\n     <span class=\"token comment\" spellcheck=\"true\">// cv::FisherFaceRecognizer::create(0, 123.0);</span>\n\n    Ptr<span class=\"token operator\">&lt;</span>BasicFaceRecognizer<span class=\"token operator\">></span> model0 <span class=\"token operator\">=</span> EigenFaceRecognizer<span class=\"token operator\">::</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    model0<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">train</span><span class=\"token punctuation\">(</span>images<span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    model0<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyFacePCAModel.xml\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    Ptr<span class=\"token operator\">&lt;</span>BasicFaceRecognizer<span class=\"token operator\">></span> model1 <span class=\"token operator\">=</span> FisherFaceRecognizer<span class=\"token operator\">::</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    model1<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">train</span><span class=\"token punctuation\">(</span>images<span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    model1<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyFaceFisherModel.xml\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n     Ptr<span class=\"token operator\">&lt;</span>LBPHFaceRecognizer<span class=\"token operator\">></span> model2 <span class=\"token operator\">=</span> LBPHFaceRecognizer<span class=\"token operator\">::</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    model2<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">train</span><span class=\"token punctuation\">(</span>images<span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    model2<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyFaceLBPHModel.xml\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n    <span class=\"token comment\" spellcheck=\"true\">// The test image is predicted below, predictedLabel is the predicted label result</span>\n    <span class=\"token keyword\">int</span> predictedLabel0 <span class=\"token operator\">=</span> model0<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">predict</span><span class=\"token punctuation\">(</span>testSample<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> predictedLabel1 <span class=\"token operator\">=</span> model1<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">predict</span><span class=\"token punctuation\">(</span>testSample<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> predictedLabel2 <span class=\"token operator\">=</span> model2<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">predict</span><span class=\"token punctuation\">(</span>testSample<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// There is also a way to get the result and get the threshold:</span>\n    <span class=\"token comment\" spellcheck=\"true\">//      int predictedLabel = -1;</span>\n    <span class=\"token comment\" spellcheck=\"true\">//      double confidence = 0.0;</span>\n    <span class=\"token comment\" spellcheck=\"true\">//      model->predict(testSample, predictedLabel, confidence);</span>\n\n    string result_message0 <span class=\"token operator\">=</span> <span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Predicted class = %d / Actual class = %d.\"</span><span class=\"token punctuation\">,</span> predictedLabel0<span class=\"token punctuation\">,</span> testLabel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    string result_message1 <span class=\"token operator\">=</span> <span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Predicted class = %d / Actual class = %d.\"</span><span class=\"token punctuation\">,</span> predictedLabel1<span class=\"token punctuation\">,</span> testLabel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    string result_message2 <span class=\"token operator\">=</span> <span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Predicted class = %d / Actual class = %d.\"</span><span class=\"token punctuation\">,</span> predictedLabel2<span class=\"token punctuation\">,</span> testLabel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    cout <span class=\"token operator\">&lt;&lt;</span> result_message0 <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n    cout <span class=\"token operator\">&lt;&lt;</span> result_message1 <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n    cout <span class=\"token operator\">&lt;&lt;</span> result_message2 <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">waitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">!=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"usage: %s &lt;csv_file>\\n\"</span><span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n  string fn_csv <span class=\"token operator\">=</span> <span class=\"token function\">string</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">train_model</span><span class=\"token punctuation\">(</span>fn_csv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>At this point, we have completed the training of the face model. And we get three files:     </p>\n<p><code>MyFaceFisherModel.xml、MyFaceLBPHModel.xml、MyFacePCAModel.xml</code></p>\n<p><img src=\"6.png\" alt><br>Note:    </p>\n<ol>\n<li><p>Changes to the API of the OpenCV3.3 Face Recognition Module</p>\n<p>a. Facerec.hpp before opencv3.3</p>\n<pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\">#<span class=\"token directive keyword\">ifndef</span> __OPENCV_FACEREC_HPP__</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> __OPENCV_FACEREC_HPP__</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"opencv2/face.hpp\"</span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"opencv2/core.hpp\"</span></span>\n\n<span class=\"token keyword\">namespace</span> cv <span class=\"token punctuation\">{</span> <span class=\"token keyword\">namespace</span> face <span class=\"token punctuation\">{</span>\n\n<span class=\"token comment\" spellcheck=\"true\">// base for two classes</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">CV_EXPORTS_W</span> BasicFaceRecognizer <span class=\"token operator\">:</span> <span class=\"token keyword\">public</span> FaceRecognizer\n<span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n    <span class=\"token comment\" spellcheck=\"true\">/** @see setNumComponents */</span>\n    CV_WRAP <span class=\"token keyword\">virtual</span> <span class=\"token keyword\">int</span> <span class=\"token function\">getNumComponents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">// ----------- ...... -----------</span>\n\n    CV_WRAP <span class=\"token keyword\">virtual</span> cv<span class=\"token operator\">::</span>Mat <span class=\"token function\">getEigenValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    CV_WRAP <span class=\"token keyword\">virtual</span> cv<span class=\"token operator\">::</span>Mat <span class=\"token function\">getEigenVectors</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    CV_WRAP <span class=\"token keyword\">virtual</span> cv<span class=\"token operator\">::</span>Mat <span class=\"token function\">getMean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nCV_EXPORTS_W Ptr<span class=\"token operator\">&lt;</span>BasicFaceRecognizer<span class=\"token operator\">></span> <span class=\"token function\">createEigenFaceRecognizer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> num_components <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">double</span> threshold <span class=\"token operator\">=</span> DBL_MAX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nCV_EXPORTS_W Ptr<span class=\"token operator\">&lt;</span>BasicFaceRecognizer<span class=\"token operator\">></span> <span class=\"token function\">createFisherFaceRecognizer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> num_components <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">double</span> threshold <span class=\"token operator\">=</span> DBL_MAX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">CV_EXPORTS_W</span> LBPHFaceRecognizer <span class=\"token operator\">:</span> <span class=\"token keyword\">public</span> FaceRecognizer\n<span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n    <span class=\"token comment\" spellcheck=\"true\">/** @see setGridX */</span>\n    CV_WRAP <span class=\"token keyword\">virtual</span> <span class=\"token keyword\">int</span> <span class=\"token function\">getGridX</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">/** @copybrief getGridX @see getGridX */</span>\n    CV_WRAP <span class=\"token keyword\">virtual</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setGridX</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> val<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">// ----------- ...... -----------</span>\n    CV_WRAP <span class=\"token keyword\">virtual</span> cv<span class=\"token operator\">::</span>Mat <span class=\"token function\">getLabels</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nCV_EXPORTS_W Ptr<span class=\"token operator\">&lt;</span>LBPHFaceRecognizer<span class=\"token operator\">></span> <span class=\"token function\">createLBPHFaceRecognizer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> radius<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> neighbors<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> grid_x<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> grid_y<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">double</span> threshold <span class=\"token operator\">=</span> DBL_MAX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token comment\" spellcheck=\"true\">//namespace cv::face</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">endif</span> </span><span class=\"token comment\" spellcheck=\"true\">//__OPENCV_FACEREC_HPP__</span></code></pre>\n<ul>\n<li><p>Comment section of the ninth line: <code>// base for two classes</code>,  This shows that BasicFaceRecognizer is the base class of two classes: EigenFaceRecognizer and FisherFaceRecognizer. With LBPHFaceRecognizer is irrelevant. Even the new API is still the case.</p>\n</li>\n<li><p>Method of creating three face recognizers.</p>\n<pre class=\" language-cpp\"><code class=\"language-cpp\">Ptr<span class=\"token operator\">&lt;</span>BasicFaceRecognizer<span class=\"token operator\">></span> model <span class=\"token operator\">=</span>  <span class=\"token function\">createEigenFaceRecognizer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nPtr<span class=\"token operator\">&lt;</span>BasicFaceRecognizer<span class=\"token operator\">></span> model <span class=\"token operator\">=</span>  <span class=\"token function\">createFisherFaceRecognizer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nPtr<span class=\"token operator\">&lt;</span>LBPHFaceRecognizer<span class=\"token operator\">></span> model  <span class=\"token operator\">=</span>  <span class=\"token function\">createLBPHFaceRecognizer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</li>\n</ul>\n<p>b. Facerec.hpp after opencv3.3</p>\n</li>\n</ol>\n<pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\">#<span class=\"token directive keyword\">ifndef</span> __OPENCV_FACEREC_HPP__</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> __OPENCV_FACEREC_HPP__</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"opencv2/face.hpp\"</span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"opencv2/core.hpp\"</span></span>\n\n<span class=\"token keyword\">namespace</span> cv <span class=\"token punctuation\">{</span> <span class=\"token keyword\">namespace</span> face <span class=\"token punctuation\">{</span>\n\n<span class=\"token comment\" spellcheck=\"true\">// base for two classes</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">CV_EXPORTS_W</span> BasicFaceRecognizer <span class=\"token operator\">:</span> <span class=\"token keyword\">public</span> FaceRecognizer\n<span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n    <span class=\"token comment\" spellcheck=\"true\">/** @see setNumComponents */</span>\n    CV_WRAP <span class=\"token keyword\">int</span> <span class=\"token function\">getNumComponents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">// ----------- ...... -----------</span>\n    CV_WRAP cv<span class=\"token operator\">::</span>Mat <span class=\"token function\">getEigenValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n    CV_WRAP cv<span class=\"token operator\">::</span>Mat <span class=\"token function\">getEigenVectors</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n    CV_WRAP cv<span class=\"token operator\">::</span>Mat <span class=\"token function\">getMean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">virtual</span> <span class=\"token keyword\">void</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> FileNode<span class=\"token operator\">&amp;</span> fn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">virtual</span> <span class=\"token keyword\">void</span> <span class=\"token function\">write</span><span class=\"token punctuation\">(</span>FileStorage<span class=\"token operator\">&amp;</span> fs<span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">virtual</span> <span class=\"token keyword\">bool</span> <span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">using</span> FaceRecognizer<span class=\"token operator\">::</span>read<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">using</span> FaceRecognizer<span class=\"token operator\">::</span>write<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">protected</span><span class=\"token operator\">:</span>\n    <span class=\"token keyword\">int</span> _num_components<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">double</span> _threshold<span class=\"token punctuation\">;</span>\n    std<span class=\"token operator\">::</span>vector<span class=\"token operator\">&lt;</span>Mat<span class=\"token operator\">></span> _projections<span class=\"token punctuation\">;</span>\n    Mat _labels<span class=\"token punctuation\">;</span>\n    Mat _eigenvectors<span class=\"token punctuation\">;</span>\n    Mat _eigenvalues<span class=\"token punctuation\">;</span>\n    Mat _mean<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">CV_EXPORTS_W</span> EigenFaceRecognizer <span class=\"token operator\">:</span> <span class=\"token keyword\">public</span> BasicFaceRecognizer\n<span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n    CV_WRAP <span class=\"token keyword\">static</span> Ptr<span class=\"token operator\">&lt;</span>EigenFaceRecognizer<span class=\"token operator\">></span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> num_components <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">double</span> threshold <span class=\"token operator\">=</span> DBL_MAX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">CV_EXPORTS_W</span> FisherFaceRecognizer <span class=\"token operator\">:</span> <span class=\"token keyword\">public</span> BasicFaceRecognizer\n<span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n    CV_WRAP <span class=\"token keyword\">static</span> Ptr<span class=\"token operator\">&lt;</span>FisherFaceRecognizer<span class=\"token operator\">></span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> num_components <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">double</span> threshold <span class=\"token operator\">=</span> DBL_MAX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">CV_EXPORTS_W</span> LBPHFaceRecognizer <span class=\"token operator\">:</span> <span class=\"token keyword\">public</span> FaceRecognizer\n<span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n    <span class=\"token comment\" spellcheck=\"true\">/** @see setGridX */</span>\n    CV_WRAP <span class=\"token keyword\">virtual</span> <span class=\"token keyword\">int</span> <span class=\"token function\">getGridX</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">// ----------- ...... -----------</span>\n    CV_WRAP <span class=\"token keyword\">virtual</span> cv<span class=\"token operator\">::</span>Mat <span class=\"token function\">getLabels</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    CV_WRAP <span class=\"token keyword\">static</span> Ptr<span class=\"token operator\">&lt;</span>LBPHFaceRecognizer<span class=\"token operator\">></span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> radius<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> neighbors<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> grid_x<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> grid_y<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">double</span> threshold <span class=\"token operator\">=</span> DBL_MAX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token comment\" spellcheck=\"true\">//namespace cv::face</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">endif</span> </span><span class=\"token comment\" spellcheck=\"true\">//__OPENCV_FACEREC_HPP__</span></code></pre>\n<ul>\n<li>Both EigenFaceRecognizer and FisherFaceRecognizer are inherited from BasicFaceRecognizer. However, the LBFPHaceRecognizer, like the BasicFaceRecognizer, inherits from FaceRecognizer.    </li>\n<li>Method of creating three face recognizer</li>\n</ul>\n<pre class=\" language-cpp\"><code class=\"language-cpp\">Ptr<span class=\"token operator\">&lt;</span>EigenFaceRecognizer<span class=\"token operator\">></span> model  <span class=\"token operator\">=</span> EigenFaceRecognizer<span class=\"token operator\">::</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nPtr<span class=\"token operator\">&lt;</span>FisherFaceRecognizer<span class=\"token operator\">></span> model <span class=\"token operator\">=</span> FisherFaceRecognizer<span class=\"token operator\">::</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nPtr<span class=\"token operator\">&lt;</span>LBPHFaceRecognizer<span class=\"token operator\">></span> model   <span class=\"token operator\">=</span> LBPHFaceRecognizer<span class=\"token operator\">::</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<h2 id=\"3-Identify-faces-in-the-video-stream-camera\"><a href=\"#3-Identify-faces-in-the-video-stream-camera\" class=\"headerlink\" title=\"3. Identify faces in the video stream (camera)\"></a>3. Identify faces in the video stream (camera)</h2><h3 id=\"3-1-Ready-to-work\"><a href=\"#3-1-Ready-to-work\" class=\"headerlink\" title=\"3.1 Ready to work.\"></a>3.1 Ready to work.</h3><h4 id=\"3-1-1-Copy-the-training-file-obtained-in-the-second-step-to-the-current-folder\"><a href=\"#3-1-1-Copy-the-training-file-obtained-in-the-second-step-to-the-current-folder\" class=\"headerlink\" title=\"3.1.1 Copy the training file obtained in the second step to the current folder.\"></a>3.1.1 Copy the training file obtained in the second step to the current folder.</h4><h4 id=\"3-1-2-The-process-or-method-of-Face-Recognition\"><a href=\"#3-1-2-The-process-or-method-of-Face-Recognition\" class=\"headerlink\" title=\"3.1.2 The process or method of Face Recognition\"></a>3.1.2 The process or method of Face Recognition</h4><p>This step has a similar part to the creation of a face recognition database.</p>\n<ul>\n<li>Open the camera</li>\n<li>Loading face detector, face model</li>\n<li>Scale the image (for efficiency)</li>\n<li>Face recognition (compare to face model)</li>\n<li>Label faces with rectangular wireframes and add text labels</li>\n</ul>\n<h4 id=\"3-2-Code\"><a href=\"#3-2-Code\" class=\"headerlink\" title=\"3.2 Code\"></a>3.2 Code</h4><pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/opencv.hpp></span>  </span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"opencv2/core.hpp\"</span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"opencv2/face.hpp\"</span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"opencv2/highgui.hpp\"</span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"opencv2/imgproc.hpp\"</span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;fstream></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sstream></span></span>\n\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> cv<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> cv<span class=\"token operator\">::</span>face<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> std<span class=\"token punctuation\">;</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> ROW_MIN        45</span>\n\n<span class=\"token keyword\">int</span> exitFlag <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">Recognition_And_Draw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">Recognition_And_Draw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">int</span> ret <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//</span>\n  <span class=\"token keyword\">double</span> scale <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//Zoom factor</span>\n  <span class=\"token keyword\">double</span> fx <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">/</span> scale<span class=\"token punctuation\">;</span>\n  Mat frame<span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">//Video frame</span>\n  VideoCapture <span class=\"token function\">cap</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\" spellcheck=\"true\">//Open the camera</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>cap<span class=\"token punctuation\">.</span><span class=\"token function\">isOpened</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"Open camera failed.\\n\"</span> <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">//Load cascade classifier</span>\n  CascadeClassifier cascade<span class=\"token punctuation\">;</span>\n  ret <span class=\"token operator\">=</span> cascade<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"haarcascade_frontalface_alt2.xml\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>ret<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Load xml failed[ret = %d]. \\n\"</span><span class=\"token punctuation\">,</span> ret<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"Load xml succeed.\"</span> <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">// Loading trained face models</span>\n  Ptr<span class=\"token operator\">&lt;</span>BasicFaceRecognizer<span class=\"token operator\">></span> modelPCA <span class=\"token operator\">=</span> EigenFaceRecognizer<span class=\"token operator\">::</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  modelPCA<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyFacePCAModel.xml\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  Ptr<span class=\"token operator\">&lt;</span>BasicFaceRecognizer<span class=\"token operator\">></span> modelFisher <span class=\"token operator\">=</span> FisherFaceRecognizer<span class=\"token operator\">::</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  modelFisher<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyFaceFisherModel.xml\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  Ptr<span class=\"token operator\">&lt;</span>LBPHFaceRecognizer<span class=\"token operator\">></span> modelLBPH <span class=\"token operator\">=</span> LBPHFaceRecognizer<span class=\"token operator\">::</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  modelLBPH<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyFaceLBPHModel.xml\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n\n  <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>exitFlag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    cap <span class=\"token operator\">>></span> frame<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n\n    Mat facesImg<span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">//</span>\n    vector<span class=\"token operator\">&lt;</span>Rect<span class=\"token operator\">></span> faces<span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">//Create a vector container for storing faces</span>\n    Mat gary_img<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//grayscale image</span>\n    Mat scl_gary_img<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//Scaled grayscale image</span>\n\n    <span class=\"token function\">cvtColor</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">,</span> gary_img<span class=\"token punctuation\">,</span> COLOR_BGR2GRAY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//Convert the original image to a grayscale image</span>\n    <span class=\"token function\">resize</span><span class=\"token punctuation\">(</span>gary_img<span class=\"token punctuation\">,</span> scl_gary_img<span class=\"token punctuation\">,</span> <span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> fx<span class=\"token punctuation\">,</span> fx<span class=\"token punctuation\">,</span> INTER_LINEAR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//resize img</span>\n    <span class=\"token function\">equalizeHist</span><span class=\"token punctuation\">(</span> scl_gary_img<span class=\"token punctuation\">,</span> scl_gary_img <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">//face detection</span>\n    cascade<span class=\"token punctuation\">.</span><span class=\"token function\">detectMultiScale</span><span class=\"token punctuation\">(</span>scl_gary_img<span class=\"token punctuation\">,</span> faces<span class=\"token punctuation\">,</span> <span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token operator\">|</span>CASCADE_SCALE_IMAGE<span class=\"token punctuation\">,</span><span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Face.size = %ld\\n\"</span><span class=\"token punctuation\">,</span> faces<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\" spellcheck=\"true\">//facesImg = scl_gary_img(faces[0]);</span>\n\n    Mat face_resize<span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">//To prevent the picture is too small (that is, people too far away from the camera)</span>\n    <span class=\"token keyword\">int</span> predictPCA <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">int</span> predictFisher <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">int</span> predictLBPH <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>size_t i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> faces<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\n      Rect rectFace <span class=\"token operator\">=</span> faces<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      facesImg <span class=\"token operator\">=</span> <span class=\"token function\">scl_gary_img</span><span class=\"token punctuation\">(</span>faces<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>facesImg<span class=\"token punctuation\">.</span>rows <span class=\"token operator\">>=</span> ROW_MIN<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token function\">resize</span><span class=\"token punctuation\">(</span>facesImg<span class=\"token punctuation\">,</span> face_resize<span class=\"token punctuation\">,</span> <span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">92</span><span class=\"token punctuation\">,</span> <span class=\"token number\">112</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"faceImg.rows[%d] &lt; %d \\n\"</span><span class=\"token punctuation\">,</span> facesImg<span class=\"token punctuation\">.</span>rows<span class=\"token punctuation\">,</span> ROW_MIN<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>face_resize<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        predictPCA <span class=\"token operator\">=</span> modelPCA<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">predict</span><span class=\"token punctuation\">(</span>face_resize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        predictFisher <span class=\"token operator\">=</span> modelFisher<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">predict</span><span class=\"token punctuation\">(</span>face_resize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        predictLBPH <span class=\"token operator\">=</span> modelLBPH<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">predict</span><span class=\"token punctuation\">(</span>face_resize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n      <span class=\"token punctuation\">}</span>\n      cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"predictPCA   : \"</span> <span class=\"token operator\">&lt;&lt;</span> predictPCA    <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n      cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"predictFisher: \"</span> <span class=\"token operator\">&lt;&lt;</span> predictFisher <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n      cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"predictLBPH  : \"</span> <span class=\"token operator\">&lt;&lt;</span> predictLBPH   <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n      <span class=\"token function\">rectangle</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">,</span> <span class=\"token function\">Point</span><span class=\"token punctuation\">(</span>rectFace<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> rectFace<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> scale<span class=\"token punctuation\">,</span> <span class=\"token function\">Point</span><span class=\"token punctuation\">(</span>rectFace<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> rectFace<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> rectFace<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> rectFace<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> scale<span class=\"token punctuation\">,</span> <span class=\"token function\">Scalar</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>predictPCA <span class=\"token operator\">==</span> <span class=\"token number\">41</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token function\">putText</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Liuyang\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Point</span><span class=\"token punctuation\">(</span>faces<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> faces<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> scale<span class=\"token punctuation\">,</span> FONT_HERSHEY_SIMPLEX<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Scalar</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\n        <span class=\"token function\">putText</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">,</span> <span class=\"token string\">\"X\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Point</span><span class=\"token punctuation\">(</span>faces<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> faces<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> scale<span class=\"token punctuation\">,</span> FONT_HERSHEY_SIMPLEX<span class=\"token punctuation\">,</span> <span class=\"token number\">1.5</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Scalar</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">// if(faces.size() &lt;= 0){</span>\n  <span class=\"token comment\" spellcheck=\"true\">//  cout &lt;&lt; \"There are no faces in the camera.\\n\" &lt;&lt; endl;</span>\n <span class=\"token comment\" spellcheck=\"true\">// }</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"frame\"</span><span class=\"token punctuation\">,</span> frame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">waitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">27</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n                exitFlag <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n                cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"Esc...\"</span> <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">Recognition_And_Draw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p><img src=\"7.jpg\" alt></p>\n<p>Note:    </p>\n<ol>\n<li>This program supports multiple face recognition at the same time</li>\n<li>Face recognition accuracy is not high, and it is susceptible to environmental factors such as light.</li>\n</ol>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"Face-Recognition-with-OpenCV\"><a href=\"#Face-Recognition-with-OpenCV\" class=\"headerlink\" title=\"Face Recognition with OpenCV\"></a>Face Recognition with OpenCV</h1><h1 id=\"Preface\"><a href=\"#Preface\" class=\"headerlink\" title=\"Preface\"></a>Preface</h1><p>My Particular Environment:<br>Ubuntu16.04 + OpenCV3.3.0 + OpenCV_contrib3.3.0</p>\n<h2 id=\"1-Image-Acquisition-and-Face-Database-Creation\"><a href=\"#1-Image-Acquisition-and-Face-Database-Creation\" class=\"headerlink\" title=\"1. Image Acquisition and Face Database Creation\"></a>1. Image Acquisition and Face Database Creation</h2><h3 id=\"1-1-Image-Acquisition\"><a href=\"#1-1-Image-Acquisition\" class=\"headerlink\" title=\"1.1 Image Acquisition\"></a>1.1 Image Acquisition</h3><h4 id=\"1-1-1-Steps-and-methods\"><a href=\"#1-1-1-Steps-and-methods\" class=\"headerlink\" title=\"1.1.1 Steps and methods\"></a>1.1.1 Steps and methods</h4><ol>\n<li>Open the camera and capture images;</li>\n<li>Loading the face classifier;</li>\n<li>Start face detection, frame the face part and display;</li>\n<li>Under the condition that the face is detected, take a picture with one button;</li>\n<li>For the face part, resize and write the image file in the specified directory;</li>\n</ol>\n<h4 id=\"1-1-2-Code\"><a href=\"#1-1-2-Code\" class=\"headerlink\" title=\"1.1.2 Code\"></a>1.1.2 Code</h4><pre><code class=\"cpp\">#include &lt;opencv2/highgui/highgui.hpp&gt;\n#include &lt;opencv2/imgproc/imgproc.hpp&gt;\n#include &lt;opencv2/core/core.hpp&gt;\n#include &lt;opencv2/objdetect/objdetect.hpp&gt;\n#include &lt;stdio.h&gt;\n#include &lt;opencv2/face.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt; \nusing namespace cv;\nusing namespace std;\nusing namespace cv::face;\n\n#define CV_COLOR_GREEN cv::Scalar(0, 255, 0)\n\nint resize_save(Mat&amp; faceIn, char* path, int  faceseq);\n//Input: current image, the path of file, the name or faceseq of images.\n//Output: None\n//Function: resize the current image to (92, 112), which is same to the train data.\nint get_face(char* path);\n//Input: the path of file.\n//Output: None\n//Function: Use face_cascade to detect if there are faces in the window, and save the faces through function reszie_save.\n\n\nint resize_save(Mat&amp; faceIn, char* path, int  faceseq){\n  string strname;\n  Mat faceOut;\n  bool ret;\n  if(faceIn.empty()){\n    printf(&quot;FaceIn is empty.\\n&quot;);\n    return -1;\n  }\n\n  if(faceIn.cols &gt; 100){\n    resize(faceIn, faceOut, Size(92, 112));\n    //Resize and Keep a match with the train database.\n    strname = format(&quot;%s/%d.jpg&quot;, path, faceseq); //mkdir\n    ret = imwrite(strname, faceOut); //save image. Note the file suffix.\n    if(ret == false){\n      printf(&quot;Image write failed!\\n&quot;);\n      printf(&quot;Please check filename[%s] is legal!\\n&quot;, strname.c_str());\n      return -1;\n    }\n    imshow(strname, faceOut);\n  }\n  waitKey(20);\n  return 0;\n}\n\nint get_face(char* path){\n  CascadeClassifier face_cascade;\n  VideoCapture camera;\n  int ret;\n  Mat frame;  //camera frame\n  vector&lt;Rect&gt; objects; //The faces coordinates.\n  Mat img_gary; //Gradation pictures.\n  Mat faceImg;\n  int faceNum = 1; //\n  char key;\n  camera.open(0);\n  if(!camera.isOpened()){\n    cout &lt;&lt; &quot;Open camera failed.&quot; &lt;&lt; endl;\n    return -1;\n  }\n  cout &lt;&lt; &quot;Open camera succeed. &quot; &lt;&lt; endl;\n\n  //Load the face cascadeclassifier.\n  ret = face_cascade.load(&quot;haarcascade_frontalface_alt2.xml&quot;);\n  if(!ret){\n    cout &lt;&lt; &quot;Load xml failed.&quot; &lt;&lt; endl;\n    return -1;\n  }\n  cout &lt;&lt; &quot;Load xml succeed.&quot; &lt;&lt; endl;\n\n  while(1){\n    camera &gt;&gt; frame;\n    if(frame.empty()){\n      continue;\n    }\n    cvtColor(frame, img_gary, COLOR_BGR2GRAY); //Transform frame as the gradation picture, note imshow is still the original frame.\n    equalizeHist(img_gary, img_gary); //Histogram equalization, which is helpful to improve the quality of pictures.\n\n    //Face detection\n    face_cascade.detectMultiScale(img_gary, objects, 1.1,3 , 0, Size(50,50));\n    for(size_t i = 0; i &lt; objects.size(); i++){\n      rectangle(frame, objects[i], CV_COLOR_GREEN);\n    }\n    imshow(&quot;Camera&quot;, frame);\n    key = waitKey(1);\n    switch (key){\n      case &#39;p&#39;: //tap &#39;P&#39; to save.\n        if(objects.size() == 1){\n          faceImg = frame(objects[0]);\n          ret = resize_save(faceImg, path, faceNum);\n          if(ret == 0){\n            cout &lt;&lt; &quot;resize_save succeed.\\n&quot; &lt;&lt; endl;\n            faceNum++;\n          }\n        }\n        break;\n      case 27:   //switch to ESC\n        cout &lt;&lt; &quot;Esc ...&quot; &lt;&lt; endl;\n        return 0;\n      default:\n        break;\n    }\n  }\n}\n\n\n\nint main(int argc, char* argv[]){\n  if(argc != 2)\n      {\n        printf(&quot;usage: %s &lt;path&gt;\\n&quot;, argv[0]);\n        return -1;\n      }\n  get_face(argv[1]);\n  return 0;\n}</code></pre>\n<p><img src=\"4.jpg\" alt><br>Note:    </p>\n<ol>\n<li>After the compilation is successful, the execution executable file must provide parameters, which are the directories for storing the face image, and it must be an existing directory.(E.g: ./program_name Img/s41)    </li>\n<li>Press the “P” button to take a photo and save the face. Press the “Esc” button to exit.</li>\n</ol>\n<h3 id=\"1-2-Face-Database-Creation\"><a href=\"#1-2-Face-Database-Creation\" class=\"headerlink\" title=\"1.2 Face Database Creation\"></a>1.2 Face Database Creation</h3><p>The official document provides a download of the face database, and i use the <a href=\"http://www.cl.cam.ac.uk/research/dtg/attarchive/facedatabase.html\" target=\"_blank\" rel=\"noopener\">AT&amp;T Facedatabase</a> to create my face database. I have updated this zip file to my github, you can download it from <a href=\"att_faces.zip\">here</a> faster.<br>AT&amp;T Face Database is also known as the OCR face database, 40 people, 10 photos per person. The photos are token at different times, different lighting, different expressions(closed eyes, laughing or not laughing), different face details(with or without glasses). All images were captured on a dark , even background with a vertical face o the front(some with a slight rotation).<br>You can download the compressed package from the website, and first extract the att_faces folder. There are 40 folders under the folder, which named from “s1” to “s40”. Each folder has the same person’s photos with different expressions, and there are 10 face photos.<br>The format of these images is “.pgm”<br><img src=\"1.png\" alt><br><img src=\"2.png\" alt></p>\n<p>Note:<br>If you want to add your own photos to the face database through the program, the number of added pictures must be no less than 2.</p>\n<h2 id=\"2-Face-Recognition-Model-training\"><a href=\"#2-Face-Recognition-Model-training\" class=\"headerlink\" title=\"2. Face Recognition Model training\"></a>2. Face Recognition Model training</h2><h3 id=\"2-1-Create-a-label-file-CSV\"><a href=\"#2-1-Create-a-label-file-CSV\" class=\"headerlink\" title=\"2.1 Create a label file CSV\"></a>2.1 Create a label file CSV</h3><p>With the face database data, we need to read it in the program, here we need to use csv file to read the image data in the face database.<br>The format of a csv file: image path name + label, such as /Img/s1/image.jpg;1<br>Assume the face image path is: /Img/s1/01..jpg<br>And we give this face image a label “1”, this label represents the person’s name. One person’s face image label must be the same.<br>You can create a csv file manually and then enter the data one by one. But if you use python, you don’t have to do this tedious and boring work.<br>The following is a piece of code which can write data in the CSV file automatically.</p>\n<pre><code class=\"python\">#!/usr/bin/env python\n\nimport sys\nimport os.path\n\n# This is a tiny script to help you creating a CSV file from a face\n# database with a similar hierarchie:\n#\n#  \n#  \n#  |-- s1\n#  |   |-- 1.pgm\n#  |   |-- ...\n#  |   |-- 10.pgm\n#  |-- s2\n#  |   |-- 1.pgm\n#  |   |-- ...\n#  |   |-- 10.pgm\n#  ...\n#  |-- s40\n#  |   |-- 1.pgm\n#  |   |-- ...\n#  |   |-- 10.pgm\n#\n\nif __name__ == &quot;__main__&quot;:\n\n    if len(sys.argv) != 2:\n        print &quot;usage: create_csv &lt;base_path&gt;&quot;\n        sys.exit(1)\n\n    BASE_PATH=sys.argv[1]        \n    SEPARATOR=&quot;;&quot;\n    # This is output csv file.\n    fh = open(&quot;../at.csv&quot;,&#39;w&#39;)\n\n    for dirname, dirnames, filenames in os.walk(BASE_PATH):\n        for subdirname in dirnames:\n            subject_path = os.path.join(dirname, subdirname)\n            for filename in os.listdir(subject_path):\n                abs_path = &quot;%s/%s&quot; % (subject_path, filename)\n                print(&quot;%s%s%s&quot; % (abs_path, SEPARATOR, subdirname[1:]))\n                fh.write(abs_path)\n                fh.write(SEPARATOR)\n                fh.write(subdirname[1:])\n                fh.write(&quot;\\n&quot;)\n    fh.close()</code></pre>\n<p>You should set the image path parameter (absolute path) when running.(E.g: <strong>python filename.py /home/kevin/OpenCV/face_rec/Img</strong> ) and you can get a CSV file like this:<br><img src=\"5.png\" alt><br>This CSV file is created.</p>\n<h3 id=\"2-2-Model-training\"><a href=\"#2-2-Model-training\" class=\"headerlink\" title=\"2.2 Model training\"></a>2.2 Model training</h3><p>This is the official example of OpenCV: <a href=\"https://docs.opencv.org/3.2.0/da/d60/tutorial_face_main.html\" target=\"_blank\" rel=\"noopener\">Click here</a><br>They offer three models: Eigenfaces, Fisherfaces and Local Binary Patterns Histograms(LBPH)    </p>\n<p>Then I will train my own face database based on these models on the first step.</p>\n<pre><code class=\"cpp\">static Mat norm_0_255(InputArray _src){\n  Mat src = _src.getMat();\n  Mat dst; //Create and return a normalized image matrix:\n  switch(src.channels()) {\n    case 1:\n        cv::normalize(_src, dst, 0, 255, NORM_MINMAX, CV_8UC1);\n        break;\n    case 3:\n        cv::normalize(_src, dst, 0, 255, NORM_MINMAX, CV_8UC3);\n        break;\n    default:\n        src.copyTo(dst);\n        break;\n  }\n  return dst;\n}\n//load CSV file\nstatic void read_csv(const string&amp; filename, vector&lt;Mat&gt;&amp; images, vector&lt;int&gt;&amp; labels, char separator = &#39;;&#39;){\n  std::ifstream file(filename.c_str(), ifstream::in);\n    if (!file) {\n        string error_message = &quot;No valid input file was given, please check the given filename.&quot;;\n        CV_Error(Error::StsBadArg, error_message);\n    }\n    string line, path, classlabel;\n    while (getline(file, line)) {\n        stringstream liness(line);\n        getline(liness, path, separator);\n        getline(liness, classlabel);\n        if(!path.empty() &amp;&amp; !classlabel.empty()) {\n            images.push_back(imread(path, 0));\n            labels.push_back(atoi(classlabel.c_str()));\n        }\n    }\n}\n\nvoid train_model(const string&amp; fn_csv){\n  // 2 containers to store image data and corresponding labels\n    vector&lt;Mat&gt; images;\n    vector&lt;int&gt; labels;\n    // load data\n    try\n    {\n        read_csv(fn_csv, images, labels);\n    }\n    catch (cv::Exception&amp; e)\n    {\n        cerr &lt;&lt; &quot;Error opening file \\&quot;&quot; &lt;&lt; fn_csv &lt;&lt; &quot;\\&quot;. Reason: &quot; &lt;&lt; e.msg &lt;&lt; endl;\n        exit(1);\n    }\n    if (images.size() &lt;= 1) {\n        string error_message = &quot;This demo needs at least 2 images to work. Please add more images to your data set!&quot;;\n        CV_Error(CV_StsError, error_message);\n    }\n\n    Mat testSample = images[images.size() - 1];\n    int testLabel = labels[labels.size() - 1];\n    images.pop_back();\n    labels.pop_back();\n    // The following lines create a feature face model for face recognition.\n     // Train it with images and tags read from a CSV file.\n     // Here is a complete PCA transform\n     //If you only want to keep 10 principal components, use the following code\n     // cv::EigenFaceRecognizer::create(10);\n     // cv::FisherFaceRecognizer::create(10);\n     //\n     // If you also want to initialize with a confidence threshold, use the following statement:\n     // cv::EigenFaceRecognizer::create(10, 123.0);\n     //\n     // If you use all features and use a threshold, use the following statement:\n     // cv::EigenFaceRecognizer::create(0, 123.0);\n     // cv::FisherFaceRecognizer::create(0, 123.0);\n\n    Ptr&lt;BasicFaceRecognizer&gt; model0 = EigenFaceRecognizer::create();\n    model0-&gt;train(images, labels);\n    model0-&gt;write(&quot;MyFacePCAModel.xml&quot;);\n\n    Ptr&lt;BasicFaceRecognizer&gt; model1 = FisherFaceRecognizer::create();\n    model1-&gt;train(images, labels);\n    model1-&gt;write(&quot;MyFaceFisherModel.xml&quot;);\n\n     Ptr&lt;LBPHFaceRecognizer&gt; model2 = LBPHFaceRecognizer::create();\n    model2-&gt;train(images, labels);\n    model2-&gt;write(&quot;MyFaceLBPHModel.xml&quot;);\n\n\n    // The test image is predicted below, predictedLabel is the predicted label result\n    int predictedLabel0 = model0-&gt;predict(testSample);\n    int predictedLabel1 = model1-&gt;predict(testSample);\n    int predictedLabel2 = model2-&gt;predict(testSample);\n\n    // There is also a way to get the result and get the threshold:\n    //      int predictedLabel = -1;\n    //      double confidence = 0.0;\n    //      model-&gt;predict(testSample, predictedLabel, confidence);\n\n    string result_message0 = format(&quot;Predicted class = %d / Actual class = %d.&quot;, predictedLabel0, testLabel);\n    string result_message1 = format(&quot;Predicted class = %d / Actual class = %d.&quot;, predictedLabel1, testLabel);\n    string result_message2 = format(&quot;Predicted class = %d / Actual class = %d.&quot;, predictedLabel2, testLabel);\n    cout &lt;&lt; result_message0 &lt;&lt; endl;\n    cout &lt;&lt; result_message1 &lt;&lt; endl;\n    cout &lt;&lt; result_message2 &lt;&lt; endl;\n\n    waitKey(0);\n}\n\nint main(int argc, char* argv[]){\n  if(argc != 2)\n      {\n        printf(&quot;usage: %s &lt;csv_file&gt;\\n&quot;, argv[0]);\n        return -1;\n      }\n  string fn_csv = string(argv[1]);\n  train_model(fn_csv);\n  return 0;\n}</code></pre>\n<p>At this point, we have completed the training of the face model. And we get three files:     </p>\n<p><code>MyFaceFisherModel.xml、MyFaceLBPHModel.xml、MyFacePCAModel.xml</code></p>\n<p><img src=\"6.png\" alt><br>Note:    </p>\n<ol>\n<li><p>Changes to the API of the OpenCV3.3 Face Recognition Module</p>\n<p>a. Facerec.hpp before opencv3.3</p>\n<pre><code class=\"cpp\">#ifndef __OPENCV_FACEREC_HPP__\n#define __OPENCV_FACEREC_HPP__\n\n#include &quot;opencv2/face.hpp&quot;\n#include &quot;opencv2/core.hpp&quot;\n\nnamespace cv { namespace face {\n\n// base for two classes\nclass CV_EXPORTS_W BasicFaceRecognizer : public FaceRecognizer\n{\npublic:\n    /** @see setNumComponents */\n    CV_WRAP virtual int getNumComponents() const = 0;\n    // ----------- ...... -----------\n\n    CV_WRAP virtual cv::Mat getEigenValues() const = 0;\n    CV_WRAP virtual cv::Mat getEigenVectors() const = 0;\n    CV_WRAP virtual cv::Mat getMean() const = 0;\n};\n\nCV_EXPORTS_W Ptr&lt;BasicFaceRecognizer&gt; createEigenFaceRecognizer(int num_components = 0, double threshold = DBL_MAX);\n\nCV_EXPORTS_W Ptr&lt;BasicFaceRecognizer&gt; createFisherFaceRecognizer(int num_components = 0, double threshold = DBL_MAX);\n\nclass CV_EXPORTS_W LBPHFaceRecognizer : public FaceRecognizer\n{\npublic:\n    /** @see setGridX */\n    CV_WRAP virtual int getGridX() const = 0;\n    /** @copybrief getGridX @see getGridX */\n    CV_WRAP virtual void setGridX(int val) = 0;\n    // ----------- ...... -----------\n    CV_WRAP virtual cv::Mat getLabels() const = 0;\n};\n\nCV_EXPORTS_W Ptr&lt;LBPHFaceRecognizer&gt; createLBPHFaceRecognizer(int radius=1, int neighbors=8, int grid_x=8, int grid_y=8, double threshold = DBL_MAX);\n\n}} //namespace cv::face\n\n#endif //__OPENCV_FACEREC_HPP__</code></pre>\n<ul>\n<li><p>Comment section of the ninth line: <code>// base for two classes</code>,  This shows that BasicFaceRecognizer is the base class of two classes: EigenFaceRecognizer and FisherFaceRecognizer. With LBPHFaceRecognizer is irrelevant. Even the new API is still the case.</p>\n</li>\n<li><p>Method of creating three face recognizers.</p>\n<pre><code class=\"cpp\">Ptr&lt;BasicFaceRecognizer&gt; model =  createEigenFaceRecognizer();\nPtr&lt;BasicFaceRecognizer&gt; model =  createFisherFaceRecognizer();\nPtr&lt;LBPHFaceRecognizer&gt; model  =  createLBPHFaceRecognizer();</code></pre>\n</li>\n</ul>\n<p>b. Facerec.hpp after opencv3.3</p>\n</li>\n</ol>\n<pre><code class=\"cpp\">#ifndef __OPENCV_FACEREC_HPP__\n#define __OPENCV_FACEREC_HPP__\n\n#include &quot;opencv2/face.hpp&quot;\n#include &quot;opencv2/core.hpp&quot;\n\nnamespace cv { namespace face {\n\n// base for two classes\nclass CV_EXPORTS_W BasicFaceRecognizer : public FaceRecognizer\n{\npublic:\n    /** @see setNumComponents */\n    CV_WRAP int getNumComponents() const;\n    // ----------- ...... -----------\n    CV_WRAP cv::Mat getEigenValues() const;\n    CV_WRAP cv::Mat getEigenVectors() const;\n    CV_WRAP cv::Mat getMean() const;\n\n    virtual void read(const FileNode&amp; fn);\n    virtual void write(FileStorage&amp; fs) const;\n    virtual bool empty() const;\n\n    using FaceRecognizer::read;\n    using FaceRecognizer::write;\n\nprotected:\n    int _num_components;\n    double _threshold;\n    std::vector&lt;Mat&gt; _projections;\n    Mat _labels;\n    Mat _eigenvectors;\n    Mat _eigenvalues;\n    Mat _mean;\n};\nclass CV_EXPORTS_W EigenFaceRecognizer : public BasicFaceRecognizer\n{\npublic:\n    CV_WRAP static Ptr&lt;EigenFaceRecognizer&gt; create(int num_components = 0, double threshold = DBL_MAX);\n};\n\nclass CV_EXPORTS_W FisherFaceRecognizer : public BasicFaceRecognizer\n{\npublic:\n    CV_WRAP static Ptr&lt;FisherFaceRecognizer&gt; create(int num_components = 0, double threshold = DBL_MAX);\n};\nclass CV_EXPORTS_W LBPHFaceRecognizer : public FaceRecognizer\n{\npublic:\n    /** @see setGridX */\n    CV_WRAP virtual int getGridX() const = 0;\n    // ----------- ...... -----------\n    CV_WRAP virtual cv::Mat getLabels() const = 0;\n    CV_WRAP static Ptr&lt;LBPHFaceRecognizer&gt; create(int radius=1, int neighbors=8, int grid_x=8, int grid_y=8, double threshold = DBL_MAX);\n};\n}} //namespace cv::face\n\n#endif //__OPENCV_FACEREC_HPP__</code></pre>\n<ul>\n<li>Both EigenFaceRecognizer and FisherFaceRecognizer are inherited from BasicFaceRecognizer. However, the LBFPHaceRecognizer, like the BasicFaceRecognizer, inherits from FaceRecognizer.    </li>\n<li>Method of creating three face recognizer</li>\n</ul>\n<pre><code class=\"cpp\">Ptr&lt;EigenFaceRecognizer&gt; model  = EigenFaceRecognizer::create();\nPtr&lt;FisherFaceRecognizer&gt; model = FisherFaceRecognizer::create();\nPtr&lt;LBPHFaceRecognizer&gt; model   = LBPHFaceRecognizer::create();</code></pre>\n<h2 id=\"3-Identify-faces-in-the-video-stream-camera\"><a href=\"#3-Identify-faces-in-the-video-stream-camera\" class=\"headerlink\" title=\"3. Identify faces in the video stream (camera)\"></a>3. Identify faces in the video stream (camera)</h2><h3 id=\"3-1-Ready-to-work\"><a href=\"#3-1-Ready-to-work\" class=\"headerlink\" title=\"3.1 Ready to work.\"></a>3.1 Ready to work.</h3><h4 id=\"3-1-1-Copy-the-training-file-obtained-in-the-second-step-to-the-current-folder\"><a href=\"#3-1-1-Copy-the-training-file-obtained-in-the-second-step-to-the-current-folder\" class=\"headerlink\" title=\"3.1.1 Copy the training file obtained in the second step to the current folder.\"></a>3.1.1 Copy the training file obtained in the second step to the current folder.</h4><h4 id=\"3-1-2-The-process-or-method-of-Face-Recognition\"><a href=\"#3-1-2-The-process-or-method-of-Face-Recognition\" class=\"headerlink\" title=\"3.1.2 The process or method of Face Recognition\"></a>3.1.2 The process or method of Face Recognition</h4><p>This step has a similar part to the creation of a face recognition database.</p>\n<ul>\n<li>Open the camera</li>\n<li>Loading face detector, face model</li>\n<li>Scale the image (for efficiency)</li>\n<li>Face recognition (compare to face model)</li>\n<li>Label faces with rectangular wireframes and add text labels</li>\n</ul>\n<h4 id=\"3-2-Code\"><a href=\"#3-2-Code\" class=\"headerlink\" title=\"3.2 Code\"></a>3.2 Code</h4><pre><code class=\"cpp\">#include &lt;opencv2/opencv.hpp&gt;  \n#include &quot;opencv2/core.hpp&quot;\n#include &quot;opencv2/face.hpp&quot;\n#include &quot;opencv2/highgui.hpp&quot;\n#include &quot;opencv2/imgproc.hpp&quot;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n\nusing namespace cv;\nusing namespace cv::face;\nusing namespace std;\n\n#define ROW_MIN        45\n\nint exitFlag = 0;\n\nint Recognition_And_Draw();\n\nint Recognition_And_Draw(){\n  int ret = 0; //\n  double scale = 4; //Zoom factor\n  double fx = 1 / scale;\n  Mat frame;  //Video frame\n  VideoCapture cap(0);    //Open the camera\n  if(!cap.isOpened()){\n    cout &lt;&lt; &quot;Open camera failed.\\n&quot; &lt;&lt; endl;\n    return -1;\n  }\n\n  //Load cascade classifier\n  CascadeClassifier cascade;\n  ret = cascade.load(&quot;haarcascade_frontalface_alt2.xml&quot;);\n\n  if(!ret){\n    printf(&quot;Load xml failed[ret = %d]. \\n&quot;, ret);\n    return -1;\n  }\n  cout &lt;&lt; &quot;Load xml succeed.&quot; &lt;&lt; endl;\n\n  // Loading trained face models\n  Ptr&lt;BasicFaceRecognizer&gt; modelPCA = EigenFaceRecognizer::create();  \n  modelPCA-&gt;read(&quot;MyFacePCAModel.xml&quot;);  \n  Ptr&lt;BasicFaceRecognizer&gt; modelFisher = FisherFaceRecognizer::create();\n  modelFisher-&gt;read(&quot;MyFaceFisherModel.xml&quot;);  \n  Ptr&lt;LBPHFaceRecognizer&gt; modelLBPH = LBPHFaceRecognizer::create();  \n  modelLBPH-&gt;read(&quot;MyFaceLBPHModel.xml&quot;);  \n\n  while(!exitFlag){\n    cap &gt;&gt; frame;\n    if(frame.empty())\n      continue;\n\n    Mat facesImg;  //\n    vector&lt;Rect&gt; faces;  //Create a vector container for storing faces\n    Mat gary_img; //grayscale image\n    Mat scl_gary_img; //Scaled grayscale image\n\n    cvtColor(frame, gary_img, COLOR_BGR2GRAY); //Convert the original image to a grayscale image\n    resize(gary_img, scl_gary_img, Size(), fx, fx, INTER_LINEAR); //resize img\n    equalizeHist( scl_gary_img, scl_gary_img );\n\n  //face detection\n    cascade.detectMultiScale(scl_gary_img, faces, 1.1, 2, 0|CASCADE_SCALE_IMAGE,Size(30, 30));\n    printf(&quot;Face.size = %ld\\n&quot;, faces.size());\n  //facesImg = scl_gary_img(faces[0]);\n\n    Mat face_resize;  //To prevent the picture is too small (that is, people too far away from the camera)\n    int predictPCA = 0;  \n    int predictFisher = 0;  \n    int predictLBPH = 0;\n    for(size_t i = 0; i &lt; faces.size(); i++){\n\n      Rect rectFace = faces[i];\n      facesImg = scl_gary_img(faces[i]);\n      if(facesImg.rows &gt;= ROW_MIN){\n        resize(facesImg, face_resize, Size(92, 112));\n      }\n      else{\n        printf(&quot;faceImg.rows[%d] &lt; %d \\n&quot;, facesImg.rows, ROW_MIN);\n        continue;\n      }\n      if(!face_resize.empty()){\n        predictPCA = modelPCA-&gt;predict(face_resize);  \n        predictFisher = modelFisher-&gt;predict(face_resize);  \n        predictLBPH = modelLBPH-&gt;predict(face_resize); \n      }\n      cout &lt;&lt; &quot;predictPCA   : &quot; &lt;&lt; predictPCA    &lt;&lt; endl;\n      cout &lt;&lt; &quot;predictFisher: &quot; &lt;&lt; predictFisher &lt;&lt; endl;\n      cout &lt;&lt; &quot;predictLBPH  : &quot; &lt;&lt; predictLBPH   &lt;&lt; endl;\n      rectangle(frame, Point(rectFace.x, rectFace.y) * scale, Point(rectFace.x + rectFace.width, rectFace.y + rectFace.height) * scale, Scalar(0, 255, 0), 2, 8);\n      if (predictPCA == 41){\n        putText(frame, &quot;Liuyang&quot;, Point(faces[i].x, faces[i].y) * scale, FONT_HERSHEY_SIMPLEX, 1, Scalar(0, 0, 255), 2);\n      }\n      else{\n        putText(frame, &quot;X&quot;, Point(faces[i].x, faces[i].y) * scale, FONT_HERSHEY_SIMPLEX, 1.5, Scalar(0, 0, 255), 2);\n      }\n\n  // if(faces.size() &lt;= 0){\n  //  cout &lt;&lt; &quot;There are no faces in the camera.\\n&quot; &lt;&lt; endl;\n // }\n    }\n    imshow(&quot;frame&quot;, frame);\n      if (waitKey(1) == 27){\n                exitFlag = 1;\n                cout &lt;&lt; &quot;Esc...&quot; &lt;&lt; endl;\n                break;\n      }\n  }\n}\n\nint main(){\n  Recognition_And_Draw();\n  return 0;\n}</code></pre>\n<p><img src=\"7.jpg\" alt></p>\n<p>Note:    </p>\n<ol>\n<li>This program supports multiple face recognition at the same time</li>\n<li>Face recognition accuracy is not high, and it is susceptible to environmental factors such as light.</li>\n</ol>\n"},{"title":"Git & Github","top":false,"cover":false,"toc":true,"mathjax":false,"img":"https://i.loli.net/2019/09/19/wc3vfPElWsXKTGV.jpg","date":"2019-09-18T08:21:29.000Z","password":null,"summary":"Some problems in GitHub & Git.","_content":"\n### 1. When i download files from GitHub, `Failed to connect to 127.0.0.1 port 1080: Connection refused`\n\n1. Find wheather you are using proxy server or not.\n\n```bash\ngit config --global http.proxy\n```\n\n2. Cancel the proxy server.\n\n```bash\ngit config --global --unset http.proxy\n```\n\n### 2. Clone with SSH ([Github guide](https://help.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh))\n- Install Openssh\n\n```bash\nsudo pacman -S openssh\n```\n- Generating a new SSH key\n\n```bash\nssh-keygen\n```\n\n![](https://i.loli.net/2019/12/06/foZjquaH75Jnw3Y.png) \n\n```bash\ntree .ssh\n```\n\n![](https://i.loli.net/2019/12/06/oKIUzYLRcp4OhyE.png) \n\n- Copy the SSH key to your clipboard\n\n```bash\ncat .ssh/id_rsa.pub\n```\n\n- In the upper-right corner of any page, click your profile photo, then click **Settings**\n\n![](https://i.loli.net/2019/12/06/hIA7KpbfmYMJ14j.png)\n\n- In the user settings sidebar, click **SSH and GPG keys**\n\n- Click **New SSH key** or **Add SSH key**.\n\n- In the \"Title\" field, add a descriptive label for the new key. For example, if you're using arch linux, you might call this key \"Arch linux\"\n\n- Paste your key into the \"Key\" field.\n\n![](https://i.loli.net/2019/12/06/vjZVS19MN2A4hoD.png) \n\n- If prompted, confirm your GitHub password.\n\n\n\n\n\n","source":"_posts/Git-Github.md","raw":"---\ntitle: Git & Github\ntop: false\ncover: false\ntoc: true\nmathjax: false\nimg: https://i.loli.net/2019/09/19/wc3vfPElWsXKTGV.jpg\ndate: 2019-09-18 16:21:29\npassword:\nsummary: Some problems in GitHub & Git.\ntags:\n- Git\n- Github\ncategories:\n---\n\n### 1. When i download files from GitHub, `Failed to connect to 127.0.0.1 port 1080: Connection refused`\n\n1. Find wheather you are using proxy server or not.\n\n```bash\ngit config --global http.proxy\n```\n\n2. Cancel the proxy server.\n\n```bash\ngit config --global --unset http.proxy\n```\n\n### 2. Clone with SSH ([Github guide](https://help.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh))\n- Install Openssh\n\n```bash\nsudo pacman -S openssh\n```\n- Generating a new SSH key\n\n```bash\nssh-keygen\n```\n\n![](https://i.loli.net/2019/12/06/foZjquaH75Jnw3Y.png) \n\n```bash\ntree .ssh\n```\n\n![](https://i.loli.net/2019/12/06/oKIUzYLRcp4OhyE.png) \n\n- Copy the SSH key to your clipboard\n\n```bash\ncat .ssh/id_rsa.pub\n```\n\n- In the upper-right corner of any page, click your profile photo, then click **Settings**\n\n![](https://i.loli.net/2019/12/06/hIA7KpbfmYMJ14j.png)\n\n- In the user settings sidebar, click **SSH and GPG keys**\n\n- Click **New SSH key** or **Add SSH key**.\n\n- In the \"Title\" field, add a descriptive label for the new key. For example, if you're using arch linux, you might call this key \"Arch linux\"\n\n- Paste your key into the \"Key\" field.\n\n![](https://i.loli.net/2019/12/06/vjZVS19MN2A4hoD.png) \n\n- If prompted, confirm your GitHub password.\n\n\n\n\n\n","slug":"Git-Github","published":1,"updated":"2020-02-24T10:49:41.357Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0t3000r74juwv7jld9d","content":"<h3 id=\"1-When-i-download-files-from-GitHub-Failed-to-connect-to-127-0-0-1-port-1080-Connection-refused\"><a href=\"#1-When-i-download-files-from-GitHub-Failed-to-connect-to-127-0-0-1-port-1080-Connection-refused\" class=\"headerlink\" title=\"1. When i download files from GitHub, Failed to connect to 127.0.0.1 port 1080: Connection refused\"></a>1. When i download files from GitHub, <code>Failed to connect to 127.0.0.1 port 1080: Connection refused</code></h3><ol>\n<li>Find wheather you are using proxy server or not.</li>\n</ol>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> config --global http.proxy</code></pre>\n<ol start=\"2\">\n<li>Cancel the proxy server.</li>\n</ol>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> config --global --unset http.proxy</code></pre>\n<h3 id=\"2-Clone-with-SSH-Github-guide\"><a href=\"#2-Clone-with-SSH-Github-guide\" class=\"headerlink\" title=\"2. Clone with SSH (Github guide)\"></a>2. Clone with SSH (<a href=\"https://help.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh\" target=\"_blank\" rel=\"noopener\">Github guide</a>)</h3><ul>\n<li>Install Openssh</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S openssh</code></pre>\n<ul>\n<li>Generating a new SSH key</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">ssh-keygen</code></pre>\n<p><img src=\"https://i.loli.net/2019/12/06/foZjquaH75Jnw3Y.png\" alt> </p>\n<pre class=\" language-bash\"><code class=\"language-bash\">tree .ssh</code></pre>\n<p><img src=\"https://i.loli.net/2019/12/06/oKIUzYLRcp4OhyE.png\" alt> </p>\n<ul>\n<li>Copy the SSH key to your clipboard</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> .ssh/id_rsa.pub</code></pre>\n<ul>\n<li>In the upper-right corner of any page, click your profile photo, then click <strong>Settings</strong></li>\n</ul>\n<p><img src=\"https://i.loli.net/2019/12/06/hIA7KpbfmYMJ14j.png\" alt></p>\n<ul>\n<li><p>In the user settings sidebar, click <strong>SSH and GPG keys</strong></p>\n</li>\n<li><p>Click <strong>New SSH key</strong> or <strong>Add SSH key</strong>.</p>\n</li>\n<li><p>In the “Title” field, add a descriptive label for the new key. For example, if you’re using arch linux, you might call this key “Arch linux”</p>\n</li>\n<li><p>Paste your key into the “Key” field.</p>\n</li>\n</ul>\n<p><img src=\"https://i.loli.net/2019/12/06/vjZVS19MN2A4hoD.png\" alt> </p>\n<ul>\n<li>If prompted, confirm your GitHub password.</li>\n</ul>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h3 id=\"1-When-i-download-files-from-GitHub-Failed-to-connect-to-127-0-0-1-port-1080-Connection-refused\"><a href=\"#1-When-i-download-files-from-GitHub-Failed-to-connect-to-127-0-0-1-port-1080-Connection-refused\" class=\"headerlink\" title=\"1. When i download files from GitHub, Failed to connect to 127.0.0.1 port 1080: Connection refused\"></a>1. When i download files from GitHub, <code>Failed to connect to 127.0.0.1 port 1080: Connection refused</code></h3><ol>\n<li>Find wheather you are using proxy server or not.</li>\n</ol>\n<pre><code class=\"bash\">git config --global http.proxy</code></pre>\n<ol start=\"2\">\n<li>Cancel the proxy server.</li>\n</ol>\n<pre><code class=\"bash\">git config --global --unset http.proxy</code></pre>\n<h3 id=\"2-Clone-with-SSH-Github-guide\"><a href=\"#2-Clone-with-SSH-Github-guide\" class=\"headerlink\" title=\"2. Clone with SSH (Github guide)\"></a>2. Clone with SSH (<a href=\"https://help.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh\" target=\"_blank\" rel=\"noopener\">Github guide</a>)</h3><ul>\n<li>Install Openssh</li>\n</ul>\n<pre><code class=\"bash\">sudo pacman -S openssh</code></pre>\n<ul>\n<li>Generating a new SSH key</li>\n</ul>\n<pre><code class=\"bash\">ssh-keygen</code></pre>\n<p><img src=\"https://i.loli.net/2019/12/06/foZjquaH75Jnw3Y.png\" alt> </p>\n<pre><code class=\"bash\">tree .ssh</code></pre>\n<p><img src=\"https://i.loli.net/2019/12/06/oKIUzYLRcp4OhyE.png\" alt> </p>\n<ul>\n<li>Copy the SSH key to your clipboard</li>\n</ul>\n<pre><code class=\"bash\">cat .ssh/id_rsa.pub</code></pre>\n<ul>\n<li>In the upper-right corner of any page, click your profile photo, then click <strong>Settings</strong></li>\n</ul>\n<p><img src=\"https://i.loli.net/2019/12/06/hIA7KpbfmYMJ14j.png\" alt></p>\n<ul>\n<li><p>In the user settings sidebar, click <strong>SSH and GPG keys</strong></p>\n</li>\n<li><p>Click <strong>New SSH key</strong> or <strong>Add SSH key</strong>.</p>\n</li>\n<li><p>In the “Title” field, add a descriptive label for the new key. For example, if you’re using arch linux, you might call this key “Arch linux”</p>\n</li>\n<li><p>Paste your key into the “Key” field.</p>\n</li>\n</ul>\n<p><img src=\"https://i.loli.net/2019/12/06/vjZVS19MN2A4hoD.png\" alt> </p>\n<ul>\n<li>If prompted, confirm your GitHub password.</li>\n</ul>\n"},{"title":"High-quality-ellipse-detection","top":false,"cover":false,"img":"https://i.loli.net/2019/08/15/BMeGUIZqhdRCKgF.jpg","toc":true,"mathjax":false,"date":"2019-07-29T05:01:50.000Z","password":null,"summary":"高精度椭圆检测","_content":"\n# High-quality-ellipse-detection\n\n个人环境:Matlab 2019a、VS2017、Opencv3.4.4，64位Windows操作系统\n\n## OpenCV环境配置请看这篇\n[OpenCV入坑指南:环境搭建篇](https://godliuyang.wang/2019/07/25/opencv-ru-keng-zhi-nan-huan-jing-da-jian-pian/)\n## MatLab和C++混合编程环境配置\n\nMatlab的安装这里不再说    \n1. 在命令行里输入 `mex -setup`，选择vs就行了\n2. 执行 `mex -setup C++`完成配置\n![](https://i.loli.net/2019/07/29/5d3ea6561215b10575.png)\n![](https://i.loli.net/2019/07/29/5d3eaa19b300f42041.png)\n\n## 下载Github文件\n\ndownload Zip即可\n\n\n## 导入依赖文件\n\n将 **D:\\OpenCV\\opencv\\build\\x64\\vc15\\lib**下的 **opencv_world344.lib**文件复制到你的Matlab安装路径下的 **microsoft**文件夹下,我的是 **D:\\MATLAB\\R2019a\\extern\\lib\\win64\\microsoft**\n\n![](https://i.loli.net/2019/07/29/5d3ea6564f0b271051.png)\n![](https://i.loli.net/2019/07/29/5d3ea6564ed8016435.png)\n## 在Matlab中导入文件\n\n## 在命令行执行以下命令\n\n注意作者的命令为:\n\n```matlab\nmex generateEllipseCandidates.cpp -IF:\\OpenCV\\opencv2.4.9\\build\\include -IF:\\OpenCV\\opencv2.4.9\\build\\include\\opencv -IF:\\OpenCV\\opencv2.4.9\\build\\include\\opencv2 -LF:\\OpenCV\\opencv2.4.9\\build\\x64\\vc11\\lib -IF:\\Matlab\\settlein\\extern\\include -LF:\\Matlab\\settlein\\extern\\lib\\win64\\microsoft -lopencv_core249 -lopencv_highgui249 -lopencv_imgproc249 -llibmwlapack.lib\n```\n\n把OpenCV和Matlab的相关文件的路径改成你的安装路径    \n我这里版本号为OpenCV3.4.4,安装路径如下,\n![](https://i.loli.net/2019/07/29/5d3ea6561fbd474647.png)\n故修改为`D:\\OpenCV\\opencv\\build...`,    \n由于OpenCV3.4.4只有 **opencv_world344.lib** 这一个lib文件，故将 `LF:\\Matlab\\settlein\\extern\\lib\\win64\\microsoft -lopencv_core249 -lopencv_highgui249 -lopencv_imgproc249 -llibmwlapack.lib`　修改为 `LD:\\Matlab\\R2019a\\extern\\lib\\win64\\microsoft -lopencv_world344 -llibmwlapack.lib`\n\n完整的命令为:\n\n```matlab\nmex generateEllipseCandidates.cpp -ID:\\OpenCV\\opencv\\build\\include \n-ID:\\OpenCV\\opencv\\build\\include\\opencv -ID:\\OpenCV\\opencv\\build\\include\\opencv2 \n-LD:\\OpenCV\\opencv\\build\\x64\\vc15\\lib \n-ID:\\Matlab\\R2019a\\include -LD:\\Matlab\\R2019a\\extern\\lib\\win64\\microsoft -lopencv_world344 -llibmwlapack.lib\n\n```\n\n![](https://i.loli.net/2019/07/29/5d3ea65639bdf67747.png)\n编译成功之后生成`generateEllipseCandidates.mexw64`文件\n![](https://i.loli.net/2019/07/29/5d3ea6564e0c183020.png)\n之后再运行`LCS_ellipse.m`\n![7.png](https://i.loli.net/2019/07/29/5d3ea657cb9e659639.png)\n\n##　报错解决办法\n1. 如图\n![](https://i.loli.net/2019/07/29/5d3eabf1c942443319.png)\n在.cpp文件中添加\n\n```cpp\nusing namespace std\n```\n2. 如图\n\n![](https://i.loli.net/2019/07/29/5d3eabf1d457769964.png)\n缺少lib文件，检查一下是不是配置出错了\n\n\n参考文献:\n1. [Arc-support Line Segments Revisited: An Efficient and High-quality Ellipse Detection](https://github.com/AlanLuSun/High-quality-ellipse-detection)\n","source":"_posts/High-quality-ellipse-detection.md","raw":"---\ntitle: High-quality-ellipse-detection\ntop: false\ncover: false\nimg: https://i.loli.net/2019/08/15/BMeGUIZqhdRCKgF.jpg\ntoc: true\nmathjax: false\ndate: 2019-07-29 13:01:50\npassword:\nsummary: 高精度椭圆检测 \ntags:\n- 图像处理\n- Matlab\n- OpenCV\n- c++\ncategories:\n- Open Source\n---\n\n# High-quality-ellipse-detection\n\n个人环境:Matlab 2019a、VS2017、Opencv3.4.4，64位Windows操作系统\n\n## OpenCV环境配置请看这篇\n[OpenCV入坑指南:环境搭建篇](https://godliuyang.wang/2019/07/25/opencv-ru-keng-zhi-nan-huan-jing-da-jian-pian/)\n## MatLab和C++混合编程环境配置\n\nMatlab的安装这里不再说    \n1. 在命令行里输入 `mex -setup`，选择vs就行了\n2. 执行 `mex -setup C++`完成配置\n![](https://i.loli.net/2019/07/29/5d3ea6561215b10575.png)\n![](https://i.loli.net/2019/07/29/5d3eaa19b300f42041.png)\n\n## 下载Github文件\n\ndownload Zip即可\n\n\n## 导入依赖文件\n\n将 **D:\\OpenCV\\opencv\\build\\x64\\vc15\\lib**下的 **opencv_world344.lib**文件复制到你的Matlab安装路径下的 **microsoft**文件夹下,我的是 **D:\\MATLAB\\R2019a\\extern\\lib\\win64\\microsoft**\n\n![](https://i.loli.net/2019/07/29/5d3ea6564f0b271051.png)\n![](https://i.loli.net/2019/07/29/5d3ea6564ed8016435.png)\n## 在Matlab中导入文件\n\n## 在命令行执行以下命令\n\n注意作者的命令为:\n\n```matlab\nmex generateEllipseCandidates.cpp -IF:\\OpenCV\\opencv2.4.9\\build\\include -IF:\\OpenCV\\opencv2.4.9\\build\\include\\opencv -IF:\\OpenCV\\opencv2.4.9\\build\\include\\opencv2 -LF:\\OpenCV\\opencv2.4.9\\build\\x64\\vc11\\lib -IF:\\Matlab\\settlein\\extern\\include -LF:\\Matlab\\settlein\\extern\\lib\\win64\\microsoft -lopencv_core249 -lopencv_highgui249 -lopencv_imgproc249 -llibmwlapack.lib\n```\n\n把OpenCV和Matlab的相关文件的路径改成你的安装路径    \n我这里版本号为OpenCV3.4.4,安装路径如下,\n![](https://i.loli.net/2019/07/29/5d3ea6561fbd474647.png)\n故修改为`D:\\OpenCV\\opencv\\build...`,    \n由于OpenCV3.4.4只有 **opencv_world344.lib** 这一个lib文件，故将 `LF:\\Matlab\\settlein\\extern\\lib\\win64\\microsoft -lopencv_core249 -lopencv_highgui249 -lopencv_imgproc249 -llibmwlapack.lib`　修改为 `LD:\\Matlab\\R2019a\\extern\\lib\\win64\\microsoft -lopencv_world344 -llibmwlapack.lib`\n\n完整的命令为:\n\n```matlab\nmex generateEllipseCandidates.cpp -ID:\\OpenCV\\opencv\\build\\include \n-ID:\\OpenCV\\opencv\\build\\include\\opencv -ID:\\OpenCV\\opencv\\build\\include\\opencv2 \n-LD:\\OpenCV\\opencv\\build\\x64\\vc15\\lib \n-ID:\\Matlab\\R2019a\\include -LD:\\Matlab\\R2019a\\extern\\lib\\win64\\microsoft -lopencv_world344 -llibmwlapack.lib\n\n```\n\n![](https://i.loli.net/2019/07/29/5d3ea65639bdf67747.png)\n编译成功之后生成`generateEllipseCandidates.mexw64`文件\n![](https://i.loli.net/2019/07/29/5d3ea6564e0c183020.png)\n之后再运行`LCS_ellipse.m`\n![7.png](https://i.loli.net/2019/07/29/5d3ea657cb9e659639.png)\n\n##　报错解决办法\n1. 如图\n![](https://i.loli.net/2019/07/29/5d3eabf1c942443319.png)\n在.cpp文件中添加\n\n```cpp\nusing namespace std\n```\n2. 如图\n\n![](https://i.loli.net/2019/07/29/5d3eabf1d457769964.png)\n缺少lib文件，检查一下是不是配置出错了\n\n\n参考文献:\n1. [Arc-support Line Segments Revisited: An Efficient and High-quality Ellipse Detection](https://github.com/AlanLuSun/High-quality-ellipse-detection)\n","slug":"High-quality-ellipse-detection","published":1,"updated":"2020-02-24T10:49:41.358Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0t4000v74ju9no20563","content":"<h1 id=\"High-quality-ellipse-detection\"><a href=\"#High-quality-ellipse-detection\" class=\"headerlink\" title=\"High-quality-ellipse-detection\"></a>High-quality-ellipse-detection</h1><p>个人环境:Matlab 2019a、VS2017、Opencv3.4.4，64位Windows操作系统</p>\n<h2 id=\"OpenCV环境配置请看这篇\"><a href=\"#OpenCV环境配置请看这篇\" class=\"headerlink\" title=\"OpenCV环境配置请看这篇\"></a>OpenCV环境配置请看这篇</h2><p><a href=\"https://godliuyang.wang/2019/07/25/opencv-ru-keng-zhi-nan-huan-jing-da-jian-pian/\" target=\"_blank\" rel=\"noopener\">OpenCV入坑指南:环境搭建篇</a></p>\n<h2 id=\"MatLab和C-混合编程环境配置\"><a href=\"#MatLab和C-混合编程环境配置\" class=\"headerlink\" title=\"MatLab和C++混合编程环境配置\"></a>MatLab和C++混合编程环境配置</h2><p>Matlab的安装这里不再说    </p>\n<ol>\n<li>在命令行里输入 <code>mex -setup</code>，选择vs就行了</li>\n<li>执行 <code>mex -setup C++</code>完成配置<br><img src=\"https://i.loli.net/2019/07/29/5d3ea6561215b10575.png\" alt><br><img src=\"https://i.loli.net/2019/07/29/5d3eaa19b300f42041.png\" alt></li>\n</ol>\n<h2 id=\"下载Github文件\"><a href=\"#下载Github文件\" class=\"headerlink\" title=\"下载Github文件\"></a>下载Github文件</h2><p>download Zip即可</p>\n<h2 id=\"导入依赖文件\"><a href=\"#导入依赖文件\" class=\"headerlink\" title=\"导入依赖文件\"></a>导入依赖文件</h2><p>将 <strong>D:\\OpenCV\\opencv\\build\\x64\\vc15\\lib</strong>下的 <strong>opencv_world344.lib</strong>文件复制到你的Matlab安装路径下的 <strong>microsoft</strong>文件夹下,我的是 <strong>D:\\MATLAB\\R2019a\\extern\\lib\\win64\\microsoft</strong></p>\n<p><img src=\"https://i.loli.net/2019/07/29/5d3ea6564f0b271051.png\" alt><br><img src=\"https://i.loli.net/2019/07/29/5d3ea6564ed8016435.png\" alt></p>\n<h2 id=\"在Matlab中导入文件\"><a href=\"#在Matlab中导入文件\" class=\"headerlink\" title=\"在Matlab中导入文件\"></a>在Matlab中导入文件</h2><h2 id=\"在命令行执行以下命令\"><a href=\"#在命令行执行以下命令\" class=\"headerlink\" title=\"在命令行执行以下命令\"></a>在命令行执行以下命令</h2><p>注意作者的命令为:</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">mex generateEllipseCandidates<span class=\"token punctuation\">.</span>cpp <span class=\"token operator\">-</span>IF<span class=\"token operator\">:</span><span class=\"token operator\">\\</span>OpenCV<span class=\"token operator\">\\</span>opencv2<span class=\"token number\">.4</span><span class=\"token punctuation\">.</span><span class=\"token number\">9</span><span class=\"token operator\">\\</span>build<span class=\"token operator\">\\</span>include <span class=\"token operator\">-</span>IF<span class=\"token operator\">:</span><span class=\"token operator\">\\</span>OpenCV<span class=\"token operator\">\\</span>opencv2<span class=\"token number\">.4</span><span class=\"token punctuation\">.</span><span class=\"token number\">9</span><span class=\"token operator\">\\</span>build<span class=\"token operator\">\\</span>include<span class=\"token operator\">\\</span>opencv <span class=\"token operator\">-</span>IF<span class=\"token operator\">:</span><span class=\"token operator\">\\</span>OpenCV<span class=\"token operator\">\\</span>opencv2<span class=\"token number\">.4</span><span class=\"token punctuation\">.</span><span class=\"token number\">9</span><span class=\"token operator\">\\</span>build<span class=\"token operator\">\\</span>include<span class=\"token operator\">\\</span>opencv2 <span class=\"token operator\">-</span>LF<span class=\"token operator\">:</span><span class=\"token operator\">\\</span>OpenCV<span class=\"token operator\">\\</span>opencv2<span class=\"token number\">.4</span><span class=\"token punctuation\">.</span><span class=\"token number\">9</span><span class=\"token operator\">\\</span>build<span class=\"token operator\">\\</span>x64<span class=\"token operator\">\\</span>vc11<span class=\"token operator\">\\</span>lib <span class=\"token operator\">-</span>IF<span class=\"token operator\">:</span><span class=\"token operator\">\\</span>Matlab<span class=\"token operator\">\\</span>settlein<span class=\"token operator\">\\</span>extern<span class=\"token operator\">\\</span>include <span class=\"token operator\">-</span>LF<span class=\"token operator\">:</span><span class=\"token operator\">\\</span>Matlab<span class=\"token operator\">\\</span>settlein<span class=\"token operator\">\\</span>extern<span class=\"token operator\">\\</span>lib<span class=\"token operator\">\\</span>win64<span class=\"token operator\">\\</span>microsoft <span class=\"token operator\">-</span>lopencv_core249 <span class=\"token operator\">-</span>lopencv_highgui249 <span class=\"token operator\">-</span>lopencv_imgproc249 <span class=\"token operator\">-</span>llibmwlapack<span class=\"token punctuation\">.</span>lib</code></pre>\n<p>把OpenCV和Matlab的相关文件的路径改成你的安装路径<br>我这里版本号为OpenCV3.4.4,安装路径如下,<br><img src=\"https://i.loli.net/2019/07/29/5d3ea6561fbd474647.png\" alt><br>故修改为<code>D:\\OpenCV\\opencv\\build...</code>,<br>由于OpenCV3.4.4只有 <strong>opencv_world344.lib</strong> 这一个lib文件，故将 <code>LF:\\Matlab\\settlein\\extern\\lib\\win64\\microsoft -lopencv_core249 -lopencv_highgui249 -lopencv_imgproc249 -llibmwlapack.lib</code>　修改为 <code>LD:\\Matlab\\R2019a\\extern\\lib\\win64\\microsoft -lopencv_world344 -llibmwlapack.lib</code></p>\n<p>完整的命令为:</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">mex generateEllipseCandidates<span class=\"token punctuation\">.</span>cpp <span class=\"token operator\">-</span>ID<span class=\"token operator\">:</span><span class=\"token operator\">\\</span>OpenCV<span class=\"token operator\">\\</span>opencv<span class=\"token operator\">\\</span>build<span class=\"token operator\">\\</span>include \n<span class=\"token operator\">-</span>ID<span class=\"token operator\">:</span><span class=\"token operator\">\\</span>OpenCV<span class=\"token operator\">\\</span>opencv<span class=\"token operator\">\\</span>build<span class=\"token operator\">\\</span>include<span class=\"token operator\">\\</span>opencv <span class=\"token operator\">-</span>ID<span class=\"token operator\">:</span><span class=\"token operator\">\\</span>OpenCV<span class=\"token operator\">\\</span>opencv<span class=\"token operator\">\\</span>build<span class=\"token operator\">\\</span>include<span class=\"token operator\">\\</span>opencv2 \n<span class=\"token operator\">-</span>LD<span class=\"token operator\">:</span><span class=\"token operator\">\\</span>OpenCV<span class=\"token operator\">\\</span>opencv<span class=\"token operator\">\\</span>build<span class=\"token operator\">\\</span>x64<span class=\"token operator\">\\</span>vc15<span class=\"token operator\">\\</span>lib \n<span class=\"token operator\">-</span>ID<span class=\"token operator\">:</span><span class=\"token operator\">\\</span>Matlab<span class=\"token operator\">\\</span>R2019a<span class=\"token operator\">\\</span>include <span class=\"token operator\">-</span>LD<span class=\"token operator\">:</span><span class=\"token operator\">\\</span>Matlab<span class=\"token operator\">\\</span>R2019a<span class=\"token operator\">\\</span>extern<span class=\"token operator\">\\</span>lib<span class=\"token operator\">\\</span>win64<span class=\"token operator\">\\</span>microsoft <span class=\"token operator\">-</span>lopencv_world344 <span class=\"token operator\">-</span>llibmwlapack<span class=\"token punctuation\">.</span>lib\n</code></pre>\n<p><img src=\"https://i.loli.net/2019/07/29/5d3ea65639bdf67747.png\" alt><br>编译成功之后生成<code>generateEllipseCandidates.mexw64</code>文件<br><img src=\"https://i.loli.net/2019/07/29/5d3ea6564e0c183020.png\" alt><br>之后再运行<code>LCS_ellipse.m</code><br><img src=\"https://i.loli.net/2019/07/29/5d3ea657cb9e659639.png\" alt=\"7.png\"></p>\n<p>##　报错解决办法</p>\n<ol>\n<li>如图<br><img src=\"https://i.loli.net/2019/07/29/5d3eabf1c942443319.png\" alt><br>在.cpp文件中添加</li>\n</ol>\n<pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> std</code></pre>\n<ol start=\"2\">\n<li>如图</li>\n</ol>\n<p><img src=\"https://i.loli.net/2019/07/29/5d3eabf1d457769964.png\" alt><br>缺少lib文件，检查一下是不是配置出错了</p>\n<p>参考文献:</p>\n<ol>\n<li><a href=\"https://github.com/AlanLuSun/High-quality-ellipse-detection\" target=\"_blank\" rel=\"noopener\">Arc-support Line Segments Revisited: An Efficient and High-quality Ellipse Detection</a></li>\n</ol>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"High-quality-ellipse-detection\"><a href=\"#High-quality-ellipse-detection\" class=\"headerlink\" title=\"High-quality-ellipse-detection\"></a>High-quality-ellipse-detection</h1><p>个人环境:Matlab 2019a、VS2017、Opencv3.4.4，64位Windows操作系统</p>\n<h2 id=\"OpenCV环境配置请看这篇\"><a href=\"#OpenCV环境配置请看这篇\" class=\"headerlink\" title=\"OpenCV环境配置请看这篇\"></a>OpenCV环境配置请看这篇</h2><p><a href=\"https://godliuyang.wang/2019/07/25/opencv-ru-keng-zhi-nan-huan-jing-da-jian-pian/\" target=\"_blank\" rel=\"noopener\">OpenCV入坑指南:环境搭建篇</a></p>\n<h2 id=\"MatLab和C-混合编程环境配置\"><a href=\"#MatLab和C-混合编程环境配置\" class=\"headerlink\" title=\"MatLab和C++混合编程环境配置\"></a>MatLab和C++混合编程环境配置</h2><p>Matlab的安装这里不再说    </p>\n<ol>\n<li>在命令行里输入 <code>mex -setup</code>，选择vs就行了</li>\n<li>执行 <code>mex -setup C++</code>完成配置<br><img src=\"https://i.loli.net/2019/07/29/5d3ea6561215b10575.png\" alt><br><img src=\"https://i.loli.net/2019/07/29/5d3eaa19b300f42041.png\" alt></li>\n</ol>\n<h2 id=\"下载Github文件\"><a href=\"#下载Github文件\" class=\"headerlink\" title=\"下载Github文件\"></a>下载Github文件</h2><p>download Zip即可</p>\n<h2 id=\"导入依赖文件\"><a href=\"#导入依赖文件\" class=\"headerlink\" title=\"导入依赖文件\"></a>导入依赖文件</h2><p>将 <strong>D:\\OpenCV\\opencv\\build\\x64\\vc15\\lib</strong>下的 <strong>opencv_world344.lib</strong>文件复制到你的Matlab安装路径下的 <strong>microsoft</strong>文件夹下,我的是 <strong>D:\\MATLAB\\R2019a\\extern\\lib\\win64\\microsoft</strong></p>\n<p><img src=\"https://i.loli.net/2019/07/29/5d3ea6564f0b271051.png\" alt><br><img src=\"https://i.loli.net/2019/07/29/5d3ea6564ed8016435.png\" alt></p>\n<h2 id=\"在Matlab中导入文件\"><a href=\"#在Matlab中导入文件\" class=\"headerlink\" title=\"在Matlab中导入文件\"></a>在Matlab中导入文件</h2><h2 id=\"在命令行执行以下命令\"><a href=\"#在命令行执行以下命令\" class=\"headerlink\" title=\"在命令行执行以下命令\"></a>在命令行执行以下命令</h2><p>注意作者的命令为:</p>\n<pre><code class=\"matlab\">mex generateEllipseCandidates.cpp -IF:\\OpenCV\\opencv2.4.9\\build\\include -IF:\\OpenCV\\opencv2.4.9\\build\\include\\opencv -IF:\\OpenCV\\opencv2.4.9\\build\\include\\opencv2 -LF:\\OpenCV\\opencv2.4.9\\build\\x64\\vc11\\lib -IF:\\Matlab\\settlein\\extern\\include -LF:\\Matlab\\settlein\\extern\\lib\\win64\\microsoft -lopencv_core249 -lopencv_highgui249 -lopencv_imgproc249 -llibmwlapack.lib</code></pre>\n<p>把OpenCV和Matlab的相关文件的路径改成你的安装路径<br>我这里版本号为OpenCV3.4.4,安装路径如下,<br><img src=\"https://i.loli.net/2019/07/29/5d3ea6561fbd474647.png\" alt><br>故修改为<code>D:\\OpenCV\\opencv\\build...</code>,<br>由于OpenCV3.4.4只有 <strong>opencv_world344.lib</strong> 这一个lib文件，故将 <code>LF:\\Matlab\\settlein\\extern\\lib\\win64\\microsoft -lopencv_core249 -lopencv_highgui249 -lopencv_imgproc249 -llibmwlapack.lib</code>　修改为 <code>LD:\\Matlab\\R2019a\\extern\\lib\\win64\\microsoft -lopencv_world344 -llibmwlapack.lib</code></p>\n<p>完整的命令为:</p>\n<pre><code class=\"matlab\">mex generateEllipseCandidates.cpp -ID:\\OpenCV\\opencv\\build\\include \n-ID:\\OpenCV\\opencv\\build\\include\\opencv -ID:\\OpenCV\\opencv\\build\\include\\opencv2 \n-LD:\\OpenCV\\opencv\\build\\x64\\vc15\\lib \n-ID:\\Matlab\\R2019a\\include -LD:\\Matlab\\R2019a\\extern\\lib\\win64\\microsoft -lopencv_world344 -llibmwlapack.lib\n</code></pre>\n<p><img src=\"https://i.loli.net/2019/07/29/5d3ea65639bdf67747.png\" alt><br>编译成功之后生成<code>generateEllipseCandidates.mexw64</code>文件<br><img src=\"https://i.loli.net/2019/07/29/5d3ea6564e0c183020.png\" alt><br>之后再运行<code>LCS_ellipse.m</code><br><img src=\"https://i.loli.net/2019/07/29/5d3ea657cb9e659639.png\" alt=\"7.png\"></p>\n<p>##　报错解决办法</p>\n<ol>\n<li>如图<br><img src=\"https://i.loli.net/2019/07/29/5d3eabf1c942443319.png\" alt><br>在.cpp文件中添加</li>\n</ol>\n<pre><code class=\"cpp\">using namespace std</code></pre>\n<ol start=\"2\">\n<li>如图</li>\n</ol>\n<p><img src=\"https://i.loli.net/2019/07/29/5d3eabf1d457769964.png\" alt><br>缺少lib文件，检查一下是不是配置出错了</p>\n<p>参考文献:</p>\n<ol>\n<li><a href=\"https://github.com/AlanLuSun/High-quality-ellipse-detection\" target=\"_blank\" rel=\"noopener\">Arc-support Line Segments Revisited: An Efficient and High-quality Ellipse Detection</a></li>\n</ol>\n"},{"title":"Horner's Method","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-02-02T11:54:55.000Z","img":null,"password":null,"summary":"Horner's Method","_content":"\n### Function vs Polynomial\n\n- f(x) means a function, any function\n  - $$ f(x) = \\sin (e^x) + \\ln ( \\frac{1}{x^2+1} ) $$\n  - $$ f(x) = \\alpha x^3 - \\arctan(x) $$\n- p(x) means a polynomial function\n  - $$ p(x) = dx^3 + cx^2 + bx + a $$\n  - $$ p(x) = a + bx + cx^2 + dx^3 $$\n- evaluating p(x) can be slow\n  - $$ p(x) = a + bx + cx^2 + dx^3 $$\n  - $$ p(x) = a + b \\times x + c \\times x \\times x + d \\times x \\times x \\times x $$\n\nIt include **4 additions** and **6 multiplications**\n### Horner's Method\n\n- Rewrite p(x)\n  - $$ p(x) = a + bx + cx^2 + dx^3 $$\n  - $$ p(x) = a + bx + x(cx + dx^2) $$\n  - $$ p(x) = a + x(b + x(cx + dx)) $$\n  - $$ p(x) = a + x \\times (b + x \\times (c + d \\times x)) $$\n\n\nIt include **3 additions** and **3 multiplications**\n\n- In terms of $a_n$\n  - $$ p(x) = a_0 + a_1x + a_2x^2 + a_3x^3 + \\cdots + a_nx^n $$\n  - $$ p(x) = a_0x^0 + a_1x + a_2x^2 + a_3x^3 + \\cdots + a_nx^n  = \\sum_{i=0}^{n} a_i x^i $$\n  - $$ p(x) = a_0 +x(a_1 + x(a_2 + \\cdots + x(a_{n-1} + xa_n    ) \\cdots )) $$\n  - $$p(x) = p_0(x) where p_i(x) = \\begin{cases} a_i + x \\times p_{i+1}(x), if i < n \\\\ a_n, if i = n \\end{cases}$$\n\n#### Pseudocode\n\nGive the value of coefficient $a_0$, $a_1$, $\\cdots$, $a_n$ and $x$.\n\n```python\ny = 0\nfor i = n downto 0\n  y = a_i + xy\n```\n\n  \n\n\n\n","source":"_posts/Horner-s-Method.md","raw":"---\ntitle: Horner's Method\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-02-02 19:54:55\nimg:\npassword:\nsummary: Horner's Method\ntags:\ncategories:\n---\n\n### Function vs Polynomial\n\n- f(x) means a function, any function\n  - $$ f(x) = \\sin (e^x) + \\ln ( \\frac{1}{x^2+1} ) $$\n  - $$ f(x) = \\alpha x^3 - \\arctan(x) $$\n- p(x) means a polynomial function\n  - $$ p(x) = dx^3 + cx^2 + bx + a $$\n  - $$ p(x) = a + bx + cx^2 + dx^3 $$\n- evaluating p(x) can be slow\n  - $$ p(x) = a + bx + cx^2 + dx^3 $$\n  - $$ p(x) = a + b \\times x + c \\times x \\times x + d \\times x \\times x \\times x $$\n\nIt include **4 additions** and **6 multiplications**\n### Horner's Method\n\n- Rewrite p(x)\n  - $$ p(x) = a + bx + cx^2 + dx^3 $$\n  - $$ p(x) = a + bx + x(cx + dx^2) $$\n  - $$ p(x) = a + x(b + x(cx + dx)) $$\n  - $$ p(x) = a + x \\times (b + x \\times (c + d \\times x)) $$\n\n\nIt include **3 additions** and **3 multiplications**\n\n- In terms of $a_n$\n  - $$ p(x) = a_0 + a_1x + a_2x^2 + a_3x^3 + \\cdots + a_nx^n $$\n  - $$ p(x) = a_0x^0 + a_1x + a_2x^2 + a_3x^3 + \\cdots + a_nx^n  = \\sum_{i=0}^{n} a_i x^i $$\n  - $$ p(x) = a_0 +x(a_1 + x(a_2 + \\cdots + x(a_{n-1} + xa_n    ) \\cdots )) $$\n  - $$p(x) = p_0(x) where p_i(x) = \\begin{cases} a_i + x \\times p_{i+1}(x), if i < n \\\\ a_n, if i = n \\end{cases}$$\n\n#### Pseudocode\n\nGive the value of coefficient $a_0$, $a_1$, $\\cdots$, $a_n$ and $x$.\n\n```python\ny = 0\nfor i = n downto 0\n  y = a_i + xy\n```\n\n  \n\n\n\n","slug":"Horner-s-Method","published":1,"updated":"2020-02-24T10:49:41.358Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0t5000x74juxwd9ywnt","content":"<h3 id=\"Function-vs-Polynomial\"><a href=\"#Function-vs-Polynomial\" class=\"headerlink\" title=\"Function vs Polynomial\"></a>Function vs Polynomial</h3><ul>\n<li>f(x) means a function, any function<ul>\n<li>$$ f(x) = \\sin (e^x) + \\ln ( \\frac{1}{x^2+1} ) $$</li>\n<li>$$ f(x) = \\alpha x^3 - \\arctan(x) $$</li>\n</ul>\n</li>\n<li>p(x) means a polynomial function<ul>\n<li>$$ p(x) = dx^3 + cx^2 + bx + a $$</li>\n<li>$$ p(x) = a + bx + cx^2 + dx^3 $$</li>\n</ul>\n</li>\n<li>evaluating p(x) can be slow<ul>\n<li>$$ p(x) = a + bx + cx^2 + dx^3 $$</li>\n<li>$$ p(x) = a + b \\times x + c \\times x \\times x + d \\times x \\times x \\times x $$</li>\n</ul>\n</li>\n</ul>\n<p>It include <strong>4 additions</strong> and <strong>6 multiplications</strong></p>\n<h3 id=\"Horner’s-Method\"><a href=\"#Horner’s-Method\" class=\"headerlink\" title=\"Horner’s Method\"></a>Horner’s Method</h3><ul>\n<li>Rewrite p(x)<ul>\n<li>$$ p(x) = a + bx + cx^2 + dx^3 $$</li>\n<li>$$ p(x) = a + bx + x(cx + dx^2) $$</li>\n<li>$$ p(x) = a + x(b + x(cx + dx)) $$</li>\n<li>$$ p(x) = a + x \\times (b + x \\times (c + d \\times x)) $$</li>\n</ul>\n</li>\n</ul>\n<p>It include <strong>3 additions</strong> and <strong>3 multiplications</strong></p>\n<ul>\n<li>In terms of $a_n$<ul>\n<li>$$ p(x) = a_0 + a_1x + a_2x^2 + a_3x^3 + \\cdots + a_nx^n $$</li>\n<li>$$ p(x) = a_0x^0 + a_1x + a_2x^2 + a_3x^3 + \\cdots + a_nx^n  = \\sum_{i=0}^{n} a_i x^i $$</li>\n<li>$$ p(x) = a_0 +x(a_1 + x(a_2 + \\cdots + x(a_{n-1} + xa_n    ) \\cdots )) $$</li>\n<li>$$p(x) = p_0(x) where p_i(x) = \\begin{cases} a_i + x \\times p_{i+1}(x), if i &lt; n \\\\ a_n, if i = n \\end{cases}$$</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"Pseudocode\"><a href=\"#Pseudocode\" class=\"headerlink\" title=\"Pseudocode\"></a>Pseudocode</h4><p>Give the value of coefficient $a_0$, $a_1$, $\\cdots$, $a_n$ and $x$.</p>\n<pre class=\" language-python\"><code class=\"language-python\">y <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">for</span> i <span class=\"token operator\">=</span> n downto <span class=\"token number\">0</span>\n  y <span class=\"token operator\">=</span> a_i <span class=\"token operator\">+</span> xy</code></pre>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h3 id=\"Function-vs-Polynomial\"><a href=\"#Function-vs-Polynomial\" class=\"headerlink\" title=\"Function vs Polynomial\"></a>Function vs Polynomial</h3><ul>\n<li>f(x) means a function, any function<ul>\n<li>$$ f(x) = \\sin (e^x) + \\ln ( \\frac{1}{x^2+1} ) $$</li>\n<li>$$ f(x) = \\alpha x^3 - \\arctan(x) $$</li>\n</ul>\n</li>\n<li>p(x) means a polynomial function<ul>\n<li>$$ p(x) = dx^3 + cx^2 + bx + a $$</li>\n<li>$$ p(x) = a + bx + cx^2 + dx^3 $$</li>\n</ul>\n</li>\n<li>evaluating p(x) can be slow<ul>\n<li>$$ p(x) = a + bx + cx^2 + dx^3 $$</li>\n<li>$$ p(x) = a + b \\times x + c \\times x \\times x + d \\times x \\times x \\times x $$</li>\n</ul>\n</li>\n</ul>\n<p>It include <strong>4 additions</strong> and <strong>6 multiplications</strong></p>\n<h3 id=\"Horner’s-Method\"><a href=\"#Horner’s-Method\" class=\"headerlink\" title=\"Horner’s Method\"></a>Horner’s Method</h3><ul>\n<li>Rewrite p(x)<ul>\n<li>$$ p(x) = a + bx + cx^2 + dx^3 $$</li>\n<li>$$ p(x) = a + bx + x(cx + dx^2) $$</li>\n<li>$$ p(x) = a + x(b + x(cx + dx)) $$</li>\n<li>$$ p(x) = a + x \\times (b + x \\times (c + d \\times x)) $$</li>\n</ul>\n</li>\n</ul>\n<p>It include <strong>3 additions</strong> and <strong>3 multiplications</strong></p>\n<ul>\n<li>In terms of $a_n$<ul>\n<li>$$ p(x) = a_0 + a_1x + a_2x^2 + a_3x^3 + \\cdots + a_nx^n $$</li>\n<li>$$ p(x) = a_0x^0 + a_1x + a_2x^2 + a_3x^3 + \\cdots + a_nx^n  = \\sum_{i=0}^{n} a_i x^i $$</li>\n<li>$$ p(x) = a_0 +x(a_1 + x(a_2 + \\cdots + x(a_{n-1} + xa_n    ) \\cdots )) $$</li>\n<li>$$p(x) = p_0(x) where p_i(x) = \\begin{cases} a_i + x \\times p_{i+1}(x), if i &lt; n \\\\ a_n, if i = n \\end{cases}$$</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"Pseudocode\"><a href=\"#Pseudocode\" class=\"headerlink\" title=\"Pseudocode\"></a>Pseudocode</h4><p>Give the value of coefficient $a_0$, $a_1$, $\\cdots$, $a_n$ and $x$.</p>\n<pre><code class=\"python\">y = 0\nfor i = n downto 0\n  y = a_i + xy</code></pre>\n"},{"title":"How to install OpenCV and OpenCV_contrib in Ubuntu16.04","top":false,"cover":false,"img":"https://i.loli.net/2019/08/15/T7lJf18cUGmQnHh.jpg","toc":true,"mathjax":true,"date":"2019-08-09T03:49:11.000Z","password":null,"summary":null,"_content":"","source":"_posts/How-to-install-OpenCV-and-OpenCV-contrib-in-Ubuntu16-04.md","raw":"---\ntitle: How to install OpenCV and OpenCV_contrib in Ubuntu16.04\ntop: false\ncover: false\nimg: https://i.loli.net/2019/08/15/T7lJf18cUGmQnHh.jpg\ntoc: true\nmathjax: true\ndate: 2019-08-09 11:49:11\npassword:\nsummary:\ntags:\ncategories:\n---\n","slug":"How-to-install-OpenCV-and-OpenCV-contrib-in-Ubuntu16-04","published":1,"updated":"2020-02-24T10:49:41.358Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0t7001174ju15hs2om2","content":"","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":""},{"title":"Local Binary Patterns","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-08-01T06:05:20.000Z","password":null,"summary":"LBP算法原理、LBP特征实现(c++)","_content":"\n# LBP算法\n\nLBP（Local Binary Patterns，局部二值模式）是一种能够有效地度量和提取图像局部纹理信息的算子，具有旋转不变性和灰度不变性等显著的优点。它是人脸识别中一种提取特征的重要方法，具有对光照不敏感的特性，但是对姿态和表情的鲁棒性不强。\n## 纹理\n\n纹理是由于物体表面物理属性不同所引起的能够表示某个特定表面特征的灰度或颜色信息。纹理反映了图像灰度模式的空间分布，包含了图像的表面信息及其周围环境的关系。\n\n## 基本的LBP算子\n\n局部二值模式是一种灰度范围内的纹理描述方式。最初的LBP算子定义在一个3×3的窗口，以窗口中心像素点为阈值，将相邻的像素的灰度值与其进行比较，若周围的像素值大于中心点的值，则将该像素位置标记为1,否则为0.这样一个3×3邻域内的8个点可产生一个8-bit的无符号数，再按其位置赋予不同权重求和得一整数，即可得到该窗口的 **LBP** 值，并用这个数反映该区域的纹理信息。    \n对比度分量C是邻域中所有大于和等于中心点像素的均值与所有小于中心点像素的均值之差。    \n![](https://i.loli.net/2019/07/31/5d415779ca87257597.jpg)\n\n基本的LBP算子最大的缺陷是只覆盖了一个固定半径范围内的小区域，改进的LBP算子，将3×3邻域扩展到任意邻域，用圆形邻域代替了正方形邻域，该算子允许在半径为R的圆形邻域内有任意多个像素点。\n- 一个局部区域的纹理分布可假设为局部区域内像素灰度的联合分布密度\n$$T = t(g_c,g_0, ....,g_{p-1})$$\n$g_c$表示局部区域的中心点的灰度值,$g_p(p=0,1,...,p)$对应中心点周围等距分布的P个点\n- 采用 **双线性插算法** 对没有完全落在像素位置的点计算灰度值。邻域内的$g_p$点的坐标可以表示为:\n$$(x_p,y_p) = (x_c + Rcos(\\frac{2\\pi}{P}),y_c - Rsin(\\frac{2\\pi}{P}))$$\n$(x_c,y_c)$表示中心点的坐标\n- 将中心点$g_c$的值从邻域像素的灰度值$g_p$中减去，则局部区域的纹理可以用中心点和中心点与周边像素值之差的联合分布来表示:\n$$T = t(g_c,g_0-g_c,....,g_{p-1}-g_c)$$\n- 假设中心像素点$g_c$与周边点像素$g_p$的差值$g_p-g_c(p=0,1,...P)$独立于中心点$g_c$，则\n$$T\\approx t(g_c)(g_0-g_c,...,g_{p-1}-g_c)$$\n- 实际上，$t(g_c)$只是描述了整个图像的亮度分布情况，而和图像的局部纹理无关，它不能为纹理分析提供任何有价值的信息\n$$T\\approx t(g_0-g_c,...,g_{p-1}-g_c)$$\n- 差值的联合分布具有灰度平移不变性，即邻域中所有P+1个像素同时加上或减去某个值，其表征的纹理不变。\n- 为了达到尺度不变的目的，只考虑差值的符号\n$$T\\approx t(s(g_0-g_c),...,s(g_p-g_c))$$\n\n$$s(x)=\\begin{cases}\n1 , \\quad &x > 0  \\\\\\\\\n0 , &x \\geqslant 0\n\\end{cases}\n$$\n\n上式得到了一个8位的二进制数，再对像素按不同位置用$2^p$进行加权求和，这样得到了一个与邻域像素点相关的唯一的 **LBP** 值，这个值称为 **模式**。这个值描述的是以$(x_c,y_c)$为中心的局部区域的纹理，可以表示为\n$$LBP(x_c,y_c) = \\sum_{p=0}^{P-1}s(g_p - g_c)2^P$$\n上式意味着差值的符号转化成一个P-bit的二进制数，进而转化成为一个取值范围为0-$2^p$的离散的LBP值，或者说转化为一种LBP模式。\n- 局部区域的灰度分布或纹理，可以用这个LBP值或LBP模式近似描述为:\n$$T\\approx t(LBP(x_c,y_c))$$\nLBP算子对于任何单调的灰度变化具有鲁棒性，用符号$LBP_P^R$表示在半径为R的圆形邻域内有P个像素点$g_p(p=0,1,...,P)$的LBP算子\n![](https://i.loli.net/2019/07/31/5d415779b84ac47631.jpg)\n\n## LBP等价模式\n### 定义\n当某个局部二进制模式所对应的循环二进制数从０到１或从１到０最多有两次跳变时，该局部二进制模式所对应的二进制就称为一个等价模式类。比如00000000,11111111,10001111都是等价类。\n### 检验方法\n检验某种模式是否是等价模式的简单办法是将其和其移动一位后的二进制模式按位相减的绝对值求和\n$$U(G_p) = |s(g_{p-1}-g_c)-s(g_0-g_c)|+\\sum_{p=1}^{P-1}|s(g_p-g_c)-s(g_{p-1}-g_c)$$\n若某种模式计算得到的 $U(G_p)$小于或等于２，则将其归于等价模式\n![](https://i.loli.net/2019/07/31/5d415779c949196019.jpg)\n\n## 旋转不变的LBP算子\n### 定义\n不断旋转圆形邻域得到一系列的初始定义的LBP值，取其最小值作为该邻域的LBP值，用公式表示为:\n$$LBP_{P,R}^{ri} = min(ROR(LBP_{P,R}^{ri},i)|i=0,1,...,P-1)$$\n$LBP^{ri}$表示旋转不变的LBP算子，$ROR(x,i)$函数为旋转函数，表示将x循环右移i(i<P)位。\n\n### 性质\n- 对于图像旋转，表现的更为鲁棒，并且LBP模式的种类进一步减少，使纹理识别更加容易。\n- 丢失了方向信息\n![](https://i.loli.net/2019/07/31/5d415779b8fed91298.jpg)\n\n## 旋转不变的的等价模式\n### 定义\n将等价模式类进行旋转得到旋转不变的等价模式\n\n$$LBP_{P,R}^{riu2} = \\begin{cases}\n\\sum_{P=0}^{P-1}s(g_p-g_c), & U(G_p) \\leq 2 \\\\\\\\\nP + 1, & U(G_p) >2\n\\end{cases}\n$$\n\n其中$U(G_p)$表示0到1或1到0跳变的次数，$LBP^{riu2}$被称为旋转不变的等价模式\n\n## 几种LBP算子的维数比较\n\n LBP  | 原始模式数 | 等价模式 | 旋转不变等价模式\n:---: | :---: | :---: | :---:\n$LBP_P^R$ | $2^P$ | $P(P-1) + 2$ | $P+1$\n$LBP_8^1$ | 256 | 58(+1) | 9\n$LBP_{16}^2$ | 65536 | 242(+1) | 17\n$LBP_{24}^3$ | 16777216 | 554(+1) | 25\n\n\n# LBP特征实现\n\n## 原始LBP特征\n\n```cpp\n//Original_LBP\nMat get_original_LBP_feature(Mat img){\n  Mat result;\n  result.create(img.rows - 2, img.cols -2, img.type());\n  result.setTo(0);\n  for (int i = 1; i < img.rows - 1; i++){\n    for (int j = 1; j < img.cols -1; j++){\n      uchar center = img.at<uchar>(i, j);\n      uchar lbpcode = 0;\n      lbpcode |= (img.at<uchar>(i - 1, j - 1) >= center) << 7;\n      lbpcode |= (img.at<uchar>(i - 1, j) >= center) << 6;\n      lbpcode |= (img.at<uchar>(i - 1, j + 1) >= center) << 5;\n      lbpcode |= (img.at<uchar>(i, j -1) >= center) << 4;\n      lbpcode |= (img.at<uchar>(i, j + 1) >= center) << 3;\n      lbpcode |= (img.at<uchar>(i + 1, j - 1) >= center) << 2;\n      lbpcode |= (img.at<uchar>(i + 1, j) >= center) << 1;\n      lbpcode |= (img.at<uchar>(i + 1, j + 1) >= center) << 0;\n      result.at<uchar>(i - 1, j - 1) = lbpcode;\n    }\n  }\n  return result;\n}\n```\n\n![](https://i.loli.net/2019/07/31/5d4161dac5f0b23887.png)\n\n\n## 圆形LBP特征\n\n``` cpp\n//Circular_LBP_feature\nMat get_circular_LBP_feature(Mat img, int radius, int neighbors)\n{\n  Mat result;\n  result.create(img.rows - radius * 2, img.cols - radius * 2, img.type());\n  result.setTo(0);\n  //循环处理每个像素\n  for(int i=radius;i<img.rows-radius;i++)\n  {\n      for(int j=radius;j<img.cols-radius;j++)\n      {\n          //获得中心像素点的灰度值\n          uchar center = img.at<uchar>(i,j);\n          uchar lbpCode = 0;\n          for(int k=0;k<neighbors;k++)\n          {\n              //根据公式计算第k个采样点的坐标，这个地方可以优化，不必每次都进行计算radius*cos，radius*sin\n              float x = i + static_cast<float>(radius * \\\n                  cos(2.0 * CV_PI * k / neighbors));\n              float y = j - static_cast<float>(radius * \\\n                  sin(2.0 * CV_PI * k / neighbors));\n                //根据取整结果进行双线性插值，得到第k个采样点的灰度值\n                //1.分别对x，y进行上下取整\n                int x1 = static_cast<int>(floor(x));\n                int x2 = static_cast<int>(ceil(x));\n                int y1 = static_cast<int>(floor(y));\n                int y2 = static_cast<int>(ceil(y));\n\n                //将坐标映射到0-1之间\n                float tx = x - x1;\n                float ty = y - y1;\n                //根据0-1之间的x，y的权重计算公式计算权重\n                float w1 = (1-tx) * (1-ty);\n                float w2 =    tx  * (1-ty);\n                float w3 = (1-tx) *    ty;\n                float w4 =    tx  *    ty;\n                //3.根据双线性插值公式计算第k个采样点的灰度值\n                float neighbor = img.at<uchar>(x1,y1) * w1 + img.at<uchar>(x1,y2) *w2 + img.at<uchar>(x2,y1) * w3 +img.at<uchar>(x2,y2) *w4;\n                //通过比较获得LBP值，并按顺序排列起来\n                lbpCode |= (neighbor>center) <<(neighbors-k-1);\n            }\n            result.at<uchar>(i-radius,j-radius) = lbpCode;\n        }\n    }\n  return result;\n}\n```\n\n结果:\n![](https://i.loli.net/2019/08/01/5d42b5d2e345026549.png)\n\n第一幅图设置半径为4,第二幅图设置半径为1,可以看到半径越小处理的越精细。\n\n## 旋转不变LBP特征\n\n``` cpp\n//Rotation_Invariant_LBP_feature\nMat get_rotation_invariant_LBP_feature(Mat img, int radius, int neighbors)\n{\n  Mat result;\n  result.create(img.rows - radius * 2, img.cols - radius * 2, img.type());\n  result.setTo(0);\n  for(int k=0;k<neighbors;k++)\n    {\n        //计算采样点对于中心点坐标的偏移量rx，ry\n        float rx = static_cast<float>(radius * cos(2.0 * CV_PI * k / neighbors));\n        float ry = -static_cast<float>(radius * sin(2.0 * CV_PI * k / neighbors));\n        //为双线性插值做准备\n        //对采样点偏移量分别进行上下取整\n        int x1 = static_cast<int>(floor(rx));\n        int x2 = static_cast<int>(ceil(rx));\n        int y1 = static_cast<int>(floor(ry));\n        int y2 = static_cast<int>(ceil(ry));\n        //将坐标偏移量映射到0-1之间\n        float tx = rx - x1;\n        float ty = ry - y1;\n        //根据0-1之间的x，y的权重计算公式计算权重，权重与坐标具体位置无关，与坐标间的差值有关\n        float w1 = (1-tx) * (1-ty);\n        float w2 =    tx  * (1-ty);\n        float w3 = (1-tx) *    ty;\n        float w4 =    tx  *    ty;\n        //循环处理每个像素\n        for(int i=radius;i<img.rows-radius;i++)\n        {\n            for(int j=radius;j<img.cols-radius;j++)\n            {\n                //获得中心像素点的灰度值\n                uchar center = img.at<uchar>(i,j);\n                //根据双线性插值公式计算第k个采样点的灰度值\n                float neighbor = img.at<uchar>(i+x1,j+y1) * w1 + img.at<uchar>(i+x1,j+y2) *w2 + img.at<uchar>(i+x2,j+y1) * w3 +img.at<uchar>(i+x2,j+y2) *w4;\n                //LBP特征图像的每个邻居的LBP值累加，累加通过与操作完成，对应的LBP值通过移位取得\n                result.at<uchar>(i-radius,j-radius) |= (neighbor>center) <<(neighbors-k-1);\n            }\n        }\n    }\n    //进行旋转不变处理\n    for(int i=0;i<result.rows;i++)\n    {\n        for(int j=0;j<result.cols;j++)\n        {\n            uchar currentValue = result.at<uchar>(i,j);\n            uchar minValue = currentValue;\n            for(int k=1;k<neighbors;k++)\t\t//循环左移\n            {\n                uchar temp = (currentValue>>(neighbors-k)) | (currentValue<<k);\n                if(temp < minValue)\n                {\n                    minValue = temp;\n                }\n            }\n            result.at<uchar>(i,j) = minValue;\n        }\n    }\n    return result;\n}\n\n```\n\n结果:\n![](https://i.loli.net/2019/08/01/5d42b5d30749958722.png)\n\n第一幅图neighbors值设置为8,第二幅设置为6,可以看出neighbors值越大，得到的LBP特征亮度越高。\n\n## 完整代码如下\n\n``` cpp\n#include <opencv2/highgui/highgui.hpp>\n\nusing namespace cv;\n\n//Original_LBP\nMat get_original_LBP_feature(Mat img){\n  Mat result;\n  result.create(img.rows - 2, img.cols -2, img.type());\n  result.setTo(0);\n  for (int i = 1; i < img.rows - 1; i++){\n    for (int j = 1; j < img.cols -1; j++){\n      uchar center = img.at<uchar>(i, j);\n      uchar lbpcode = 0;\n      lbpcode |= (img.at<uchar>(i - 1, j - 1) >= center) << 7;\n      lbpcode |= (img.at<uchar>(i - 1, j) >= center) << 6;\n      lbpcode |= (img.at<uchar>(i - 1, j + 1) >= center) << 5;\n      lbpcode |= (img.at<uchar>(i, j -1) >= center) << 4;\n      lbpcode |= (img.at<uchar>(i, j + 1) >= center) << 3;\n      lbpcode |= (img.at<uchar>(i + 1, j - 1) >= center) << 2;\n      lbpcode |= (img.at<uchar>(i + 1, j) >= center) << 1;\n      lbpcode |= (img.at<uchar>(i + 1, j + 1) >= center) << 0;\n      result.at<uchar>(i - 1, j - 1) = lbpcode;\n    }\n  }\n  return result;\n}\n\n//Circular_LBP_feature\nMat get_circular_LBP_feature(Mat img, int radius, int neighbors)\n{\n  Mat result;\n  result.create(img.rows - radius * 2, img.cols - radius * 2, img.type());\n  result.setTo(0);\n  //循环处理每个像素\n  for(int i=radius;i<img.rows-radius;i++)\n  {\n      for(int j=radius;j<img.cols-radius;j++)\n      {\n          //获得中心像素点的灰度值\n          uchar center = img.at<uchar>(i,j);\n          uchar lbpCode = 0;\n          for(int k=0;k<neighbors;k++)\n          {\n              //根据公式计算第k个采样点的坐标，这个地方可以优化，不必每次都进行计算radius*cos，radius*sin\n              float x = i + static_cast<float>(radius * \\\n                  cos(2.0 * CV_PI * k / neighbors));\n              float y = j - static_cast<float>(radius * \\\n                  sin(2.0 * CV_PI * k / neighbors));\n                //根据取整结果进行双线性插值，得到第k个采样点的灰度值\n                //1.分别对x，y进行上下取整\n                int x1 = static_cast<int>(floor(x));\n                int x2 = static_cast<int>(ceil(x));\n                int y1 = static_cast<int>(floor(y));\n                int y2 = static_cast<int>(ceil(y));\n\n                //将坐标映射到0-1之间\n                float tx = x - x1;\n                float ty = y - y1;\n                //根据0-1之间的x，y的权重计算公式计算权重\n                float w1 = (1-tx) * (1-ty);\n                float w2 =    tx  * (1-ty);\n                float w3 = (1-tx) *    ty;\n                float w4 =    tx  *    ty;\n                //3.根据双线性插值公式计算第k个采样点的灰度值\n                float neighbor = img.at<uchar>(x1,y1) * w1 + img.at<uchar>(x1,y2) *w2 + img.at<uchar>(x2,y1) * w3 +img.at<uchar>(x2,y2) *w4;\n                //通过比较获得LBP值，并按顺序排列起来\n                lbpCode |= (neighbor>center) <<(neighbors-k-1);\n            }\n            result.at<uchar>(i-radius,j-radius) = lbpCode;\n        }\n    }\n  return result;\n}\n\n//Rotation_Invariant_LBP_feature\nMat get_rotation_invariant_LBP_feature(Mat img, int radius, int neighbors)\n{\n  Mat result;\n  result.create(img.rows - radius * 2, img.cols - radius * 2, img.type());\n  result.setTo(0);\n  for(int k=0;k<neighbors;k++)\n    {\n        //计算采样点对于中心点坐标的偏移量rx，ry\n        float rx = static_cast<float>(radius * cos(2.0 * CV_PI * k / neighbors));\n        float ry = -static_cast<float>(radius * sin(2.0 * CV_PI * k / neighbors));\n        //为双线性插值做准备\n        //对采样点偏移量分别进行上下取整\n        int x1 = static_cast<int>(floor(rx));\n        int x2 = static_cast<int>(ceil(rx));\n        int y1 = static_cast<int>(floor(ry));\n        int y2 = static_cast<int>(ceil(ry));\n        //将坐标偏移量映射到0-1之间\n        float tx = rx - x1;\n        float ty = ry - y1;\n        //根据0-1之间的x，y的权重计算公式计算权重，权重与坐标具体位置无关，与坐标间的差值有关\n        float w1 = (1-tx) * (1-ty);\n        float w2 =    tx  * (1-ty);\n        float w3 = (1-tx) *    ty;\n        float w4 =    tx  *    ty;\n        //循环处理每个像素\n        for(int i=radius;i<img.rows-radius;i++)\n        {\n            for(int j=radius;j<img.cols-radius;j++)\n            {\n                //获得中心像素点的灰度值\n                uchar center = img.at<uchar>(i,j);\n                //根据双线性插值公式计算第k个采样点的灰度值\n                float neighbor = img.at<uchar>(i+x1,j+y1) * w1 + img.at<uchar>(i+x1,j+y2) *w2 + img.at<uchar>(i+x2,j+y1) * w3 +img.at<uchar>(i+x2,j+y2) *w4;\n                //LBP特征图像的每个邻居的LBP值累加，累加通过与操作完成，对应的LBP值通过移位取得\n                result.at<uchar>(i-radius,j-radius) |= (neighbor>center) <<(neighbors-k-1);\n            }\n        }\n    }\n    //进行旋转不变处理\n    for(int i=0;i<result.rows;i++)\n    {\n        for(int j=0;j<result.cols;j++)\n        {\n            uchar currentValue = result.at<uchar>(i,j);\n            uchar minValue = currentValue;\n            for(int k=1;k<neighbors;k++)\t\t//循环左移\n            {\n                uchar temp = (currentValue>>(neighbors-k)) | (currentValue<<k);\n                if(temp < minValue)\n                {\n                    minValue = temp;\n                }\n            }\n            result.at<uchar>(i,j) = minValue;\n        }\n    }\n    return result;\n}\n\nint main(int argc, char* argv[])\n{\n  Mat src = imread(argv[1], 0);\n  Mat dst = get_original_LBP_feature(src);\n  Mat odst1 = get_circular_LBP_feature(src, 1, 8);\n  //Mat odst4 = get_circular_LBP_feature(src, 4, 8);\n  Mat rif8 = get_rotation_invariant_LBP_feature(src, 1, 8);\n  Mat rif6 = get_rotation_invariant_LBP_feature(src, 1, 6);\n\n\n  imshow(\"原始图片\", src);\n  imshow(\"原始LBP\", dst);\n  imshow(\"圆形LBP\", odst1);\n  //imshow(\"圆形LBP4\", odst4);\n  imshow(\"旋转不变LBP\", rif8);\n  //imshow(\"旋转不变LBP6\", rif6);\n\n  waitKey(0);\n  return 0;\n}\n```\n","source":"_posts/Local-Binary-Patterns.md","raw":"---\ntitle: Local Binary Patterns\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-08-01 14:05:20\npassword:\nsummary: LBP算法原理、LBP特征实现(c++)\ntags:\n- 图像处理\n- LBP\n- c++\ncategories:\n- 算法\n---\n\n# LBP算法\n\nLBP（Local Binary Patterns，局部二值模式）是一种能够有效地度量和提取图像局部纹理信息的算子，具有旋转不变性和灰度不变性等显著的优点。它是人脸识别中一种提取特征的重要方法，具有对光照不敏感的特性，但是对姿态和表情的鲁棒性不强。\n## 纹理\n\n纹理是由于物体表面物理属性不同所引起的能够表示某个特定表面特征的灰度或颜色信息。纹理反映了图像灰度模式的空间分布，包含了图像的表面信息及其周围环境的关系。\n\n## 基本的LBP算子\n\n局部二值模式是一种灰度范围内的纹理描述方式。最初的LBP算子定义在一个3×3的窗口，以窗口中心像素点为阈值，将相邻的像素的灰度值与其进行比较，若周围的像素值大于中心点的值，则将该像素位置标记为1,否则为0.这样一个3×3邻域内的8个点可产生一个8-bit的无符号数，再按其位置赋予不同权重求和得一整数，即可得到该窗口的 **LBP** 值，并用这个数反映该区域的纹理信息。    \n对比度分量C是邻域中所有大于和等于中心点像素的均值与所有小于中心点像素的均值之差。    \n![](https://i.loli.net/2019/07/31/5d415779ca87257597.jpg)\n\n基本的LBP算子最大的缺陷是只覆盖了一个固定半径范围内的小区域，改进的LBP算子，将3×3邻域扩展到任意邻域，用圆形邻域代替了正方形邻域，该算子允许在半径为R的圆形邻域内有任意多个像素点。\n- 一个局部区域的纹理分布可假设为局部区域内像素灰度的联合分布密度\n$$T = t(g_c,g_0, ....,g_{p-1})$$\n$g_c$表示局部区域的中心点的灰度值,$g_p(p=0,1,...,p)$对应中心点周围等距分布的P个点\n- 采用 **双线性插算法** 对没有完全落在像素位置的点计算灰度值。邻域内的$g_p$点的坐标可以表示为:\n$$(x_p,y_p) = (x_c + Rcos(\\frac{2\\pi}{P}),y_c - Rsin(\\frac{2\\pi}{P}))$$\n$(x_c,y_c)$表示中心点的坐标\n- 将中心点$g_c$的值从邻域像素的灰度值$g_p$中减去，则局部区域的纹理可以用中心点和中心点与周边像素值之差的联合分布来表示:\n$$T = t(g_c,g_0-g_c,....,g_{p-1}-g_c)$$\n- 假设中心像素点$g_c$与周边点像素$g_p$的差值$g_p-g_c(p=0,1,...P)$独立于中心点$g_c$，则\n$$T\\approx t(g_c)(g_0-g_c,...,g_{p-1}-g_c)$$\n- 实际上，$t(g_c)$只是描述了整个图像的亮度分布情况，而和图像的局部纹理无关，它不能为纹理分析提供任何有价值的信息\n$$T\\approx t(g_0-g_c,...,g_{p-1}-g_c)$$\n- 差值的联合分布具有灰度平移不变性，即邻域中所有P+1个像素同时加上或减去某个值，其表征的纹理不变。\n- 为了达到尺度不变的目的，只考虑差值的符号\n$$T\\approx t(s(g_0-g_c),...,s(g_p-g_c))$$\n\n$$s(x)=\\begin{cases}\n1 , \\quad &x > 0  \\\\\\\\\n0 , &x \\geqslant 0\n\\end{cases}\n$$\n\n上式得到了一个8位的二进制数，再对像素按不同位置用$2^p$进行加权求和，这样得到了一个与邻域像素点相关的唯一的 **LBP** 值，这个值称为 **模式**。这个值描述的是以$(x_c,y_c)$为中心的局部区域的纹理，可以表示为\n$$LBP(x_c,y_c) = \\sum_{p=0}^{P-1}s(g_p - g_c)2^P$$\n上式意味着差值的符号转化成一个P-bit的二进制数，进而转化成为一个取值范围为0-$2^p$的离散的LBP值，或者说转化为一种LBP模式。\n- 局部区域的灰度分布或纹理，可以用这个LBP值或LBP模式近似描述为:\n$$T\\approx t(LBP(x_c,y_c))$$\nLBP算子对于任何单调的灰度变化具有鲁棒性，用符号$LBP_P^R$表示在半径为R的圆形邻域内有P个像素点$g_p(p=0,1,...,P)$的LBP算子\n![](https://i.loli.net/2019/07/31/5d415779b84ac47631.jpg)\n\n## LBP等价模式\n### 定义\n当某个局部二进制模式所对应的循环二进制数从０到１或从１到０最多有两次跳变时，该局部二进制模式所对应的二进制就称为一个等价模式类。比如00000000,11111111,10001111都是等价类。\n### 检验方法\n检验某种模式是否是等价模式的简单办法是将其和其移动一位后的二进制模式按位相减的绝对值求和\n$$U(G_p) = |s(g_{p-1}-g_c)-s(g_0-g_c)|+\\sum_{p=1}^{P-1}|s(g_p-g_c)-s(g_{p-1}-g_c)$$\n若某种模式计算得到的 $U(G_p)$小于或等于２，则将其归于等价模式\n![](https://i.loli.net/2019/07/31/5d415779c949196019.jpg)\n\n## 旋转不变的LBP算子\n### 定义\n不断旋转圆形邻域得到一系列的初始定义的LBP值，取其最小值作为该邻域的LBP值，用公式表示为:\n$$LBP_{P,R}^{ri} = min(ROR(LBP_{P,R}^{ri},i)|i=0,1,...,P-1)$$\n$LBP^{ri}$表示旋转不变的LBP算子，$ROR(x,i)$函数为旋转函数，表示将x循环右移i(i<P)位。\n\n### 性质\n- 对于图像旋转，表现的更为鲁棒，并且LBP模式的种类进一步减少，使纹理识别更加容易。\n- 丢失了方向信息\n![](https://i.loli.net/2019/07/31/5d415779b8fed91298.jpg)\n\n## 旋转不变的的等价模式\n### 定义\n将等价模式类进行旋转得到旋转不变的等价模式\n\n$$LBP_{P,R}^{riu2} = \\begin{cases}\n\\sum_{P=0}^{P-1}s(g_p-g_c), & U(G_p) \\leq 2 \\\\\\\\\nP + 1, & U(G_p) >2\n\\end{cases}\n$$\n\n其中$U(G_p)$表示0到1或1到0跳变的次数，$LBP^{riu2}$被称为旋转不变的等价模式\n\n## 几种LBP算子的维数比较\n\n LBP  | 原始模式数 | 等价模式 | 旋转不变等价模式\n:---: | :---: | :---: | :---:\n$LBP_P^R$ | $2^P$ | $P(P-1) + 2$ | $P+1$\n$LBP_8^1$ | 256 | 58(+1) | 9\n$LBP_{16}^2$ | 65536 | 242(+1) | 17\n$LBP_{24}^3$ | 16777216 | 554(+1) | 25\n\n\n# LBP特征实现\n\n## 原始LBP特征\n\n```cpp\n//Original_LBP\nMat get_original_LBP_feature(Mat img){\n  Mat result;\n  result.create(img.rows - 2, img.cols -2, img.type());\n  result.setTo(0);\n  for (int i = 1; i < img.rows - 1; i++){\n    for (int j = 1; j < img.cols -1; j++){\n      uchar center = img.at<uchar>(i, j);\n      uchar lbpcode = 0;\n      lbpcode |= (img.at<uchar>(i - 1, j - 1) >= center) << 7;\n      lbpcode |= (img.at<uchar>(i - 1, j) >= center) << 6;\n      lbpcode |= (img.at<uchar>(i - 1, j + 1) >= center) << 5;\n      lbpcode |= (img.at<uchar>(i, j -1) >= center) << 4;\n      lbpcode |= (img.at<uchar>(i, j + 1) >= center) << 3;\n      lbpcode |= (img.at<uchar>(i + 1, j - 1) >= center) << 2;\n      lbpcode |= (img.at<uchar>(i + 1, j) >= center) << 1;\n      lbpcode |= (img.at<uchar>(i + 1, j + 1) >= center) << 0;\n      result.at<uchar>(i - 1, j - 1) = lbpcode;\n    }\n  }\n  return result;\n}\n```\n\n![](https://i.loli.net/2019/07/31/5d4161dac5f0b23887.png)\n\n\n## 圆形LBP特征\n\n``` cpp\n//Circular_LBP_feature\nMat get_circular_LBP_feature(Mat img, int radius, int neighbors)\n{\n  Mat result;\n  result.create(img.rows - radius * 2, img.cols - radius * 2, img.type());\n  result.setTo(0);\n  //循环处理每个像素\n  for(int i=radius;i<img.rows-radius;i++)\n  {\n      for(int j=radius;j<img.cols-radius;j++)\n      {\n          //获得中心像素点的灰度值\n          uchar center = img.at<uchar>(i,j);\n          uchar lbpCode = 0;\n          for(int k=0;k<neighbors;k++)\n          {\n              //根据公式计算第k个采样点的坐标，这个地方可以优化，不必每次都进行计算radius*cos，radius*sin\n              float x = i + static_cast<float>(radius * \\\n                  cos(2.0 * CV_PI * k / neighbors));\n              float y = j - static_cast<float>(radius * \\\n                  sin(2.0 * CV_PI * k / neighbors));\n                //根据取整结果进行双线性插值，得到第k个采样点的灰度值\n                //1.分别对x，y进行上下取整\n                int x1 = static_cast<int>(floor(x));\n                int x2 = static_cast<int>(ceil(x));\n                int y1 = static_cast<int>(floor(y));\n                int y2 = static_cast<int>(ceil(y));\n\n                //将坐标映射到0-1之间\n                float tx = x - x1;\n                float ty = y - y1;\n                //根据0-1之间的x，y的权重计算公式计算权重\n                float w1 = (1-tx) * (1-ty);\n                float w2 =    tx  * (1-ty);\n                float w3 = (1-tx) *    ty;\n                float w4 =    tx  *    ty;\n                //3.根据双线性插值公式计算第k个采样点的灰度值\n                float neighbor = img.at<uchar>(x1,y1) * w1 + img.at<uchar>(x1,y2) *w2 + img.at<uchar>(x2,y1) * w3 +img.at<uchar>(x2,y2) *w4;\n                //通过比较获得LBP值，并按顺序排列起来\n                lbpCode |= (neighbor>center) <<(neighbors-k-1);\n            }\n            result.at<uchar>(i-radius,j-radius) = lbpCode;\n        }\n    }\n  return result;\n}\n```\n\n结果:\n![](https://i.loli.net/2019/08/01/5d42b5d2e345026549.png)\n\n第一幅图设置半径为4,第二幅图设置半径为1,可以看到半径越小处理的越精细。\n\n## 旋转不变LBP特征\n\n``` cpp\n//Rotation_Invariant_LBP_feature\nMat get_rotation_invariant_LBP_feature(Mat img, int radius, int neighbors)\n{\n  Mat result;\n  result.create(img.rows - radius * 2, img.cols - radius * 2, img.type());\n  result.setTo(0);\n  for(int k=0;k<neighbors;k++)\n    {\n        //计算采样点对于中心点坐标的偏移量rx，ry\n        float rx = static_cast<float>(radius * cos(2.0 * CV_PI * k / neighbors));\n        float ry = -static_cast<float>(radius * sin(2.0 * CV_PI * k / neighbors));\n        //为双线性插值做准备\n        //对采样点偏移量分别进行上下取整\n        int x1 = static_cast<int>(floor(rx));\n        int x2 = static_cast<int>(ceil(rx));\n        int y1 = static_cast<int>(floor(ry));\n        int y2 = static_cast<int>(ceil(ry));\n        //将坐标偏移量映射到0-1之间\n        float tx = rx - x1;\n        float ty = ry - y1;\n        //根据0-1之间的x，y的权重计算公式计算权重，权重与坐标具体位置无关，与坐标间的差值有关\n        float w1 = (1-tx) * (1-ty);\n        float w2 =    tx  * (1-ty);\n        float w3 = (1-tx) *    ty;\n        float w4 =    tx  *    ty;\n        //循环处理每个像素\n        for(int i=radius;i<img.rows-radius;i++)\n        {\n            for(int j=radius;j<img.cols-radius;j++)\n            {\n                //获得中心像素点的灰度值\n                uchar center = img.at<uchar>(i,j);\n                //根据双线性插值公式计算第k个采样点的灰度值\n                float neighbor = img.at<uchar>(i+x1,j+y1) * w1 + img.at<uchar>(i+x1,j+y2) *w2 + img.at<uchar>(i+x2,j+y1) * w3 +img.at<uchar>(i+x2,j+y2) *w4;\n                //LBP特征图像的每个邻居的LBP值累加，累加通过与操作完成，对应的LBP值通过移位取得\n                result.at<uchar>(i-radius,j-radius) |= (neighbor>center) <<(neighbors-k-1);\n            }\n        }\n    }\n    //进行旋转不变处理\n    for(int i=0;i<result.rows;i++)\n    {\n        for(int j=0;j<result.cols;j++)\n        {\n            uchar currentValue = result.at<uchar>(i,j);\n            uchar minValue = currentValue;\n            for(int k=1;k<neighbors;k++)\t\t//循环左移\n            {\n                uchar temp = (currentValue>>(neighbors-k)) | (currentValue<<k);\n                if(temp < minValue)\n                {\n                    minValue = temp;\n                }\n            }\n            result.at<uchar>(i,j) = minValue;\n        }\n    }\n    return result;\n}\n\n```\n\n结果:\n![](https://i.loli.net/2019/08/01/5d42b5d30749958722.png)\n\n第一幅图neighbors值设置为8,第二幅设置为6,可以看出neighbors值越大，得到的LBP特征亮度越高。\n\n## 完整代码如下\n\n``` cpp\n#include <opencv2/highgui/highgui.hpp>\n\nusing namespace cv;\n\n//Original_LBP\nMat get_original_LBP_feature(Mat img){\n  Mat result;\n  result.create(img.rows - 2, img.cols -2, img.type());\n  result.setTo(0);\n  for (int i = 1; i < img.rows - 1; i++){\n    for (int j = 1; j < img.cols -1; j++){\n      uchar center = img.at<uchar>(i, j);\n      uchar lbpcode = 0;\n      lbpcode |= (img.at<uchar>(i - 1, j - 1) >= center) << 7;\n      lbpcode |= (img.at<uchar>(i - 1, j) >= center) << 6;\n      lbpcode |= (img.at<uchar>(i - 1, j + 1) >= center) << 5;\n      lbpcode |= (img.at<uchar>(i, j -1) >= center) << 4;\n      lbpcode |= (img.at<uchar>(i, j + 1) >= center) << 3;\n      lbpcode |= (img.at<uchar>(i + 1, j - 1) >= center) << 2;\n      lbpcode |= (img.at<uchar>(i + 1, j) >= center) << 1;\n      lbpcode |= (img.at<uchar>(i + 1, j + 1) >= center) << 0;\n      result.at<uchar>(i - 1, j - 1) = lbpcode;\n    }\n  }\n  return result;\n}\n\n//Circular_LBP_feature\nMat get_circular_LBP_feature(Mat img, int radius, int neighbors)\n{\n  Mat result;\n  result.create(img.rows - radius * 2, img.cols - radius * 2, img.type());\n  result.setTo(0);\n  //循环处理每个像素\n  for(int i=radius;i<img.rows-radius;i++)\n  {\n      for(int j=radius;j<img.cols-radius;j++)\n      {\n          //获得中心像素点的灰度值\n          uchar center = img.at<uchar>(i,j);\n          uchar lbpCode = 0;\n          for(int k=0;k<neighbors;k++)\n          {\n              //根据公式计算第k个采样点的坐标，这个地方可以优化，不必每次都进行计算radius*cos，radius*sin\n              float x = i + static_cast<float>(radius * \\\n                  cos(2.0 * CV_PI * k / neighbors));\n              float y = j - static_cast<float>(radius * \\\n                  sin(2.0 * CV_PI * k / neighbors));\n                //根据取整结果进行双线性插值，得到第k个采样点的灰度值\n                //1.分别对x，y进行上下取整\n                int x1 = static_cast<int>(floor(x));\n                int x2 = static_cast<int>(ceil(x));\n                int y1 = static_cast<int>(floor(y));\n                int y2 = static_cast<int>(ceil(y));\n\n                //将坐标映射到0-1之间\n                float tx = x - x1;\n                float ty = y - y1;\n                //根据0-1之间的x，y的权重计算公式计算权重\n                float w1 = (1-tx) * (1-ty);\n                float w2 =    tx  * (1-ty);\n                float w3 = (1-tx) *    ty;\n                float w4 =    tx  *    ty;\n                //3.根据双线性插值公式计算第k个采样点的灰度值\n                float neighbor = img.at<uchar>(x1,y1) * w1 + img.at<uchar>(x1,y2) *w2 + img.at<uchar>(x2,y1) * w3 +img.at<uchar>(x2,y2) *w4;\n                //通过比较获得LBP值，并按顺序排列起来\n                lbpCode |= (neighbor>center) <<(neighbors-k-1);\n            }\n            result.at<uchar>(i-radius,j-radius) = lbpCode;\n        }\n    }\n  return result;\n}\n\n//Rotation_Invariant_LBP_feature\nMat get_rotation_invariant_LBP_feature(Mat img, int radius, int neighbors)\n{\n  Mat result;\n  result.create(img.rows - radius * 2, img.cols - radius * 2, img.type());\n  result.setTo(0);\n  for(int k=0;k<neighbors;k++)\n    {\n        //计算采样点对于中心点坐标的偏移量rx，ry\n        float rx = static_cast<float>(radius * cos(2.0 * CV_PI * k / neighbors));\n        float ry = -static_cast<float>(radius * sin(2.0 * CV_PI * k / neighbors));\n        //为双线性插值做准备\n        //对采样点偏移量分别进行上下取整\n        int x1 = static_cast<int>(floor(rx));\n        int x2 = static_cast<int>(ceil(rx));\n        int y1 = static_cast<int>(floor(ry));\n        int y2 = static_cast<int>(ceil(ry));\n        //将坐标偏移量映射到0-1之间\n        float tx = rx - x1;\n        float ty = ry - y1;\n        //根据0-1之间的x，y的权重计算公式计算权重，权重与坐标具体位置无关，与坐标间的差值有关\n        float w1 = (1-tx) * (1-ty);\n        float w2 =    tx  * (1-ty);\n        float w3 = (1-tx) *    ty;\n        float w4 =    tx  *    ty;\n        //循环处理每个像素\n        for(int i=radius;i<img.rows-radius;i++)\n        {\n            for(int j=radius;j<img.cols-radius;j++)\n            {\n                //获得中心像素点的灰度值\n                uchar center = img.at<uchar>(i,j);\n                //根据双线性插值公式计算第k个采样点的灰度值\n                float neighbor = img.at<uchar>(i+x1,j+y1) * w1 + img.at<uchar>(i+x1,j+y2) *w2 + img.at<uchar>(i+x2,j+y1) * w3 +img.at<uchar>(i+x2,j+y2) *w4;\n                //LBP特征图像的每个邻居的LBP值累加，累加通过与操作完成，对应的LBP值通过移位取得\n                result.at<uchar>(i-radius,j-radius) |= (neighbor>center) <<(neighbors-k-1);\n            }\n        }\n    }\n    //进行旋转不变处理\n    for(int i=0;i<result.rows;i++)\n    {\n        for(int j=0;j<result.cols;j++)\n        {\n            uchar currentValue = result.at<uchar>(i,j);\n            uchar minValue = currentValue;\n            for(int k=1;k<neighbors;k++)\t\t//循环左移\n            {\n                uchar temp = (currentValue>>(neighbors-k)) | (currentValue<<k);\n                if(temp < minValue)\n                {\n                    minValue = temp;\n                }\n            }\n            result.at<uchar>(i,j) = minValue;\n        }\n    }\n    return result;\n}\n\nint main(int argc, char* argv[])\n{\n  Mat src = imread(argv[1], 0);\n  Mat dst = get_original_LBP_feature(src);\n  Mat odst1 = get_circular_LBP_feature(src, 1, 8);\n  //Mat odst4 = get_circular_LBP_feature(src, 4, 8);\n  Mat rif8 = get_rotation_invariant_LBP_feature(src, 1, 8);\n  Mat rif6 = get_rotation_invariant_LBP_feature(src, 1, 6);\n\n\n  imshow(\"原始图片\", src);\n  imshow(\"原始LBP\", dst);\n  imshow(\"圆形LBP\", odst1);\n  //imshow(\"圆形LBP4\", odst4);\n  imshow(\"旋转不变LBP\", rif8);\n  //imshow(\"旋转不变LBP6\", rif6);\n\n  waitKey(0);\n  return 0;\n}\n```\n","slug":"Local-Binary-Patterns","published":1,"updated":"2020-02-24T10:49:41.358Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0t8001474judddgd7ta","content":"<h1 id=\"LBP算法\"><a href=\"#LBP算法\" class=\"headerlink\" title=\"LBP算法\"></a>LBP算法</h1><p>LBP（Local Binary Patterns，局部二值模式）是一种能够有效地度量和提取图像局部纹理信息的算子，具有旋转不变性和灰度不变性等显著的优点。它是人脸识别中一种提取特征的重要方法，具有对光照不敏感的特性，但是对姿态和表情的鲁棒性不强。</p>\n<h2 id=\"纹理\"><a href=\"#纹理\" class=\"headerlink\" title=\"纹理\"></a>纹理</h2><p>纹理是由于物体表面物理属性不同所引起的能够表示某个特定表面特征的灰度或颜色信息。纹理反映了图像灰度模式的空间分布，包含了图像的表面信息及其周围环境的关系。</p>\n<h2 id=\"基本的LBP算子\"><a href=\"#基本的LBP算子\" class=\"headerlink\" title=\"基本的LBP算子\"></a>基本的LBP算子</h2><p>局部二值模式是一种灰度范围内的纹理描述方式。最初的LBP算子定义在一个3×3的窗口，以窗口中心像素点为阈值，将相邻的像素的灰度值与其进行比较，若周围的像素值大于中心点的值，则将该像素位置标记为1,否则为0.这样一个3×3邻域内的8个点可产生一个8-bit的无符号数，再按其位置赋予不同权重求和得一整数，即可得到该窗口的 <strong>LBP</strong> 值，并用这个数反映该区域的纹理信息。<br>对比度分量C是邻域中所有大于和等于中心点像素的均值与所有小于中心点像素的均值之差。<br><img src=\"https://i.loli.net/2019/07/31/5d415779ca87257597.jpg\" alt></p>\n<p>基本的LBP算子最大的缺陷是只覆盖了一个固定半径范围内的小区域，改进的LBP算子，将3×3邻域扩展到任意邻域，用圆形邻域代替了正方形邻域，该算子允许在半径为R的圆形邻域内有任意多个像素点。</p>\n<ul>\n<li>一个局部区域的纹理分布可假设为局部区域内像素灰度的联合分布密度<br>$$T = t(g_c,g_0, ….,g_{p-1})$$<br>$g_c$表示局部区域的中心点的灰度值,$g_p(p=0,1,…,p)$对应中心点周围等距分布的P个点</li>\n<li>采用 <strong>双线性插算法</strong> 对没有完全落在像素位置的点计算灰度值。邻域内的$g_p$点的坐标可以表示为:<br>$$(x_p,y_p) = (x_c + Rcos(\\frac{2\\pi}{P}),y_c - Rsin(\\frac{2\\pi}{P}))$$<br>$(x_c,y_c)$表示中心点的坐标</li>\n<li>将中心点$g_c$的值从邻域像素的灰度值$g_p$中减去，则局部区域的纹理可以用中心点和中心点与周边像素值之差的联合分布来表示:<br>$$T = t(g_c,g_0-g_c,….,g_{p-1}-g_c)$$</li>\n<li>假设中心像素点$g_c$与周边点像素$g_p$的差值$g_p-g_c(p=0,1,…P)$独立于中心点$g_c$，则<br>$$T\\approx t(g_c)(g_0-g_c,…,g_{p-1}-g_c)$$</li>\n<li>实际上，$t(g_c)$只是描述了整个图像的亮度分布情况，而和图像的局部纹理无关，它不能为纹理分析提供任何有价值的信息<br>$$T\\approx t(g_0-g_c,…,g_{p-1}-g_c)$$</li>\n<li>差值的联合分布具有灰度平移不变性，即邻域中所有P+1个像素同时加上或减去某个值，其表征的纹理不变。</li>\n<li>为了达到尺度不变的目的，只考虑差值的符号<br>$$T\\approx t(s(g_0-g_c),…,s(g_p-g_c))$$</li>\n</ul>\n<p>$$s(x)=\\begin{cases}<br>1 , \\quad &amp;x &gt; 0  \\\\\\<br>0 , &amp;x \\geqslant 0<br>\\end{cases}<br>$$</p>\n<p>上式得到了一个8位的二进制数，再对像素按不同位置用$2^p$进行加权求和，这样得到了一个与邻域像素点相关的唯一的 <strong>LBP</strong> 值，这个值称为 <strong>模式</strong>。这个值描述的是以$(x_c,y_c)$为中心的局部区域的纹理，可以表示为<br>$$LBP(x_c,y_c) = \\sum_{p=0}^{P-1}s(g_p - g_c)2^P$$<br>上式意味着差值的符号转化成一个P-bit的二进制数，进而转化成为一个取值范围为0-$2^p$的离散的LBP值，或者说转化为一种LBP模式。</p>\n<ul>\n<li>局部区域的灰度分布或纹理，可以用这个LBP值或LBP模式近似描述为:<br>$$T\\approx t(LBP(x_c,y_c))$$<br>LBP算子对于任何单调的灰度变化具有鲁棒性，用符号$LBP_P^R$表示在半径为R的圆形邻域内有P个像素点$g_p(p=0,1,…,P)$的LBP算子<br><img src=\"https://i.loli.net/2019/07/31/5d415779b84ac47631.jpg\" alt></li>\n</ul>\n<h2 id=\"LBP等价模式\"><a href=\"#LBP等价模式\" class=\"headerlink\" title=\"LBP等价模式\"></a>LBP等价模式</h2><h3 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p>当某个局部二进制模式所对应的循环二进制数从０到１或从１到０最多有两次跳变时，该局部二进制模式所对应的二进制就称为一个等价模式类。比如00000000,11111111,10001111都是等价类。</p>\n<h3 id=\"检验方法\"><a href=\"#检验方法\" class=\"headerlink\" title=\"检验方法\"></a>检验方法</h3><p>检验某种模式是否是等价模式的简单办法是将其和其移动一位后的二进制模式按位相减的绝对值求和<br>$$U(G_p) = |s(g_{p-1}-g_c)-s(g_0-g_c)|+\\sum_{p=1}^{P-1}|s(g_p-g_c)-s(g_{p-1}-g_c)$$<br>若某种模式计算得到的 $U(G_p)$小于或等于２，则将其归于等价模式<br><img src=\"https://i.loli.net/2019/07/31/5d415779c949196019.jpg\" alt></p>\n<h2 id=\"旋转不变的LBP算子\"><a href=\"#旋转不变的LBP算子\" class=\"headerlink\" title=\"旋转不变的LBP算子\"></a>旋转不变的LBP算子</h2><h3 id=\"定义-1\"><a href=\"#定义-1\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p>不断旋转圆形邻域得到一系列的初始定义的LBP值，取其最小值作为该邻域的LBP值，用公式表示为:<br>$$LBP_{P,R}^{ri} = min(ROR(LBP_{P,R}^{ri},i)|i=0,1,…,P-1)$$<br>$LBP^{ri}$表示旋转不变的LBP算子，$ROR(x,i)$函数为旋转函数，表示将x循环右移i(i&lt;P)位。</p>\n<h3 id=\"性质\"><a href=\"#性质\" class=\"headerlink\" title=\"性质\"></a>性质</h3><ul>\n<li>对于图像旋转，表现的更为鲁棒，并且LBP模式的种类进一步减少，使纹理识别更加容易。</li>\n<li>丢失了方向信息<br><img src=\"https://i.loli.net/2019/07/31/5d415779b8fed91298.jpg\" alt></li>\n</ul>\n<h2 id=\"旋转不变的的等价模式\"><a href=\"#旋转不变的的等价模式\" class=\"headerlink\" title=\"旋转不变的的等价模式\"></a>旋转不变的的等价模式</h2><h3 id=\"定义-2\"><a href=\"#定义-2\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p>将等价模式类进行旋转得到旋转不变的等价模式</p>\n<p>$$LBP_{P,R}^{riu2} = \\begin{cases}<br>\\sum_{P=0}^{P-1}s(g_p-g_c), &amp; U(G_p) \\leq 2 \\\\\\<br>P + 1, &amp; U(G_p) &gt;2<br>\\end{cases}<br>$$</p>\n<p>其中$U(G_p)$表示0到1或1到0跳变的次数，$LBP^{riu2}$被称为旋转不变的等价模式</p>\n<h2 id=\"几种LBP算子的维数比较\"><a href=\"#几种LBP算子的维数比较\" class=\"headerlink\" title=\"几种LBP算子的维数比较\"></a>几种LBP算子的维数比较</h2><table>\n<thead>\n<tr>\n<th align=\"center\">LBP</th>\n<th align=\"center\">原始模式数</th>\n<th align=\"center\">等价模式</th>\n<th align=\"center\">旋转不变等价模式</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">$LBP_P^R$</td>\n<td align=\"center\">$2^P$</td>\n<td align=\"center\">$P(P-1) + 2$</td>\n<td align=\"center\">$P+1$</td>\n</tr>\n<tr>\n<td align=\"center\">$LBP_8^1$</td>\n<td align=\"center\">256</td>\n<td align=\"center\">58(+1)</td>\n<td align=\"center\">9</td>\n</tr>\n<tr>\n<td align=\"center\">$LBP_{16}^2$</td>\n<td align=\"center\">65536</td>\n<td align=\"center\">242(+1)</td>\n<td align=\"center\">17</td>\n</tr>\n<tr>\n<td align=\"center\">$LBP_{24}^3$</td>\n<td align=\"center\">16777216</td>\n<td align=\"center\">554(+1)</td>\n<td align=\"center\">25</td>\n</tr>\n</tbody></table>\n<h1 id=\"LBP特征实现\"><a href=\"#LBP特征实现\" class=\"headerlink\" title=\"LBP特征实现\"></a>LBP特征实现</h1><h2 id=\"原始LBP特征\"><a href=\"#原始LBP特征\" class=\"headerlink\" title=\"原始LBP特征\"></a>原始LBP特征</h2><pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\" spellcheck=\"true\">//Original_LBP</span>\nMat <span class=\"token function\">get_original_LBP_feature</span><span class=\"token punctuation\">(</span>Mat img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  Mat result<span class=\"token punctuation\">;</span>\n  result<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>rows <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span>cols <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  result<span class=\"token punctuation\">.</span><span class=\"token function\">setTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> img<span class=\"token punctuation\">.</span>rows <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> img<span class=\"token punctuation\">.</span>cols <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      uchar center <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      uchar lbpcode <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> j <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> j <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n      result<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> lbpcode<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p><img src=\"https://i.loli.net/2019/07/31/5d4161dac5f0b23887.png\" alt></p>\n<h2 id=\"圆形LBP特征\"><a href=\"#圆形LBP特征\" class=\"headerlink\" title=\"圆形LBP特征\"></a>圆形LBP特征</h2><pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\" spellcheck=\"true\">//Circular_LBP_feature</span>\nMat <span class=\"token function\">get_circular_LBP_feature</span><span class=\"token punctuation\">(</span>Mat img<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> radius<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> neighbors<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  Mat result<span class=\"token punctuation\">;</span>\n  result<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>rows <span class=\"token operator\">-</span> radius <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span>cols <span class=\"token operator\">-</span> radius <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  result<span class=\"token punctuation\">.</span><span class=\"token function\">setTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\" spellcheck=\"true\">//循环处理每个像素</span>\n  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span>radius<span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>img<span class=\"token punctuation\">.</span>rows<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j<span class=\"token operator\">=</span>radius<span class=\"token punctuation\">;</span>j<span class=\"token operator\">&lt;</span>img<span class=\"token punctuation\">.</span>cols<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">;</span>j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\" spellcheck=\"true\">//获得中心像素点的灰度值</span>\n          uchar center <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          uchar lbpCode <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> k<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>k<span class=\"token operator\">&lt;</span>neighbors<span class=\"token punctuation\">;</span>k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">{</span>\n              <span class=\"token comment\" spellcheck=\"true\">//根据公式计算第k个采样点的坐标，这个地方可以优化，不必每次都进行计算radius*cos，radius*sin</span>\n              <span class=\"token keyword\">float</span> x <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">float</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>radius <span class=\"token operator\">*</span> \\\n                  <span class=\"token function\">cos</span><span class=\"token punctuation\">(</span><span class=\"token number\">2.0</span> <span class=\"token operator\">*</span> CV_PI <span class=\"token operator\">*</span> k <span class=\"token operator\">/</span> neighbors<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token keyword\">float</span> y <span class=\"token operator\">=</span> j <span class=\"token operator\">-</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">float</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>radius <span class=\"token operator\">*</span> \\\n                  <span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token number\">2.0</span> <span class=\"token operator\">*</span> CV_PI <span class=\"token operator\">*</span> k <span class=\"token operator\">/</span> neighbors<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\" spellcheck=\"true\">//根据取整结果进行双线性插值，得到第k个采样点的灰度值</span>\n                <span class=\"token comment\" spellcheck=\"true\">//1.分别对x，y进行上下取整</span>\n                <span class=\"token keyword\">int</span> x1 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">int</span> x2 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">int</span> y1 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">int</span> y2 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token comment\" spellcheck=\"true\">//将坐标映射到0-1之间</span>\n                <span class=\"token keyword\">float</span> tx <span class=\"token operator\">=</span> x <span class=\"token operator\">-</span> x1<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">float</span> ty <span class=\"token operator\">=</span> y <span class=\"token operator\">-</span> y1<span class=\"token punctuation\">;</span>\n                <span class=\"token comment\" spellcheck=\"true\">//根据0-1之间的x，y的权重计算公式计算权重</span>\n                <span class=\"token keyword\">float</span> w1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>tx<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>ty<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">float</span> w2 <span class=\"token operator\">=</span>    tx  <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>ty<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">float</span> w3 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>tx<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span>    ty<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">float</span> w4 <span class=\"token operator\">=</span>    tx  <span class=\"token operator\">*</span>    ty<span class=\"token punctuation\">;</span>\n                <span class=\"token comment\" spellcheck=\"true\">//3.根据双线性插值公式计算第k个采样点的灰度值</span>\n                <span class=\"token keyword\">float</span> neighbor <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>x1<span class=\"token punctuation\">,</span>y1<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> w1 <span class=\"token operator\">+</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>x1<span class=\"token punctuation\">,</span>y2<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span>w2 <span class=\"token operator\">+</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>x2<span class=\"token punctuation\">,</span>y1<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> w3 <span class=\"token operator\">+</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>x2<span class=\"token punctuation\">,</span>y2<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span>w4<span class=\"token punctuation\">;</span>\n                <span class=\"token comment\" spellcheck=\"true\">//通过比较获得LBP值，并按顺序排列起来</span>\n                lbpCode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>neighbor<span class=\"token operator\">></span>center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token punctuation\">(</span>neighbors<span class=\"token operator\">-</span>k<span class=\"token number\">-1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            result<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">,</span>j<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> lbpCode<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>结果:<br><img src=\"https://i.loli.net/2019/08/01/5d42b5d2e345026549.png\" alt></p>\n<p>第一幅图设置半径为4,第二幅图设置半径为1,可以看到半径越小处理的越精细。</p>\n<h2 id=\"旋转不变LBP特征\"><a href=\"#旋转不变LBP特征\" class=\"headerlink\" title=\"旋转不变LBP特征\"></a>旋转不变LBP特征</h2><pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\" spellcheck=\"true\">//Rotation_Invariant_LBP_feature</span>\nMat <span class=\"token function\">get_rotation_invariant_LBP_feature</span><span class=\"token punctuation\">(</span>Mat img<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> radius<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> neighbors<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  Mat result<span class=\"token punctuation\">;</span>\n  result<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>rows <span class=\"token operator\">-</span> radius <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span>cols <span class=\"token operator\">-</span> radius <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  result<span class=\"token punctuation\">.</span><span class=\"token function\">setTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> k<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>k<span class=\"token operator\">&lt;</span>neighbors<span class=\"token punctuation\">;</span>k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\" spellcheck=\"true\">//计算采样点对于中心点坐标的偏移量rx，ry</span>\n        <span class=\"token keyword\">float</span> rx <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">float</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>radius <span class=\"token operator\">*</span> <span class=\"token function\">cos</span><span class=\"token punctuation\">(</span><span class=\"token number\">2.0</span> <span class=\"token operator\">*</span> CV_PI <span class=\"token operator\">*</span> k <span class=\"token operator\">/</span> neighbors<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">float</span> ry <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">float</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>radius <span class=\"token operator\">*</span> <span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token number\">2.0</span> <span class=\"token operator\">*</span> CV_PI <span class=\"token operator\">*</span> k <span class=\"token operator\">/</span> neighbors<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">//为双线性插值做准备</span>\n        <span class=\"token comment\" spellcheck=\"true\">//对采样点偏移量分别进行上下取整</span>\n        <span class=\"token keyword\">int</span> x1 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>rx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> x2 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>rx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> y1 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>ry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> y2 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>ry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">//将坐标偏移量映射到0-1之间</span>\n        <span class=\"token keyword\">float</span> tx <span class=\"token operator\">=</span> rx <span class=\"token operator\">-</span> x1<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">float</span> ty <span class=\"token operator\">=</span> ry <span class=\"token operator\">-</span> y1<span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">//根据0-1之间的x，y的权重计算公式计算权重，权重与坐标具体位置无关，与坐标间的差值有关</span>\n        <span class=\"token keyword\">float</span> w1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>tx<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>ty<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">float</span> w2 <span class=\"token operator\">=</span>    tx  <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>ty<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">float</span> w3 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>tx<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span>    ty<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">float</span> w4 <span class=\"token operator\">=</span>    tx  <span class=\"token operator\">*</span>    ty<span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">//循环处理每个像素</span>\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span>radius<span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>img<span class=\"token punctuation\">.</span>rows<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j<span class=\"token operator\">=</span>radius<span class=\"token punctuation\">;</span>j<span class=\"token operator\">&lt;</span>img<span class=\"token punctuation\">.</span>cols<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">;</span>j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\" spellcheck=\"true\">//获得中心像素点的灰度值</span>\n                uchar center <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\" spellcheck=\"true\">//根据双线性插值公式计算第k个采样点的灰度值</span>\n                <span class=\"token keyword\">float</span> neighbor <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span>x1<span class=\"token punctuation\">,</span>j<span class=\"token operator\">+</span>y1<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> w1 <span class=\"token operator\">+</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span>x1<span class=\"token punctuation\">,</span>j<span class=\"token operator\">+</span>y2<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span>w2 <span class=\"token operator\">+</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span>x2<span class=\"token punctuation\">,</span>j<span class=\"token operator\">+</span>y1<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> w3 <span class=\"token operator\">+</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span>x2<span class=\"token punctuation\">,</span>j<span class=\"token operator\">+</span>y2<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span>w4<span class=\"token punctuation\">;</span>\n                <span class=\"token comment\" spellcheck=\"true\">//LBP特征图像的每个邻居的LBP值累加，累加通过与操作完成，对应的LBP值通过移位取得</span>\n                result<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">,</span>j<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>neighbor<span class=\"token operator\">></span>center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token punctuation\">(</span>neighbors<span class=\"token operator\">-</span>k<span class=\"token number\">-1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\" spellcheck=\"true\">//进行旋转不变处理</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>result<span class=\"token punctuation\">.</span>rows<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>j<span class=\"token operator\">&lt;</span>result<span class=\"token punctuation\">.</span>cols<span class=\"token punctuation\">;</span>j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            uchar currentValue <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            uchar minValue <span class=\"token operator\">=</span> currentValue<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> k<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>k<span class=\"token operator\">&lt;</span>neighbors<span class=\"token punctuation\">;</span>k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\" spellcheck=\"true\">//循环左移</span>\n            <span class=\"token punctuation\">{</span>\n                uchar temp <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>currentValue<span class=\"token operator\">>></span><span class=\"token punctuation\">(</span>neighbors<span class=\"token operator\">-</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">(</span>currentValue<span class=\"token operator\">&lt;&lt;</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>temp <span class=\"token operator\">&lt;</span> minValue<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{</span>\n                    minValue <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            result<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> minValue<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>结果:<br><img src=\"https://i.loli.net/2019/08/01/5d42b5d30749958722.png\" alt></p>\n<p>第一幅图neighbors值设置为8,第二幅设置为6,可以看出neighbors值越大，得到的LBP特征亮度越高。</p>\n<h2 id=\"完整代码如下\"><a href=\"#完整代码如下\" class=\"headerlink\" title=\"完整代码如下\"></a>完整代码如下</h2><pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/highgui/highgui.hpp></span></span>\n\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> cv<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">//Original_LBP</span>\nMat <span class=\"token function\">get_original_LBP_feature</span><span class=\"token punctuation\">(</span>Mat img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  Mat result<span class=\"token punctuation\">;</span>\n  result<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>rows <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span>cols <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  result<span class=\"token punctuation\">.</span><span class=\"token function\">setTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> img<span class=\"token punctuation\">.</span>rows <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> img<span class=\"token punctuation\">.</span>cols <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      uchar center <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      uchar lbpcode <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> j <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> j <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n      lbpcode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n      result<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> lbpcode<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\" spellcheck=\"true\">//Circular_LBP_feature</span>\nMat <span class=\"token function\">get_circular_LBP_feature</span><span class=\"token punctuation\">(</span>Mat img<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> radius<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> neighbors<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  Mat result<span class=\"token punctuation\">;</span>\n  result<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>rows <span class=\"token operator\">-</span> radius <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span>cols <span class=\"token operator\">-</span> radius <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  result<span class=\"token punctuation\">.</span><span class=\"token function\">setTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\" spellcheck=\"true\">//循环处理每个像素</span>\n  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span>radius<span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>img<span class=\"token punctuation\">.</span>rows<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j<span class=\"token operator\">=</span>radius<span class=\"token punctuation\">;</span>j<span class=\"token operator\">&lt;</span>img<span class=\"token punctuation\">.</span>cols<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">;</span>j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\" spellcheck=\"true\">//获得中心像素点的灰度值</span>\n          uchar center <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          uchar lbpCode <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> k<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>k<span class=\"token operator\">&lt;</span>neighbors<span class=\"token punctuation\">;</span>k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">{</span>\n              <span class=\"token comment\" spellcheck=\"true\">//根据公式计算第k个采样点的坐标，这个地方可以优化，不必每次都进行计算radius*cos，radius*sin</span>\n              <span class=\"token keyword\">float</span> x <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">float</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>radius <span class=\"token operator\">*</span> \\\n                  <span class=\"token function\">cos</span><span class=\"token punctuation\">(</span><span class=\"token number\">2.0</span> <span class=\"token operator\">*</span> CV_PI <span class=\"token operator\">*</span> k <span class=\"token operator\">/</span> neighbors<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token keyword\">float</span> y <span class=\"token operator\">=</span> j <span class=\"token operator\">-</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">float</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>radius <span class=\"token operator\">*</span> \\\n                  <span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token number\">2.0</span> <span class=\"token operator\">*</span> CV_PI <span class=\"token operator\">*</span> k <span class=\"token operator\">/</span> neighbors<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\" spellcheck=\"true\">//根据取整结果进行双线性插值，得到第k个采样点的灰度值</span>\n                <span class=\"token comment\" spellcheck=\"true\">//1.分别对x，y进行上下取整</span>\n                <span class=\"token keyword\">int</span> x1 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">int</span> x2 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">int</span> y1 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">int</span> y2 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token comment\" spellcheck=\"true\">//将坐标映射到0-1之间</span>\n                <span class=\"token keyword\">float</span> tx <span class=\"token operator\">=</span> x <span class=\"token operator\">-</span> x1<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">float</span> ty <span class=\"token operator\">=</span> y <span class=\"token operator\">-</span> y1<span class=\"token punctuation\">;</span>\n                <span class=\"token comment\" spellcheck=\"true\">//根据0-1之间的x，y的权重计算公式计算权重</span>\n                <span class=\"token keyword\">float</span> w1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>tx<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>ty<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">float</span> w2 <span class=\"token operator\">=</span>    tx  <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>ty<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">float</span> w3 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>tx<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span>    ty<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">float</span> w4 <span class=\"token operator\">=</span>    tx  <span class=\"token operator\">*</span>    ty<span class=\"token punctuation\">;</span>\n                <span class=\"token comment\" spellcheck=\"true\">//3.根据双线性插值公式计算第k个采样点的灰度值</span>\n                <span class=\"token keyword\">float</span> neighbor <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>x1<span class=\"token punctuation\">,</span>y1<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> w1 <span class=\"token operator\">+</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>x1<span class=\"token punctuation\">,</span>y2<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span>w2 <span class=\"token operator\">+</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>x2<span class=\"token punctuation\">,</span>y1<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> w3 <span class=\"token operator\">+</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>x2<span class=\"token punctuation\">,</span>y2<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span>w4<span class=\"token punctuation\">;</span>\n                <span class=\"token comment\" spellcheck=\"true\">//通过比较获得LBP值，并按顺序排列起来</span>\n                lbpCode <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>neighbor<span class=\"token operator\">></span>center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token punctuation\">(</span>neighbors<span class=\"token operator\">-</span>k<span class=\"token number\">-1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            result<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">,</span>j<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> lbpCode<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\" spellcheck=\"true\">//Rotation_Invariant_LBP_feature</span>\nMat <span class=\"token function\">get_rotation_invariant_LBP_feature</span><span class=\"token punctuation\">(</span>Mat img<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> radius<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> neighbors<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  Mat result<span class=\"token punctuation\">;</span>\n  result<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>rows <span class=\"token operator\">-</span> radius <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span>cols <span class=\"token operator\">-</span> radius <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  result<span class=\"token punctuation\">.</span><span class=\"token function\">setTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> k<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>k<span class=\"token operator\">&lt;</span>neighbors<span class=\"token punctuation\">;</span>k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\" spellcheck=\"true\">//计算采样点对于中心点坐标的偏移量rx，ry</span>\n        <span class=\"token keyword\">float</span> rx <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">float</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>radius <span class=\"token operator\">*</span> <span class=\"token function\">cos</span><span class=\"token punctuation\">(</span><span class=\"token number\">2.0</span> <span class=\"token operator\">*</span> CV_PI <span class=\"token operator\">*</span> k <span class=\"token operator\">/</span> neighbors<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">float</span> ry <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">float</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>radius <span class=\"token operator\">*</span> <span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token number\">2.0</span> <span class=\"token operator\">*</span> CV_PI <span class=\"token operator\">*</span> k <span class=\"token operator\">/</span> neighbors<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">//为双线性插值做准备</span>\n        <span class=\"token comment\" spellcheck=\"true\">//对采样点偏移量分别进行上下取整</span>\n        <span class=\"token keyword\">int</span> x1 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>rx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> x2 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>rx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> y1 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>ry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> y2 <span class=\"token operator\">=</span> <span class=\"token keyword\">static_cast</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>ry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">//将坐标偏移量映射到0-1之间</span>\n        <span class=\"token keyword\">float</span> tx <span class=\"token operator\">=</span> rx <span class=\"token operator\">-</span> x1<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">float</span> ty <span class=\"token operator\">=</span> ry <span class=\"token operator\">-</span> y1<span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">//根据0-1之间的x，y的权重计算公式计算权重，权重与坐标具体位置无关，与坐标间的差值有关</span>\n        <span class=\"token keyword\">float</span> w1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>tx<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>ty<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">float</span> w2 <span class=\"token operator\">=</span>    tx  <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>ty<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">float</span> w3 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>tx<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span>    ty<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">float</span> w4 <span class=\"token operator\">=</span>    tx  <span class=\"token operator\">*</span>    ty<span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">//循环处理每个像素</span>\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span>radius<span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>img<span class=\"token punctuation\">.</span>rows<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j<span class=\"token operator\">=</span>radius<span class=\"token punctuation\">;</span>j<span class=\"token operator\">&lt;</span>img<span class=\"token punctuation\">.</span>cols<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">;</span>j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\" spellcheck=\"true\">//获得中心像素点的灰度值</span>\n                uchar center <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\" spellcheck=\"true\">//根据双线性插值公式计算第k个采样点的灰度值</span>\n                <span class=\"token keyword\">float</span> neighbor <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span>x1<span class=\"token punctuation\">,</span>j<span class=\"token operator\">+</span>y1<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> w1 <span class=\"token operator\">+</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span>x1<span class=\"token punctuation\">,</span>j<span class=\"token operator\">+</span>y2<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span>w2 <span class=\"token operator\">+</span> img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span>x2<span class=\"token punctuation\">,</span>j<span class=\"token operator\">+</span>y1<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> w3 <span class=\"token operator\">+</span>img<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span>x2<span class=\"token punctuation\">,</span>j<span class=\"token operator\">+</span>y2<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span>w4<span class=\"token punctuation\">;</span>\n                <span class=\"token comment\" spellcheck=\"true\">//LBP特征图像的每个邻居的LBP值累加，累加通过与操作完成，对应的LBP值通过移位取得</span>\n                result<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">,</span>j<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>neighbor<span class=\"token operator\">></span>center<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token punctuation\">(</span>neighbors<span class=\"token operator\">-</span>k<span class=\"token number\">-1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\" spellcheck=\"true\">//进行旋转不变处理</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>result<span class=\"token punctuation\">.</span>rows<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>j<span class=\"token operator\">&lt;</span>result<span class=\"token punctuation\">.</span>cols<span class=\"token punctuation\">;</span>j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            uchar currentValue <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            uchar minValue <span class=\"token operator\">=</span> currentValue<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> k<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>k<span class=\"token operator\">&lt;</span>neighbors<span class=\"token punctuation\">;</span>k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\" spellcheck=\"true\">//循环左移</span>\n            <span class=\"token punctuation\">{</span>\n                uchar temp <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>currentValue<span class=\"token operator\">>></span><span class=\"token punctuation\">(</span>neighbors<span class=\"token operator\">-</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">(</span>currentValue<span class=\"token operator\">&lt;&lt;</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>temp <span class=\"token operator\">&lt;</span> minValue<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{</span>\n                    minValue <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            result<span class=\"token punctuation\">.</span>at<span class=\"token operator\">&lt;</span>uchar<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> minValue<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  Mat src <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Mat dst <span class=\"token operator\">=</span> <span class=\"token function\">get_original_LBP_feature</span><span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Mat odst1 <span class=\"token operator\">=</span> <span class=\"token function\">get_circular_LBP_feature</span><span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\" spellcheck=\"true\">//Mat odst4 = get_circular_LBP_feature(src, 4, 8);</span>\n  Mat rif8 <span class=\"token operator\">=</span> <span class=\"token function\">get_rotation_invariant_LBP_feature</span><span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Mat rif6 <span class=\"token operator\">=</span> <span class=\"token function\">get_rotation_invariant_LBP_feature</span><span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n  <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"原始图片\"</span><span class=\"token punctuation\">,</span> src<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"原始LBP\"</span><span class=\"token punctuation\">,</span> dst<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"圆形LBP\"</span><span class=\"token punctuation\">,</span> odst1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\" spellcheck=\"true\">//imshow(\"圆形LBP4\", odst4);</span>\n  <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"旋转不变LBP\"</span><span class=\"token punctuation\">,</span> rif8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\" spellcheck=\"true\">//imshow(\"旋转不变LBP6\", rif6);</span>\n\n  <span class=\"token function\">waitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"LBP算法\"><a href=\"#LBP算法\" class=\"headerlink\" title=\"LBP算法\"></a>LBP算法</h1><p>LBP（Local Binary Patterns，局部二值模式）是一种能够有效地度量和提取图像局部纹理信息的算子，具有旋转不变性和灰度不变性等显著的优点。它是人脸识别中一种提取特征的重要方法，具有对光照不敏感的特性，但是对姿态和表情的鲁棒性不强。</p>\n<h2 id=\"纹理\"><a href=\"#纹理\" class=\"headerlink\" title=\"纹理\"></a>纹理</h2><p>纹理是由于物体表面物理属性不同所引起的能够表示某个特定表面特征的灰度或颜色信息。纹理反映了图像灰度模式的空间分布，包含了图像的表面信息及其周围环境的关系。</p>\n<h2 id=\"基本的LBP算子\"><a href=\"#基本的LBP算子\" class=\"headerlink\" title=\"基本的LBP算子\"></a>基本的LBP算子</h2><p>局部二值模式是一种灰度范围内的纹理描述方式。最初的LBP算子定义在一个3×3的窗口，以窗口中心像素点为阈值，将相邻的像素的灰度值与其进行比较，若周围的像素值大于中心点的值，则将该像素位置标记为1,否则为0.这样一个3×3邻域内的8个点可产生一个8-bit的无符号数，再按其位置赋予不同权重求和得一整数，即可得到该窗口的 <strong>LBP</strong> 值，并用这个数反映该区域的纹理信息。<br>对比度分量C是邻域中所有大于和等于中心点像素的均值与所有小于中心点像素的均值之差。<br><img src=\"https://i.loli.net/2019/07/31/5d415779ca87257597.jpg\" alt></p>\n<p>基本的LBP算子最大的缺陷是只覆盖了一个固定半径范围内的小区域，改进的LBP算子，将3×3邻域扩展到任意邻域，用圆形邻域代替了正方形邻域，该算子允许在半径为R的圆形邻域内有任意多个像素点。</p>\n<ul>\n<li>一个局部区域的纹理分布可假设为局部区域内像素灰度的联合分布密度<br>$$T = t(g_c,g_0, ….,g_{p-1})$$<br>$g_c$表示局部区域的中心点的灰度值,$g_p(p=0,1,…,p)$对应中心点周围等距分布的P个点</li>\n<li>采用 <strong>双线性插算法</strong> 对没有完全落在像素位置的点计算灰度值。邻域内的$g_p$点的坐标可以表示为:<br>$$(x_p,y_p) = (x_c + Rcos(\\frac{2\\pi}{P}),y_c - Rsin(\\frac{2\\pi}{P}))$$<br>$(x_c,y_c)$表示中心点的坐标</li>\n<li>将中心点$g_c$的值从邻域像素的灰度值$g_p$中减去，则局部区域的纹理可以用中心点和中心点与周边像素值之差的联合分布来表示:<br>$$T = t(g_c,g_0-g_c,….,g_{p-1}-g_c)$$</li>\n<li>假设中心像素点$g_c$与周边点像素$g_p$的差值$g_p-g_c(p=0,1,…P)$独立于中心点$g_c$，则<br>$$T\\approx t(g_c)(g_0-g_c,…,g_{p-1}-g_c)$$</li>\n<li>实际上，$t(g_c)$只是描述了整个图像的亮度分布情况，而和图像的局部纹理无关，它不能为纹理分析提供任何有价值的信息<br>$$T\\approx t(g_0-g_c,…,g_{p-1}-g_c)$$</li>\n<li>差值的联合分布具有灰度平移不变性，即邻域中所有P+1个像素同时加上或减去某个值，其表征的纹理不变。</li>\n<li>为了达到尺度不变的目的，只考虑差值的符号<br>$$T\\approx t(s(g_0-g_c),…,s(g_p-g_c))$$</li>\n</ul>\n<p>$$s(x)=\\begin{cases}<br>1 , \\quad &amp;x &gt; 0  \\\\\\<br>0 , &amp;x \\geqslant 0<br>\\end{cases}<br>$$</p>\n<p>上式得到了一个8位的二进制数，再对像素按不同位置用$2^p$进行加权求和，这样得到了一个与邻域像素点相关的唯一的 <strong>LBP</strong> 值，这个值称为 <strong>模式</strong>。这个值描述的是以$(x_c,y_c)$为中心的局部区域的纹理，可以表示为<br>$$LBP(x_c,y_c) = \\sum_{p=0}^{P-1}s(g_p - g_c)2^P$$<br>上式意味着差值的符号转化成一个P-bit的二进制数，进而转化成为一个取值范围为0-$2^p$的离散的LBP值，或者说转化为一种LBP模式。</p>\n<ul>\n<li>局部区域的灰度分布或纹理，可以用这个LBP值或LBP模式近似描述为:<br>$$T\\approx t(LBP(x_c,y_c))$$<br>LBP算子对于任何单调的灰度变化具有鲁棒性，用符号$LBP_P^R$表示在半径为R的圆形邻域内有P个像素点$g_p(p=0,1,…,P)$的LBP算子<br><img src=\"https://i.loli.net/2019/07/31/5d415779b84ac47631.jpg\" alt></li>\n</ul>\n<h2 id=\"LBP等价模式\"><a href=\"#LBP等价模式\" class=\"headerlink\" title=\"LBP等价模式\"></a>LBP等价模式</h2><h3 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p>当某个局部二进制模式所对应的循环二进制数从０到１或从１到０最多有两次跳变时，该局部二进制模式所对应的二进制就称为一个等价模式类。比如00000000,11111111,10001111都是等价类。</p>\n<h3 id=\"检验方法\"><a href=\"#检验方法\" class=\"headerlink\" title=\"检验方法\"></a>检验方法</h3><p>检验某种模式是否是等价模式的简单办法是将其和其移动一位后的二进制模式按位相减的绝对值求和<br>$$U(G_p) = |s(g_{p-1}-g_c)-s(g_0-g_c)|+\\sum_{p=1}^{P-1}|s(g_p-g_c)-s(g_{p-1}-g_c)$$<br>若某种模式计算得到的 $U(G_p)$小于或等于２，则将其归于等价模式<br><img src=\"https://i.loli.net/2019/07/31/5d415779c949196019.jpg\" alt></p>\n<h2 id=\"旋转不变的LBP算子\"><a href=\"#旋转不变的LBP算子\" class=\"headerlink\" title=\"旋转不变的LBP算子\"></a>旋转不变的LBP算子</h2><h3 id=\"定义-1\"><a href=\"#定义-1\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p>不断旋转圆形邻域得到一系列的初始定义的LBP值，取其最小值作为该邻域的LBP值，用公式表示为:<br>$$LBP_{P,R}^{ri} = min(ROR(LBP_{P,R}^{ri},i)|i=0,1,…,P-1)$$<br>$LBP^{ri}$表示旋转不变的LBP算子，$ROR(x,i)$函数为旋转函数，表示将x循环右移i(i&lt;P)位。</p>\n<h3 id=\"性质\"><a href=\"#性质\" class=\"headerlink\" title=\"性质\"></a>性质</h3><ul>\n<li>对于图像旋转，表现的更为鲁棒，并且LBP模式的种类进一步减少，使纹理识别更加容易。</li>\n<li>丢失了方向信息<br><img src=\"https://i.loli.net/2019/07/31/5d415779b8fed91298.jpg\" alt></li>\n</ul>\n<h2 id=\"旋转不变的的等价模式\"><a href=\"#旋转不变的的等价模式\" class=\"headerlink\" title=\"旋转不变的的等价模式\"></a>旋转不变的的等价模式</h2><h3 id=\"定义-2\"><a href=\"#定义-2\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p>将等价模式类进行旋转得到旋转不变的等价模式</p>\n<p>$$LBP_{P,R}^{riu2} = \\begin{cases}<br>\\sum_{P=0}^{P-1}s(g_p-g_c), &amp; U(G_p) \\leq 2 \\\\\\<br>P + 1, &amp; U(G_p) &gt;2<br>\\end{cases}<br>$$</p>\n<p>其中$U(G_p)$表示0到1或1到0跳变的次数，$LBP^{riu2}$被称为旋转不变的等价模式</p>\n<h2 id=\"几种LBP算子的维数比较\"><a href=\"#几种LBP算子的维数比较\" class=\"headerlink\" title=\"几种LBP算子的维数比较\"></a>几种LBP算子的维数比较</h2><table>\n<thead>\n<tr>\n<th align=\"center\">LBP</th>\n<th align=\"center\">原始模式数</th>\n<th align=\"center\">等价模式</th>\n<th align=\"center\">旋转不变等价模式</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">$LBP_P^R$</td>\n<td align=\"center\">$2^P$</td>\n<td align=\"center\">$P(P-1) + 2$</td>\n<td align=\"center\">$P+1$</td>\n</tr>\n<tr>\n<td align=\"center\">$LBP_8^1$</td>\n<td align=\"center\">256</td>\n<td align=\"center\">58(+1)</td>\n<td align=\"center\">9</td>\n</tr>\n<tr>\n<td align=\"center\">$LBP_{16}^2$</td>\n<td align=\"center\">65536</td>\n<td align=\"center\">242(+1)</td>\n<td align=\"center\">17</td>\n</tr>\n<tr>\n<td align=\"center\">$LBP_{24}^3$</td>\n<td align=\"center\">16777216</td>\n<td align=\"center\">554(+1)</td>\n<td align=\"center\">25</td>\n</tr>\n</tbody></table>\n<h1 id=\"LBP特征实现\"><a href=\"#LBP特征实现\" class=\"headerlink\" title=\"LBP特征实现\"></a>LBP特征实现</h1><h2 id=\"原始LBP特征\"><a href=\"#原始LBP特征\" class=\"headerlink\" title=\"原始LBP特征\"></a>原始LBP特征</h2><pre><code class=\"cpp\">//Original_LBP\nMat get_original_LBP_feature(Mat img){\n  Mat result;\n  result.create(img.rows - 2, img.cols -2, img.type());\n  result.setTo(0);\n  for (int i = 1; i &lt; img.rows - 1; i++){\n    for (int j = 1; j &lt; img.cols -1; j++){\n      uchar center = img.at&lt;uchar&gt;(i, j);\n      uchar lbpcode = 0;\n      lbpcode |= (img.at&lt;uchar&gt;(i - 1, j - 1) &gt;= center) &lt;&lt; 7;\n      lbpcode |= (img.at&lt;uchar&gt;(i - 1, j) &gt;= center) &lt;&lt; 6;\n      lbpcode |= (img.at&lt;uchar&gt;(i - 1, j + 1) &gt;= center) &lt;&lt; 5;\n      lbpcode |= (img.at&lt;uchar&gt;(i, j -1) &gt;= center) &lt;&lt; 4;\n      lbpcode |= (img.at&lt;uchar&gt;(i, j + 1) &gt;= center) &lt;&lt; 3;\n      lbpcode |= (img.at&lt;uchar&gt;(i + 1, j - 1) &gt;= center) &lt;&lt; 2;\n      lbpcode |= (img.at&lt;uchar&gt;(i + 1, j) &gt;= center) &lt;&lt; 1;\n      lbpcode |= (img.at&lt;uchar&gt;(i + 1, j + 1) &gt;= center) &lt;&lt; 0;\n      result.at&lt;uchar&gt;(i - 1, j - 1) = lbpcode;\n    }\n  }\n  return result;\n}</code></pre>\n<p><img src=\"https://i.loli.net/2019/07/31/5d4161dac5f0b23887.png\" alt></p>\n<h2 id=\"圆形LBP特征\"><a href=\"#圆形LBP特征\" class=\"headerlink\" title=\"圆形LBP特征\"></a>圆形LBP特征</h2><pre><code class=\"cpp\">//Circular_LBP_feature\nMat get_circular_LBP_feature(Mat img, int radius, int neighbors)\n{\n  Mat result;\n  result.create(img.rows - radius * 2, img.cols - radius * 2, img.type());\n  result.setTo(0);\n  //循环处理每个像素\n  for(int i=radius;i&lt;img.rows-radius;i++)\n  {\n      for(int j=radius;j&lt;img.cols-radius;j++)\n      {\n          //获得中心像素点的灰度值\n          uchar center = img.at&lt;uchar&gt;(i,j);\n          uchar lbpCode = 0;\n          for(int k=0;k&lt;neighbors;k++)\n          {\n              //根据公式计算第k个采样点的坐标，这个地方可以优化，不必每次都进行计算radius*cos，radius*sin\n              float x = i + static_cast&lt;float&gt;(radius * \\\n                  cos(2.0 * CV_PI * k / neighbors));\n              float y = j - static_cast&lt;float&gt;(radius * \\\n                  sin(2.0 * CV_PI * k / neighbors));\n                //根据取整结果进行双线性插值，得到第k个采样点的灰度值\n                //1.分别对x，y进行上下取整\n                int x1 = static_cast&lt;int&gt;(floor(x));\n                int x2 = static_cast&lt;int&gt;(ceil(x));\n                int y1 = static_cast&lt;int&gt;(floor(y));\n                int y2 = static_cast&lt;int&gt;(ceil(y));\n\n                //将坐标映射到0-1之间\n                float tx = x - x1;\n                float ty = y - y1;\n                //根据0-1之间的x，y的权重计算公式计算权重\n                float w1 = (1-tx) * (1-ty);\n                float w2 =    tx  * (1-ty);\n                float w3 = (1-tx) *    ty;\n                float w4 =    tx  *    ty;\n                //3.根据双线性插值公式计算第k个采样点的灰度值\n                float neighbor = img.at&lt;uchar&gt;(x1,y1) * w1 + img.at&lt;uchar&gt;(x1,y2) *w2 + img.at&lt;uchar&gt;(x2,y1) * w3 +img.at&lt;uchar&gt;(x2,y2) *w4;\n                //通过比较获得LBP值，并按顺序排列起来\n                lbpCode |= (neighbor&gt;center) &lt;&lt;(neighbors-k-1);\n            }\n            result.at&lt;uchar&gt;(i-radius,j-radius) = lbpCode;\n        }\n    }\n  return result;\n}</code></pre>\n<p>结果:<br><img src=\"https://i.loli.net/2019/08/01/5d42b5d2e345026549.png\" alt></p>\n<p>第一幅图设置半径为4,第二幅图设置半径为1,可以看到半径越小处理的越精细。</p>\n<h2 id=\"旋转不变LBP特征\"><a href=\"#旋转不变LBP特征\" class=\"headerlink\" title=\"旋转不变LBP特征\"></a>旋转不变LBP特征</h2><pre><code class=\"cpp\">//Rotation_Invariant_LBP_feature\nMat get_rotation_invariant_LBP_feature(Mat img, int radius, int neighbors)\n{\n  Mat result;\n  result.create(img.rows - radius * 2, img.cols - radius * 2, img.type());\n  result.setTo(0);\n  for(int k=0;k&lt;neighbors;k++)\n    {\n        //计算采样点对于中心点坐标的偏移量rx，ry\n        float rx = static_cast&lt;float&gt;(radius * cos(2.0 * CV_PI * k / neighbors));\n        float ry = -static_cast&lt;float&gt;(radius * sin(2.0 * CV_PI * k / neighbors));\n        //为双线性插值做准备\n        //对采样点偏移量分别进行上下取整\n        int x1 = static_cast&lt;int&gt;(floor(rx));\n        int x2 = static_cast&lt;int&gt;(ceil(rx));\n        int y1 = static_cast&lt;int&gt;(floor(ry));\n        int y2 = static_cast&lt;int&gt;(ceil(ry));\n        //将坐标偏移量映射到0-1之间\n        float tx = rx - x1;\n        float ty = ry - y1;\n        //根据0-1之间的x，y的权重计算公式计算权重，权重与坐标具体位置无关，与坐标间的差值有关\n        float w1 = (1-tx) * (1-ty);\n        float w2 =    tx  * (1-ty);\n        float w3 = (1-tx) *    ty;\n        float w4 =    tx  *    ty;\n        //循环处理每个像素\n        for(int i=radius;i&lt;img.rows-radius;i++)\n        {\n            for(int j=radius;j&lt;img.cols-radius;j++)\n            {\n                //获得中心像素点的灰度值\n                uchar center = img.at&lt;uchar&gt;(i,j);\n                //根据双线性插值公式计算第k个采样点的灰度值\n                float neighbor = img.at&lt;uchar&gt;(i+x1,j+y1) * w1 + img.at&lt;uchar&gt;(i+x1,j+y2) *w2 + img.at&lt;uchar&gt;(i+x2,j+y1) * w3 +img.at&lt;uchar&gt;(i+x2,j+y2) *w4;\n                //LBP特征图像的每个邻居的LBP值累加，累加通过与操作完成，对应的LBP值通过移位取得\n                result.at&lt;uchar&gt;(i-radius,j-radius) |= (neighbor&gt;center) &lt;&lt;(neighbors-k-1);\n            }\n        }\n    }\n    //进行旋转不变处理\n    for(int i=0;i&lt;result.rows;i++)\n    {\n        for(int j=0;j&lt;result.cols;j++)\n        {\n            uchar currentValue = result.at&lt;uchar&gt;(i,j);\n            uchar minValue = currentValue;\n            for(int k=1;k&lt;neighbors;k++)        //循环左移\n            {\n                uchar temp = (currentValue&gt;&gt;(neighbors-k)) | (currentValue&lt;&lt;k);\n                if(temp &lt; minValue)\n                {\n                    minValue = temp;\n                }\n            }\n            result.at&lt;uchar&gt;(i,j) = minValue;\n        }\n    }\n    return result;\n}\n</code></pre>\n<p>结果:<br><img src=\"https://i.loli.net/2019/08/01/5d42b5d30749958722.png\" alt></p>\n<p>第一幅图neighbors值设置为8,第二幅设置为6,可以看出neighbors值越大，得到的LBP特征亮度越高。</p>\n<h2 id=\"完整代码如下\"><a href=\"#完整代码如下\" class=\"headerlink\" title=\"完整代码如下\"></a>完整代码如下</h2><pre><code class=\"cpp\">#include &lt;opencv2/highgui/highgui.hpp&gt;\n\nusing namespace cv;\n\n//Original_LBP\nMat get_original_LBP_feature(Mat img){\n  Mat result;\n  result.create(img.rows - 2, img.cols -2, img.type());\n  result.setTo(0);\n  for (int i = 1; i &lt; img.rows - 1; i++){\n    for (int j = 1; j &lt; img.cols -1; j++){\n      uchar center = img.at&lt;uchar&gt;(i, j);\n      uchar lbpcode = 0;\n      lbpcode |= (img.at&lt;uchar&gt;(i - 1, j - 1) &gt;= center) &lt;&lt; 7;\n      lbpcode |= (img.at&lt;uchar&gt;(i - 1, j) &gt;= center) &lt;&lt; 6;\n      lbpcode |= (img.at&lt;uchar&gt;(i - 1, j + 1) &gt;= center) &lt;&lt; 5;\n      lbpcode |= (img.at&lt;uchar&gt;(i, j -1) &gt;= center) &lt;&lt; 4;\n      lbpcode |= (img.at&lt;uchar&gt;(i, j + 1) &gt;= center) &lt;&lt; 3;\n      lbpcode |= (img.at&lt;uchar&gt;(i + 1, j - 1) &gt;= center) &lt;&lt; 2;\n      lbpcode |= (img.at&lt;uchar&gt;(i + 1, j) &gt;= center) &lt;&lt; 1;\n      lbpcode |= (img.at&lt;uchar&gt;(i + 1, j + 1) &gt;= center) &lt;&lt; 0;\n      result.at&lt;uchar&gt;(i - 1, j - 1) = lbpcode;\n    }\n  }\n  return result;\n}\n\n//Circular_LBP_feature\nMat get_circular_LBP_feature(Mat img, int radius, int neighbors)\n{\n  Mat result;\n  result.create(img.rows - radius * 2, img.cols - radius * 2, img.type());\n  result.setTo(0);\n  //循环处理每个像素\n  for(int i=radius;i&lt;img.rows-radius;i++)\n  {\n      for(int j=radius;j&lt;img.cols-radius;j++)\n      {\n          //获得中心像素点的灰度值\n          uchar center = img.at&lt;uchar&gt;(i,j);\n          uchar lbpCode = 0;\n          for(int k=0;k&lt;neighbors;k++)\n          {\n              //根据公式计算第k个采样点的坐标，这个地方可以优化，不必每次都进行计算radius*cos，radius*sin\n              float x = i + static_cast&lt;float&gt;(radius * \\\n                  cos(2.0 * CV_PI * k / neighbors));\n              float y = j - static_cast&lt;float&gt;(radius * \\\n                  sin(2.0 * CV_PI * k / neighbors));\n                //根据取整结果进行双线性插值，得到第k个采样点的灰度值\n                //1.分别对x，y进行上下取整\n                int x1 = static_cast&lt;int&gt;(floor(x));\n                int x2 = static_cast&lt;int&gt;(ceil(x));\n                int y1 = static_cast&lt;int&gt;(floor(y));\n                int y2 = static_cast&lt;int&gt;(ceil(y));\n\n                //将坐标映射到0-1之间\n                float tx = x - x1;\n                float ty = y - y1;\n                //根据0-1之间的x，y的权重计算公式计算权重\n                float w1 = (1-tx) * (1-ty);\n                float w2 =    tx  * (1-ty);\n                float w3 = (1-tx) *    ty;\n                float w4 =    tx  *    ty;\n                //3.根据双线性插值公式计算第k个采样点的灰度值\n                float neighbor = img.at&lt;uchar&gt;(x1,y1) * w1 + img.at&lt;uchar&gt;(x1,y2) *w2 + img.at&lt;uchar&gt;(x2,y1) * w3 +img.at&lt;uchar&gt;(x2,y2) *w4;\n                //通过比较获得LBP值，并按顺序排列起来\n                lbpCode |= (neighbor&gt;center) &lt;&lt;(neighbors-k-1);\n            }\n            result.at&lt;uchar&gt;(i-radius,j-radius) = lbpCode;\n        }\n    }\n  return result;\n}\n\n//Rotation_Invariant_LBP_feature\nMat get_rotation_invariant_LBP_feature(Mat img, int radius, int neighbors)\n{\n  Mat result;\n  result.create(img.rows - radius * 2, img.cols - radius * 2, img.type());\n  result.setTo(0);\n  for(int k=0;k&lt;neighbors;k++)\n    {\n        //计算采样点对于中心点坐标的偏移量rx，ry\n        float rx = static_cast&lt;float&gt;(radius * cos(2.0 * CV_PI * k / neighbors));\n        float ry = -static_cast&lt;float&gt;(radius * sin(2.0 * CV_PI * k / neighbors));\n        //为双线性插值做准备\n        //对采样点偏移量分别进行上下取整\n        int x1 = static_cast&lt;int&gt;(floor(rx));\n        int x2 = static_cast&lt;int&gt;(ceil(rx));\n        int y1 = static_cast&lt;int&gt;(floor(ry));\n        int y2 = static_cast&lt;int&gt;(ceil(ry));\n        //将坐标偏移量映射到0-1之间\n        float tx = rx - x1;\n        float ty = ry - y1;\n        //根据0-1之间的x，y的权重计算公式计算权重，权重与坐标具体位置无关，与坐标间的差值有关\n        float w1 = (1-tx) * (1-ty);\n        float w2 =    tx  * (1-ty);\n        float w3 = (1-tx) *    ty;\n        float w4 =    tx  *    ty;\n        //循环处理每个像素\n        for(int i=radius;i&lt;img.rows-radius;i++)\n        {\n            for(int j=radius;j&lt;img.cols-radius;j++)\n            {\n                //获得中心像素点的灰度值\n                uchar center = img.at&lt;uchar&gt;(i,j);\n                //根据双线性插值公式计算第k个采样点的灰度值\n                float neighbor = img.at&lt;uchar&gt;(i+x1,j+y1) * w1 + img.at&lt;uchar&gt;(i+x1,j+y2) *w2 + img.at&lt;uchar&gt;(i+x2,j+y1) * w3 +img.at&lt;uchar&gt;(i+x2,j+y2) *w4;\n                //LBP特征图像的每个邻居的LBP值累加，累加通过与操作完成，对应的LBP值通过移位取得\n                result.at&lt;uchar&gt;(i-radius,j-radius) |= (neighbor&gt;center) &lt;&lt;(neighbors-k-1);\n            }\n        }\n    }\n    //进行旋转不变处理\n    for(int i=0;i&lt;result.rows;i++)\n    {\n        for(int j=0;j&lt;result.cols;j++)\n        {\n            uchar currentValue = result.at&lt;uchar&gt;(i,j);\n            uchar minValue = currentValue;\n            for(int k=1;k&lt;neighbors;k++)        //循环左移\n            {\n                uchar temp = (currentValue&gt;&gt;(neighbors-k)) | (currentValue&lt;&lt;k);\n                if(temp &lt; minValue)\n                {\n                    minValue = temp;\n                }\n            }\n            result.at&lt;uchar&gt;(i,j) = minValue;\n        }\n    }\n    return result;\n}\n\nint main(int argc, char* argv[])\n{\n  Mat src = imread(argv[1], 0);\n  Mat dst = get_original_LBP_feature(src);\n  Mat odst1 = get_circular_LBP_feature(src, 1, 8);\n  //Mat odst4 = get_circular_LBP_feature(src, 4, 8);\n  Mat rif8 = get_rotation_invariant_LBP_feature(src, 1, 8);\n  Mat rif6 = get_rotation_invariant_LBP_feature(src, 1, 6);\n\n\n  imshow(&quot;原始图片&quot;, src);\n  imshow(&quot;原始LBP&quot;, dst);\n  imshow(&quot;圆形LBP&quot;, odst1);\n  //imshow(&quot;圆形LBP4&quot;, odst4);\n  imshow(&quot;旋转不变LBP&quot;, rif8);\n  //imshow(&quot;旋转不变LBP6&quot;, rif6);\n\n  waitKey(0);\n  return 0;\n}</code></pre>\n"},{"title":"Manjaro i3wm 高效率环境配置篇(持续更新)","top":false,"cover":false,"img":"https://i.loli.net/2019/08/24/bx7Ky4DUoWQXzdq.jpg","toc":true,"mathjax":false,"date":"2019-08-24T07:45:27.000Z","password":null,"summary":"Manjaro i3wm配置教程","_content":"![](4.png)\nManjaro是一款基于Arch Linux、对用户友好、全球排名第1的Linux发行版     \n使用它是因为 AUR软件仓库有着世界上最齐全的Linux软件，万物皆可 pacman ,arch的wiki绝对是我见过的最详细的linux发行版的\"说明书\", 在这里基本能解决我所有的问题, 另，作为基于Arch的发行版，每日一 `sudo pacman -Syu`简直不要太爽啊！    \n有时间一定要尝试一下 原生Arch(有生之年系列，趁还折腾的动)\n\n## 1. 系统安装\n\n### 1.1 ISO文件下载\n\n[Manjaro官网](https://www.manjaro.org/)\n\nManjaro i3属于社区版本    \n[Download manjaro-i3-18.0.4-stable-x86_64.iso](https://osdn.net/projects/manjaro-community/storage/i3/18.0.4/manjaro-i3-18.0.4-stable-x86_64.iso/)\n\n### 1.2 U盘启动盘制作\n\n首先准备一个容量大于4G的U盘，在制作启动盘之前请先把里面的资料转存到别处，因为此项操作会格式化U盘且不可恢复。    \n刻录工具有很多，\n- [UltralISO](http://cn.ezbsystems.com/dl2.php?file=uiso9_cn.exe)\n- [深度启动盘制作工具](http://cdimage.deepin.com/applications/deepin-boot-maker/windows/deepin-boot-maker.exe) 深度科技，很简洁的一个工具\n- [Rufus](https://github.com/pbatard/rufus/releases/download/v3.6/rufus-3.6.exe)\n\n按照软件的操作步骤制作启动盘    \n注：若遇到启动盘系统安装的过程中遇到启动盘不可用则使用 **Rufus** 使用DD镜像模式制作\n![](1.png)\n\n### 1.3 系统安装\n安装过程很简单，参考下面这篇博客\n[Manjaro Linux i3 安装笔记](https://www.jianshu.com/p/e555a079f78a)\n\n安装时语言选择  **简体中文**即可\n## 2. 中文环境配置\n\n### 2.1 更换Linux国内源\n\nManjaro 默认的更新源在国外，没翻墙的宝宝无法更新，这里先换一下更新源\n#### 2.1.1 更新镜像排名\n\n```bash\nsudo pacman-mirrors -i -c China -m rank //更新镜像排名\n```\n之后自己选择几个镜像，推荐ustc和tuna的镜像源\n\n```bash\nsudo vim /etc/pacman.d/mirrorlist //查看选择的源\nsudo pacman -Syy  //更新数据源\n```\n\n#### 2.1.2 设置Archlinuxcn源\n\n```bash\nsudo vim /etc/pacman.conf\n```\n\n在文件末尾添加如下:\n\n```bash\n[archlinuxcn]\nSigLevel = Optional TrustedOnly\n#中科大源\nServer = https://mirrors.ustc.edu.cn/archlinuxcn/$arch\n#清华源\nServer = http://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch\n\n[antergos]\nSigLevel = TrustAll\nServer = https://mirrors.ustc.edu.cn/antergos/$repo/$arch\nServer = http://mirrors.tuna.tsinghua.edu.cn/antergos/$repo/$arch\n\n[arch4edu]\nSigLevel = TrustAll\nServer = http://mirrors.tuna.tsinghua.edu.cn/arch4edu/$arch\n```\n\n#### 2.1.3 导入GPG key\n\n```bash\nsudo pacman -Syy //更新数据源\nsudo pacman -S archlinuxcn-keyring //安装导入GPG key\nsudo pacman -S antergos-keyrin\n```\n\n#### 2.1.4 更新系统\n\n```bash\nsudo pacman -Syu\n```\n\n### 2.2 解决桌面中文显示方块问题\n\n若遇到桌面时间中文部分显示为 **方块**     \n\n```bash\nsudo vim /usr/share/conky/conky_maia\n```\n\n将 **conky.text** 的前四行字体改为 **anti** 即可\n\n### 2.3 中文输入法\n先安装fcitx\n\n```bash\nsudo pacman -S fcitx fcitx-im fcitx-configtool\n```\n\n安装完fcitx之后，创建.xprofile文件\n\n```bash\nvim ~/.xprofile\n```\n在里面添加如下内容:\n\n```bash\n#fcitx\nexport GTK_IM_MODULE=fcitx \nexport QT_IM_MODULE=fcitx \nexport XMODIFIERS=\"@im=fcitx\"\n```\n之后安装中文输入法，搜狗拼音貌似对arch的支持不太好，所以我们选择谷歌拼音\n\n```bash\nsudo pacman -S fcitx-googlepinyin\n```\n之后在终端运行 `$ fcitx` 在图形化界面的配置文件中配置输入法即可，配置快捷键\n![](2.png)\n![](3.png)\n\n若中文输入法开机无法自启动，则执行如下操作\n\n```bash\nvim ~/.i3/config\n```\n\n添加如下内容:\n\n`exec_always fcitx`\n\n## 3. 高效率软件以及配置\n\n### 3.1 软件\n\n#### 3.1.1 Alacritty \n\nAlacritty 是一个免费的开源，快速，跨平台的终端仿真器，它使用GPU进行渲染，我使用tree命令跑了一下，确实速度快。kitty也是一款优秀的终端，不过它的配置稍麻烦，感兴趣的可以自行Google.\n\n```bash\nsudo pacman -S alacritty\n```\n#### 3.1.2 fish & oh-my-fish(omf)\n\n- fish是一个智能且用户友好的命令行shell，适用于macOS，Linux和其他家族。fish包含语法突出显示，自动提示类型和精美的选项卡完成等功能，无需配置。    \nTerminal下默认的SHELL是bash, 但bash作为你经常使用的工具来说一点都不便捷,相信有很多人都用过另一款shell,它的名字是**zsh**，以及**oh-my-zsh**，我也用了一段时间的zsh，在用的过程中我发现它有时候运行贼慢，忍不了，而且配置虽说有oh-my-zsh管理，但终归不是傻瓜式工具，直到有一天我发现了 **fish**,官网号称是一个专为90后设计的shell。   \n安装很简单:\n\n```bash\nsudo pacman -S fish\n```\n终端输入`fish`即可进入\n- 查看已经安装的shell\n\n```bash\ncat /etc/shells\n```\n\n![](12.png)\n- 修改默认shell\n\n看一下上一步输出的`fish`的位置，然后执行\n\n```bash\nchsh -s usr/bin/fish\n```\n![](13.png)\n之后重启终端,shell就默认为fish了\n![](14.png)\n\n配置文件的位置是`/home/kevin/.config/fish/functions/fish_prompt.fish`，可以在这里设置替换命令，提高效率，举个例子:\n![](18.png)\n\n- oh-my-fish是一个 Fishshell 框架，允许你安装扩展或更改你的 shell 外观的软件包。它简单易用，快速可扩展。使用 omf，你可以根据你的想法，很容易地安装主题，丰富你的外观和安装插件来调整你的 Fish shell。    \n- 安装omf\n在fish shell里执行\n\n```bash\ncurl -L https://get.oh-my.fish | fish\n```\n- 列出所有的安装包\n\n```bash\nomf list\n```\n\n这条命令会列出一安装的主题和插件\n\n![](15.png)\n- 列出已安装主题\n\n```bash\nomf theme\n```\n- 安装一个新主题\n我现在用的主题叫 ays\n```bash\nomf install ays\n```\n- 改变主题\n\n```bash \nomf theme ays\n```\n- 卸载oh-my-fish\n\n```bash\nomf destroy\n```\n\n- Fish 运行Bash commands    \n例如 在fish 不能运行 time 命令，以下是解决办法    \n   - 在 `fish/functions/` 目录下创建 `time.fish` 文件，在里面输入    \n\n    ```\n    function time --description \"alias time bash -c time\"\n      bash -c \"time $argv\";\n    end\n    ```\n\n其他具体功能见[oh-my-fish](https://github.com/oh-my-fish/oh-my-fish)\n\n#### 3.1.3 Chromium\n\n安装方式:\n\n```bash\nsudo pacman -S chromium\n```\n#### 3.1.4 nitrogen \n一款可视化换壁纸的软件,当然**feh**也是一款优秀的壁纸切换软件，教程很多，这里不再说了\n\n```bash\nsudo pacman -S nitrogen\n```\n![](5.png)\n\n#### 3.1.5 neofetch\n\nneofetch是一个个性化显示Linux系统信息的工具\n\n```bash\nsudo pacman -S neofetch\n```\n![](19.png)\n#### 3.1.6 vim \n\n![](6.png)\n\n文本/代码编辑中最最最为优秀经典的上古神器,之后我会写一个调教Vim的教程\n\n```bash\nsudo pacman -S vim \n```\n\n#### 3.1.7 albert\n\n![](7.png)\n一款软件/文件/搜索 启动器\n\n```bash\nsudo pacman -S albert\n```\n第一次运行会提示你设置一下\n\n![](8.png)\n![](9.png)\n\n#### 3.1.8 iease-music\n\n网易云音乐最漂亮的第三方客户端！\n\n```bash\nsudo pacman -S iease-music\n```\n![](10.png)\n\n#### 3.1.9 deepin-screenshot\n\n深度截图\n\n```bash\nsudo pacman -S deepin-screenshot\n```\n\n#### 3.1.10 shadowsocks-qt5\n\n```bash\nsudo pacman -S shadowsocks-qt5\n```\n\n#### 3.1.11 thefuck\n\n自从用了\"Thefuck\",妈妈再也不用担心我敲错命令了。   \n有了它，万物皆可fffffffffuck!\n\n```bash\nsudo pacman -S thefuck\n```\n![](11.png)\n\n#### 3.1.12 compton\n\n设置窗口半透明+毛玻璃效果\n\n![](16.png)\n\nManjaro i3 自带的有compton，不过这个只能做到半透明而没有毛玻璃效果，我使用的是[Compton](https://github.com/tryone144/compton),下面详细介绍一下安装过程\n\n1. 卸载原有的compton\n\n```bash\nsudo pacman -R compton\n```\n若遇到依赖问题无法卸载，则\n\n```bash\nsudo pacman -Rc compton\n```\n\n2. clone仓库\n\n```bash\ngit clone git@github.com:liuyaanng/compton.git\n```\n\n3. 安装\n\n具体内容参考[README](https://github.com/liuyaanng/compton/blob/dual_kawase/README.md)    \n安装前要确保下列依赖已经安装。    \n其实大部分都已经安装,只有个别没有，若下面安装不成功，则按提示把依赖装上即可，有问题也可以在issues上查看\n\n![](17.png)\n\n```bash\ncd compton\n# Make the main program\nmake\n# Make the man page\nmake docs\n# Install\nmake install\n```\n\n4. 配置\n\n配置信息在[.config]()\n\n#### 3.1.13 deepin-file-manager\n\n默认的 `pcmanfm` 竟然没有搜索功能，这不能忍啊    \n我使用 `deepin-file-manager` 来代替默认的 `pcmanfm`\n\n```bash\nsudo pacman -S deepin-file-manager\n```\n在配置文件里\n\n![](20.png)\n\n\n### 3.2 i3的配置\n\ni3的配置文件在 `~/.i3/config`\n\n里面的配置信息介绍的很详细,需要更详细的信息你可以阅读官方[userguide](https://i3wm.org/docs/userguide.html)\n\n 首先在`Autoapplications`处添加自启动的应用\n\n```bash\nexec_always fcitx\nexec_always albert\n```\n- 把系统默认terminal换成`alacritty`\n在 `start a terminal`处将原来的代码注释掉，加上以下语句\n\n```bash\nbindsym $mod+Return exec alacritty\n```\n- 设置软件启动快捷键\n\n在配置文件中添加\n\n```bash\nset $mod Mod4\nset $mod1 Mod1\n```\n\nmod在这里设置的是键盘的`Super`键\nmod1在这里设置的是`Alt`键\n\n```bash \nbindsym $mod+c exec chromium\nbindsym $mod+p exec nitrogen\nbindsym $mod1+m exec iease-music\nbindsym $mod1+Shift+a exec deepin-screenshot\n```\n- 窗口之间的间距通过i3-gaps来设置，若没有安装，则\n\n```bash\nsudo pacman -S i3-gaps\n```\n在配置文件中加入\n\n```bash\ngaps inner 16\ngaps outer 0\n```\n可以根据自己喜好调整数值\n\n- xbacklight config\n\ninstall `xorg-xbacklight` first\n\n```bash\nsudo pacman -S xorg-xbacklight \n```\n\n\n\n\n## 杂项\n\n#### 彻底解决蜂鸣问题\n由于蜂鸣是由主板发出来的声音，故不能通过调节音量来消除此声音，要从源头上解决\n- 关闭终端下Tab键的蜂鸣提示\n\n```bash\nsudo vim /etc/inputrc\n```\n将 `set bell-style none` 前的注释去掉\n\n- 关闭vim中错误提示蜂鸣声\n\n```bash\nvim .vim/vimrc\n```\n在里面加入  `set vb t_vb= `\n\n\n\n\n","source":"_posts/Manjaro-i3wm-环境配置篇.md","raw":"---\ntitle: Manjaro i3wm 高效率环境配置篇(持续更新)\ntop: false\ncover: false\nimg: https://i.loli.net/2019/08/24/bx7Ky4DUoWQXzdq.jpg\ntoc: true\nmathjax: false\ndate: 2019-08-24 15:45:27\npassword:\nsummary: Manjaro i3wm配置教程\ntags:\n- Manjaro\n- i3wm\ncategories:\n- 教程\n---\n![](4.png)\nManjaro是一款基于Arch Linux、对用户友好、全球排名第1的Linux发行版     \n使用它是因为 AUR软件仓库有着世界上最齐全的Linux软件，万物皆可 pacman ,arch的wiki绝对是我见过的最详细的linux发行版的\"说明书\", 在这里基本能解决我所有的问题, 另，作为基于Arch的发行版，每日一 `sudo pacman -Syu`简直不要太爽啊！    \n有时间一定要尝试一下 原生Arch(有生之年系列，趁还折腾的动)\n\n## 1. 系统安装\n\n### 1.1 ISO文件下载\n\n[Manjaro官网](https://www.manjaro.org/)\n\nManjaro i3属于社区版本    \n[Download manjaro-i3-18.0.4-stable-x86_64.iso](https://osdn.net/projects/manjaro-community/storage/i3/18.0.4/manjaro-i3-18.0.4-stable-x86_64.iso/)\n\n### 1.2 U盘启动盘制作\n\n首先准备一个容量大于4G的U盘，在制作启动盘之前请先把里面的资料转存到别处，因为此项操作会格式化U盘且不可恢复。    \n刻录工具有很多，\n- [UltralISO](http://cn.ezbsystems.com/dl2.php?file=uiso9_cn.exe)\n- [深度启动盘制作工具](http://cdimage.deepin.com/applications/deepin-boot-maker/windows/deepin-boot-maker.exe) 深度科技，很简洁的一个工具\n- [Rufus](https://github.com/pbatard/rufus/releases/download/v3.6/rufus-3.6.exe)\n\n按照软件的操作步骤制作启动盘    \n注：若遇到启动盘系统安装的过程中遇到启动盘不可用则使用 **Rufus** 使用DD镜像模式制作\n![](1.png)\n\n### 1.3 系统安装\n安装过程很简单，参考下面这篇博客\n[Manjaro Linux i3 安装笔记](https://www.jianshu.com/p/e555a079f78a)\n\n安装时语言选择  **简体中文**即可\n## 2. 中文环境配置\n\n### 2.1 更换Linux国内源\n\nManjaro 默认的更新源在国外，没翻墙的宝宝无法更新，这里先换一下更新源\n#### 2.1.1 更新镜像排名\n\n```bash\nsudo pacman-mirrors -i -c China -m rank //更新镜像排名\n```\n之后自己选择几个镜像，推荐ustc和tuna的镜像源\n\n```bash\nsudo vim /etc/pacman.d/mirrorlist //查看选择的源\nsudo pacman -Syy  //更新数据源\n```\n\n#### 2.1.2 设置Archlinuxcn源\n\n```bash\nsudo vim /etc/pacman.conf\n```\n\n在文件末尾添加如下:\n\n```bash\n[archlinuxcn]\nSigLevel = Optional TrustedOnly\n#中科大源\nServer = https://mirrors.ustc.edu.cn/archlinuxcn/$arch\n#清华源\nServer = http://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch\n\n[antergos]\nSigLevel = TrustAll\nServer = https://mirrors.ustc.edu.cn/antergos/$repo/$arch\nServer = http://mirrors.tuna.tsinghua.edu.cn/antergos/$repo/$arch\n\n[arch4edu]\nSigLevel = TrustAll\nServer = http://mirrors.tuna.tsinghua.edu.cn/arch4edu/$arch\n```\n\n#### 2.1.3 导入GPG key\n\n```bash\nsudo pacman -Syy //更新数据源\nsudo pacman -S archlinuxcn-keyring //安装导入GPG key\nsudo pacman -S antergos-keyrin\n```\n\n#### 2.1.4 更新系统\n\n```bash\nsudo pacman -Syu\n```\n\n### 2.2 解决桌面中文显示方块问题\n\n若遇到桌面时间中文部分显示为 **方块**     \n\n```bash\nsudo vim /usr/share/conky/conky_maia\n```\n\n将 **conky.text** 的前四行字体改为 **anti** 即可\n\n### 2.3 中文输入法\n先安装fcitx\n\n```bash\nsudo pacman -S fcitx fcitx-im fcitx-configtool\n```\n\n安装完fcitx之后，创建.xprofile文件\n\n```bash\nvim ~/.xprofile\n```\n在里面添加如下内容:\n\n```bash\n#fcitx\nexport GTK_IM_MODULE=fcitx \nexport QT_IM_MODULE=fcitx \nexport XMODIFIERS=\"@im=fcitx\"\n```\n之后安装中文输入法，搜狗拼音貌似对arch的支持不太好，所以我们选择谷歌拼音\n\n```bash\nsudo pacman -S fcitx-googlepinyin\n```\n之后在终端运行 `$ fcitx` 在图形化界面的配置文件中配置输入法即可，配置快捷键\n![](2.png)\n![](3.png)\n\n若中文输入法开机无法自启动，则执行如下操作\n\n```bash\nvim ~/.i3/config\n```\n\n添加如下内容:\n\n`exec_always fcitx`\n\n## 3. 高效率软件以及配置\n\n### 3.1 软件\n\n#### 3.1.1 Alacritty \n\nAlacritty 是一个免费的开源，快速，跨平台的终端仿真器，它使用GPU进行渲染，我使用tree命令跑了一下，确实速度快。kitty也是一款优秀的终端，不过它的配置稍麻烦，感兴趣的可以自行Google.\n\n```bash\nsudo pacman -S alacritty\n```\n#### 3.1.2 fish & oh-my-fish(omf)\n\n- fish是一个智能且用户友好的命令行shell，适用于macOS，Linux和其他家族。fish包含语法突出显示，自动提示类型和精美的选项卡完成等功能，无需配置。    \nTerminal下默认的SHELL是bash, 但bash作为你经常使用的工具来说一点都不便捷,相信有很多人都用过另一款shell,它的名字是**zsh**，以及**oh-my-zsh**，我也用了一段时间的zsh，在用的过程中我发现它有时候运行贼慢，忍不了，而且配置虽说有oh-my-zsh管理，但终归不是傻瓜式工具，直到有一天我发现了 **fish**,官网号称是一个专为90后设计的shell。   \n安装很简单:\n\n```bash\nsudo pacman -S fish\n```\n终端输入`fish`即可进入\n- 查看已经安装的shell\n\n```bash\ncat /etc/shells\n```\n\n![](12.png)\n- 修改默认shell\n\n看一下上一步输出的`fish`的位置，然后执行\n\n```bash\nchsh -s usr/bin/fish\n```\n![](13.png)\n之后重启终端,shell就默认为fish了\n![](14.png)\n\n配置文件的位置是`/home/kevin/.config/fish/functions/fish_prompt.fish`，可以在这里设置替换命令，提高效率，举个例子:\n![](18.png)\n\n- oh-my-fish是一个 Fishshell 框架，允许你安装扩展或更改你的 shell 外观的软件包。它简单易用，快速可扩展。使用 omf，你可以根据你的想法，很容易地安装主题，丰富你的外观和安装插件来调整你的 Fish shell。    \n- 安装omf\n在fish shell里执行\n\n```bash\ncurl -L https://get.oh-my.fish | fish\n```\n- 列出所有的安装包\n\n```bash\nomf list\n```\n\n这条命令会列出一安装的主题和插件\n\n![](15.png)\n- 列出已安装主题\n\n```bash\nomf theme\n```\n- 安装一个新主题\n我现在用的主题叫 ays\n```bash\nomf install ays\n```\n- 改变主题\n\n```bash \nomf theme ays\n```\n- 卸载oh-my-fish\n\n```bash\nomf destroy\n```\n\n- Fish 运行Bash commands    \n例如 在fish 不能运行 time 命令，以下是解决办法    \n   - 在 `fish/functions/` 目录下创建 `time.fish` 文件，在里面输入    \n\n    ```\n    function time --description \"alias time bash -c time\"\n      bash -c \"time $argv\";\n    end\n    ```\n\n其他具体功能见[oh-my-fish](https://github.com/oh-my-fish/oh-my-fish)\n\n#### 3.1.3 Chromium\n\n安装方式:\n\n```bash\nsudo pacman -S chromium\n```\n#### 3.1.4 nitrogen \n一款可视化换壁纸的软件,当然**feh**也是一款优秀的壁纸切换软件，教程很多，这里不再说了\n\n```bash\nsudo pacman -S nitrogen\n```\n![](5.png)\n\n#### 3.1.5 neofetch\n\nneofetch是一个个性化显示Linux系统信息的工具\n\n```bash\nsudo pacman -S neofetch\n```\n![](19.png)\n#### 3.1.6 vim \n\n![](6.png)\n\n文本/代码编辑中最最最为优秀经典的上古神器,之后我会写一个调教Vim的教程\n\n```bash\nsudo pacman -S vim \n```\n\n#### 3.1.7 albert\n\n![](7.png)\n一款软件/文件/搜索 启动器\n\n```bash\nsudo pacman -S albert\n```\n第一次运行会提示你设置一下\n\n![](8.png)\n![](9.png)\n\n#### 3.1.8 iease-music\n\n网易云音乐最漂亮的第三方客户端！\n\n```bash\nsudo pacman -S iease-music\n```\n![](10.png)\n\n#### 3.1.9 deepin-screenshot\n\n深度截图\n\n```bash\nsudo pacman -S deepin-screenshot\n```\n\n#### 3.1.10 shadowsocks-qt5\n\n```bash\nsudo pacman -S shadowsocks-qt5\n```\n\n#### 3.1.11 thefuck\n\n自从用了\"Thefuck\",妈妈再也不用担心我敲错命令了。   \n有了它，万物皆可fffffffffuck!\n\n```bash\nsudo pacman -S thefuck\n```\n![](11.png)\n\n#### 3.1.12 compton\n\n设置窗口半透明+毛玻璃效果\n\n![](16.png)\n\nManjaro i3 自带的有compton，不过这个只能做到半透明而没有毛玻璃效果，我使用的是[Compton](https://github.com/tryone144/compton),下面详细介绍一下安装过程\n\n1. 卸载原有的compton\n\n```bash\nsudo pacman -R compton\n```\n若遇到依赖问题无法卸载，则\n\n```bash\nsudo pacman -Rc compton\n```\n\n2. clone仓库\n\n```bash\ngit clone git@github.com:liuyaanng/compton.git\n```\n\n3. 安装\n\n具体内容参考[README](https://github.com/liuyaanng/compton/blob/dual_kawase/README.md)    \n安装前要确保下列依赖已经安装。    \n其实大部分都已经安装,只有个别没有，若下面安装不成功，则按提示把依赖装上即可，有问题也可以在issues上查看\n\n![](17.png)\n\n```bash\ncd compton\n# Make the main program\nmake\n# Make the man page\nmake docs\n# Install\nmake install\n```\n\n4. 配置\n\n配置信息在[.config]()\n\n#### 3.1.13 deepin-file-manager\n\n默认的 `pcmanfm` 竟然没有搜索功能，这不能忍啊    \n我使用 `deepin-file-manager` 来代替默认的 `pcmanfm`\n\n```bash\nsudo pacman -S deepin-file-manager\n```\n在配置文件里\n\n![](20.png)\n\n\n### 3.2 i3的配置\n\ni3的配置文件在 `~/.i3/config`\n\n里面的配置信息介绍的很详细,需要更详细的信息你可以阅读官方[userguide](https://i3wm.org/docs/userguide.html)\n\n 首先在`Autoapplications`处添加自启动的应用\n\n```bash\nexec_always fcitx\nexec_always albert\n```\n- 把系统默认terminal换成`alacritty`\n在 `start a terminal`处将原来的代码注释掉，加上以下语句\n\n```bash\nbindsym $mod+Return exec alacritty\n```\n- 设置软件启动快捷键\n\n在配置文件中添加\n\n```bash\nset $mod Mod4\nset $mod1 Mod1\n```\n\nmod在这里设置的是键盘的`Super`键\nmod1在这里设置的是`Alt`键\n\n```bash \nbindsym $mod+c exec chromium\nbindsym $mod+p exec nitrogen\nbindsym $mod1+m exec iease-music\nbindsym $mod1+Shift+a exec deepin-screenshot\n```\n- 窗口之间的间距通过i3-gaps来设置，若没有安装，则\n\n```bash\nsudo pacman -S i3-gaps\n```\n在配置文件中加入\n\n```bash\ngaps inner 16\ngaps outer 0\n```\n可以根据自己喜好调整数值\n\n- xbacklight config\n\ninstall `xorg-xbacklight` first\n\n```bash\nsudo pacman -S xorg-xbacklight \n```\n\n\n\n\n## 杂项\n\n#### 彻底解决蜂鸣问题\n由于蜂鸣是由主板发出来的声音，故不能通过调节音量来消除此声音，要从源头上解决\n- 关闭终端下Tab键的蜂鸣提示\n\n```bash\nsudo vim /etc/inputrc\n```\n将 `set bell-style none` 前的注释去掉\n\n- 关闭vim中错误提示蜂鸣声\n\n```bash\nvim .vim/vimrc\n```\n在里面加入  `set vb t_vb= `\n\n\n\n\n","slug":"Manjaro-i3wm-环境配置篇","published":1,"updated":"2020-02-24T10:49:41.359Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0t9001774ju2zamo4o1","content":"<p><img src=\"4.png\" alt><br>Manjaro是一款基于Arch Linux、对用户友好、全球排名第1的Linux发行版<br>使用它是因为 AUR软件仓库有着世界上最齐全的Linux软件，万物皆可 pacman ,arch的wiki绝对是我见过的最详细的linux发行版的”说明书”, 在这里基本能解决我所有的问题, 另，作为基于Arch的发行版，每日一 <code>sudo pacman -Syu</code>简直不要太爽啊！<br>有时间一定要尝试一下 原生Arch(有生之年系列，趁还折腾的动)</p>\n<h2 id=\"1-系统安装\"><a href=\"#1-系统安装\" class=\"headerlink\" title=\"1. 系统安装\"></a>1. 系统安装</h2><h3 id=\"1-1-ISO文件下载\"><a href=\"#1-1-ISO文件下载\" class=\"headerlink\" title=\"1.1 ISO文件下载\"></a>1.1 ISO文件下载</h3><p><a href=\"https://www.manjaro.org/\" target=\"_blank\" rel=\"noopener\">Manjaro官网</a></p>\n<p>Manjaro i3属于社区版本<br><a href=\"https://osdn.net/projects/manjaro-community/storage/i3/18.0.4/manjaro-i3-18.0.4-stable-x86_64.iso/\" target=\"_blank\" rel=\"noopener\">Download manjaro-i3-18.0.4-stable-x86_64.iso</a></p>\n<h3 id=\"1-2-U盘启动盘制作\"><a href=\"#1-2-U盘启动盘制作\" class=\"headerlink\" title=\"1.2 U盘启动盘制作\"></a>1.2 U盘启动盘制作</h3><p>首先准备一个容量大于4G的U盘，在制作启动盘之前请先把里面的资料转存到别处，因为此项操作会格式化U盘且不可恢复。<br>刻录工具有很多，</p>\n<ul>\n<li><a href=\"http://cn.ezbsystems.com/dl2.php?file=uiso9_cn.exe\" target=\"_blank\" rel=\"noopener\">UltralISO</a></li>\n<li><a href=\"http://cdimage.deepin.com/applications/deepin-boot-maker/windows/deepin-boot-maker.exe\" target=\"_blank\" rel=\"noopener\">深度启动盘制作工具</a> 深度科技，很简洁的一个工具</li>\n<li><a href=\"https://github.com/pbatard/rufus/releases/download/v3.6/rufus-3.6.exe\" target=\"_blank\" rel=\"noopener\">Rufus</a></li>\n</ul>\n<p>按照软件的操作步骤制作启动盘<br>注：若遇到启动盘系统安装的过程中遇到启动盘不可用则使用 <strong>Rufus</strong> 使用DD镜像模式制作<br><img src=\"1.png\" alt></p>\n<h3 id=\"1-3-系统安装\"><a href=\"#1-3-系统安装\" class=\"headerlink\" title=\"1.3 系统安装\"></a>1.3 系统安装</h3><p>安装过程很简单，参考下面这篇博客<br><a href=\"https://www.jianshu.com/p/e555a079f78a\" target=\"_blank\" rel=\"noopener\">Manjaro Linux i3 安装笔记</a></p>\n<p>安装时语言选择  <strong>简体中文</strong>即可</p>\n<h2 id=\"2-中文环境配置\"><a href=\"#2-中文环境配置\" class=\"headerlink\" title=\"2. 中文环境配置\"></a>2. 中文环境配置</h2><h3 id=\"2-1-更换Linux国内源\"><a href=\"#2-1-更换Linux国内源\" class=\"headerlink\" title=\"2.1 更换Linux国内源\"></a>2.1 更换Linux国内源</h3><p>Manjaro 默认的更新源在国外，没翻墙的宝宝无法更新，这里先换一下更新源</p>\n<h4 id=\"2-1-1-更新镜像排名\"><a href=\"#2-1-1-更新镜像排名\" class=\"headerlink\" title=\"2.1.1 更新镜像排名\"></a>2.1.1 更新镜像排名</h4><pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman-mirrors -i -c China -m rank //更新镜像排名</code></pre>\n<p>之后自己选择几个镜像，推荐ustc和tuna的镜像源</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> vim /etc/pacman.d/mirrorlist //查看选择的源\n<span class=\"token function\">sudo</span> pacman -Syy  //更新数据源</code></pre>\n<h4 id=\"2-1-2-设置Archlinuxcn源\"><a href=\"#2-1-2-设置Archlinuxcn源\" class=\"headerlink\" title=\"2.1.2 设置Archlinuxcn源\"></a>2.1.2 设置Archlinuxcn源</h4><pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> vim /etc/pacman.conf</code></pre>\n<p>在文件末尾添加如下:</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span>archlinuxcn<span class=\"token punctuation\">]</span>\nSigLevel <span class=\"token operator\">=</span> Optional TrustedOnly\n<span class=\"token comment\" spellcheck=\"true\">#中科大源</span>\nServer <span class=\"token operator\">=</span> https://mirrors.ustc.edu.cn/archlinuxcn/<span class=\"token variable\">$arch</span>\n<span class=\"token comment\" spellcheck=\"true\">#清华源</span>\nServer <span class=\"token operator\">=</span> http://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/<span class=\"token variable\">$arch</span>\n\n<span class=\"token punctuation\">[</span>antergos<span class=\"token punctuation\">]</span>\nSigLevel <span class=\"token operator\">=</span> TrustAll\nServer <span class=\"token operator\">=</span> https://mirrors.ustc.edu.cn/antergos/<span class=\"token variable\">$repo</span>/<span class=\"token variable\">$arch</span>\nServer <span class=\"token operator\">=</span> http://mirrors.tuna.tsinghua.edu.cn/antergos/<span class=\"token variable\">$repo</span>/<span class=\"token variable\">$arch</span>\n\n<span class=\"token punctuation\">[</span>arch4edu<span class=\"token punctuation\">]</span>\nSigLevel <span class=\"token operator\">=</span> TrustAll\nServer <span class=\"token operator\">=</span> http://mirrors.tuna.tsinghua.edu.cn/arch4edu/<span class=\"token variable\">$arch</span></code></pre>\n<h4 id=\"2-1-3-导入GPG-key\"><a href=\"#2-1-3-导入GPG-key\" class=\"headerlink\" title=\"2.1.3 导入GPG key\"></a>2.1.3 导入GPG key</h4><pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -Syy //更新数据源\n<span class=\"token function\">sudo</span> pacman -S archlinuxcn-keyring //安装导入GPG key\n<span class=\"token function\">sudo</span> pacman -S antergos-keyrin</code></pre>\n<h4 id=\"2-1-4-更新系统\"><a href=\"#2-1-4-更新系统\" class=\"headerlink\" title=\"2.1.4 更新系统\"></a>2.1.4 更新系统</h4><pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -Syu</code></pre>\n<h3 id=\"2-2-解决桌面中文显示方块问题\"><a href=\"#2-2-解决桌面中文显示方块问题\" class=\"headerlink\" title=\"2.2 解决桌面中文显示方块问题\"></a>2.2 解决桌面中文显示方块问题</h3><p>若遇到桌面时间中文部分显示为 <strong>方块</strong>     </p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> vim /usr/share/conky/conky_maia</code></pre>\n<p>将 <strong>conky.text</strong> 的前四行字体改为 <strong>anti</strong> 即可</p>\n<h3 id=\"2-3-中文输入法\"><a href=\"#2-3-中文输入法\" class=\"headerlink\" title=\"2.3 中文输入法\"></a>2.3 中文输入法</h3><p>先安装fcitx</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S fcitx fcitx-im fcitx-configtool</code></pre>\n<p>安装完fcitx之后，创建.xprofile文件</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">vim ~/.xprofile</code></pre>\n<p>在里面添加如下内容:</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token comment\" spellcheck=\"true\">#fcitx</span>\n<span class=\"token function\">export</span> GTK_IM_MODULE<span class=\"token operator\">=</span>fcitx \n<span class=\"token function\">export</span> QT_IM_MODULE<span class=\"token operator\">=</span>fcitx \n<span class=\"token function\">export</span> XMODIFIERS<span class=\"token operator\">=</span><span class=\"token string\">\"@im=fcitx\"</span></code></pre>\n<p>之后安装中文输入法，搜狗拼音貌似对arch的支持不太好，所以我们选择谷歌拼音</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S fcitx-googlepinyin</code></pre>\n<p>之后在终端运行 <code>$ fcitx</code> 在图形化界面的配置文件中配置输入法即可，配置快捷键<br><img src=\"2.png\" alt><br><img src=\"3.png\" alt></p>\n<p>若中文输入法开机无法自启动，则执行如下操作</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">vim ~/.i3/config</code></pre>\n<p>添加如下内容:</p>\n<p><code>exec_always fcitx</code></p>\n<h2 id=\"3-高效率软件以及配置\"><a href=\"#3-高效率软件以及配置\" class=\"headerlink\" title=\"3. 高效率软件以及配置\"></a>3. 高效率软件以及配置</h2><h3 id=\"3-1-软件\"><a href=\"#3-1-软件\" class=\"headerlink\" title=\"3.1 软件\"></a>3.1 软件</h3><h4 id=\"3-1-1-Alacritty\"><a href=\"#3-1-1-Alacritty\" class=\"headerlink\" title=\"3.1.1 Alacritty\"></a>3.1.1 Alacritty</h4><p>Alacritty 是一个免费的开源，快速，跨平台的终端仿真器，它使用GPU进行渲染，我使用tree命令跑了一下，确实速度快。kitty也是一款优秀的终端，不过它的配置稍麻烦，感兴趣的可以自行Google.</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S alacritty</code></pre>\n<h4 id=\"3-1-2-fish-amp-oh-my-fish-omf\"><a href=\"#3-1-2-fish-amp-oh-my-fish-omf\" class=\"headerlink\" title=\"3.1.2 fish &amp; oh-my-fish(omf)\"></a>3.1.2 fish &amp; oh-my-fish(omf)</h4><ul>\n<li>fish是一个智能且用户友好的命令行shell，适用于macOS，Linux和其他家族。fish包含语法突出显示，自动提示类型和精美的选项卡完成等功能，无需配置。<br>Terminal下默认的SHELL是bash, 但bash作为你经常使用的工具来说一点都不便捷,相信有很多人都用过另一款shell,它的名字是<strong>zsh</strong>，以及<strong>oh-my-zsh</strong>，我也用了一段时间的zsh，在用的过程中我发现它有时候运行贼慢，忍不了，而且配置虽说有oh-my-zsh管理，但终归不是傻瓜式工具，直到有一天我发现了 <strong>fish</strong>,官网号称是一个专为90后设计的shell。<br>安装很简单:</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S fish</code></pre>\n<p>终端输入<code>fish</code>即可进入</p>\n<ul>\n<li>查看已经安装的shell</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> /etc/shells</code></pre>\n<p><img src=\"12.png\" alt></p>\n<ul>\n<li>修改默认shell</li>\n</ul>\n<p>看一下上一步输出的<code>fish</code>的位置，然后执行</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">chsh -s usr/bin/fish</code></pre>\n<p><img src=\"13.png\" alt><br>之后重启终端,shell就默认为fish了<br><img src=\"14.png\" alt></p>\n<p>配置文件的位置是<code>/home/kevin/.config/fish/functions/fish_prompt.fish</code>，可以在这里设置替换命令，提高效率，举个例子:<br><img src=\"18.png\" alt></p>\n<ul>\n<li>oh-my-fish是一个 Fishshell 框架，允许你安装扩展或更改你的 shell 外观的软件包。它简单易用，快速可扩展。使用 omf，你可以根据你的想法，很容易地安装主题，丰富你的外观和安装插件来调整你的 Fish shell。    </li>\n<li>安装omf<br>在fish shell里执行</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">curl -L https://get.oh-my.fish <span class=\"token operator\">|</span> fish</code></pre>\n<ul>\n<li>列出所有的安装包</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">omf list</code></pre>\n<p>这条命令会列出一安装的主题和插件</p>\n<p><img src=\"15.png\" alt></p>\n<ul>\n<li>列出已安装主题</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">omf theme</code></pre>\n<ul>\n<li>安装一个新主题<br>我现在用的主题叫 ays<pre class=\" language-bash\"><code class=\"language-bash\">omf <span class=\"token function\">install</span> ays</code></pre>\n</li>\n<li>改变主题</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">omf theme ays</code></pre>\n<ul>\n<li>卸载oh-my-fish</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">omf destroy</code></pre>\n<ul>\n<li><p>Fish 运行Bash commands<br>例如 在fish 不能运行 time 命令，以下是解决办法    </p>\n<ul>\n<li><p>在 <code>fish/functions/</code> 目录下创建 <code>time.fish</code> 文件，在里面输入    </p>\n<pre><code>function time --description &quot;alias time bash -c time&quot;\n bash -c &quot;time $argv&quot;;\nend</code></pre></li>\n</ul>\n</li>\n</ul>\n<p>其他具体功能见<a href=\"https://github.com/oh-my-fish/oh-my-fish\" target=\"_blank\" rel=\"noopener\">oh-my-fish</a></p>\n<h4 id=\"3-1-3-Chromium\"><a href=\"#3-1-3-Chromium\" class=\"headerlink\" title=\"3.1.3 Chromium\"></a>3.1.3 Chromium</h4><p>安装方式:</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S chromium</code></pre>\n<h4 id=\"3-1-4-nitrogen\"><a href=\"#3-1-4-nitrogen\" class=\"headerlink\" title=\"3.1.4 nitrogen\"></a>3.1.4 nitrogen</h4><p>一款可视化换壁纸的软件,当然<strong>feh</strong>也是一款优秀的壁纸切换软件，教程很多，这里不再说了</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S nitrogen</code></pre>\n<p><img src=\"5.png\" alt></p>\n<h4 id=\"3-1-5-neofetch\"><a href=\"#3-1-5-neofetch\" class=\"headerlink\" title=\"3.1.5 neofetch\"></a>3.1.5 neofetch</h4><p>neofetch是一个个性化显示Linux系统信息的工具</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S neofetch</code></pre>\n<p><img src=\"19.png\" alt></p>\n<h4 id=\"3-1-6-vim\"><a href=\"#3-1-6-vim\" class=\"headerlink\" title=\"3.1.6 vim\"></a>3.1.6 vim</h4><p><img src=\"6.png\" alt></p>\n<p>文本/代码编辑中最最最为优秀经典的上古神器,之后我会写一个调教Vim的教程</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S vim </code></pre>\n<h4 id=\"3-1-7-albert\"><a href=\"#3-1-7-albert\" class=\"headerlink\" title=\"3.1.7 albert\"></a>3.1.7 albert</h4><p><img src=\"7.png\" alt><br>一款软件/文件/搜索 启动器</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S albert</code></pre>\n<p>第一次运行会提示你设置一下</p>\n<p><img src=\"8.png\" alt><br><img src=\"9.png\" alt></p>\n<h4 id=\"3-1-8-iease-music\"><a href=\"#3-1-8-iease-music\" class=\"headerlink\" title=\"3.1.8 iease-music\"></a>3.1.8 iease-music</h4><p>网易云音乐最漂亮的第三方客户端！</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S iease-music</code></pre>\n<p><img src=\"10.png\" alt></p>\n<h4 id=\"3-1-9-deepin-screenshot\"><a href=\"#3-1-9-deepin-screenshot\" class=\"headerlink\" title=\"3.1.9 deepin-screenshot\"></a>3.1.9 deepin-screenshot</h4><p>深度截图</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S deepin-screenshot</code></pre>\n<h4 id=\"3-1-10-shadowsocks-qt5\"><a href=\"#3-1-10-shadowsocks-qt5\" class=\"headerlink\" title=\"3.1.10 shadowsocks-qt5\"></a>3.1.10 shadowsocks-qt5</h4><pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S shadowsocks-qt5</code></pre>\n<h4 id=\"3-1-11-thefuck\"><a href=\"#3-1-11-thefuck\" class=\"headerlink\" title=\"3.1.11 thefuck\"></a>3.1.11 thefuck</h4><p>自从用了”Thefuck”,妈妈再也不用担心我敲错命令了。<br>有了它，万物皆可fffffffffuck!</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S thefuck</code></pre>\n<p><img src=\"11.png\" alt></p>\n<h4 id=\"3-1-12-compton\"><a href=\"#3-1-12-compton\" class=\"headerlink\" title=\"3.1.12 compton\"></a>3.1.12 compton</h4><p>设置窗口半透明+毛玻璃效果</p>\n<p><img src=\"16.png\" alt></p>\n<p>Manjaro i3 自带的有compton，不过这个只能做到半透明而没有毛玻璃效果，我使用的是<a href=\"https://github.com/tryone144/compton\" target=\"_blank\" rel=\"noopener\">Compton</a>,下面详细介绍一下安装过程</p>\n<ol>\n<li>卸载原有的compton</li>\n</ol>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -R compton</code></pre>\n<p>若遇到依赖问题无法卸载，则</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -Rc compton</code></pre>\n<ol start=\"2\">\n<li>clone仓库</li>\n</ol>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone git@github.com:liuyaanng/compton.git</code></pre>\n<ol start=\"3\">\n<li>安装</li>\n</ol>\n<p>具体内容参考<a href=\"https://github.com/liuyaanng/compton/blob/dual_kawase/README.md\" target=\"_blank\" rel=\"noopener\">README</a><br>安装前要确保下列依赖已经安装。<br>其实大部分都已经安装,只有个别没有，若下面安装不成功，则按提示把依赖装上即可，有问题也可以在issues上查看</p>\n<p><img src=\"17.png\" alt></p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">cd</span> compton\n<span class=\"token comment\" spellcheck=\"true\"># Make the main program</span>\n<span class=\"token function\">make</span>\n<span class=\"token comment\" spellcheck=\"true\"># Make the man page</span>\n<span class=\"token function\">make</span> docs\n<span class=\"token comment\" spellcheck=\"true\"># Install</span>\n<span class=\"token function\">make</span> <span class=\"token function\">install</span></code></pre>\n<ol start=\"4\">\n<li>配置</li>\n</ol>\n<p>配置信息在<a href>.config</a></p>\n<h4 id=\"3-1-13-deepin-file-manager\"><a href=\"#3-1-13-deepin-file-manager\" class=\"headerlink\" title=\"3.1.13 deepin-file-manager\"></a>3.1.13 deepin-file-manager</h4><p>默认的 <code>pcmanfm</code> 竟然没有搜索功能，这不能忍啊<br>我使用 <code>deepin-file-manager</code> 来代替默认的 <code>pcmanfm</code></p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S deepin-file-manager</code></pre>\n<p>在配置文件里</p>\n<p><img src=\"20.png\" alt></p>\n<h3 id=\"3-2-i3的配置\"><a href=\"#3-2-i3的配置\" class=\"headerlink\" title=\"3.2 i3的配置\"></a>3.2 i3的配置</h3><p>i3的配置文件在 <code>~/.i3/config</code></p>\n<p>里面的配置信息介绍的很详细,需要更详细的信息你可以阅读官方<a href=\"https://i3wm.org/docs/userguide.html\" target=\"_blank\" rel=\"noopener\">userguide</a></p>\n<p> 首先在<code>Autoapplications</code>处添加自启动的应用</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">exec_always fcitx\nexec_always albert</code></pre>\n<ul>\n<li>把系统默认terminal换成<code>alacritty</code><br>在 <code>start a terminal</code>处将原来的代码注释掉，加上以下语句</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">bindsym <span class=\"token variable\">$mod</span>+Return <span class=\"token function\">exec</span> alacritty</code></pre>\n<ul>\n<li>设置软件启动快捷键</li>\n</ul>\n<p>在配置文件中添加</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token keyword\">set</span> <span class=\"token variable\">$mod</span> Mod4\n<span class=\"token keyword\">set</span> <span class=\"token variable\">$mod1</span> Mod1</code></pre>\n<p>mod在这里设置的是键盘的<code>Super</code>键<br>mod1在这里设置的是<code>Alt</code>键</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">bindsym <span class=\"token variable\">$mod</span>+c <span class=\"token function\">exec</span> chromium\nbindsym <span class=\"token variable\">$mod</span>+p <span class=\"token function\">exec</span> nitrogen\nbindsym <span class=\"token variable\">$mod1</span>+m <span class=\"token function\">exec</span> iease-music\nbindsym <span class=\"token variable\">$mod1</span>+Shift+a <span class=\"token function\">exec</span> deepin-screenshot</code></pre>\n<ul>\n<li>窗口之间的间距通过i3-gaps来设置，若没有安装，则</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S i3-gaps</code></pre>\n<p>在配置文件中加入</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">gaps inner 16\ngaps outer 0</code></pre>\n<p>可以根据自己喜好调整数值</p>\n<ul>\n<li>xbacklight config</li>\n</ul>\n<p>install <code>xorg-xbacklight</code> first</p>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pacman -S xorg-xbacklight </code></pre>\n<h2 id=\"杂项\"><a href=\"#杂项\" class=\"headerlink\" title=\"杂项\"></a>杂项</h2><h4 id=\"彻底解决蜂鸣问题\"><a href=\"#彻底解决蜂鸣问题\" class=\"headerlink\" title=\"彻底解决蜂鸣问题\"></a>彻底解决蜂鸣问题</h4><p>由于蜂鸣是由主板发出来的声音，故不能通过调节音量来消除此声音，要从源头上解决</p>\n<ul>\n<li>关闭终端下Tab键的蜂鸣提示</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> vim /etc/inputrc</code></pre>\n<p>将 <code>set bell-style none</code> 前的注释去掉</p>\n<ul>\n<li>关闭vim中错误提示蜂鸣声</li>\n</ul>\n<pre class=\" language-bash\"><code class=\"language-bash\">vim .vim/vimrc</code></pre>\n<p>在里面加入  <code>set vb t_vb=</code></p>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<p><img src=\"4.png\" alt><br>Manjaro是一款基于Arch Linux、对用户友好、全球排名第1的Linux发行版<br>使用它是因为 AUR软件仓库有着世界上最齐全的Linux软件，万物皆可 pacman ,arch的wiki绝对是我见过的最详细的linux发行版的”说明书”, 在这里基本能解决我所有的问题, 另，作为基于Arch的发行版，每日一 <code>sudo pacman -Syu</code>简直不要太爽啊！<br>有时间一定要尝试一下 原生Arch(有生之年系列，趁还折腾的动)</p>\n<h2 id=\"1-系统安装\"><a href=\"#1-系统安装\" class=\"headerlink\" title=\"1. 系统安装\"></a>1. 系统安装</h2><h3 id=\"1-1-ISO文件下载\"><a href=\"#1-1-ISO文件下载\" class=\"headerlink\" title=\"1.1 ISO文件下载\"></a>1.1 ISO文件下载</h3><p><a href=\"https://www.manjaro.org/\" target=\"_blank\" rel=\"noopener\">Manjaro官网</a></p>\n<p>Manjaro i3属于社区版本<br><a href=\"https://osdn.net/projects/manjaro-community/storage/i3/18.0.4/manjaro-i3-18.0.4-stable-x86_64.iso/\" target=\"_blank\" rel=\"noopener\">Download manjaro-i3-18.0.4-stable-x86_64.iso</a></p>\n<h3 id=\"1-2-U盘启动盘制作\"><a href=\"#1-2-U盘启动盘制作\" class=\"headerlink\" title=\"1.2 U盘启动盘制作\"></a>1.2 U盘启动盘制作</h3><p>首先准备一个容量大于4G的U盘，在制作启动盘之前请先把里面的资料转存到别处，因为此项操作会格式化U盘且不可恢复。<br>刻录工具有很多，</p>\n<ul>\n<li><a href=\"http://cn.ezbsystems.com/dl2.php?file=uiso9_cn.exe\" target=\"_blank\" rel=\"noopener\">UltralISO</a></li>\n<li><a href=\"http://cdimage.deepin.com/applications/deepin-boot-maker/windows/deepin-boot-maker.exe\" target=\"_blank\" rel=\"noopener\">深度启动盘制作工具</a> 深度科技，很简洁的一个工具</li>\n<li><a href=\"https://github.com/pbatard/rufus/releases/download/v3.6/rufus-3.6.exe\" target=\"_blank\" rel=\"noopener\">Rufus</a></li>\n</ul>\n<p>按照软件的操作步骤制作启动盘<br>注：若遇到启动盘系统安装的过程中遇到启动盘不可用则使用 <strong>Rufus</strong> 使用DD镜像模式制作<br><img src=\"1.png\" alt></p>\n<h3 id=\"1-3-系统安装\"><a href=\"#1-3-系统安装\" class=\"headerlink\" title=\"1.3 系统安装\"></a>1.3 系统安装</h3><p>安装过程很简单，参考下面这篇博客<br><a href=\"https://www.jianshu.com/p/e555a079f78a\" target=\"_blank\" rel=\"noopener\">Manjaro Linux i3 安装笔记</a></p>\n<p>安装时语言选择  <strong>简体中文</strong>即可</p>\n<h2 id=\"2-中文环境配置\"><a href=\"#2-中文环境配置\" class=\"headerlink\" title=\"2. 中文环境配置\"></a>2. 中文环境配置</h2><h3 id=\"2-1-更换Linux国内源\"><a href=\"#2-1-更换Linux国内源\" class=\"headerlink\" title=\"2.1 更换Linux国内源\"></a>2.1 更换Linux国内源</h3><p>Manjaro 默认的更新源在国外，没翻墙的宝宝无法更新，这里先换一下更新源</p>\n<h4 id=\"2-1-1-更新镜像排名\"><a href=\"#2-1-1-更新镜像排名\" class=\"headerlink\" title=\"2.1.1 更新镜像排名\"></a>2.1.1 更新镜像排名</h4><pre><code class=\"bash\">sudo pacman-mirrors -i -c China -m rank //更新镜像排名</code></pre>\n<p>之后自己选择几个镜像，推荐ustc和tuna的镜像源</p>\n<pre><code class=\"bash\">sudo vim /etc/pacman.d/mirrorlist //查看选择的源\nsudo pacman -Syy  //更新数据源</code></pre>\n<h4 id=\"2-1-2-设置Archlinuxcn源\"><a href=\"#2-1-2-设置Archlinuxcn源\" class=\"headerlink\" title=\"2.1.2 设置Archlinuxcn源\"></a>2.1.2 设置Archlinuxcn源</h4><pre><code class=\"bash\">sudo vim /etc/pacman.conf</code></pre>\n<p>在文件末尾添加如下:</p>\n<pre><code class=\"bash\">[archlinuxcn]\nSigLevel = Optional TrustedOnly\n#中科大源\nServer = https://mirrors.ustc.edu.cn/archlinuxcn/$arch\n#清华源\nServer = http://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch\n\n[antergos]\nSigLevel = TrustAll\nServer = https://mirrors.ustc.edu.cn/antergos/$repo/$arch\nServer = http://mirrors.tuna.tsinghua.edu.cn/antergos/$repo/$arch\n\n[arch4edu]\nSigLevel = TrustAll\nServer = http://mirrors.tuna.tsinghua.edu.cn/arch4edu/$arch</code></pre>\n<h4 id=\"2-1-3-导入GPG-key\"><a href=\"#2-1-3-导入GPG-key\" class=\"headerlink\" title=\"2.1.3 导入GPG key\"></a>2.1.3 导入GPG key</h4><pre><code class=\"bash\">sudo pacman -Syy //更新数据源\nsudo pacman -S archlinuxcn-keyring //安装导入GPG key\nsudo pacman -S antergos-keyrin</code></pre>\n<h4 id=\"2-1-4-更新系统\"><a href=\"#2-1-4-更新系统\" class=\"headerlink\" title=\"2.1.4 更新系统\"></a>2.1.4 更新系统</h4><pre><code class=\"bash\">sudo pacman -Syu</code></pre>\n<h3 id=\"2-2-解决桌面中文显示方块问题\"><a href=\"#2-2-解决桌面中文显示方块问题\" class=\"headerlink\" title=\"2.2 解决桌面中文显示方块问题\"></a>2.2 解决桌面中文显示方块问题</h3><p>若遇到桌面时间中文部分显示为 <strong>方块</strong>     </p>\n<pre><code class=\"bash\">sudo vim /usr/share/conky/conky_maia</code></pre>\n<p>将 <strong>conky.text</strong> 的前四行字体改为 <strong>anti</strong> 即可</p>\n<h3 id=\"2-3-中文输入法\"><a href=\"#2-3-中文输入法\" class=\"headerlink\" title=\"2.3 中文输入法\"></a>2.3 中文输入法</h3><p>先安装fcitx</p>\n<pre><code class=\"bash\">sudo pacman -S fcitx fcitx-im fcitx-configtool</code></pre>\n<p>安装完fcitx之后，创建.xprofile文件</p>\n<pre><code class=\"bash\">vim ~/.xprofile</code></pre>\n<p>在里面添加如下内容:</p>\n<pre><code class=\"bash\">#fcitx\nexport GTK_IM_MODULE=fcitx \nexport QT_IM_MODULE=fcitx \nexport XMODIFIERS=&quot;@im=fcitx&quot;</code></pre>\n<p>之后安装中文输入法，搜狗拼音貌似对arch的支持不太好，所以我们选择谷歌拼音</p>\n<pre><code class=\"bash\">sudo pacman -S fcitx-googlepinyin</code></pre>\n<p>之后在终端运行 <code>$ fcitx</code> 在图形化界面的配置文件中配置输入法即可，配置快捷键<br><img src=\"2.png\" alt><br><img src=\"3.png\" alt></p>\n<p>若中文输入法开机无法自启动，则执行如下操作</p>\n<pre><code class=\"bash\">vim ~/.i3/config</code></pre>\n<p>添加如下内容:</p>\n<p><code>exec_always fcitx</code></p>\n<h2 id=\"3-高效率软件以及配置\"><a href=\"#3-高效率软件以及配置\" class=\"headerlink\" title=\"3. 高效率软件以及配置\"></a>3. 高效率软件以及配置</h2><h3 id=\"3-1-软件\"><a href=\"#3-1-软件\" class=\"headerlink\" title=\"3.1 软件\"></a>3.1 软件</h3><h4 id=\"3-1-1-Alacritty\"><a href=\"#3-1-1-Alacritty\" class=\"headerlink\" title=\"3.1.1 Alacritty\"></a>3.1.1 Alacritty</h4><p>Alacritty 是一个免费的开源，快速，跨平台的终端仿真器，它使用GPU进行渲染，我使用tree命令跑了一下，确实速度快。kitty也是一款优秀的终端，不过它的配置稍麻烦，感兴趣的可以自行Google.</p>\n<pre><code class=\"bash\">sudo pacman -S alacritty</code></pre>\n<h4 id=\"3-1-2-fish-amp-oh-my-fish-omf\"><a href=\"#3-1-2-fish-amp-oh-my-fish-omf\" class=\"headerlink\" title=\"3.1.2 fish &amp; oh-my-fish(omf)\"></a>3.1.2 fish &amp; oh-my-fish(omf)</h4><ul>\n<li>fish是一个智能且用户友好的命令行shell，适用于macOS，Linux和其他家族。fish包含语法突出显示，自动提示类型和精美的选项卡完成等功能，无需配置。<br>Terminal下默认的SHELL是bash, 但bash作为你经常使用的工具来说一点都不便捷,相信有很多人都用过另一款shell,它的名字是<strong>zsh</strong>，以及<strong>oh-my-zsh</strong>，我也用了一段时间的zsh，在用的过程中我发现它有时候运行贼慢，忍不了，而且配置虽说有oh-my-zsh管理，但终归不是傻瓜式工具，直到有一天我发现了 <strong>fish</strong>,官网号称是一个专为90后设计的shell。<br>安装很简单:</li>\n</ul>\n<pre><code class=\"bash\">sudo pacman -S fish</code></pre>\n<p>终端输入<code>fish</code>即可进入</p>\n<ul>\n<li>查看已经安装的shell</li>\n</ul>\n<pre><code class=\"bash\">cat /etc/shells</code></pre>\n<p><img src=\"12.png\" alt></p>\n<ul>\n<li>修改默认shell</li>\n</ul>\n<p>看一下上一步输出的<code>fish</code>的位置，然后执行</p>\n<pre><code class=\"bash\">chsh -s usr/bin/fish</code></pre>\n<p><img src=\"13.png\" alt><br>之后重启终端,shell就默认为fish了<br><img src=\"14.png\" alt></p>\n<p>配置文件的位置是<code>/home/kevin/.config/fish/functions/fish_prompt.fish</code>，可以在这里设置替换命令，提高效率，举个例子:<br><img src=\"18.png\" alt></p>\n<ul>\n<li>oh-my-fish是一个 Fishshell 框架，允许你安装扩展或更改你的 shell 外观的软件包。它简单易用，快速可扩展。使用 omf，你可以根据你的想法，很容易地安装主题，丰富你的外观和安装插件来调整你的 Fish shell。    </li>\n<li>安装omf<br>在fish shell里执行</li>\n</ul>\n<pre><code class=\"bash\">curl -L https://get.oh-my.fish | fish</code></pre>\n<ul>\n<li>列出所有的安装包</li>\n</ul>\n<pre><code class=\"bash\">omf list</code></pre>\n<p>这条命令会列出一安装的主题和插件</p>\n<p><img src=\"15.png\" alt></p>\n<ul>\n<li>列出已安装主题</li>\n</ul>\n<pre><code class=\"bash\">omf theme</code></pre>\n<ul>\n<li>安装一个新主题<br>我现在用的主题叫 ays<pre><code class=\"bash\">omf install ays</code></pre>\n</li>\n<li>改变主题</li>\n</ul>\n<pre><code class=\"bash\">omf theme ays</code></pre>\n<ul>\n<li>卸载oh-my-fish</li>\n</ul>\n<pre><code class=\"bash\">omf destroy</code></pre>\n<ul>\n<li><p>Fish 运行Bash commands<br>例如 在fish 不能运行 time 命令，以下是解决办法    </p>\n<ul>\n<li><p>在 <code>fish/functions/</code> 目录下创建 <code>time.fish</code> 文件，在里面输入    </p>\n<pre><code>function time --description &quot;alias time bash -c time&quot;\n bash -c &quot;time $argv&quot;;\nend</code></pre></li>\n</ul>\n</li>\n</ul>\n<p>其他具体功能见<a href=\"https://github.com/oh-my-fish/oh-my-fish\" target=\"_blank\" rel=\"noopener\">oh-my-fish</a></p>\n<h4 id=\"3-1-3-Chromium\"><a href=\"#3-1-3-Chromium\" class=\"headerlink\" title=\"3.1.3 Chromium\"></a>3.1.3 Chromium</h4><p>安装方式:</p>\n<pre><code class=\"bash\">sudo pacman -S chromium</code></pre>\n<h4 id=\"3-1-4-nitrogen\"><a href=\"#3-1-4-nitrogen\" class=\"headerlink\" title=\"3.1.4 nitrogen\"></a>3.1.4 nitrogen</h4><p>一款可视化换壁纸的软件,当然<strong>feh</strong>也是一款优秀的壁纸切换软件，教程很多，这里不再说了</p>\n<pre><code class=\"bash\">sudo pacman -S nitrogen</code></pre>\n<p><img src=\"5.png\" alt></p>\n<h4 id=\"3-1-5-neofetch\"><a href=\"#3-1-5-neofetch\" class=\"headerlink\" title=\"3.1.5 neofetch\"></a>3.1.5 neofetch</h4><p>neofetch是一个个性化显示Linux系统信息的工具</p>\n<pre><code class=\"bash\">sudo pacman -S neofetch</code></pre>\n<p><img src=\"19.png\" alt></p>\n<h4 id=\"3-1-6-vim\"><a href=\"#3-1-6-vim\" class=\"headerlink\" title=\"3.1.6 vim\"></a>3.1.6 vim</h4><p><img src=\"6.png\" alt></p>\n<p>文本/代码编辑中最最最为优秀经典的上古神器,之后我会写一个调教Vim的教程</p>\n<pre><code class=\"bash\">sudo pacman -S vim </code></pre>\n<h4 id=\"3-1-7-albert\"><a href=\"#3-1-7-albert\" class=\"headerlink\" title=\"3.1.7 albert\"></a>3.1.7 albert</h4><p><img src=\"7.png\" alt><br>一款软件/文件/搜索 启动器</p>\n<pre><code class=\"bash\">sudo pacman -S albert</code></pre>\n<p>第一次运行会提示你设置一下</p>\n<p><img src=\"8.png\" alt><br><img src=\"9.png\" alt></p>\n<h4 id=\"3-1-8-iease-music\"><a href=\"#3-1-8-iease-music\" class=\"headerlink\" title=\"3.1.8 iease-music\"></a>3.1.8 iease-music</h4><p>网易云音乐最漂亮的第三方客户端！</p>\n<pre><code class=\"bash\">sudo pacman -S iease-music</code></pre>\n<p><img src=\"10.png\" alt></p>\n<h4 id=\"3-1-9-deepin-screenshot\"><a href=\"#3-1-9-deepin-screenshot\" class=\"headerlink\" title=\"3.1.9 deepin-screenshot\"></a>3.1.9 deepin-screenshot</h4><p>深度截图</p>\n<pre><code class=\"bash\">sudo pacman -S deepin-screenshot</code></pre>\n<h4 id=\"3-1-10-shadowsocks-qt5\"><a href=\"#3-1-10-shadowsocks-qt5\" class=\"headerlink\" title=\"3.1.10 shadowsocks-qt5\"></a>3.1.10 shadowsocks-qt5</h4><pre><code class=\"bash\">sudo pacman -S shadowsocks-qt5</code></pre>\n<h4 id=\"3-1-11-thefuck\"><a href=\"#3-1-11-thefuck\" class=\"headerlink\" title=\"3.1.11 thefuck\"></a>3.1.11 thefuck</h4><p>自从用了”Thefuck”,妈妈再也不用担心我敲错命令了。<br>有了它，万物皆可fffffffffuck!</p>\n<pre><code class=\"bash\">sudo pacman -S thefuck</code></pre>\n<p><img src=\"11.png\" alt></p>\n<h4 id=\"3-1-12-compton\"><a href=\"#3-1-12-compton\" class=\"headerlink\" title=\"3.1.12 compton\"></a>3.1.12 compton</h4><p>设置窗口半透明+毛玻璃效果</p>\n<p><img src=\"16.png\" alt></p>\n<p>Manjaro i3 自带的有compton，不过这个只能做到半透明而没有毛玻璃效果，我使用的是<a href=\"https://github.com/tryone144/compton\" target=\"_blank\" rel=\"noopener\">Compton</a>,下面详细介绍一下安装过程</p>\n<ol>\n<li>卸载原有的compton</li>\n</ol>\n<pre><code class=\"bash\">sudo pacman -R compton</code></pre>\n<p>若遇到依赖问题无法卸载，则</p>\n<pre><code class=\"bash\">sudo pacman -Rc compton</code></pre>\n<ol start=\"2\">\n<li>clone仓库</li>\n</ol>\n<pre><code class=\"bash\">git clone git@github.com:liuyaanng/compton.git</code></pre>\n<ol start=\"3\">\n<li>安装</li>\n</ol>\n<p>具体内容参考<a href=\"https://github.com/liuyaanng/compton/blob/dual_kawase/README.md\" target=\"_blank\" rel=\"noopener\">README</a><br>安装前要确保下列依赖已经安装。<br>其实大部分都已经安装,只有个别没有，若下面安装不成功，则按提示把依赖装上即可，有问题也可以在issues上查看</p>\n<p><img src=\"17.png\" alt></p>\n<pre><code class=\"bash\">cd compton\n# Make the main program\nmake\n# Make the man page\nmake docs\n# Install\nmake install</code></pre>\n<ol start=\"4\">\n<li>配置</li>\n</ol>\n<p>配置信息在<a href>.config</a></p>\n<h4 id=\"3-1-13-deepin-file-manager\"><a href=\"#3-1-13-deepin-file-manager\" class=\"headerlink\" title=\"3.1.13 deepin-file-manager\"></a>3.1.13 deepin-file-manager</h4><p>默认的 <code>pcmanfm</code> 竟然没有搜索功能，这不能忍啊<br>我使用 <code>deepin-file-manager</code> 来代替默认的 <code>pcmanfm</code></p>\n<pre><code class=\"bash\">sudo pacman -S deepin-file-manager</code></pre>\n<p>在配置文件里</p>\n<p><img src=\"20.png\" alt></p>\n<h3 id=\"3-2-i3的配置\"><a href=\"#3-2-i3的配置\" class=\"headerlink\" title=\"3.2 i3的配置\"></a>3.2 i3的配置</h3><p>i3的配置文件在 <code>~/.i3/config</code></p>\n<p>里面的配置信息介绍的很详细,需要更详细的信息你可以阅读官方<a href=\"https://i3wm.org/docs/userguide.html\" target=\"_blank\" rel=\"noopener\">userguide</a></p>\n<p> 首先在<code>Autoapplications</code>处添加自启动的应用</p>\n<pre><code class=\"bash\">exec_always fcitx\nexec_always albert</code></pre>\n<ul>\n<li>把系统默认terminal换成<code>alacritty</code><br>在 <code>start a terminal</code>处将原来的代码注释掉，加上以下语句</li>\n</ul>\n<pre><code class=\"bash\">bindsym $mod+Return exec alacritty</code></pre>\n<ul>\n<li>设置软件启动快捷键</li>\n</ul>\n<p>在配置文件中添加</p>\n<pre><code class=\"bash\">set $mod Mod4\nset $mod1 Mod1</code></pre>\n<p>mod在这里设置的是键盘的<code>Super</code>键<br>mod1在这里设置的是<code>Alt</code>键</p>\n<pre><code class=\"bash\">bindsym $mod+c exec chromium\nbindsym $mod+p exec nitrogen\nbindsym $mod1+m exec iease-music\nbindsym $mod1+Shift+a exec deepin-screenshot</code></pre>\n<ul>\n<li>窗口之间的间距通过i3-gaps来设置，若没有安装，则</li>\n</ul>\n<pre><code class=\"bash\">sudo pacman -S i3-gaps</code></pre>\n<p>在配置文件中加入</p>\n<pre><code class=\"bash\">gaps inner 16\ngaps outer 0</code></pre>\n<p>可以根据自己喜好调整数值</p>\n<ul>\n<li>xbacklight config</li>\n</ul>\n<p>install <code>xorg-xbacklight</code> first</p>\n<pre><code class=\"bash\">sudo pacman -S xorg-xbacklight </code></pre>\n<h2 id=\"杂项\"><a href=\"#杂项\" class=\"headerlink\" title=\"杂项\"></a>杂项</h2><h4 id=\"彻底解决蜂鸣问题\"><a href=\"#彻底解决蜂鸣问题\" class=\"headerlink\" title=\"彻底解决蜂鸣问题\"></a>彻底解决蜂鸣问题</h4><p>由于蜂鸣是由主板发出来的声音，故不能通过调节音量来消除此声音，要从源头上解决</p>\n<ul>\n<li>关闭终端下Tab键的蜂鸣提示</li>\n</ul>\n<pre><code class=\"bash\">sudo vim /etc/inputrc</code></pre>\n<p>将 <code>set bell-style none</code> 前的注释去掉</p>\n<ul>\n<li>关闭vim中错误提示蜂鸣声</li>\n</ul>\n<pre><code class=\"bash\">vim .vim/vimrc</code></pre>\n<p>在里面加入  <code>set vb t_vb=</code></p>\n"},{"title":"Markdown数学公式汇总","date":"2019-07-19T07:31:03.000Z","toc":"ture","top":true,"mathjax":true,"summary":"总结一下Markdown的数学公式语法","img":"https://i.loli.net/2019/07/08/5d235019a672f97339.jpg","_content":"\n#### 分数、上标、下标、方根、求和、积分\n分数 ` $\\dfrac{2}{3}$ `表示$\\dfrac{2}{3}$，` $\\tfrac{2}{3}$ `表示$\\tfrac{2}{3}$\n```\n\\begin{eqnarray\\*}\n    \\dfrac{1}{\\sqrt 2 +\n    \\dfrac{1}{\\sqrt 2 +\n    \\dfrac{1}{\\sqrt 2 + \\dotsb}}}\\;\n    \\tfrac{1}{\\sqrt 2 +\n    \\tfrac{1}{\\sqrt 2 +\n    \\tfrac{1}{\\sqrt 2 + \\cdots}}}\\;\n    \\frac{1}{\\sqrt 2 +\n    \\frac{1}{\\sqrt 2 +\n    \\frac{1}{\\sqrt 2 + \\cdots}}}\n\\end{eqnarray\\*}\n```\n表示\n\\begin{eqnarray\\*}\n    \\dfrac{1}{\\sqrt 2 +\n    \\dfrac{1}{\\sqrt 2 +\n    \\dfrac{1}{\\sqrt 2 + \\dotsb}}}\\;\n    \\tfrac{1}{\\sqrt 2 +\n    \\tfrac{1}{\\sqrt 2 +\n    \\tfrac{1}{\\sqrt 2 + \\cdots}}}\\;\n    \\frac{1}{\\sqrt 2 +\n    \\frac{1}{\\sqrt 2 +\n    \\frac{1}{\\sqrt 2 + \\cdots}}}\n\\end{eqnarray\\*}\n\n***\n上标$A^2$、$A^{上标}$\n` $$A^2 \\; A^{上标} \\; \\mathop{A}\\limits^2$$ `表示$$A^2 \\; A^{上标} \\; \\mathop{A}\\limits^2$$\n\n***\n下标$A_2$、$A_{下标}$\n` $$A_2 \\; A_{下标}\\; \\mathop{A}\\limits_2$$ `表示$$A_2 \\; A_{下标}\\; \\mathop{A}\\limits_2$$\n\n***\n开方数$\\sqrt[开方数]{参数}$\n` $$\\sqrt[开方数]{参数}$$`表示$$\\sqrt[开方数]{参数}$$\n\n***\n求和$\\sum$\n$$\\sum ^2_3\\;\\sum \\nolimits^2_3$$\n\n***\n分$\\int$\n$$\\int ^2_3\\;\\int \\limits^2_3$$\n\n***\n\n#### 行内公式\n$R^s_r(t_r,t_e)=(t_r-t_e)c$\n***\n#### 显示公式\n$$R^s_r(t_r,t_e)=(t_r-t_e)c$$\n***\n#### 带有编号的显示公式\n\\begin{equation}\n    R^s_r(t_r,t_e)=(t_r-t_e)c\n\\end{equation}\n***\n#### 带有编号的多行公式\n\\begin{eqnarray}\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c\n\\end{eqnarray}\n***\n#### 取消某一编号的多行公式\n\\begin{eqnarray}\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\nonumber\\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c\n\\end{eqnarray}\n***\n#### 带有指定编号的多行公式\n\\begin{eqnarray\\*}\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\tag{1}\\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c\n\\end{eqnarray\\*}\n***\n#### 不带编号的多行公式\n\\begin{eqnarray\\*}\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c\n\\end{eqnarray\\*}\n***\n#### 指定对齐方式的多行公式\n\\begin{eqnarray}\n    &R^s_r(t_r,t_e)&=(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)& = &(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)=&(t_r-t_e)c&\n\\end{eqnarray}\n***\n#### 输入矩阵\n\\begin{matrix}\n    0 & 1 \\\\\\\n    1 & 0\n\\end{matrix}\n***\n\\begin{pmatrix}\n    0 & -i \\\\\\\n    i & 0\n\\end{pmatrix}\n***\n\\begin{bmatrix}\n    0 & -1 \\\\\\\n    1 & 0\n\\end{bmatrix}\n***\n\\begin{Bmatrix}\n    1 & 0 \\\\\\\n    0 & -1\n\\end{Bmatrix}\n***\n\\begin{vmatrix}\n    a & b \\\\\\\n    c & d\n\\end{vmatrix}\n***\n\\begin{Vmatrix}\n    i & 0 \\\\\\\n     0 & -i\n\\end{Vmatrix}\n***\n#### 数学符号\n##### 操作符号\n$$\n\\pm    \\mp    \\times    \\div    \\ast    \\star    \\circ    \\bullet    \\divideontimes    \\ltimes    \\rtimes    \\cdot    \\dotplus    \\leftthreetimes    \\rightthreetimes    \\amalg    \\otimes    \\oplus    \\ominus    \\oslash    \\odot    \\circledcirc    \\circleddash    \\circledast    \\bigcirc \\boxdot    \\boxminus    \\boxplus    \\boxtimes    \\diamond    \\bigtriangleup    \\bigtriangledown    \\triangleleft    \\triangleright    \\lhd    \\rhd    \\unlhd    \\unrhd    \\cup    \\cap    \\uplus    \\Cup    \\Cap    \\wr    \\setminus    \\smallsetminus    \\sqcap    \\sqcup \\wedge    \\vee    \\barwedge    \\veebar    \\doublebarwedge    \\curlywedge    \\curlyvee    \\dagger    \\ddagger    \\intercal    \\bigcap    \\bigcup    \\biguplus    \\bigsqcup    \\prod    \\coprod    \\bigwedge    \\bigvee    \\bigodot    \\bigoplus    \\bigotimes    \\sum \\int    \\oint    \\iint    \\iiint    \\iiiint    \\idotsint    \\arccos    \\arcsin    \\arctan    \\arg    \\cos    \\cosh    \\cot    \\coth    \\csc    \\deg    \\det    \\dim    \\exp    \\gcd    \\hom    \\inf    \\ker    \\lg    \\lim    \\liminf    \\limsup    \\ln    \\log    \\max    \\min    \\Pr    \\projlim    \\sec\\sin\\sinh    \\sup    \\tan    \\tanh \\varlimsup    \\varliminf    \\varinjlim    \\varprojlim\n $$\n##### 关系符号\n$$\n\\bowtie    \\Join    \\propto    \\varpropto    \\multimap    \\pitchfork  \\therefore    \\because    =    \\neq    \\equiv    \\approx    \\sim    \\simeq    \\backsimeq    \\approxeq    \\cong    \\ncong        \\smile    \\frown    \\asymp    \\smallfrown    \\smallsmile    \\between    \\prec    \\succ    \\nprec    \\nsucc    \\preceq    \\succeq    \\npreceq    \\nsucceq    \\preccurlyeq    \\succcurlyeq    \\curlyeqprec    \\curlyeqsucc    \\precsim    \\succsim    \\precnsim    \\succnsim    \\precapprox    \\succapprox    \\precnapprox    \\succnapprox    \\perp    \\vdash    \\dashv    \\nvdash    \\Vdash    \\Vvdash    \\models    \\vDash    \\nvDash    \\nVDash    \\mid    \\nmid    \\parallel    \\nparallel    \\shortmid    \\nshortmid    \\shortparallel    \\nshortparallel    <    >    \\nless    \\ngtr    \\lessdot    \\gtrdot    \\ll    \\gg    \\lll    \\ggg    \\leq    \\geq    \\lneq    \\gneq    \\nleq    \\ngeq    \\leqq    \\geqq    \\lneqq    \\gneqq    \\lvertneqq    \\gvertneqq    \\nleqq    \\ngeqq    \\leqslant    \\geqslant    \\nleqslant    \\ngeqslant    \\eqslantless    \\eqslantgtr    \\lessgtr    \\gtrless    \\lesseqgtr    \\gtreqless    \\lesseqqgtr    \\gtreqqless    \\lesssim    \\gtrsim    \\lnsim    \\gnsim    \\lessapprox    \\gtrapprox    \\lnapprox    \\gnapprox    \\vartriangleleft    \\vartriangleright    \\ntriangleleft    \\ntriangleright    \\trianglelefteq    \\trianglerighteq    \\ntrianglelefteq    \\ntrianglerighteq    \\blacktriangleleft    \\blacktriangleright    \\subset    \\supset    \\subseteq    \\supseteq    \\subsetneq    \\supsetneq    \\varsubsetneq    \\varsupsetneq    \\nsubseteq    \\nsupseteq    \\subseteqq    \\supseteqq    \\subsetneqq    \\supsetneqq    \\nsubseteqq    \\nsupseteqq    \\backepsilon    \\Subset    \\Supset    \\sqsubset    \\sqsupset    \\sqsubseteq    \\sqsupseteq\n$$\n##### 箭头符号\n$$\n\\leftarrow    \\leftrightarrow    \\rightarrow    \\mapsto    \\longleftarrow        \\longleftrightarrow    \\longrightarrow    \\longmapsto    \\downarrow    \\updownarrow    \\uparrow    \\nwarrow        \\searrow    \\nearrow    \\swarrow        \\nleftarrow            \\nleftrightarrow        \\nrightarrow        \\hookleftarrow        \\hookrightarrow        \\twoheadleftarrow        \\twoheadrightarrow        \\leftarrowtail        \\rightarrowtail        \\Leftarrow        \\Leftrightarrow        \\Rightarrow        \\Longleftarrow        \\Longleftrightarrow        \\Longrightarrow            \\Updownarrow        \\Uparrow        \\Downarrow        \\nLeftarrow        \\nLeftrightarrow    \\nRightarrow        \\leftleftarrows        \\leftrightarrows        \\rightleftarrows        \\rightrightarrows        \\downdownarrows        \\upuparrows        \\circlearrowleft        \\circlearrowright        \\curvearrowleft        \\curvearrowright        \\Lsh        \\Rsh        \\looparrowleft        \\looparrowright        \\dashleftarrow        \\dashrightarrow        \\leftrightsquigarrow        \\rightsquigarrow        \\Lleftarrow        \\leftharpoondown        \\rightharpoondown        \\leftharpoonup        \\rightharpoonup        \\rightleftharpoons        \\leftrightharpoons        \\downharpoonleft        \\upharpoonleft        \\downharpoonright            \\upharpoonright\n$$\n##### 分隔符\n$$\n\\downarrow    \\Downarrow    \\langle \\rangle [ ] | \\| \\lceil \\rceil \\uparrow    \\Uparrow    \\lfloor        \\rfloor    \\updownarrow    \\Updownarrow    (        )    \\{    \\} \\backslash    \\lmoustache        \\rmoustache    \\lgroup    \\rgroup    \\arrowvert    \\Arrowvert    \\bracevert    \\lvert    \\rvert    \\lVert        \\rVert    \\ulcorner    \\urcorner \\llcorner \\lrcorner\n$$\n##### 希腊字符\n$$\n\\alpha    \\beta        \\gamma    \\delta    \\epsilon    \\zeta    \\eta    \\theta    \\vartheta    \\iota    \\kappa    \\lambda    \\mu    \\nu    \\xi    o    \\pi    \\varpi    \\rho    \\varrho    \\sigma    \\varsigma    \\tau    \\upsilon    \\phi    \\varphi    \\chi    \\psi    \\omega    A    B    \\Gamma    \\varGamma    \\Delta    \\varDelta    E    Z    H    \\Theta    \\varTheta    I    K    \\Lambda    \\varLambda    M    N    \\Xi    \\varXi    O    \\Pi    \\varPi    P    \\Sigma        \\Upsilon    \\varUpsilon    \\Phi    \\varPhi    X    \\varPsi    \\Omega    \\varOmega\n$$\n\n\n\n","source":"_posts/Markdown数学公式汇总.md","raw":"---\ntitle: Markdown数学公式汇总\ndate: 2019-07-19 15:31:03\ntoc: ture\ntop: true\ntags: \n- Markdown\ncategories: \n- 教程\nmathjax: true\nsummary: 总结一下Markdown的数学公式语法\nimg: https://i.loli.net/2019/07/08/5d235019a672f97339.jpg\n---\n\n#### 分数、上标、下标、方根、求和、积分\n分数 ` $\\dfrac{2}{3}$ `表示$\\dfrac{2}{3}$，` $\\tfrac{2}{3}$ `表示$\\tfrac{2}{3}$\n```\n\\begin{eqnarray\\*}\n    \\dfrac{1}{\\sqrt 2 +\n    \\dfrac{1}{\\sqrt 2 +\n    \\dfrac{1}{\\sqrt 2 + \\dotsb}}}\\;\n    \\tfrac{1}{\\sqrt 2 +\n    \\tfrac{1}{\\sqrt 2 +\n    \\tfrac{1}{\\sqrt 2 + \\cdots}}}\\;\n    \\frac{1}{\\sqrt 2 +\n    \\frac{1}{\\sqrt 2 +\n    \\frac{1}{\\sqrt 2 + \\cdots}}}\n\\end{eqnarray\\*}\n```\n表示\n\\begin{eqnarray\\*}\n    \\dfrac{1}{\\sqrt 2 +\n    \\dfrac{1}{\\sqrt 2 +\n    \\dfrac{1}{\\sqrt 2 + \\dotsb}}}\\;\n    \\tfrac{1}{\\sqrt 2 +\n    \\tfrac{1}{\\sqrt 2 +\n    \\tfrac{1}{\\sqrt 2 + \\cdots}}}\\;\n    \\frac{1}{\\sqrt 2 +\n    \\frac{1}{\\sqrt 2 +\n    \\frac{1}{\\sqrt 2 + \\cdots}}}\n\\end{eqnarray\\*}\n\n***\n上标$A^2$、$A^{上标}$\n` $$A^2 \\; A^{上标} \\; \\mathop{A}\\limits^2$$ `表示$$A^2 \\; A^{上标} \\; \\mathop{A}\\limits^2$$\n\n***\n下标$A_2$、$A_{下标}$\n` $$A_2 \\; A_{下标}\\; \\mathop{A}\\limits_2$$ `表示$$A_2 \\; A_{下标}\\; \\mathop{A}\\limits_2$$\n\n***\n开方数$\\sqrt[开方数]{参数}$\n` $$\\sqrt[开方数]{参数}$$`表示$$\\sqrt[开方数]{参数}$$\n\n***\n求和$\\sum$\n$$\\sum ^2_3\\;\\sum \\nolimits^2_3$$\n\n***\n分$\\int$\n$$\\int ^2_3\\;\\int \\limits^2_3$$\n\n***\n\n#### 行内公式\n$R^s_r(t_r,t_e)=(t_r-t_e)c$\n***\n#### 显示公式\n$$R^s_r(t_r,t_e)=(t_r-t_e)c$$\n***\n#### 带有编号的显示公式\n\\begin{equation}\n    R^s_r(t_r,t_e)=(t_r-t_e)c\n\\end{equation}\n***\n#### 带有编号的多行公式\n\\begin{eqnarray}\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c\n\\end{eqnarray}\n***\n#### 取消某一编号的多行公式\n\\begin{eqnarray}\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\nonumber\\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c\n\\end{eqnarray}\n***\n#### 带有指定编号的多行公式\n\\begin{eqnarray\\*}\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\tag{1}\\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c\n\\end{eqnarray\\*}\n***\n#### 不带编号的多行公式\n\\begin{eqnarray\\*}\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)=(t_r-t_e)c\n\\end{eqnarray\\*}\n***\n#### 指定对齐方式的多行公式\n\\begin{eqnarray}\n    &R^s_r(t_r,t_e)&=(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)& = &(t_r-t_e)c \\\\\\\n    R^s_r(t_r,t_e)=&(t_r-t_e)c&\n\\end{eqnarray}\n***\n#### 输入矩阵\n\\begin{matrix}\n    0 & 1 \\\\\\\n    1 & 0\n\\end{matrix}\n***\n\\begin{pmatrix}\n    0 & -i \\\\\\\n    i & 0\n\\end{pmatrix}\n***\n\\begin{bmatrix}\n    0 & -1 \\\\\\\n    1 & 0\n\\end{bmatrix}\n***\n\\begin{Bmatrix}\n    1 & 0 \\\\\\\n    0 & -1\n\\end{Bmatrix}\n***\n\\begin{vmatrix}\n    a & b \\\\\\\n    c & d\n\\end{vmatrix}\n***\n\\begin{Vmatrix}\n    i & 0 \\\\\\\n     0 & -i\n\\end{Vmatrix}\n***\n#### 数学符号\n##### 操作符号\n$$\n\\pm    \\mp    \\times    \\div    \\ast    \\star    \\circ    \\bullet    \\divideontimes    \\ltimes    \\rtimes    \\cdot    \\dotplus    \\leftthreetimes    \\rightthreetimes    \\amalg    \\otimes    \\oplus    \\ominus    \\oslash    \\odot    \\circledcirc    \\circleddash    \\circledast    \\bigcirc \\boxdot    \\boxminus    \\boxplus    \\boxtimes    \\diamond    \\bigtriangleup    \\bigtriangledown    \\triangleleft    \\triangleright    \\lhd    \\rhd    \\unlhd    \\unrhd    \\cup    \\cap    \\uplus    \\Cup    \\Cap    \\wr    \\setminus    \\smallsetminus    \\sqcap    \\sqcup \\wedge    \\vee    \\barwedge    \\veebar    \\doublebarwedge    \\curlywedge    \\curlyvee    \\dagger    \\ddagger    \\intercal    \\bigcap    \\bigcup    \\biguplus    \\bigsqcup    \\prod    \\coprod    \\bigwedge    \\bigvee    \\bigodot    \\bigoplus    \\bigotimes    \\sum \\int    \\oint    \\iint    \\iiint    \\iiiint    \\idotsint    \\arccos    \\arcsin    \\arctan    \\arg    \\cos    \\cosh    \\cot    \\coth    \\csc    \\deg    \\det    \\dim    \\exp    \\gcd    \\hom    \\inf    \\ker    \\lg    \\lim    \\liminf    \\limsup    \\ln    \\log    \\max    \\min    \\Pr    \\projlim    \\sec\\sin\\sinh    \\sup    \\tan    \\tanh \\varlimsup    \\varliminf    \\varinjlim    \\varprojlim\n $$\n##### 关系符号\n$$\n\\bowtie    \\Join    \\propto    \\varpropto    \\multimap    \\pitchfork  \\therefore    \\because    =    \\neq    \\equiv    \\approx    \\sim    \\simeq    \\backsimeq    \\approxeq    \\cong    \\ncong        \\smile    \\frown    \\asymp    \\smallfrown    \\smallsmile    \\between    \\prec    \\succ    \\nprec    \\nsucc    \\preceq    \\succeq    \\npreceq    \\nsucceq    \\preccurlyeq    \\succcurlyeq    \\curlyeqprec    \\curlyeqsucc    \\precsim    \\succsim    \\precnsim    \\succnsim    \\precapprox    \\succapprox    \\precnapprox    \\succnapprox    \\perp    \\vdash    \\dashv    \\nvdash    \\Vdash    \\Vvdash    \\models    \\vDash    \\nvDash    \\nVDash    \\mid    \\nmid    \\parallel    \\nparallel    \\shortmid    \\nshortmid    \\shortparallel    \\nshortparallel    <    >    \\nless    \\ngtr    \\lessdot    \\gtrdot    \\ll    \\gg    \\lll    \\ggg    \\leq    \\geq    \\lneq    \\gneq    \\nleq    \\ngeq    \\leqq    \\geqq    \\lneqq    \\gneqq    \\lvertneqq    \\gvertneqq    \\nleqq    \\ngeqq    \\leqslant    \\geqslant    \\nleqslant    \\ngeqslant    \\eqslantless    \\eqslantgtr    \\lessgtr    \\gtrless    \\lesseqgtr    \\gtreqless    \\lesseqqgtr    \\gtreqqless    \\lesssim    \\gtrsim    \\lnsim    \\gnsim    \\lessapprox    \\gtrapprox    \\lnapprox    \\gnapprox    \\vartriangleleft    \\vartriangleright    \\ntriangleleft    \\ntriangleright    \\trianglelefteq    \\trianglerighteq    \\ntrianglelefteq    \\ntrianglerighteq    \\blacktriangleleft    \\blacktriangleright    \\subset    \\supset    \\subseteq    \\supseteq    \\subsetneq    \\supsetneq    \\varsubsetneq    \\varsupsetneq    \\nsubseteq    \\nsupseteq    \\subseteqq    \\supseteqq    \\subsetneqq    \\supsetneqq    \\nsubseteqq    \\nsupseteqq    \\backepsilon    \\Subset    \\Supset    \\sqsubset    \\sqsupset    \\sqsubseteq    \\sqsupseteq\n$$\n##### 箭头符号\n$$\n\\leftarrow    \\leftrightarrow    \\rightarrow    \\mapsto    \\longleftarrow        \\longleftrightarrow    \\longrightarrow    \\longmapsto    \\downarrow    \\updownarrow    \\uparrow    \\nwarrow        \\searrow    \\nearrow    \\swarrow        \\nleftarrow            \\nleftrightarrow        \\nrightarrow        \\hookleftarrow        \\hookrightarrow        \\twoheadleftarrow        \\twoheadrightarrow        \\leftarrowtail        \\rightarrowtail        \\Leftarrow        \\Leftrightarrow        \\Rightarrow        \\Longleftarrow        \\Longleftrightarrow        \\Longrightarrow            \\Updownarrow        \\Uparrow        \\Downarrow        \\nLeftarrow        \\nLeftrightarrow    \\nRightarrow        \\leftleftarrows        \\leftrightarrows        \\rightleftarrows        \\rightrightarrows        \\downdownarrows        \\upuparrows        \\circlearrowleft        \\circlearrowright        \\curvearrowleft        \\curvearrowright        \\Lsh        \\Rsh        \\looparrowleft        \\looparrowright        \\dashleftarrow        \\dashrightarrow        \\leftrightsquigarrow        \\rightsquigarrow        \\Lleftarrow        \\leftharpoondown        \\rightharpoondown        \\leftharpoonup        \\rightharpoonup        \\rightleftharpoons        \\leftrightharpoons        \\downharpoonleft        \\upharpoonleft        \\downharpoonright            \\upharpoonright\n$$\n##### 分隔符\n$$\n\\downarrow    \\Downarrow    \\langle \\rangle [ ] | \\| \\lceil \\rceil \\uparrow    \\Uparrow    \\lfloor        \\rfloor    \\updownarrow    \\Updownarrow    (        )    \\{    \\} \\backslash    \\lmoustache        \\rmoustache    \\lgroup    \\rgroup    \\arrowvert    \\Arrowvert    \\bracevert    \\lvert    \\rvert    \\lVert        \\rVert    \\ulcorner    \\urcorner \\llcorner \\lrcorner\n$$\n##### 希腊字符\n$$\n\\alpha    \\beta        \\gamma    \\delta    \\epsilon    \\zeta    \\eta    \\theta    \\vartheta    \\iota    \\kappa    \\lambda    \\mu    \\nu    \\xi    o    \\pi    \\varpi    \\rho    \\varrho    \\sigma    \\varsigma    \\tau    \\upsilon    \\phi    \\varphi    \\chi    \\psi    \\omega    A    B    \\Gamma    \\varGamma    \\Delta    \\varDelta    E    Z    H    \\Theta    \\varTheta    I    K    \\Lambda    \\varLambda    M    N    \\Xi    \\varXi    O    \\Pi    \\varPi    P    \\Sigma        \\Upsilon    \\varUpsilon    \\Phi    \\varPhi    X    \\varPsi    \\Omega    \\varOmega\n$$\n\n\n\n","slug":"Markdown数学公式汇总","published":1,"updated":"2020-02-24T10:49:41.377Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0ta001974juiehkuj41","content":"<h4 id=\"分数、上标、下标、方根、求和、积分\"><a href=\"#分数、上标、下标、方根、求和、积分\" class=\"headerlink\" title=\"分数、上标、下标、方根、求和、积分\"></a>分数、上标、下标、方根、求和、积分</h4><p>分数 <code>$\\dfrac{2}{3}$</code>表示$\\dfrac{2}{3}$，<code>$\\tfrac{2}{3}$</code>表示$\\tfrac{2}{3}$</p>\n<pre><code>\\begin{eqnarray\\*}\n    \\dfrac{1}{\\sqrt 2 +\n    \\dfrac{1}{\\sqrt 2 +\n    \\dfrac{1}{\\sqrt 2 + \\dotsb}}}\\;\n    \\tfrac{1}{\\sqrt 2 +\n    \\tfrac{1}{\\sqrt 2 +\n    \\tfrac{1}{\\sqrt 2 + \\cdots}}}\\;\n    \\frac{1}{\\sqrt 2 +\n    \\frac{1}{\\sqrt 2 +\n    \\frac{1}{\\sqrt 2 + \\cdots}}}\n\\end{eqnarray\\*}</code></pre><p>表示<br>\\begin{eqnarray*}<br>    \\dfrac{1}{\\sqrt 2 +<br>    \\dfrac{1}{\\sqrt 2 +<br>    \\dfrac{1}{\\sqrt 2 + \\dotsb}}}\\;<br>    \\tfrac{1}{\\sqrt 2 +<br>    \\tfrac{1}{\\sqrt 2 +<br>    \\tfrac{1}{\\sqrt 2 + \\cdots}}}\\;<br>    \\frac{1}{\\sqrt 2 +<br>    \\frac{1}{\\sqrt 2 +<br>    \\frac{1}{\\sqrt 2 + \\cdots}}}<br>\\end{eqnarray*}</p>\n<hr>\n<p>上标$A^2$、$A^{上标}$<br><code>$$A^2 \\; A^{上标} \\; \\mathop{A}\\limits^2$$</code>表示$$A^2 \\; A^{上标} \\; \\mathop{A}\\limits^2$$</p>\n<hr>\n<p>下标$A_2$、$A_{下标}$<br><code>$$A_2 \\; A_{下标}\\; \\mathop{A}\\limits_2$$</code>表示$$A_2 \\; A_{下标}\\; \\mathop{A}\\limits_2$$</p>\n<hr>\n<p>开方数$\\sqrt[开方数]{参数}$<br><code>$$\\sqrt[开方数]{参数}$$</code>表示$$\\sqrt[开方数]{参数}$$</p>\n<hr>\n<p>求和$\\sum$<br>$$\\sum ^2_3\\;\\sum \\nolimits^2_3$$</p>\n<hr>\n<p>分$\\int$<br>$$\\int ^2_3\\;\\int \\limits^2_3$$</p>\n<hr>\n<h4 id=\"行内公式\"><a href=\"#行内公式\" class=\"headerlink\" title=\"行内公式\"></a>行内公式</h4><p>$R^s_r(t_r,t_e)=(t_r-t_e)c$</p>\n<hr>\n<h4 id=\"显示公式\"><a href=\"#显示公式\" class=\"headerlink\" title=\"显示公式\"></a>显示公式</h4><p>$$R^s_r(t_r,t_e)=(t_r-t_e)c$$</p>\n<hr>\n<h4 id=\"带有编号的显示公式\"><a href=\"#带有编号的显示公式\" class=\"headerlink\" title=\"带有编号的显示公式\"></a>带有编号的显示公式</h4><p>\\begin{equation}<br>    R^s_r(t_r,t_e)=(t_r-t_e)c<br>\\end{equation}</p>\n<hr>\n<h4 id=\"带有编号的多行公式\"><a href=\"#带有编号的多行公式\" class=\"headerlink\" title=\"带有编号的多行公式\"></a>带有编号的多行公式</h4><p>\\begin{eqnarray}<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c<br>\\end{eqnarray}</p>\n<hr>\n<h4 id=\"取消某一编号的多行公式\"><a href=\"#取消某一编号的多行公式\" class=\"headerlink\" title=\"取消某一编号的多行公式\"></a>取消某一编号的多行公式</h4><p>\\begin{eqnarray}<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\nonumber\\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c<br>\\end{eqnarray}</p>\n<hr>\n<h4 id=\"带有指定编号的多行公式\"><a href=\"#带有指定编号的多行公式\" class=\"headerlink\" title=\"带有指定编号的多行公式\"></a>带有指定编号的多行公式</h4><p>\\begin{eqnarray*}<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\tag{1}\\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c<br>\\end{eqnarray*}</p>\n<hr>\n<h4 id=\"不带编号的多行公式\"><a href=\"#不带编号的多行公式\" class=\"headerlink\" title=\"不带编号的多行公式\"></a>不带编号的多行公式</h4><p>\\begin{eqnarray*}<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c<br>\\end{eqnarray*}</p>\n<hr>\n<h4 id=\"指定对齐方式的多行公式\"><a href=\"#指定对齐方式的多行公式\" class=\"headerlink\" title=\"指定对齐方式的多行公式\"></a>指定对齐方式的多行公式</h4><p>\\begin{eqnarray}<br>    &amp;R^s_r(t_r,t_e)&amp;=(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)&amp; = &amp;(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)=&amp;(t_r-t_e)c&amp;<br>\\end{eqnarray}</p>\n<hr>\n<h4 id=\"输入矩阵\"><a href=\"#输入矩阵\" class=\"headerlink\" title=\"输入矩阵\"></a>输入矩阵</h4><p>\\begin{matrix}<br>    0 &amp; 1 \\\\<br>    1 &amp; 0<br>\\end{matrix}</p>\n<hr>\n<p>\\begin{pmatrix}<br>    0 &amp; -i \\\\<br>    i &amp; 0<br>\\end{pmatrix}</p>\n<hr>\n<p>\\begin{bmatrix}<br>    0 &amp; -1 \\\\<br>    1 &amp; 0<br>\\end{bmatrix}</p>\n<hr>\n<p>\\begin{Bmatrix}<br>    1 &amp; 0 \\\\<br>    0 &amp; -1<br>\\end{Bmatrix}</p>\n<hr>\n<p>\\begin{vmatrix}<br>    a &amp; b \\\\<br>    c &amp; d<br>\\end{vmatrix}</p>\n<hr>\n<p>\\begin{Vmatrix}<br>    i &amp; 0 \\\\<br>     0 &amp; -i<br>\\end{Vmatrix}</p>\n<hr>\n<h4 id=\"数学符号\"><a href=\"#数学符号\" class=\"headerlink\" title=\"数学符号\"></a>数学符号</h4><h5 id=\"操作符号\"><a href=\"#操作符号\" class=\"headerlink\" title=\"操作符号\"></a>操作符号</h5><p>$$<br>\\pm    \\mp    \\times    \\div    \\ast    \\star    \\circ    \\bullet    \\divideontimes    \\ltimes    \\rtimes    \\cdot    \\dotplus    \\leftthreetimes    \\rightthreetimes    \\amalg    \\otimes    \\oplus    \\ominus    \\oslash    \\odot    \\circledcirc    \\circleddash    \\circledast    \\bigcirc \\boxdot    \\boxminus    \\boxplus    \\boxtimes    \\diamond    \\bigtriangleup    \\bigtriangledown    \\triangleleft    \\triangleright    \\lhd    \\rhd    \\unlhd    \\unrhd    \\cup    \\cap    \\uplus    \\Cup    \\Cap    \\wr    \\setminus    \\smallsetminus    \\sqcap    \\sqcup \\wedge    \\vee    \\barwedge    \\veebar    \\doublebarwedge    \\curlywedge    \\curlyvee    \\dagger    \\ddagger    \\intercal    \\bigcap    \\bigcup    \\biguplus    \\bigsqcup    \\prod    \\coprod    \\bigwedge    \\bigvee    \\bigodot    \\bigoplus    \\bigotimes    \\sum \\int    \\oint    \\iint    \\iiint    \\iiiint    \\idotsint    \\arccos    \\arcsin    \\arctan    \\arg    \\cos    \\cosh    \\cot    \\coth    \\csc    \\deg    \\det    \\dim    \\exp    \\gcd    \\hom    \\inf    \\ker    \\lg    \\lim    \\liminf    \\limsup    \\ln    \\log    \\max    \\min    \\Pr    \\projlim    \\sec\\sin\\sinh    \\sup    \\tan    \\tanh \\varlimsup    \\varliminf    \\varinjlim    \\varprojlim<br> $$</p>\n<h5 id=\"关系符号\"><a href=\"#关系符号\" class=\"headerlink\" title=\"关系符号\"></a>关系符号</h5><p>$$<br>\\bowtie    \\Join    \\propto    \\varpropto    \\multimap    \\pitchfork  \\therefore    \\because    =    \\neq    \\equiv    \\approx    \\sim    \\simeq    \\backsimeq    \\approxeq    \\cong    \\ncong        \\smile    \\frown    \\asymp    \\smallfrown    \\smallsmile    \\between    \\prec    \\succ    \\nprec    \\nsucc    \\preceq    \\succeq    \\npreceq    \\nsucceq    \\preccurlyeq    \\succcurlyeq    \\curlyeqprec    \\curlyeqsucc    \\precsim    \\succsim    \\precnsim    \\succnsim    \\precapprox    \\succapprox    \\precnapprox    \\succnapprox    \\perp    \\vdash    \\dashv    \\nvdash    \\Vdash    \\Vvdash    \\models    \\vDash    \\nvDash    \\nVDash    \\mid    \\nmid    \\parallel    \\nparallel    \\shortmid    \\nshortmid    \\shortparallel    \\nshortparallel    &lt;    &gt;    \\nless    \\ngtr    \\lessdot    \\gtrdot    \\ll    \\gg    \\lll    \\ggg    \\leq    \\geq    \\lneq    \\gneq    \\nleq    \\ngeq    \\leqq    \\geqq    \\lneqq    \\gneqq    \\lvertneqq    \\gvertneqq    \\nleqq    \\ngeqq    \\leqslant    \\geqslant    \\nleqslant    \\ngeqslant    \\eqslantless    \\eqslantgtr    \\lessgtr    \\gtrless    \\lesseqgtr    \\gtreqless    \\lesseqqgtr    \\gtreqqless    \\lesssim    \\gtrsim    \\lnsim    \\gnsim    \\lessapprox    \\gtrapprox    \\lnapprox    \\gnapprox    \\vartriangleleft    \\vartriangleright    \\ntriangleleft    \\ntriangleright    \\trianglelefteq    \\trianglerighteq    \\ntrianglelefteq    \\ntrianglerighteq    \\blacktriangleleft    \\blacktriangleright    \\subset    \\supset    \\subseteq    \\supseteq    \\subsetneq    \\supsetneq    \\varsubsetneq    \\varsupsetneq    \\nsubseteq    \\nsupseteq    \\subseteqq    \\supseteqq    \\subsetneqq    \\supsetneqq    \\nsubseteqq    \\nsupseteqq    \\backepsilon    \\Subset    \\Supset    \\sqsubset    \\sqsupset    \\sqsubseteq    \\sqsupseteq<br>$$</p>\n<h5 id=\"箭头符号\"><a href=\"#箭头符号\" class=\"headerlink\" title=\"箭头符号\"></a>箭头符号</h5><p>$$<br>\\leftarrow    \\leftrightarrow    \\rightarrow    \\mapsto    \\longleftarrow        \\longleftrightarrow    \\longrightarrow    \\longmapsto    \\downarrow    \\updownarrow    \\uparrow    \\nwarrow        \\searrow    \\nearrow    \\swarrow        \\nleftarrow            \\nleftrightarrow        \\nrightarrow        \\hookleftarrow        \\hookrightarrow        \\twoheadleftarrow        \\twoheadrightarrow        \\leftarrowtail        \\rightarrowtail        \\Leftarrow        \\Leftrightarrow        \\Rightarrow        \\Longleftarrow        \\Longleftrightarrow        \\Longrightarrow            \\Updownarrow        \\Uparrow        \\Downarrow        \\nLeftarrow        \\nLeftrightarrow    \\nRightarrow        \\leftleftarrows        \\leftrightarrows        \\rightleftarrows        \\rightrightarrows        \\downdownarrows        \\upuparrows        \\circlearrowleft        \\circlearrowright        \\curvearrowleft        \\curvearrowright        \\Lsh        \\Rsh        \\looparrowleft        \\looparrowright        \\dashleftarrow        \\dashrightarrow        \\leftrightsquigarrow        \\rightsquigarrow        \\Lleftarrow        \\leftharpoondown        \\rightharpoondown        \\leftharpoonup        \\rightharpoonup        \\rightleftharpoons        \\leftrightharpoons        \\downharpoonleft        \\upharpoonleft        \\downharpoonright            \\upharpoonright<br>$$</p>\n<h5 id=\"分隔符\"><a href=\"#分隔符\" class=\"headerlink\" title=\"分隔符\"></a>分隔符</h5><p>$$<br>\\downarrow    \\Downarrow    \\langle \\rangle [ ] | | \\lceil \\rceil \\uparrow    \\Uparrow    \\lfloor        \\rfloor    \\updownarrow    \\Updownarrow    (        )    \\{    \\} \\backslash    \\lmoustache        \\rmoustache    \\lgroup    \\rgroup    \\arrowvert    \\Arrowvert    \\bracevert    \\lvert    \\rvert    \\lVert        \\rVert    \\ulcorner    \\urcorner \\llcorner \\lrcorner<br>$$</p>\n<h5 id=\"希腊字符\"><a href=\"#希腊字符\" class=\"headerlink\" title=\"希腊字符\"></a>希腊字符</h5><p>$$<br>\\alpha    \\beta        \\gamma    \\delta    \\epsilon    \\zeta    \\eta    \\theta    \\vartheta    \\iota    \\kappa    \\lambda    \\mu    \\nu    \\xi    o    \\pi    \\varpi    \\rho    \\varrho    \\sigma    \\varsigma    \\tau    \\upsilon    \\phi    \\varphi    \\chi    \\psi    \\omega    A    B    \\Gamma    \\varGamma    \\Delta    \\varDelta    E    Z    H    \\Theta    \\varTheta    I    K    \\Lambda    \\varLambda    M    N    \\Xi    \\varXi    O    \\Pi    \\varPi    P    \\Sigma        \\Upsilon    \\varUpsilon    \\Phi    \\varPhi    X    \\varPsi    \\Omega    \\varOmega<br>$$</p>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h4 id=\"分数、上标、下标、方根、求和、积分\"><a href=\"#分数、上标、下标、方根、求和、积分\" class=\"headerlink\" title=\"分数、上标、下标、方根、求和、积分\"></a>分数、上标、下标、方根、求和、积分</h4><p>分数 <code>$\\dfrac{2}{3}$</code>表示$\\dfrac{2}{3}$，<code>$\\tfrac{2}{3}$</code>表示$\\tfrac{2}{3}$</p>\n<pre><code>\\begin{eqnarray\\*}\n    \\dfrac{1}{\\sqrt 2 +\n    \\dfrac{1}{\\sqrt 2 +\n    \\dfrac{1}{\\sqrt 2 + \\dotsb}}}\\;\n    \\tfrac{1}{\\sqrt 2 +\n    \\tfrac{1}{\\sqrt 2 +\n    \\tfrac{1}{\\sqrt 2 + \\cdots}}}\\;\n    \\frac{1}{\\sqrt 2 +\n    \\frac{1}{\\sqrt 2 +\n    \\frac{1}{\\sqrt 2 + \\cdots}}}\n\\end{eqnarray\\*}</code></pre><p>表示<br>\\begin{eqnarray*}<br>    \\dfrac{1}{\\sqrt 2 +<br>    \\dfrac{1}{\\sqrt 2 +<br>    \\dfrac{1}{\\sqrt 2 + \\dotsb}}}\\;<br>    \\tfrac{1}{\\sqrt 2 +<br>    \\tfrac{1}{\\sqrt 2 +<br>    \\tfrac{1}{\\sqrt 2 + \\cdots}}}\\;<br>    \\frac{1}{\\sqrt 2 +<br>    \\frac{1}{\\sqrt 2 +<br>    \\frac{1}{\\sqrt 2 + \\cdots}}}<br>\\end{eqnarray*}</p>\n<hr>\n<p>上标$A^2$、$A^{上标}$<br><code>$$A^2 \\; A^{上标} \\; \\mathop{A}\\limits^2$$</code>表示$$A^2 \\; A^{上标} \\; \\mathop{A}\\limits^2$$</p>\n<hr>\n<p>下标$A_2$、$A_{下标}$<br><code>$$A_2 \\; A_{下标}\\; \\mathop{A}\\limits_2$$</code>表示$$A_2 \\; A_{下标}\\; \\mathop{A}\\limits_2$$</p>\n<hr>\n<p>开方数$\\sqrt[开方数]{参数}$<br><code>$$\\sqrt[开方数]{参数}$$</code>表示$$\\sqrt[开方数]{参数}$$</p>\n<hr>\n<p>求和$\\sum$<br>$$\\sum ^2_3\\;\\sum \\nolimits^2_3$$</p>\n<hr>\n<p>分$\\int$<br>$$\\int ^2_3\\;\\int \\limits^2_3$$</p>\n<hr>\n<h4 id=\"行内公式\"><a href=\"#行内公式\" class=\"headerlink\" title=\"行内公式\"></a>行内公式</h4><p>$R^s_r(t_r,t_e)=(t_r-t_e)c$</p>\n<hr>\n<h4 id=\"显示公式\"><a href=\"#显示公式\" class=\"headerlink\" title=\"显示公式\"></a>显示公式</h4><p>$$R^s_r(t_r,t_e)=(t_r-t_e)c$$</p>\n<hr>\n<h4 id=\"带有编号的显示公式\"><a href=\"#带有编号的显示公式\" class=\"headerlink\" title=\"带有编号的显示公式\"></a>带有编号的显示公式</h4><p>\\begin{equation}<br>    R^s_r(t_r,t_e)=(t_r-t_e)c<br>\\end{equation}</p>\n<hr>\n<h4 id=\"带有编号的多行公式\"><a href=\"#带有编号的多行公式\" class=\"headerlink\" title=\"带有编号的多行公式\"></a>带有编号的多行公式</h4><p>\\begin{eqnarray}<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c<br>\\end{eqnarray}</p>\n<hr>\n<h4 id=\"取消某一编号的多行公式\"><a href=\"#取消某一编号的多行公式\" class=\"headerlink\" title=\"取消某一编号的多行公式\"></a>取消某一编号的多行公式</h4><p>\\begin{eqnarray}<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\nonumber\\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c<br>\\end{eqnarray}</p>\n<hr>\n<h4 id=\"带有指定编号的多行公式\"><a href=\"#带有指定编号的多行公式\" class=\"headerlink\" title=\"带有指定编号的多行公式\"></a>带有指定编号的多行公式</h4><p>\\begin{eqnarray*}<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\tag{1}\\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c<br>\\end{eqnarray*}</p>\n<hr>\n<h4 id=\"不带编号的多行公式\"><a href=\"#不带编号的多行公式\" class=\"headerlink\" title=\"不带编号的多行公式\"></a>不带编号的多行公式</h4><p>\\begin{eqnarray*}<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)=(t_r-t_e)c<br>\\end{eqnarray*}</p>\n<hr>\n<h4 id=\"指定对齐方式的多行公式\"><a href=\"#指定对齐方式的多行公式\" class=\"headerlink\" title=\"指定对齐方式的多行公式\"></a>指定对齐方式的多行公式</h4><p>\\begin{eqnarray}<br>    &amp;R^s_r(t_r,t_e)&amp;=(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)&amp; = &amp;(t_r-t_e)c \\\\<br>    R^s_r(t_r,t_e)=&amp;(t_r-t_e)c&amp;<br>\\end{eqnarray}</p>\n<hr>\n<h4 id=\"输入矩阵\"><a href=\"#输入矩阵\" class=\"headerlink\" title=\"输入矩阵\"></a>输入矩阵</h4><p>\\begin{matrix}<br>    0 &amp; 1 \\\\<br>    1 &amp; 0<br>\\end{matrix}</p>\n<hr>\n<p>\\begin{pmatrix}<br>    0 &amp; -i \\\\<br>    i &amp; 0<br>\\end{pmatrix}</p>\n<hr>\n<p>\\begin{bmatrix}<br>    0 &amp; -1 \\\\<br>    1 &amp; 0<br>\\end{bmatrix}</p>\n<hr>\n<p>\\begin{Bmatrix}<br>    1 &amp; 0 \\\\<br>    0 &amp; -1<br>\\end{Bmatrix}</p>\n<hr>\n<p>\\begin{vmatrix}<br>    a &amp; b \\\\<br>    c &amp; d<br>\\end{vmatrix}</p>\n<hr>\n<p>\\begin{Vmatrix}<br>    i &amp; 0 \\\\<br>     0 &amp; -i<br>\\end{Vmatrix}</p>\n<hr>\n<h4 id=\"数学符号\"><a href=\"#数学符号\" class=\"headerlink\" title=\"数学符号\"></a>数学符号</h4><h5 id=\"操作符号\"><a href=\"#操作符号\" class=\"headerlink\" title=\"操作符号\"></a>操作符号</h5><p>$$<br>\\pm    \\mp    \\times    \\div    \\ast    \\star    \\circ    \\bullet    \\divideontimes    \\ltimes    \\rtimes    \\cdot    \\dotplus    \\leftthreetimes    \\rightthreetimes    \\amalg    \\otimes    \\oplus    \\ominus    \\oslash    \\odot    \\circledcirc    \\circleddash    \\circledast    \\bigcirc \\boxdot    \\boxminus    \\boxplus    \\boxtimes    \\diamond    \\bigtriangleup    \\bigtriangledown    \\triangleleft    \\triangleright    \\lhd    \\rhd    \\unlhd    \\unrhd    \\cup    \\cap    \\uplus    \\Cup    \\Cap    \\wr    \\setminus    \\smallsetminus    \\sqcap    \\sqcup \\wedge    \\vee    \\barwedge    \\veebar    \\doublebarwedge    \\curlywedge    \\curlyvee    \\dagger    \\ddagger    \\intercal    \\bigcap    \\bigcup    \\biguplus    \\bigsqcup    \\prod    \\coprod    \\bigwedge    \\bigvee    \\bigodot    \\bigoplus    \\bigotimes    \\sum \\int    \\oint    \\iint    \\iiint    \\iiiint    \\idotsint    \\arccos    \\arcsin    \\arctan    \\arg    \\cos    \\cosh    \\cot    \\coth    \\csc    \\deg    \\det    \\dim    \\exp    \\gcd    \\hom    \\inf    \\ker    \\lg    \\lim    \\liminf    \\limsup    \\ln    \\log    \\max    \\min    \\Pr    \\projlim    \\sec\\sin\\sinh    \\sup    \\tan    \\tanh \\varlimsup    \\varliminf    \\varinjlim    \\varprojlim<br> $$</p>\n<h5 id=\"关系符号\"><a href=\"#关系符号\" class=\"headerlink\" title=\"关系符号\"></a>关系符号</h5><p>$$<br>\\bowtie    \\Join    \\propto    \\varpropto    \\multimap    \\pitchfork  \\therefore    \\because    =    \\neq    \\equiv    \\approx    \\sim    \\simeq    \\backsimeq    \\approxeq    \\cong    \\ncong        \\smile    \\frown    \\asymp    \\smallfrown    \\smallsmile    \\between    \\prec    \\succ    \\nprec    \\nsucc    \\preceq    \\succeq    \\npreceq    \\nsucceq    \\preccurlyeq    \\succcurlyeq    \\curlyeqprec    \\curlyeqsucc    \\precsim    \\succsim    \\precnsim    \\succnsim    \\precapprox    \\succapprox    \\precnapprox    \\succnapprox    \\perp    \\vdash    \\dashv    \\nvdash    \\Vdash    \\Vvdash    \\models    \\vDash    \\nvDash    \\nVDash    \\mid    \\nmid    \\parallel    \\nparallel    \\shortmid    \\nshortmid    \\shortparallel    \\nshortparallel    &lt;    &gt;    \\nless    \\ngtr    \\lessdot    \\gtrdot    \\ll    \\gg    \\lll    \\ggg    \\leq    \\geq    \\lneq    \\gneq    \\nleq    \\ngeq    \\leqq    \\geqq    \\lneqq    \\gneqq    \\lvertneqq    \\gvertneqq    \\nleqq    \\ngeqq    \\leqslant    \\geqslant    \\nleqslant    \\ngeqslant    \\eqslantless    \\eqslantgtr    \\lessgtr    \\gtrless    \\lesseqgtr    \\gtreqless    \\lesseqqgtr    \\gtreqqless    \\lesssim    \\gtrsim    \\lnsim    \\gnsim    \\lessapprox    \\gtrapprox    \\lnapprox    \\gnapprox    \\vartriangleleft    \\vartriangleright    \\ntriangleleft    \\ntriangleright    \\trianglelefteq    \\trianglerighteq    \\ntrianglelefteq    \\ntrianglerighteq    \\blacktriangleleft    \\blacktriangleright    \\subset    \\supset    \\subseteq    \\supseteq    \\subsetneq    \\supsetneq    \\varsubsetneq    \\varsupsetneq    \\nsubseteq    \\nsupseteq    \\subseteqq    \\supseteqq    \\subsetneqq    \\supsetneqq    \\nsubseteqq    \\nsupseteqq    \\backepsilon    \\Subset    \\Supset    \\sqsubset    \\sqsupset    \\sqsubseteq    \\sqsupseteq<br>$$</p>\n<h5 id=\"箭头符号\"><a href=\"#箭头符号\" class=\"headerlink\" title=\"箭头符号\"></a>箭头符号</h5><p>$$<br>\\leftarrow    \\leftrightarrow    \\rightarrow    \\mapsto    \\longleftarrow        \\longleftrightarrow    \\longrightarrow    \\longmapsto    \\downarrow    \\updownarrow    \\uparrow    \\nwarrow        \\searrow    \\nearrow    \\swarrow        \\nleftarrow            \\nleftrightarrow        \\nrightarrow        \\hookleftarrow        \\hookrightarrow        \\twoheadleftarrow        \\twoheadrightarrow        \\leftarrowtail        \\rightarrowtail        \\Leftarrow        \\Leftrightarrow        \\Rightarrow        \\Longleftarrow        \\Longleftrightarrow        \\Longrightarrow            \\Updownarrow        \\Uparrow        \\Downarrow        \\nLeftarrow        \\nLeftrightarrow    \\nRightarrow        \\leftleftarrows        \\leftrightarrows        \\rightleftarrows        \\rightrightarrows        \\downdownarrows        \\upuparrows        \\circlearrowleft        \\circlearrowright        \\curvearrowleft        \\curvearrowright        \\Lsh        \\Rsh        \\looparrowleft        \\looparrowright        \\dashleftarrow        \\dashrightarrow        \\leftrightsquigarrow        \\rightsquigarrow        \\Lleftarrow        \\leftharpoondown        \\rightharpoondown        \\leftharpoonup        \\rightharpoonup        \\rightleftharpoons        \\leftrightharpoons        \\downharpoonleft        \\upharpoonleft        \\downharpoonright            \\upharpoonright<br>$$</p>\n<h5 id=\"分隔符\"><a href=\"#分隔符\" class=\"headerlink\" title=\"分隔符\"></a>分隔符</h5><p>$$<br>\\downarrow    \\Downarrow    \\langle \\rangle [ ] | | \\lceil \\rceil \\uparrow    \\Uparrow    \\lfloor        \\rfloor    \\updownarrow    \\Updownarrow    (        )    \\{    \\} \\backslash    \\lmoustache        \\rmoustache    \\lgroup    \\rgroup    \\arrowvert    \\Arrowvert    \\bracevert    \\lvert    \\rvert    \\lVert        \\rVert    \\ulcorner    \\urcorner \\llcorner \\lrcorner<br>$$</p>\n<h5 id=\"希腊字符\"><a href=\"#希腊字符\" class=\"headerlink\" title=\"希腊字符\"></a>希腊字符</h5><p>$$<br>\\alpha    \\beta        \\gamma    \\delta    \\epsilon    \\zeta    \\eta    \\theta    \\vartheta    \\iota    \\kappa    \\lambda    \\mu    \\nu    \\xi    o    \\pi    \\varpi    \\rho    \\varrho    \\sigma    \\varsigma    \\tau    \\upsilon    \\phi    \\varphi    \\chi    \\psi    \\omega    A    B    \\Gamma    \\varGamma    \\Delta    \\varDelta    E    Z    H    \\Theta    \\varTheta    I    K    \\Lambda    \\varLambda    M    N    \\Xi    \\varXi    O    \\Pi    \\varPi    P    \\Sigma        \\Upsilon    \\varUpsilon    \\Phi    \\varPhi    X    \\varPsi    \\Omega    \\varOmega<br>$$</p>\n"},{"title":"My Vim Config","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-09-11T19:05:29.000Z","password":null,"summary":null,"_content":"","source":"_posts/My-Vim-Config.md","raw":"---\ntitle: My Vim Config\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-09-12 03:05:29\npassword:\nsummary:\ntags:\ncategories:\n---\n","slug":"My-Vim-Config","published":1,"updated":"2020-02-24T10:49:41.378Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0tb001c74jud6yp8djp","content":"","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":""},{"title":"My plan","date":"2019-07-05T15:52:51.000Z","cover":false,"img":"http://images2.fanpop.com/image/photos/10500000/simple-plan-simple-plan-10550897-1024-768.jpg","_content":"\n\n\n# 写一下近期要做的事情：\n- 整理一下之前做过的项目\n\n- 写一下manjaro+i3wm配置相关的教程，其中包括：\n\n![config](https://github.com/liuyaanng/.config/raw/master/config.png)\n- **配置vim**\n\n- 从零开始的narkdown教程\n\n- Python单排系列\n\n- 人工智能笔记\n","source":"_posts/My-plan.md","raw":"---\ntitle: My plan\ndate: 2019-07-05 23:52:51\ntags: plan\ncover: false\nimg: http://images2.fanpop.com/image/photos/10500000/simple-plan-simple-plan-10550897-1024-768.jpg\n---\n\n\n\n# 写一下近期要做的事情：\n- 整理一下之前做过的项目\n\n- 写一下manjaro+i3wm配置相关的教程，其中包括：\n\n![config](https://github.com/liuyaanng/.config/raw/master/config.png)\n- **配置vim**\n\n- 从零开始的narkdown教程\n\n- Python单排系列\n\n- 人工智能笔记\n","slug":"My-plan","published":1,"updated":"2020-02-24T10:49:41.378Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0tc001e74ju87ina0ik","content":"<h1 id=\"写一下近期要做的事情：\"><a href=\"#写一下近期要做的事情：\" class=\"headerlink\" title=\"写一下近期要做的事情：\"></a>写一下近期要做的事情：</h1><ul>\n<li><p>整理一下之前做过的项目</p>\n</li>\n<li><p>写一下manjaro+i3wm配置相关的教程，其中包括：</p>\n</li>\n</ul>\n<p><img src=\"https://github.com/liuyaanng/.config/raw/master/config.png\" alt=\"config\"></p>\n<ul>\n<li><p><strong>配置vim</strong></p>\n</li>\n<li><p>从零开始的narkdown教程</p>\n</li>\n<li><p>Python单排系列</p>\n</li>\n<li><p>人工智能笔记</p>\n</li>\n</ul>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"写一下近期要做的事情：\"><a href=\"#写一下近期要做的事情：\" class=\"headerlink\" title=\"写一下近期要做的事情：\"></a>写一下近期要做的事情：</h1><ul>\n<li><p>整理一下之前做过的项目</p>\n</li>\n<li><p>写一下manjaro+i3wm配置相关的教程，其中包括：</p>\n</li>\n</ul>\n<p><img src=\"https://github.com/liuyaanng/.config/raw/master/config.png\" alt=\"config\"></p>\n<ul>\n<li><p><strong>配置vim</strong></p>\n</li>\n<li><p>从零开始的narkdown教程</p>\n</li>\n<li><p>Python单排系列</p>\n</li>\n<li><p>人工智能笔记</p>\n</li>\n</ul>\n"},{"title":"OpenCV入坑指南:环境搭建篇","date":"2019-07-25T13:12:11.000Z","cover":false,"top":true,"img":"https://i.loli.net/2019/08/03/e2qDLXKy9vWnpfa.png","toc":true,"summary":"从零开始搭建OpenCV图像处理环境, 总结了搭建过程中遇到的坑，满满的干货.","tag":["OpenCV"],"_content":"# OpenCV\n## 什么是OpenCV\n[OpenCv](https://opencv.org/about/)是一个基于BSD许可（开源）发行的跨平台计算机视觉库，可以运行在Linux、Windows、Android和Mac OS操作系统上。它轻量级而且高效——由一系列 C 函数和少量 C++ 类构成，同时提供了Python、Ruby、MATLAB等语言的接口，实现了图像处理和计算机视觉方面的很多通用算法。    \nOpenCV用C++语言编写，它的主要接口也是C++语言，但是依然保留了大量的C语言接口。该库也有大量的Python、Java and MATLAB/OCTAVE（版本2.5）的接口。这些语言的API接口函数可以通过在线文档获得。如今也提供对于C#、Ch、Ruby,GO的支持。\n## OpenCV可以来做什么\n使用OpenCV，你几乎可以做任何你能够想到的计算机视觉任务。    \n1. 内置数据结构和输入/输出(In-build data structures and input/output)\n2. 图像处理操作(Image processing operations)\n\n3. 构建图形用户界面(Build GUI)\n\n4. 视频分析(Video analysis)\n\n5. 3D重建(3D reconstruction)\n\n6. 特征提取(Feature extraction)\n\n7. 目标检测(Object detection)\n\n8. 机器学习(Machine learning)\n\n9. 计算摄影(Computational photography)\n\n10. 形状分析(Shape analysis)\n\n11. 光流算法(Optical flow algorithms)\n\n12. 人脸和目标识别(Face and object recognition)\n\n13. 表面匹配(Surface matching)\n\n14. 文本检测和识别(Text detection and recognition)\n\n---\n\n# Microsoft Visual Studio\n\n宇宙最强IDE(逃),不多说了\n\n---\n\n# OpenCV + VS学习(装×)环境搭建\n工欲善其事，必先利其器。当你准备好入坑OpenCV时，你首先要把学习环境搭建起来，光是这一关不知道劝退了多少人，我在搭建的过程中也是踩了很多坑，也遇到了各种各样刁钻的问题，现在总结一下，给自己踩过的雷做一下记录，也希望能够帮到即将入坑的你们。\n\n## 版本选择\n为什么把这个放到第一个呢？因为这是我遇到并纠结了一天的问题！我在网上查找教程的时候很多人都没有标注这个问题，当然也是自己蠢，在所有的配置都配置完成之后，还是不能正常跑程序，又重新安装重新配置，反复好几次，都快怀疑人生了，最后才发现是版本号不对。废话不多说，下面是OpenCV版本和VS版本的对应表，选择的时候一定要擦亮眼睛。我选择的环境是VS2017+OpenCV3.4.4    \n\nVisual Studio 版本 | VC 版本\n:---: | :---:\nVS 6 | vc6\nVS 2003 | vc7\nVS 2005 | vc8\nVS 2008 | vc9\nVS 2010 | vc10\nVS 2013 | vc12\nVS 2015 | vc14\nVS 2017 | vc15\n\nOpenCV对VC版本的支持情况(不全)\n\nOpenCV 2.4.10 | vc10、vc11、vc12\n:---: | :---:\nOpenCV 2.4.13 | vc11、vc12\nOpenCV 3.4.0 | vc14、vc15\nOpenCv 3.4.1 | vc14、vc15\n\n## VS2017安装\n我的VS安装的时间太久了，网上教程一大堆，给你们挑一篇吧，这里就不再多说了\n\n## OpenCV3.4.4下载与安装\n\n### 下载\n1. 官网下载\nOpenCV官网给我们提供了下载，不过下载速度嘛～自求多福    \n[OpenCV下载](https://opencv.org/releases/),里面有各个版本可以选择\n2. OpenCV下载驿站    \n[OpenCV各版本汇总下载](https://blog.csdn.net/oMoDao1/article/details/80276834)    \n感谢这位大哥的总结\n\n### 安装\n找一个你能记住名字的路径安装进去就OK了，一定要记住这个路径，非常重要\n![](https://i.loli.net/2019/07/27/5d3c0e0f7a6db16095.png)\n## 系统环境变量配置\n\n1. 找到此电脑\n2. 依次找到 属性->高级->环境变量,找到系统变量里的Path，双击进去编辑，如图所示，添加的路径 **\"D:\\OpenCV\\opencv\\bulid\\x64\\vc15\\bin\"**,把\"D:\\OpenCV\\\"替换成你的安装路径即可\n\n![](https://i.loli.net/2019/07/27/5d3c0e0f9cd5286868.png)\n![](https://i.loli.net/2019/07/27/5d3c0e0fa09f948672.png)\n![](https://i.loli.net/2019/07/27/5d3c0e0fa634780591.png)\n![](https://i.loli.net/2019/07/27/5d3c0e0fa37ce25025.png)\n\n到这就完成了系统环境的配置了\n\n## 一些文件的配置\n\n这一步的目的是为了解决以后可能会出现的关于缺少.dll的问题\n\n将 **\"D:\\OpenCV\\opencv\\bulid\\x64\\vc15\\bin\"** 里面的三个 **.dll** 文件复制到 **C:\\Windows“** 目录下的 **System32**和 **SysWOW64**目录下\n\n![](https://i.loli.net/2019/07/28/5d3d5857adbe920715.png)\n![](https://i.loli.net/2019/07/28/5d3d5857bd82f79652.png)\n\n## VS2017配置\n\n1. 新建一个空项目\n2. 进入属性管理器  视图->其他窗口->属性管理器\n![](https://i.loli.net/2019/07/27/5d3c156f6359d16629.png)\n3. 选择Debug | x64 的 Microsoft.Cpp.x64.user\n![8.png](https://i.loli.net/2019/07/27/5d3c156ecb8ad31557.png)\n4. 选择VC++目录，对包含目录和库目录进行配置    \n   ![](https://i.loli.net/2019/07/27/5d3c156f2e22b74192.png)\n   - 在包含目录里添加 **D:\\OpenCV\\opencv\\bulid\\include**,**D:\\OpenCV\\opencv\\bulid\\include\\opencv**,**D:\\OpenCV\\opencv\\bulid\\include\\opencv2**    \n![](https://i.loli.net/2019/07/27/5d3c156f2132f35424.png)\n   - 在库目录里添加 **D:\\OpenCV\\opencv\\bulid\\x64\\vc15\\lib**   \n   ![](https://i.loli.net/2019/07/27/5d3c156f492f430904.png)\n5. 选择 链接器->输入->附加依赖项,    \n   ![12.png](https://i.loli.net/2019/07/27/5d3c156f13aac74119.png)\n   在里面添加 **opencv_world344d.lib**，这个lib文件根据你的OpenCV版本号灵活变动\n   ![](https://i.loli.net/2019/07/27/5d3c156f0828190561.png)\n6. 点击应用，确定即可\n到这里，OpenCV的所有配置工作已经完成了，要注意的是解决方案那一栏要换成x64(因为我们一直在配置的就是x64)\n![](https://i.loli.net/2019/07/27/5d3c156ee8b6668598.png)\n## 测试\n这是一段读取并显示本地图片的代码，测试一下你的OpenCV环境是否配置好\n\n```cpp\n#include <iostream>\n#include <opencv2/core/core.hpp>\n#include <opencv2/highgui/highgui.hpp>\n\nusing namespace cv;\n\nint main()\n{\n\tMat img = imread(\"1.bmp\");\n\tnamedWindow(\"图片\");\n\timshow(\"图片\", img);\n\twaitKey(6000);\n\treturn 0;\n}\n```\n\n运行结果如下：\n![](https://i.loli.net/2019/07/27/5d3c15857414f57549.png)\n\n## 需要注意的问题\n1. 导入包的时候不报错，但运行程序时出现一下错误\n![15.png](https://i.loli.net/2019/07/27/5d3c156f55e6b74341.png)\n![16.png](https://i.loli.net/2019/07/27/5d3c156f39a4e29681.png)\n出现这个问题，目前已知的有两个原因    \n  - imread函数读不到图片，即你的图片路径写的有问题    \n    这里给出两种基本的路径书写形式    \n    1. 绝对路径    \n    Mat img = imread(\"D:\\\\Pictures\\\\1.bmp\");    \n    一定要注意这里是双斜杠\n    2. 图片路径    \n    Mat img = imread(\"1.bmp\");    \n    使用这个的前提是图片的位置在你的工程目录下\n  - 链接器的附加依赖项配置的有问题    \n    在Debug模式下，附加依赖项添加的是 **opencv_world344d.lib**   \n    在Release模式下，附加依赖项添加的是 **opencv_world344.lib**    \n    有些教程是两个都添加，这是不对的，一定要注意。\n    \n---\n\n# MacOS 安装opencv-python\n\n### 1. 首先安装xcode\n\n```bash\nxcode-select --install \n```\n\n### 2. 安装opencv-python\n\n```bash\npip install opencv-python\n```\n\n这默认将安装`opencv-python 4.2`, 但在 **catalina** 貌似不可用\n\n所以我选择了安装低版本的opencv-python\n\n```bash\npip install opencv-python==4.1.2.30\n```\n\n或者选择安装\n\n```bash\npip install opencv-python-headless\n```\n\n这个原因未知\n\n\n好了，教程到此结束，    \n接下来你就可以放心地去玩耍了，Enjoy Your OpenCV!\n","source":"_posts/OpenCV入坑指南-环境搭建篇.md","raw":"---\ntitle: 'OpenCV入坑指南:环境搭建篇'\ndate: 2019-07-25 21:12:11\ntags: OpenCV\ncover: false\ntop: true\nimg: https://i.loli.net/2019/08/03/e2qDLXKy9vWnpfa.png\ntoc: true\nsummary: 从零开始搭建OpenCV图像处理环境, 总结了搭建过程中遇到的坑，满满的干货.\ntag: \n- OpenCV\ncategories: \n- 教程\n---\n# OpenCV\n## 什么是OpenCV\n[OpenCv](https://opencv.org/about/)是一个基于BSD许可（开源）发行的跨平台计算机视觉库，可以运行在Linux、Windows、Android和Mac OS操作系统上。它轻量级而且高效——由一系列 C 函数和少量 C++ 类构成，同时提供了Python、Ruby、MATLAB等语言的接口，实现了图像处理和计算机视觉方面的很多通用算法。    \nOpenCV用C++语言编写，它的主要接口也是C++语言，但是依然保留了大量的C语言接口。该库也有大量的Python、Java and MATLAB/OCTAVE（版本2.5）的接口。这些语言的API接口函数可以通过在线文档获得。如今也提供对于C#、Ch、Ruby,GO的支持。\n## OpenCV可以来做什么\n使用OpenCV，你几乎可以做任何你能够想到的计算机视觉任务。    \n1. 内置数据结构和输入/输出(In-build data structures and input/output)\n2. 图像处理操作(Image processing operations)\n\n3. 构建图形用户界面(Build GUI)\n\n4. 视频分析(Video analysis)\n\n5. 3D重建(3D reconstruction)\n\n6. 特征提取(Feature extraction)\n\n7. 目标检测(Object detection)\n\n8. 机器学习(Machine learning)\n\n9. 计算摄影(Computational photography)\n\n10. 形状分析(Shape analysis)\n\n11. 光流算法(Optical flow algorithms)\n\n12. 人脸和目标识别(Face and object recognition)\n\n13. 表面匹配(Surface matching)\n\n14. 文本检测和识别(Text detection and recognition)\n\n---\n\n# Microsoft Visual Studio\n\n宇宙最强IDE(逃),不多说了\n\n---\n\n# OpenCV + VS学习(装×)环境搭建\n工欲善其事，必先利其器。当你准备好入坑OpenCV时，你首先要把学习环境搭建起来，光是这一关不知道劝退了多少人，我在搭建的过程中也是踩了很多坑，也遇到了各种各样刁钻的问题，现在总结一下，给自己踩过的雷做一下记录，也希望能够帮到即将入坑的你们。\n\n## 版本选择\n为什么把这个放到第一个呢？因为这是我遇到并纠结了一天的问题！我在网上查找教程的时候很多人都没有标注这个问题，当然也是自己蠢，在所有的配置都配置完成之后，还是不能正常跑程序，又重新安装重新配置，反复好几次，都快怀疑人生了，最后才发现是版本号不对。废话不多说，下面是OpenCV版本和VS版本的对应表，选择的时候一定要擦亮眼睛。我选择的环境是VS2017+OpenCV3.4.4    \n\nVisual Studio 版本 | VC 版本\n:---: | :---:\nVS 6 | vc6\nVS 2003 | vc7\nVS 2005 | vc8\nVS 2008 | vc9\nVS 2010 | vc10\nVS 2013 | vc12\nVS 2015 | vc14\nVS 2017 | vc15\n\nOpenCV对VC版本的支持情况(不全)\n\nOpenCV 2.4.10 | vc10、vc11、vc12\n:---: | :---:\nOpenCV 2.4.13 | vc11、vc12\nOpenCV 3.4.0 | vc14、vc15\nOpenCv 3.4.1 | vc14、vc15\n\n## VS2017安装\n我的VS安装的时间太久了，网上教程一大堆，给你们挑一篇吧，这里就不再多说了\n\n## OpenCV3.4.4下载与安装\n\n### 下载\n1. 官网下载\nOpenCV官网给我们提供了下载，不过下载速度嘛～自求多福    \n[OpenCV下载](https://opencv.org/releases/),里面有各个版本可以选择\n2. OpenCV下载驿站    \n[OpenCV各版本汇总下载](https://blog.csdn.net/oMoDao1/article/details/80276834)    \n感谢这位大哥的总结\n\n### 安装\n找一个你能记住名字的路径安装进去就OK了，一定要记住这个路径，非常重要\n![](https://i.loli.net/2019/07/27/5d3c0e0f7a6db16095.png)\n## 系统环境变量配置\n\n1. 找到此电脑\n2. 依次找到 属性->高级->环境变量,找到系统变量里的Path，双击进去编辑，如图所示，添加的路径 **\"D:\\OpenCV\\opencv\\bulid\\x64\\vc15\\bin\"**,把\"D:\\OpenCV\\\"替换成你的安装路径即可\n\n![](https://i.loli.net/2019/07/27/5d3c0e0f9cd5286868.png)\n![](https://i.loli.net/2019/07/27/5d3c0e0fa09f948672.png)\n![](https://i.loli.net/2019/07/27/5d3c0e0fa634780591.png)\n![](https://i.loli.net/2019/07/27/5d3c0e0fa37ce25025.png)\n\n到这就完成了系统环境的配置了\n\n## 一些文件的配置\n\n这一步的目的是为了解决以后可能会出现的关于缺少.dll的问题\n\n将 **\"D:\\OpenCV\\opencv\\bulid\\x64\\vc15\\bin\"** 里面的三个 **.dll** 文件复制到 **C:\\Windows“** 目录下的 **System32**和 **SysWOW64**目录下\n\n![](https://i.loli.net/2019/07/28/5d3d5857adbe920715.png)\n![](https://i.loli.net/2019/07/28/5d3d5857bd82f79652.png)\n\n## VS2017配置\n\n1. 新建一个空项目\n2. 进入属性管理器  视图->其他窗口->属性管理器\n![](https://i.loli.net/2019/07/27/5d3c156f6359d16629.png)\n3. 选择Debug | x64 的 Microsoft.Cpp.x64.user\n![8.png](https://i.loli.net/2019/07/27/5d3c156ecb8ad31557.png)\n4. 选择VC++目录，对包含目录和库目录进行配置    \n   ![](https://i.loli.net/2019/07/27/5d3c156f2e22b74192.png)\n   - 在包含目录里添加 **D:\\OpenCV\\opencv\\bulid\\include**,**D:\\OpenCV\\opencv\\bulid\\include\\opencv**,**D:\\OpenCV\\opencv\\bulid\\include\\opencv2**    \n![](https://i.loli.net/2019/07/27/5d3c156f2132f35424.png)\n   - 在库目录里添加 **D:\\OpenCV\\opencv\\bulid\\x64\\vc15\\lib**   \n   ![](https://i.loli.net/2019/07/27/5d3c156f492f430904.png)\n5. 选择 链接器->输入->附加依赖项,    \n   ![12.png](https://i.loli.net/2019/07/27/5d3c156f13aac74119.png)\n   在里面添加 **opencv_world344d.lib**，这个lib文件根据你的OpenCV版本号灵活变动\n   ![](https://i.loli.net/2019/07/27/5d3c156f0828190561.png)\n6. 点击应用，确定即可\n到这里，OpenCV的所有配置工作已经完成了，要注意的是解决方案那一栏要换成x64(因为我们一直在配置的就是x64)\n![](https://i.loli.net/2019/07/27/5d3c156ee8b6668598.png)\n## 测试\n这是一段读取并显示本地图片的代码，测试一下你的OpenCV环境是否配置好\n\n```cpp\n#include <iostream>\n#include <opencv2/core/core.hpp>\n#include <opencv2/highgui/highgui.hpp>\n\nusing namespace cv;\n\nint main()\n{\n\tMat img = imread(\"1.bmp\");\n\tnamedWindow(\"图片\");\n\timshow(\"图片\", img);\n\twaitKey(6000);\n\treturn 0;\n}\n```\n\n运行结果如下：\n![](https://i.loli.net/2019/07/27/5d3c15857414f57549.png)\n\n## 需要注意的问题\n1. 导入包的时候不报错，但运行程序时出现一下错误\n![15.png](https://i.loli.net/2019/07/27/5d3c156f55e6b74341.png)\n![16.png](https://i.loli.net/2019/07/27/5d3c156f39a4e29681.png)\n出现这个问题，目前已知的有两个原因    \n  - imread函数读不到图片，即你的图片路径写的有问题    \n    这里给出两种基本的路径书写形式    \n    1. 绝对路径    \n    Mat img = imread(\"D:\\\\Pictures\\\\1.bmp\");    \n    一定要注意这里是双斜杠\n    2. 图片路径    \n    Mat img = imread(\"1.bmp\");    \n    使用这个的前提是图片的位置在你的工程目录下\n  - 链接器的附加依赖项配置的有问题    \n    在Debug模式下，附加依赖项添加的是 **opencv_world344d.lib**   \n    在Release模式下，附加依赖项添加的是 **opencv_world344.lib**    \n    有些教程是两个都添加，这是不对的，一定要注意。\n    \n---\n\n# MacOS 安装opencv-python\n\n### 1. 首先安装xcode\n\n```bash\nxcode-select --install \n```\n\n### 2. 安装opencv-python\n\n```bash\npip install opencv-python\n```\n\n这默认将安装`opencv-python 4.2`, 但在 **catalina** 貌似不可用\n\n所以我选择了安装低版本的opencv-python\n\n```bash\npip install opencv-python==4.1.2.30\n```\n\n或者选择安装\n\n```bash\npip install opencv-python-headless\n```\n\n这个原因未知\n\n\n好了，教程到此结束，    \n接下来你就可以放心地去玩耍了，Enjoy Your OpenCV!\n","slug":"OpenCV入坑指南-环境搭建篇","published":1,"updated":"2020-03-02T11:52:46.371Z","_id":"ck70cp0td001h74ju6p3hh6a2","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"OpenCV\"><a href=\"#OpenCV\" class=\"headerlink\" title=\"OpenCV\"></a>OpenCV</h1><h2 id=\"什么是OpenCV\"><a href=\"#什么是OpenCV\" class=\"headerlink\" title=\"什么是OpenCV\"></a>什么是OpenCV</h2><p><a href=\"https://opencv.org/about/\" target=\"_blank\" rel=\"noopener\">OpenCv</a>是一个基于BSD许可（开源）发行的跨平台计算机视觉库，可以运行在Linux、Windows、Android和Mac OS操作系统上。它轻量级而且高效——由一系列 C 函数和少量 C++ 类构成，同时提供了Python、Ruby、MATLAB等语言的接口，实现了图像处理和计算机视觉方面的很多通用算法。<br>OpenCV用C++语言编写，它的主要接口也是C++语言，但是依然保留了大量的C语言接口。该库也有大量的Python、Java and MATLAB/OCTAVE（版本2.5）的接口。这些语言的API接口函数可以通过在线文档获得。如今也提供对于C#、Ch、Ruby,GO的支持。</p>\n<h2 id=\"OpenCV可以来做什么\"><a href=\"#OpenCV可以来做什么\" class=\"headerlink\" title=\"OpenCV可以来做什么\"></a>OpenCV可以来做什么</h2><p>使用OpenCV，你几乎可以做任何你能够想到的计算机视觉任务。    </p>\n<ol>\n<li><p>内置数据结构和输入/输出(In-build data structures and input/output)</p>\n</li>\n<li><p>图像处理操作(Image processing operations)</p>\n</li>\n<li><p>构建图形用户界面(Build GUI)</p>\n</li>\n<li><p>视频分析(Video analysis)</p>\n</li>\n<li><p>3D重建(3D reconstruction)</p>\n</li>\n<li><p>特征提取(Feature extraction)</p>\n</li>\n<li><p>目标检测(Object detection)</p>\n</li>\n<li><p>机器学习(Machine learning)</p>\n</li>\n<li><p>计算摄影(Computational photography)</p>\n</li>\n<li><p>形状分析(Shape analysis)</p>\n</li>\n<li><p>光流算法(Optical flow algorithms)</p>\n</li>\n<li><p>人脸和目标识别(Face and object recognition)</p>\n</li>\n<li><p>表面匹配(Surface matching)</p>\n</li>\n<li><p>文本检测和识别(Text detection and recognition)</p>\n</li>\n</ol>\n<hr>\n<h1 id=\"Microsoft-Visual-Studio\"><a href=\"#Microsoft-Visual-Studio\" class=\"headerlink\" title=\"Microsoft Visual Studio\"></a>Microsoft Visual Studio</h1><p>宇宙最强IDE(逃),不多说了</p>\n<hr>\n<h1 id=\"OpenCV-VS学习-装×-环境搭建\"><a href=\"#OpenCV-VS学习-装×-环境搭建\" class=\"headerlink\" title=\"OpenCV + VS学习(装×)环境搭建\"></a>OpenCV + VS学习(装×)环境搭建</h1><p>工欲善其事，必先利其器。当你准备好入坑OpenCV时，你首先要把学习环境搭建起来，光是这一关不知道劝退了多少人，我在搭建的过程中也是踩了很多坑，也遇到了各种各样刁钻的问题，现在总结一下，给自己踩过的雷做一下记录，也希望能够帮到即将入坑的你们。</p>\n<h2 id=\"版本选择\"><a href=\"#版本选择\" class=\"headerlink\" title=\"版本选择\"></a>版本选择</h2><p>为什么把这个放到第一个呢？因为这是我遇到并纠结了一天的问题！我在网上查找教程的时候很多人都没有标注这个问题，当然也是自己蠢，在所有的配置都配置完成之后，还是不能正常跑程序，又重新安装重新配置，反复好几次，都快怀疑人生了，最后才发现是版本号不对。废话不多说，下面是OpenCV版本和VS版本的对应表，选择的时候一定要擦亮眼睛。我选择的环境是VS2017+OpenCV3.4.4    </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Visual Studio 版本</th>\n<th align=\"center\">VC 版本</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">VS 6</td>\n<td align=\"center\">vc6</td>\n</tr>\n<tr>\n<td align=\"center\">VS 2003</td>\n<td align=\"center\">vc7</td>\n</tr>\n<tr>\n<td align=\"center\">VS 2005</td>\n<td align=\"center\">vc8</td>\n</tr>\n<tr>\n<td align=\"center\">VS 2008</td>\n<td align=\"center\">vc9</td>\n</tr>\n<tr>\n<td align=\"center\">VS 2010</td>\n<td align=\"center\">vc10</td>\n</tr>\n<tr>\n<td align=\"center\">VS 2013</td>\n<td align=\"center\">vc12</td>\n</tr>\n<tr>\n<td align=\"center\">VS 2015</td>\n<td align=\"center\">vc14</td>\n</tr>\n<tr>\n<td align=\"center\">VS 2017</td>\n<td align=\"center\">vc15</td>\n</tr>\n</tbody></table>\n<p>OpenCV对VC版本的支持情况(不全)</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">OpenCV 2.4.10</th>\n<th align=\"center\">vc10、vc11、vc12</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">OpenCV 2.4.13</td>\n<td align=\"center\">vc11、vc12</td>\n</tr>\n<tr>\n<td align=\"center\">OpenCV 3.4.0</td>\n<td align=\"center\">vc14、vc15</td>\n</tr>\n<tr>\n<td align=\"center\">OpenCv 3.4.1</td>\n<td align=\"center\">vc14、vc15</td>\n</tr>\n</tbody></table>\n<h2 id=\"VS2017安装\"><a href=\"#VS2017安装\" class=\"headerlink\" title=\"VS2017安装\"></a>VS2017安装</h2><p>我的VS安装的时间太久了，网上教程一大堆，给你们挑一篇吧，这里就不再多说了</p>\n<h2 id=\"OpenCV3-4-4下载与安装\"><a href=\"#OpenCV3-4-4下载与安装\" class=\"headerlink\" title=\"OpenCV3.4.4下载与安装\"></a>OpenCV3.4.4下载与安装</h2><h3 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h3><ol>\n<li>官网下载<br>OpenCV官网给我们提供了下载，不过下载速度嘛～自求多福<br><a href=\"https://opencv.org/releases/\" target=\"_blank\" rel=\"noopener\">OpenCV下载</a>,里面有各个版本可以选择</li>\n<li>OpenCV下载驿站<br><a href=\"https://blog.csdn.net/oMoDao1/article/details/80276834\" target=\"_blank\" rel=\"noopener\">OpenCV各版本汇总下载</a><br>感谢这位大哥的总结</li>\n</ol>\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><p>找一个你能记住名字的路径安装进去就OK了，一定要记住这个路径，非常重要<br><img src=\"https://i.loli.net/2019/07/27/5d3c0e0f7a6db16095.png\" alt></p>\n<h2 id=\"系统环境变量配置\"><a href=\"#系统环境变量配置\" class=\"headerlink\" title=\"系统环境变量配置\"></a>系统环境变量配置</h2><ol>\n<li>找到此电脑</li>\n<li>依次找到 属性-&gt;高级-&gt;环境变量,找到系统变量里的Path，双击进去编辑，如图所示，添加的路径 <strong>“D:\\OpenCV\\opencv\\bulid\\x64\\vc15\\bin”</strong>,把”D:\\OpenCV\\”替换成你的安装路径即可</li>\n</ol>\n<p><img src=\"https://i.loli.net/2019/07/27/5d3c0e0f9cd5286868.png\" alt><br><img src=\"https://i.loli.net/2019/07/27/5d3c0e0fa09f948672.png\" alt><br><img src=\"https://i.loli.net/2019/07/27/5d3c0e0fa634780591.png\" alt><br><img src=\"https://i.loli.net/2019/07/27/5d3c0e0fa37ce25025.png\" alt></p>\n<p>到这就完成了系统环境的配置了</p>\n<h2 id=\"一些文件的配置\"><a href=\"#一些文件的配置\" class=\"headerlink\" title=\"一些文件的配置\"></a>一些文件的配置</h2><p>这一步的目的是为了解决以后可能会出现的关于缺少.dll的问题</p>\n<p>将 <strong>“D:\\OpenCV\\opencv\\bulid\\x64\\vc15\\bin”</strong> 里面的三个 <strong>.dll</strong> 文件复制到 <strong>C:\\Windows“</strong> 目录下的 <strong>System32</strong>和 <strong>SysWOW64</strong>目录下</p>\n<p><img src=\"https://i.loli.net/2019/07/28/5d3d5857adbe920715.png\" alt><br><img src=\"https://i.loli.net/2019/07/28/5d3d5857bd82f79652.png\" alt></p>\n<h2 id=\"VS2017配置\"><a href=\"#VS2017配置\" class=\"headerlink\" title=\"VS2017配置\"></a>VS2017配置</h2><ol>\n<li>新建一个空项目</li>\n<li>进入属性管理器  视图-&gt;其他窗口-&gt;属性管理器<br><img src=\"https://i.loli.net/2019/07/27/5d3c156f6359d16629.png\" alt></li>\n<li>选择Debug | x64 的 Microsoft.Cpp.x64.user<br><img src=\"https://i.loli.net/2019/07/27/5d3c156ecb8ad31557.png\" alt=\"8.png\"></li>\n<li>选择VC++目录，对包含目录和库目录进行配置<br><img src=\"https://i.loli.net/2019/07/27/5d3c156f2e22b74192.png\" alt><ul>\n<li>在包含目录里添加 <strong>D:\\OpenCV\\opencv\\bulid\\include</strong>,<strong>D:\\OpenCV\\opencv\\bulid\\include\\opencv</strong>,<strong>D:\\OpenCV\\opencv\\bulid\\include\\opencv2</strong><br><img src=\"https://i.loli.net/2019/07/27/5d3c156f2132f35424.png\" alt></li>\n<li>在库目录里添加 <strong>D:\\OpenCV\\opencv\\bulid\\x64\\vc15\\lib</strong><br><img src=\"https://i.loli.net/2019/07/27/5d3c156f492f430904.png\" alt></li>\n</ul>\n</li>\n<li>选择 链接器-&gt;输入-&gt;附加依赖项,<br><img src=\"https://i.loli.net/2019/07/27/5d3c156f13aac74119.png\" alt=\"12.png\"><br>在里面添加 <strong>opencv_world344d.lib</strong>，这个lib文件根据你的OpenCV版本号灵活变动<br><img src=\"https://i.loli.net/2019/07/27/5d3c156f0828190561.png\" alt></li>\n<li>点击应用，确定即可<br>到这里，OpenCV的所有配置工作已经完成了，要注意的是解决方案那一栏要换成x64(因为我们一直在配置的就是x64)<br><img src=\"https://i.loli.net/2019/07/27/5d3c156ee8b6668598.png\" alt><h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2>这是一段读取并显示本地图片的代码，测试一下你的OpenCV环境是否配置好</li>\n</ol>\n<pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/core/core.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/highgui/highgui.hpp></span></span>\n\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> cv<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    Mat img <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"1.bmp\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">namedWindow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"图片\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"图片\"</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">waitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">6000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>运行结果如下：<br><img src=\"https://i.loli.net/2019/07/27/5d3c15857414f57549.png\" alt></p>\n<h2 id=\"需要注意的问题\"><a href=\"#需要注意的问题\" class=\"headerlink\" title=\"需要注意的问题\"></a>需要注意的问题</h2><ol>\n<li>导入包的时候不报错，但运行程序时出现一下错误<br><img src=\"https://i.loli.net/2019/07/27/5d3c156f55e6b74341.png\" alt=\"15.png\"><br><img src=\"https://i.loli.net/2019/07/27/5d3c156f39a4e29681.png\" alt=\"16.png\"><br>出现这个问题，目前已知的有两个原因    <ul>\n<li>imread函数读不到图片，即你的图片路径写的有问题<br>这里给出两种基本的路径书写形式    <ol>\n<li>绝对路径<br>Mat img = imread(“D:\\\\Pictures\\\\1.bmp”);<br>一定要注意这里是双斜杠</li>\n<li>图片路径<br>Mat img = imread(“1.bmp”);<br>使用这个的前提是图片的位置在你的工程目录下</li>\n</ol>\n</li>\n<li>链接器的附加依赖项配置的有问题<br>在Debug模式下，附加依赖项添加的是 <strong>opencv_world344d.lib</strong><br>在Release模式下，附加依赖项添加的是 <strong>opencv_world344.lib</strong><br>有些教程是两个都添加，这是不对的，一定要注意。</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h1 id=\"MacOS-安装opencv-python\"><a href=\"#MacOS-安装opencv-python\" class=\"headerlink\" title=\"MacOS 安装opencv-python\"></a>MacOS 安装opencv-python</h1><h3 id=\"1-首先安装xcode\"><a href=\"#1-首先安装xcode\" class=\"headerlink\" title=\"1. 首先安装xcode\"></a>1. 首先安装xcode</h3><pre class=\" language-bash\"><code class=\"language-bash\">xcode-select --install </code></pre>\n<h3 id=\"2-安装opencv-python\"><a href=\"#2-安装opencv-python\" class=\"headerlink\" title=\"2. 安装opencv-python\"></a>2. 安装opencv-python</h3><pre class=\" language-bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> opencv-python</code></pre>\n<p>这默认将安装<code>opencv-python 4.2</code>, 但在 <strong>catalina</strong> 貌似不可用</p>\n<p>所以我选择了安装低版本的opencv-python</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> opencv-python<span class=\"token operator\">==</span>4.1.2.30</code></pre>\n<p>或者选择安装</p>\n<pre class=\" language-bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> opencv-python-headless</code></pre>\n<p>这个原因未知</p>\n<p>好了，教程到此结束，<br>接下来你就可以放心地去玩耍了，Enjoy Your OpenCV!</p>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"OpenCV\"><a href=\"#OpenCV\" class=\"headerlink\" title=\"OpenCV\"></a>OpenCV</h1><h2 id=\"什么是OpenCV\"><a href=\"#什么是OpenCV\" class=\"headerlink\" title=\"什么是OpenCV\"></a>什么是OpenCV</h2><p><a href=\"https://opencv.org/about/\" target=\"_blank\" rel=\"noopener\">OpenCv</a>是一个基于BSD许可（开源）发行的跨平台计算机视觉库，可以运行在Linux、Windows、Android和Mac OS操作系统上。它轻量级而且高效——由一系列 C 函数和少量 C++ 类构成，同时提供了Python、Ruby、MATLAB等语言的接口，实现了图像处理和计算机视觉方面的很多通用算法。<br>OpenCV用C++语言编写，它的主要接口也是C++语言，但是依然保留了大量的C语言接口。该库也有大量的Python、Java and MATLAB/OCTAVE（版本2.5）的接口。这些语言的API接口函数可以通过在线文档获得。如今也提供对于C#、Ch、Ruby,GO的支持。</p>\n<h2 id=\"OpenCV可以来做什么\"><a href=\"#OpenCV可以来做什么\" class=\"headerlink\" title=\"OpenCV可以来做什么\"></a>OpenCV可以来做什么</h2><p>使用OpenCV，你几乎可以做任何你能够想到的计算机视觉任务。    </p>\n<ol>\n<li><p>内置数据结构和输入/输出(In-build data structures and input/output)</p>\n</li>\n<li><p>图像处理操作(Image processing operations)</p>\n</li>\n<li><p>构建图形用户界面(Build GUI)</p>\n</li>\n<li><p>视频分析(Video analysis)</p>\n</li>\n<li><p>3D重建(3D reconstruction)</p>\n</li>\n<li><p>特征提取(Feature extraction)</p>\n</li>\n<li><p>目标检测(Object detection)</p>\n</li>\n<li><p>机器学习(Machine learning)</p>\n</li>\n<li><p>计算摄影(Computational photography)</p>\n</li>\n<li><p>形状分析(Shape analysis)</p>\n</li>\n<li><p>光流算法(Optical flow algorithms)</p>\n</li>\n<li><p>人脸和目标识别(Face and object recognition)</p>\n</li>\n<li><p>表面匹配(Surface matching)</p>\n</li>\n<li><p>文本检测和识别(Text detection and recognition)</p>\n</li>\n</ol>\n<hr>\n<h1 id=\"Microsoft-Visual-Studio\"><a href=\"#Microsoft-Visual-Studio\" class=\"headerlink\" title=\"Microsoft Visual Studio\"></a>Microsoft Visual Studio</h1><p>宇宙最强IDE(逃),不多说了</p>\n<hr>\n<h1 id=\"OpenCV-VS学习-装×-环境搭建\"><a href=\"#OpenCV-VS学习-装×-环境搭建\" class=\"headerlink\" title=\"OpenCV + VS学习(装×)环境搭建\"></a>OpenCV + VS学习(装×)环境搭建</h1><p>工欲善其事，必先利其器。当你准备好入坑OpenCV时，你首先要把学习环境搭建起来，光是这一关不知道劝退了多少人，我在搭建的过程中也是踩了很多坑，也遇到了各种各样刁钻的问题，现在总结一下，给自己踩过的雷做一下记录，也希望能够帮到即将入坑的你们。</p>\n<h2 id=\"版本选择\"><a href=\"#版本选择\" class=\"headerlink\" title=\"版本选择\"></a>版本选择</h2><p>为什么把这个放到第一个呢？因为这是我遇到并纠结了一天的问题！我在网上查找教程的时候很多人都没有标注这个问题，当然也是自己蠢，在所有的配置都配置完成之后，还是不能正常跑程序，又重新安装重新配置，反复好几次，都快怀疑人生了，最后才发现是版本号不对。废话不多说，下面是OpenCV版本和VS版本的对应表，选择的时候一定要擦亮眼睛。我选择的环境是VS2017+OpenCV3.4.4    </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Visual Studio 版本</th>\n<th align=\"center\">VC 版本</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">VS 6</td>\n<td align=\"center\">vc6</td>\n</tr>\n<tr>\n<td align=\"center\">VS 2003</td>\n<td align=\"center\">vc7</td>\n</tr>\n<tr>\n<td align=\"center\">VS 2005</td>\n<td align=\"center\">vc8</td>\n</tr>\n<tr>\n<td align=\"center\">VS 2008</td>\n<td align=\"center\">vc9</td>\n</tr>\n<tr>\n<td align=\"center\">VS 2010</td>\n<td align=\"center\">vc10</td>\n</tr>\n<tr>\n<td align=\"center\">VS 2013</td>\n<td align=\"center\">vc12</td>\n</tr>\n<tr>\n<td align=\"center\">VS 2015</td>\n<td align=\"center\">vc14</td>\n</tr>\n<tr>\n<td align=\"center\">VS 2017</td>\n<td align=\"center\">vc15</td>\n</tr>\n</tbody></table>\n<p>OpenCV对VC版本的支持情况(不全)</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">OpenCV 2.4.10</th>\n<th align=\"center\">vc10、vc11、vc12</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">OpenCV 2.4.13</td>\n<td align=\"center\">vc11、vc12</td>\n</tr>\n<tr>\n<td align=\"center\">OpenCV 3.4.0</td>\n<td align=\"center\">vc14、vc15</td>\n</tr>\n<tr>\n<td align=\"center\">OpenCv 3.4.1</td>\n<td align=\"center\">vc14、vc15</td>\n</tr>\n</tbody></table>\n<h2 id=\"VS2017安装\"><a href=\"#VS2017安装\" class=\"headerlink\" title=\"VS2017安装\"></a>VS2017安装</h2><p>我的VS安装的时间太久了，网上教程一大堆，给你们挑一篇吧，这里就不再多说了</p>\n<h2 id=\"OpenCV3-4-4下载与安装\"><a href=\"#OpenCV3-4-4下载与安装\" class=\"headerlink\" title=\"OpenCV3.4.4下载与安装\"></a>OpenCV3.4.4下载与安装</h2><h3 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h3><ol>\n<li>官网下载<br>OpenCV官网给我们提供了下载，不过下载速度嘛～自求多福<br><a href=\"https://opencv.org/releases/\" target=\"_blank\" rel=\"noopener\">OpenCV下载</a>,里面有各个版本可以选择</li>\n<li>OpenCV下载驿站<br><a href=\"https://blog.csdn.net/oMoDao1/article/details/80276834\" target=\"_blank\" rel=\"noopener\">OpenCV各版本汇总下载</a><br>感谢这位大哥的总结</li>\n</ol>\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><p>找一个你能记住名字的路径安装进去就OK了，一定要记住这个路径，非常重要<br><img src=\"https://i.loli.net/2019/07/27/5d3c0e0f7a6db16095.png\" alt></p>\n<h2 id=\"系统环境变量配置\"><a href=\"#系统环境变量配置\" class=\"headerlink\" title=\"系统环境变量配置\"></a>系统环境变量配置</h2><ol>\n<li>找到此电脑</li>\n<li>依次找到 属性-&gt;高级-&gt;环境变量,找到系统变量里的Path，双击进去编辑，如图所示，添加的路径 <strong>“D:\\OpenCV\\opencv\\bulid\\x64\\vc15\\bin”</strong>,把”D:\\OpenCV\\”替换成你的安装路径即可</li>\n</ol>\n<p><img src=\"https://i.loli.net/2019/07/27/5d3c0e0f9cd5286868.png\" alt><br><img src=\"https://i.loli.net/2019/07/27/5d3c0e0fa09f948672.png\" alt><br><img src=\"https://i.loli.net/2019/07/27/5d3c0e0fa634780591.png\" alt><br><img src=\"https://i.loli.net/2019/07/27/5d3c0e0fa37ce25025.png\" alt></p>\n<p>到这就完成了系统环境的配置了</p>\n<h2 id=\"一些文件的配置\"><a href=\"#一些文件的配置\" class=\"headerlink\" title=\"一些文件的配置\"></a>一些文件的配置</h2><p>这一步的目的是为了解决以后可能会出现的关于缺少.dll的问题</p>\n<p>将 <strong>“D:\\OpenCV\\opencv\\bulid\\x64\\vc15\\bin”</strong> 里面的三个 <strong>.dll</strong> 文件复制到 <strong>C:\\Windows“</strong> 目录下的 <strong>System32</strong>和 <strong>SysWOW64</strong>目录下</p>\n<p><img src=\"https://i.loli.net/2019/07/28/5d3d5857adbe920715.png\" alt><br><img src=\"https://i.loli.net/2019/07/28/5d3d5857bd82f79652.png\" alt></p>\n<h2 id=\"VS2017配置\"><a href=\"#VS2017配置\" class=\"headerlink\" title=\"VS2017配置\"></a>VS2017配置</h2><ol>\n<li>新建一个空项目</li>\n<li>进入属性管理器  视图-&gt;其他窗口-&gt;属性管理器<br><img src=\"https://i.loli.net/2019/07/27/5d3c156f6359d16629.png\" alt></li>\n<li>选择Debug | x64 的 Microsoft.Cpp.x64.user<br><img src=\"https://i.loli.net/2019/07/27/5d3c156ecb8ad31557.png\" alt=\"8.png\"></li>\n<li>选择VC++目录，对包含目录和库目录进行配置<br><img src=\"https://i.loli.net/2019/07/27/5d3c156f2e22b74192.png\" alt><ul>\n<li>在包含目录里添加 <strong>D:\\OpenCV\\opencv\\bulid\\include</strong>,<strong>D:\\OpenCV\\opencv\\bulid\\include\\opencv</strong>,<strong>D:\\OpenCV\\opencv\\bulid\\include\\opencv2</strong><br><img src=\"https://i.loli.net/2019/07/27/5d3c156f2132f35424.png\" alt></li>\n<li>在库目录里添加 <strong>D:\\OpenCV\\opencv\\bulid\\x64\\vc15\\lib</strong><br><img src=\"https://i.loli.net/2019/07/27/5d3c156f492f430904.png\" alt></li>\n</ul>\n</li>\n<li>选择 链接器-&gt;输入-&gt;附加依赖项,<br><img src=\"https://i.loli.net/2019/07/27/5d3c156f13aac74119.png\" alt=\"12.png\"><br>在里面添加 <strong>opencv_world344d.lib</strong>，这个lib文件根据你的OpenCV版本号灵活变动<br><img src=\"https://i.loli.net/2019/07/27/5d3c156f0828190561.png\" alt></li>\n<li>点击应用，确定即可<br>到这里，OpenCV的所有配置工作已经完成了，要注意的是解决方案那一栏要换成x64(因为我们一直在配置的就是x64)<br><img src=\"https://i.loli.net/2019/07/27/5d3c156ee8b6668598.png\" alt><h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2>这是一段读取并显示本地图片的代码，测试一下你的OpenCV环境是否配置好</li>\n</ol>\n<pre><code class=\"cpp\">#include &lt;iostream&gt;\n#include &lt;opencv2/core/core.hpp&gt;\n#include &lt;opencv2/highgui/highgui.hpp&gt;\n\nusing namespace cv;\n\nint main()\n{\n    Mat img = imread(&quot;1.bmp&quot;);\n    namedWindow(&quot;图片&quot;);\n    imshow(&quot;图片&quot;, img);\n    waitKey(6000);\n    return 0;\n}</code></pre>\n<p>运行结果如下：<br><img src=\"https://i.loli.net/2019/07/27/5d3c15857414f57549.png\" alt></p>\n<h2 id=\"需要注意的问题\"><a href=\"#需要注意的问题\" class=\"headerlink\" title=\"需要注意的问题\"></a>需要注意的问题</h2><ol>\n<li>导入包的时候不报错，但运行程序时出现一下错误<br><img src=\"https://i.loli.net/2019/07/27/5d3c156f55e6b74341.png\" alt=\"15.png\"><br><img src=\"https://i.loli.net/2019/07/27/5d3c156f39a4e29681.png\" alt=\"16.png\"><br>出现这个问题，目前已知的有两个原因    <ul>\n<li>imread函数读不到图片，即你的图片路径写的有问题<br>这里给出两种基本的路径书写形式    <ol>\n<li>绝对路径<br>Mat img = imread(“D:\\\\Pictures\\\\1.bmp”);<br>一定要注意这里是双斜杠</li>\n<li>图片路径<br>Mat img = imread(“1.bmp”);<br>使用这个的前提是图片的位置在你的工程目录下</li>\n</ol>\n</li>\n<li>链接器的附加依赖项配置的有问题<br>在Debug模式下，附加依赖项添加的是 <strong>opencv_world344d.lib</strong><br>在Release模式下，附加依赖项添加的是 <strong>opencv_world344.lib</strong><br>有些教程是两个都添加，这是不对的，一定要注意。</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h1 id=\"MacOS-安装opencv-python\"><a href=\"#MacOS-安装opencv-python\" class=\"headerlink\" title=\"MacOS 安装opencv-python\"></a>MacOS 安装opencv-python</h1><h3 id=\"1-首先安装xcode\"><a href=\"#1-首先安装xcode\" class=\"headerlink\" title=\"1. 首先安装xcode\"></a>1. 首先安装xcode</h3><pre><code class=\"bash\">xcode-select --install </code></pre>\n<h3 id=\"2-安装opencv-python\"><a href=\"#2-安装opencv-python\" class=\"headerlink\" title=\"2. 安装opencv-python\"></a>2. 安装opencv-python</h3><pre><code class=\"bash\">pip install opencv-python</code></pre>\n<p>这默认将安装<code>opencv-python 4.2</code>, 但在 <strong>catalina</strong> 貌似不可用</p>\n<p>所以我选择了安装低版本的opencv-python</p>\n<pre><code class=\"bash\">pip install opencv-python==4.1.2.30</code></pre>\n<p>或者选择安装</p>\n<pre><code class=\"bash\">pip install opencv-python-headless</code></pre>\n<p>这个原因未知</p>\n<p>好了，教程到此结束，<br>接下来你就可以放心地去玩耍了，Enjoy Your OpenCV!</p>\n"},{"title":"PCA原理分析","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-08-05T07:22:19.000Z","password":null,"summary":"PCA的数学原理","_content":"参考资料\n[PCA原理分析](PCA.pdf)\n# PCA的数学原理\nPCA（Principal Component Analysis）是一种常用的数据分析方法。PCA通过线性变换将原始数据变换为一组各维度线性无关的表示，可用于提取数据的主要特征分量，常用于高维数据的降维。\n\n## 数据的向量表示以及降维问题\n\n一般情况下，在数据挖掘和机器学习中，数据被表示为向量。例如某个外卖商家2018年全年的流量及交易记录可以看成是一组数据的集合，其中每一天的数据是一条记录。记录的格式如下:    \n(日期, 浏览量，访客数，下单数，成交数，成交金额)    \n其中\"日期\"是一个记录标志而非度量值，而数据挖掘关心的大多是度量值，因此如果我们忽略日期这个字段后，我们得到一组记录，每条记录可以被表示为一个五维向量，其中一条看起来大约是这个样子：    \n$$(1000, 580, 300, 240, 3000)^T$$\n注意这里用了转置，习惯上使用列向量来表示一条记录。本文说到的向量默认都是列向量。    \n\n我们当然可以对这一组五维向量进行分析和挖掘，不过很多机器学习算法的复杂度和数据的维数有着密切关系，甚至与维数呈指数级关联。当然，这里区区五维的数据，也许还无所谓，但是实际机器学习中处理成千上万甚至几十万维的情况也并不罕见，在这种情况下，机器学习的资源消耗是不可接受的，因此我们必须对数据进行降维。\n\n降维当然意味着信息的丢失，不过鉴于实际数据本身常常存在的相关性，我们可以想办法在降维的同时将信息的损失尽量降低。    \n\n举一个例子，假如某学籍数据有两列M和F，其中M列的取值是如何此学生为男性取值1，为女性取值0；而F列是学生为女性取值1，男性取值0。此时如果我们统计全部学籍数据，会发现对于任何一条记录来说，当M为1时F必定为0，反之当M为0时F必定为1。在这种情况下，我们将M或F去掉实际上没有任何信息的损失，因为只要保留一列就可以完全还原另一列。    \n当然上面是一个极端的情况，在现实中也许不会出现，不过类似的情况还是很常见的。例如上面淘宝店铺的数据，从经验我们可以知道，“浏览量”和“访客数”往往具有较强的相关关系，而“下单数”和“成交数”也具有较强的相关关系。这里我们非正式的使用“ **相关关系**”这个词，可以直观理解为“当某一天这个店铺的浏览量较高（或较低）时，我们应该很大程度上认为这天的访客数也较高（或较低）”。    \n这种情况表明，如果我们删除浏览量或访客数其中一个指标，我们应该期待并不会丢失太多信息。因此我们可以删除一个，以降低机器学习算法的复杂度。    \n\n上面给出的是降维的朴素思想描述，可以有助于直观理解降维的动机和可行性，但并不具有操作指导意义。例如，我们到底删除哪一列损失的信息才最小？亦或根本不是单纯删除几列，而是通过某些变换将原始数据变为更少的列但又使得丢失的信息最小？到底如何度量丢失信息的多少？如何根据原始数据决定具体的降维操作步骤？下面对降维问题进行数学化和形式化的讨论\n\n## 向量的表示及基变换\n\n### 内积与投影\n\n下面先来看一个高中就学过的向量运算：内积。两个维数相同的向量的内积被定义为：\n\n$$(a_1, a_2, \\dots ,a_n)^T \\cdot (b_1, b_2, \\dots , b_n)^T = a_1b_1 + a_2b_2 + \\dots + a_nb_n)$$\n内积运算将两个向量映射为一个实数。其计算方式非常容易理解，但是其意义并不明显。下面我们分析内积的几何意义。假设A和B是两个n维向量，我们知道n维向量可以等价表示为n维空间中的一条从原点发射的有向线段，为了简单起见我们假设A和B均为二维向量,则 $A = (x_1,y_1)$, $B = (x_2,y_2)$. 则在二维平面上A和B可以用两条发自原点的有向线段表示，见下图：\n![](01.png)\n好，现在我们从A点向B所在直线引一条垂线。我们知道垂线与B的交点叫做A在B上的投影，再设A与B的夹角是a，则投影的矢量长度为|A|cos(a),其中 $|A| = \\sqrt{x_1^2 + y_1^2}$ 是向量A的模，也就是A线段的标量长度。    \n注意这里我们专门区分了矢量长度和标量长度，标量长度总是大于等于0，值就是线段的长度；而矢量长度可能为负，其绝对值是线段长度，而符号取决于其方向与标准方向相同或相反。    \n到这里还是看不出内积和这东西有什么关系，不过如果我们将内积表示为另一种我们熟悉的形式：\n$$ A \\cdot B = |A||B|cos(a)$$\n\n现在事情似乎是有点眉目了：A与B的内积等于A到B的投影长度乘以B的模。再进一步，如果我们假设B的模为1，即让|B|=1，那么就变成了：\n$$A \\cdot B = |A|cos(a)$$\n也就是说， **设向量B的模为1，则A与B的内积值等于A向B所在直线投影的矢量长度！**这就是内积的一种几何解释，也是我们得到的第一个重要结论。在后面的推导中，将反复使用这个结论。\n\n### 基\n下面我们继续在二维空间内讨论向量。上文说过，一个二维向量可以对应二维笛卡尔直角坐标系中从原点出发的一个有向线段。例如下面这个向量：\n![](02.png)\n在代数表示方面，我们经常用线段终点的点坐标表示向量，例如上面的向量可以表示为(3,2)，这是我们再熟悉不过的向量表示。    \n不过我们常常忽略， **只有一个(3,2)本身是不能够精确表示一个向量的**。我们仔细看一下，这里的3实际表示的是向量在x轴上的投影值是3，在y轴上的投影值是2。也就是说我们其实隐式引入了一个定义：以x轴和y轴上正方向长度为1的向量为标准。那么一个向量(3,2)实际是说在x轴投影为3而y轴的投影为2。注意投影是一个矢量，所以可以为负。    \n更正式的说，向量(x,y)实际上表示线性组合：\n$$x(1,0)^T + y(0,1)^T$$\n不难证明所有二维向量都可以表示为这样的线性组合。此处(1,0)和(0,1)叫做二维空间中的一组基。\n![](03.png)\n所以， **要准确描述向量，首先要确定一组基，然后给出在基所在的各个直线上的投影值，就可以了**。只不过我们经常省略第一步，而默认以(1,0)和(0,1)为基。    \n我们之所以默认选择(1,0)和(0,1)为基，当然是比较方便，因为它们分别是x和y轴正方向上的单位向量，因此就使得二维平面上点坐标和向量一一对应，非常方便。但实际上任何两个线性无关的二维向量都可以成为一组基，所谓线性无关在二维平面内可以直观认为是两个不在一条直线上的向量。    \n\n例如，(1,1)和(-1,1)也可以成为一组基。一般来说，我们希望基的模是1，因为从内积的意义可以看到，如果基的模是1，那么就可以方便的用向量点乘基而直接获得其在新基上的坐标了！实际上，对应任何一个向量我们总可以找到其同方向上模为1的向量，只要让两个分量分别除以模就好了。例如，上面的基可以变为 $(\\frac{1}{\\sqrt 2},\\frac{1}{\\sqrt 2})$ 和 $(\\frac{-1}{\\sqrt 2},\\frac{1}{\\sqrt 2})$.    \n现在，我们想获得(3,2)在新基上的坐标，即在两个方向上的投影矢量值，那么根据内积的几何意义，我们只要分别计算(3,2)和两个基的内积，不难得到新的坐标为 $(\\frac{5}{\\sqrt 2},\\frac{-1}{\\sqrt 2})$。下图给出了新的基以及(3,2)在新基上坐标值的示意图：\n![](05.png)\n一要求就是线性无关，非正交的基也是可以的。不过因为正交基有较好的性质，所以一般使用的基都是正交的。\n\n### 基变换的矩阵表示\n\n下面我们找一种简便的方式来表示基变换。还是拿上面的例子，想一下，将(3,2)变换为新基上的坐标，就是用(3,2)与第一个基做内积运算，作为第一个新的坐标分量，然后用(3,2)与第二个基做内积运算，作为第二个新坐标的分量。实际上，我们可以用矩阵相乘的形式简洁的表示这个变换：\n$$\\begin{pmatrix} \n1/ \\sqrt 2 & 1/ \\sqrt 2 \\\\\\\\\n-1/ \\sqrt 2 & 1/ \\sqrt 2 \\\\\n\\end{pmatrix}\n\\begin{pmatrix}\n3 \\\\\\\\\n2 \\\\\n\\end{pmatrix} = \\begin{pmatrix}\n5 / \\sqrt 2 \\\\\\\\\n-1/ \\sqrt 2 \\\\\n\\end{pmatrix}$$\n\n太漂亮了！其中矩阵的两行分别为两个基，乘以原向量，其结果刚好为新基的坐标。可以稍微推广一下，如果我们有m个二维向量，只要将二维向量按列排成一个两行m列矩阵，然后用“基矩阵”乘以这个矩阵，就得到了所有这些向量在新基下的值。例如 $(1,1)，(2,2)，(3,3)$，想变换到刚才那组基上，则可以这样表示：\n\n$$\\begin{pmatrix}\n1 / \\sqrt 2 & 1/ \\sqrt 2 \\\\\\\\\n-1 / \\sqrt 2 & 1/ \\sqrt 2 \\\\\n\\end{pmatrix}\n\\begin{pmatrix}\n1 & 2 & 3 \\\\\\\\\n1 & 2 & 3 \\\\\n\\end{pmatrix} = \\begin{pmatrix}\n2 / \\sqrt 2 & 4 / \\sqrt 2 & 6 / \\sqrt 2 \\\\\\\\\n0 & 0 & 0 \\\\\n\\end{pmatrix}$$\n\n于是一组向量的基变换被干净的表示为矩阵的相乘。    \n**一般的，如果我们有M个N维向量，想将其变换为由R个N维向量表示的新空间中，那么首先将R个基按行组成矩阵A，然后将向量按列组成矩阵B，那么两矩阵的乘积AB就是变换结果，其中AB的第m列为A中第m列变换后的结果。**    \n数学表示为：\n$$\\begin{pmatrix}\np_1 \\\\\\\\\np_2 \\\\\\\\\n\\vdots \\\\\\\\\np_R \\\\\n\\end{pmatrix}\n\\begin{pmatrix}\na_1 & a_2 & \\dots & a_M \\\\\n\\end{pmatrix} = \\begin{pmatrix}\np_1a_1 & p_1a_2 & \\dots & p_1a_M \\\\\\\\\np_2a_1 & p_2a_2 & \\dots & p_2a_M \\\\\\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\\\\\np_Ra_1 & p_Ra_2 & \\dots & p_Ra_M \\\\\n\\end{pmatrix}$$\n其中 $p_i$是一个行向量，表示第i个基， $a_j$是一个列向量，表示第j个原始数据记录。    \n特别要注意的是，这里R可以小于N，而R决定了变换后数据的维数。也就是说，我们可以将一N维数据变换到更低维度的空间中去，变换后的维度取决于基的数量。因此这种矩阵相乘的表示也可以表示降维变换。    \n最后，上述分析同时给矩阵相乘找到了一种物理解释： **两个矩阵相乘的意义是将右边矩阵中的每一列列向量变换到左边矩阵中每一行行向量为基所表示的空间中去**。更抽象的说，一个矩阵可以表示一种线性变换。很多同学在学线性代数时对矩阵相乘的方法感到奇怪，但是如果明白了矩阵相乘的物理意义，其合理性就一目了然了。    \n\n### 协方差矩阵及优化目标\n\n上面我们讨论了选择不同的基可以对同样一组数据给出不同的表示，而且如果基的数量少于向量本身的维数，则可以达到降维的效果。但是我们还没有回答一个最最关键的问题：如何选择基才是最优的。或者说，如果我们有一组N维向量，现在要将其降到K维（K小于N），那么我们应该如何选择K个基才能最大程度保留原有的信息？    \n要完全数学化这个问题非常繁杂，这里我们用一种非形式化的直观方法来看这个问题。\n\n为了避免过于抽象的讨论，我们仍以一个具体的例子展开。假设我们的数据由五条记录组成，将它们表示成矩阵形式：\n$$ \\begin{pmatrix}\n1 & 1 &2 & 4 & 2 \\\\\\\\\n1 & 3 & 3 & 4 & 4 \\\\\n\\end{pmatrix}$$\n其中每一列为一条数据记录，而一行为一个字段。为了后续处理方便，我们首先将每个字段内所有值都减去字段均值，其结果是将每个字段都变为均值为0（这样做的道理和好处后面会看到）。    \n我们看上面的数据，第一个字段均值为2，第二个字段均值为3，所以变换后：\n$$ \\begin{pmatrix}\n-1 & -1 & 0 & 2 & 0 \\\\\\\\\n-2 & 0 & 0 & 1 & 1 \\\\\n\\end{pmatrix}$$\n我们可以看下五条数据在平面直角坐标系内的样子：\n![](06.png)\n现在问题来了：如果我们必须使用一维来表示这些数据，又希望尽量保留原始的信息，你要如何选择？    \n\n通过上一节对基变换的讨论我们知道，这个问题实际上是要在二维平面中选择一个方向，将所有数据都投影到这个方向所在直线上，用投影值表示原始记录。这是一个实际的二维降到一维的问题。    \n\n那么如何选择这个方向（或者说基）才能尽量保留最多的原始信息呢？一种直观的看法是：希望投影后的投影值尽可能分散。    \n\n以上图为例，可以看出如果向x轴投影，那么最左边的两个点会重叠在一起，中间的两个点也会重叠在一起，于是本身四个各不相同的二维点投影后只剩下两个不同的值了，这是一种严重的信息丢失，同理，如果向y轴投影最上面的两个点和分布在x轴上的两个点也会重叠。所以看来x和y轴都不是最好的投影选择。我们直观目测，如果向通过第一象限和第三象限的斜线投影，则五个点在投影后还是可以区分的。    \n下面，我们用数学方法表述这个问题。\n\n### 方差\n\n上文说到，我们希望投影后投影值尽可能分散，而这种分散程度，可以用数学上的方差来表述。此处，一个字段的方差可以看做是每个元素与字段均值的差的平方和的均值，即：\n$$Var(a)=\\frac{1}{m} \\sum_{i=1}^{m}(a_i- \\mu)^2$$\n由于上面我们已经将每个字段的均值都化为0了，因此方差可以直接用每个元素的平方和除以元素个数表示：\n$$Var(a) = \\frac{1}{m} \\sum_{i=1}^{m}a_i^2$$\n于是上面的问题被形式化表述为：寻找一个一维基，使得所有数据变换为这个基上的坐标表示后，方差值最大。    \n\n### 协方差\n对于上面二维降成一维的问题来说，找到那个使得方差最大的方向就可以了。不过对于更高维，还有一个问题需要解决。考虑三维降到二维问题。与之前相同，首先我们希望找到一个方向使得投影后方差最大，这样就完成了第一个方向的选择，继而我们选择第二个投影方向。    \n如果我们还是单纯只选择方差最大的方向，很明显，这个方向与第一个方向应该是“几乎重合在一起”，显然这样的维度是没有用的，因此，应该有其他约束条件。从直观上说，让两个字段尽可能表示更多的原始信息，我们是不希望它们之间存在（线性）相关性的，因为相关性意味着两个字段不是完全独立，必然存在重复表示的信息。    \n数学上可以用两个字段的协方差表示其相关性，由于已经让每个字段均值为0，则：\n$$Cov(a,b)=\\frac{1}{m} \\sum_{i=1}^{m}a_ib_i$$\n可以看到，在字段均值为0的情况下，两个字段的协方差简洁的表示为其内积除以元素数m。\n\n当协方差为0时，表示两个字段完全独立。为了让协方差为0，我们选择第二个基时只能在与第一个基正交的方向上选择。因此最终选择的两个方向一定是正交的。\n\n至此，我们得到了降维问题的优化目标：**将一组N维向量降为K维（K大于0，小于N），其目标是选择K个单位（模为1）正交基，使得原始数据变换到这组基上后，各字段两两间协方差为0，而字段的方差则尽可能大（在正交的约束下，取最大的K个方差）**。\n\n### 协方差矩阵\n\n上面我们导出了优化目标，但是这个目标似乎不能直接作为操作指南（或者说算法），因为它只说要什么，但根本没有说怎么做。所以我们要继续在数学上研究计算方案。\n\n我们看到，最终要达到的目的与字段内方差及字段间协方差有密切关系。因此我们希望能将两者统一表示，仔细观察发现，两者均可以表示为内积的形式，而内积又与矩阵相乘密切相关。于是我们来了灵感：\n\n假设我们只有a和b两个字段，那么我们将它们按行组成矩阵X：\n\n$$ X = \\begin{pmatrix}\na_1 & a_2 & \\dots & a_m \\\\\\\\\nb_1 & b_2 & \\dots & b_m \\\\\n\\end{pmatrix}$$\n然后我们用X乘以X的转置，并乘上系数 $\\frac{1}{m}$：\n$$\\frac{1}{m} \\begin{pmatrix}\n\\frac{1}{m} \\sum_{i=1}^{m}a_i^2 & \\frac{1}{m} \\sum_{i=1}^{m}a_ib_i \\\\\\\\\n\\frac{1}{m} \\sum_{i=1}^{m}a_ib_i & \\frac{1}{m} \\sum_{i=1}^{m}b_i^2 \\\\\n\\end{pmatrix}$$\n\n奇迹出现了！这个矩阵对角线上的两个元素分别是两个字段的方差，而其它元素是a和b的协方差。两者被统一到了一个矩阵的。\n\n根据矩阵相乘的运算法则，这个结论很容易被推广到一般情况：\n\n**设我们有m个n维数据记录，将其按列排成n乘m的矩阵X，设 $C = \\frac{1}{m}XX^T$,则C是一个对称矩阵，其对角线分别个各个字段的方差，而第i行j列和j行i列元素相同，表示i和j两个字段的协方差。**\n\n### 协方差矩阵对角化\n\n根据上述推导，我们发现要达到优化目前，等价于将协方差矩阵对角化：即除对角线外的其它元素化为0，并且在对角线上将元素按大小从上到下排列，这样我们就达到了优化目的。这样说可能还不是很明晰，我们进一步看下原矩阵与基变换后矩阵协方差矩阵的关系：\n\n设原始数据矩阵X对应的协方差矩阵为C，而P是一组基按行组成的矩阵，设Y=PX，则Y为X对P做基变换后的数据。设Y的协方差矩阵为D，我们推导一下D与C的关系：\n$$\\begin{align}\nD &= \\frac{1}{m}YY^T \\\\\\\\\n  &= \\frac{1}{m}(PX)(PX)^T \\\\\\\\\n  &= \\frac{1}{m}PXX^T P^T \\\\\\\\\n  &= P(\\frac{1}{m}XX^T)P^T \\\\\\\\\n  &= PCP^T\n\\end{align}$$\n\n现在事情很明白了！我们要找的P不是别的，而是能让原始协方差矩阵对角化的P。换句话说，优化目标变成了寻找一个矩阵P，满足 $PCP^T$ 是一个对角矩阵，并且对角元素按从大到小依次排列，那么P的前K行就是要寻找的基，用P的前K行组成的矩阵乘以X就使得X从N维降到了K维并满足上述优化条件。    \n现在所有焦点都聚焦在了协方差矩阵对角化问题上，有时，我们真应该感谢数学家的先行，因为矩阵对角化在线性代数领域已经属于被玩烂了的东西，所以这在数学上根本不是问题。\n\n由上文知道，协方差矩阵C是一个是对称矩阵，在线性代数上，实对称矩阵有一系列非常好的性质：\n1. 实对称矩阵不同特征值对应的特征向量必然正交\n2. 设特征向量λ重数为r，则必然存在r个线性无关的特征向量对应于λ，因此可以将这r个特征向量单位正交化。    \n由上面两条可知，一个n行n列的实对称矩阵一定可以找到n个单位正交特征向量，设这n个特征向量为 $e_1,e_2,\\dots,e_n,$ 我们将其按列组成矩阵：\n$$E = \\begin{pmatrix}\ne_1 & e_2 & \\dots & e_n \\\\\n\\end{pmatrix}$$\n则对协方差矩阵C有如下结论：\n$$E_TCE = \\Lambda = \\begin{pmatrix}\n\\lambda_1 & & & \\\\\\\\\n & \\lambda_2 & & \\\\\\\\\n & & \\ddots & \\\\\\\\\n & & & \\lambda_n \\\\\n \\end{pmatrix}$$\n其中 $Lambda$为对角矩阵，其对角元素为各特征向量对应的特征值（可能有重复）。\n\n以上结论不再给出严格的数学证明，对证明感兴趣的朋友可以参考线性代数书籍关于“实对称矩阵对角化”的内容。\n\n到这里，我们发现我们已经找到了需要的矩阵P：\n$$P = E^T$$\n\nP是协方差矩阵的特征向量单位化后按行排列出的矩阵，其中每一行都是C的一个特征向量。如果设P按照Λ中特征值的从大到小，将特征向量从上到下排列，则用P的前K行组成的矩阵乘以原始数据矩阵X，就得到了我们需要的降维后的数据矩阵Y。\n","source":"_posts/PCA原理分析.md","raw":"---\ntitle: PCA原理分析\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-08-05 15:22:19\npassword:\nsummary: PCA的数学原理\ntags:\n- PCA\ncategories: \n- 算法\n---\n参考资料\n[PCA原理分析](PCA.pdf)\n# PCA的数学原理\nPCA（Principal Component Analysis）是一种常用的数据分析方法。PCA通过线性变换将原始数据变换为一组各维度线性无关的表示，可用于提取数据的主要特征分量，常用于高维数据的降维。\n\n## 数据的向量表示以及降维问题\n\n一般情况下，在数据挖掘和机器学习中，数据被表示为向量。例如某个外卖商家2018年全年的流量及交易记录可以看成是一组数据的集合，其中每一天的数据是一条记录。记录的格式如下:    \n(日期, 浏览量，访客数，下单数，成交数，成交金额)    \n其中\"日期\"是一个记录标志而非度量值，而数据挖掘关心的大多是度量值，因此如果我们忽略日期这个字段后，我们得到一组记录，每条记录可以被表示为一个五维向量，其中一条看起来大约是这个样子：    \n$$(1000, 580, 300, 240, 3000)^T$$\n注意这里用了转置，习惯上使用列向量来表示一条记录。本文说到的向量默认都是列向量。    \n\n我们当然可以对这一组五维向量进行分析和挖掘，不过很多机器学习算法的复杂度和数据的维数有着密切关系，甚至与维数呈指数级关联。当然，这里区区五维的数据，也许还无所谓，但是实际机器学习中处理成千上万甚至几十万维的情况也并不罕见，在这种情况下，机器学习的资源消耗是不可接受的，因此我们必须对数据进行降维。\n\n降维当然意味着信息的丢失，不过鉴于实际数据本身常常存在的相关性，我们可以想办法在降维的同时将信息的损失尽量降低。    \n\n举一个例子，假如某学籍数据有两列M和F，其中M列的取值是如何此学生为男性取值1，为女性取值0；而F列是学生为女性取值1，男性取值0。此时如果我们统计全部学籍数据，会发现对于任何一条记录来说，当M为1时F必定为0，反之当M为0时F必定为1。在这种情况下，我们将M或F去掉实际上没有任何信息的损失，因为只要保留一列就可以完全还原另一列。    \n当然上面是一个极端的情况，在现实中也许不会出现，不过类似的情况还是很常见的。例如上面淘宝店铺的数据，从经验我们可以知道，“浏览量”和“访客数”往往具有较强的相关关系，而“下单数”和“成交数”也具有较强的相关关系。这里我们非正式的使用“ **相关关系**”这个词，可以直观理解为“当某一天这个店铺的浏览量较高（或较低）时，我们应该很大程度上认为这天的访客数也较高（或较低）”。    \n这种情况表明，如果我们删除浏览量或访客数其中一个指标，我们应该期待并不会丢失太多信息。因此我们可以删除一个，以降低机器学习算法的复杂度。    \n\n上面给出的是降维的朴素思想描述，可以有助于直观理解降维的动机和可行性，但并不具有操作指导意义。例如，我们到底删除哪一列损失的信息才最小？亦或根本不是单纯删除几列，而是通过某些变换将原始数据变为更少的列但又使得丢失的信息最小？到底如何度量丢失信息的多少？如何根据原始数据决定具体的降维操作步骤？下面对降维问题进行数学化和形式化的讨论\n\n## 向量的表示及基变换\n\n### 内积与投影\n\n下面先来看一个高中就学过的向量运算：内积。两个维数相同的向量的内积被定义为：\n\n$$(a_1, a_2, \\dots ,a_n)^T \\cdot (b_1, b_2, \\dots , b_n)^T = a_1b_1 + a_2b_2 + \\dots + a_nb_n)$$\n内积运算将两个向量映射为一个实数。其计算方式非常容易理解，但是其意义并不明显。下面我们分析内积的几何意义。假设A和B是两个n维向量，我们知道n维向量可以等价表示为n维空间中的一条从原点发射的有向线段，为了简单起见我们假设A和B均为二维向量,则 $A = (x_1,y_1)$, $B = (x_2,y_2)$. 则在二维平面上A和B可以用两条发自原点的有向线段表示，见下图：\n![](01.png)\n好，现在我们从A点向B所在直线引一条垂线。我们知道垂线与B的交点叫做A在B上的投影，再设A与B的夹角是a，则投影的矢量长度为|A|cos(a),其中 $|A| = \\sqrt{x_1^2 + y_1^2}$ 是向量A的模，也就是A线段的标量长度。    \n注意这里我们专门区分了矢量长度和标量长度，标量长度总是大于等于0，值就是线段的长度；而矢量长度可能为负，其绝对值是线段长度，而符号取决于其方向与标准方向相同或相反。    \n到这里还是看不出内积和这东西有什么关系，不过如果我们将内积表示为另一种我们熟悉的形式：\n$$ A \\cdot B = |A||B|cos(a)$$\n\n现在事情似乎是有点眉目了：A与B的内积等于A到B的投影长度乘以B的模。再进一步，如果我们假设B的模为1，即让|B|=1，那么就变成了：\n$$A \\cdot B = |A|cos(a)$$\n也就是说， **设向量B的模为1，则A与B的内积值等于A向B所在直线投影的矢量长度！**这就是内积的一种几何解释，也是我们得到的第一个重要结论。在后面的推导中，将反复使用这个结论。\n\n### 基\n下面我们继续在二维空间内讨论向量。上文说过，一个二维向量可以对应二维笛卡尔直角坐标系中从原点出发的一个有向线段。例如下面这个向量：\n![](02.png)\n在代数表示方面，我们经常用线段终点的点坐标表示向量，例如上面的向量可以表示为(3,2)，这是我们再熟悉不过的向量表示。    \n不过我们常常忽略， **只有一个(3,2)本身是不能够精确表示一个向量的**。我们仔细看一下，这里的3实际表示的是向量在x轴上的投影值是3，在y轴上的投影值是2。也就是说我们其实隐式引入了一个定义：以x轴和y轴上正方向长度为1的向量为标准。那么一个向量(3,2)实际是说在x轴投影为3而y轴的投影为2。注意投影是一个矢量，所以可以为负。    \n更正式的说，向量(x,y)实际上表示线性组合：\n$$x(1,0)^T + y(0,1)^T$$\n不难证明所有二维向量都可以表示为这样的线性组合。此处(1,0)和(0,1)叫做二维空间中的一组基。\n![](03.png)\n所以， **要准确描述向量，首先要确定一组基，然后给出在基所在的各个直线上的投影值，就可以了**。只不过我们经常省略第一步，而默认以(1,0)和(0,1)为基。    \n我们之所以默认选择(1,0)和(0,1)为基，当然是比较方便，因为它们分别是x和y轴正方向上的单位向量，因此就使得二维平面上点坐标和向量一一对应，非常方便。但实际上任何两个线性无关的二维向量都可以成为一组基，所谓线性无关在二维平面内可以直观认为是两个不在一条直线上的向量。    \n\n例如，(1,1)和(-1,1)也可以成为一组基。一般来说，我们希望基的模是1，因为从内积的意义可以看到，如果基的模是1，那么就可以方便的用向量点乘基而直接获得其在新基上的坐标了！实际上，对应任何一个向量我们总可以找到其同方向上模为1的向量，只要让两个分量分别除以模就好了。例如，上面的基可以变为 $(\\frac{1}{\\sqrt 2},\\frac{1}{\\sqrt 2})$ 和 $(\\frac{-1}{\\sqrt 2},\\frac{1}{\\sqrt 2})$.    \n现在，我们想获得(3,2)在新基上的坐标，即在两个方向上的投影矢量值，那么根据内积的几何意义，我们只要分别计算(3,2)和两个基的内积，不难得到新的坐标为 $(\\frac{5}{\\sqrt 2},\\frac{-1}{\\sqrt 2})$。下图给出了新的基以及(3,2)在新基上坐标值的示意图：\n![](05.png)\n一要求就是线性无关，非正交的基也是可以的。不过因为正交基有较好的性质，所以一般使用的基都是正交的。\n\n### 基变换的矩阵表示\n\n下面我们找一种简便的方式来表示基变换。还是拿上面的例子，想一下，将(3,2)变换为新基上的坐标，就是用(3,2)与第一个基做内积运算，作为第一个新的坐标分量，然后用(3,2)与第二个基做内积运算，作为第二个新坐标的分量。实际上，我们可以用矩阵相乘的形式简洁的表示这个变换：\n$$\\begin{pmatrix} \n1/ \\sqrt 2 & 1/ \\sqrt 2 \\\\\\\\\n-1/ \\sqrt 2 & 1/ \\sqrt 2 \\\\\n\\end{pmatrix}\n\\begin{pmatrix}\n3 \\\\\\\\\n2 \\\\\n\\end{pmatrix} = \\begin{pmatrix}\n5 / \\sqrt 2 \\\\\\\\\n-1/ \\sqrt 2 \\\\\n\\end{pmatrix}$$\n\n太漂亮了！其中矩阵的两行分别为两个基，乘以原向量，其结果刚好为新基的坐标。可以稍微推广一下，如果我们有m个二维向量，只要将二维向量按列排成一个两行m列矩阵，然后用“基矩阵”乘以这个矩阵，就得到了所有这些向量在新基下的值。例如 $(1,1)，(2,2)，(3,3)$，想变换到刚才那组基上，则可以这样表示：\n\n$$\\begin{pmatrix}\n1 / \\sqrt 2 & 1/ \\sqrt 2 \\\\\\\\\n-1 / \\sqrt 2 & 1/ \\sqrt 2 \\\\\n\\end{pmatrix}\n\\begin{pmatrix}\n1 & 2 & 3 \\\\\\\\\n1 & 2 & 3 \\\\\n\\end{pmatrix} = \\begin{pmatrix}\n2 / \\sqrt 2 & 4 / \\sqrt 2 & 6 / \\sqrt 2 \\\\\\\\\n0 & 0 & 0 \\\\\n\\end{pmatrix}$$\n\n于是一组向量的基变换被干净的表示为矩阵的相乘。    \n**一般的，如果我们有M个N维向量，想将其变换为由R个N维向量表示的新空间中，那么首先将R个基按行组成矩阵A，然后将向量按列组成矩阵B，那么两矩阵的乘积AB就是变换结果，其中AB的第m列为A中第m列变换后的结果。**    \n数学表示为：\n$$\\begin{pmatrix}\np_1 \\\\\\\\\np_2 \\\\\\\\\n\\vdots \\\\\\\\\np_R \\\\\n\\end{pmatrix}\n\\begin{pmatrix}\na_1 & a_2 & \\dots & a_M \\\\\n\\end{pmatrix} = \\begin{pmatrix}\np_1a_1 & p_1a_2 & \\dots & p_1a_M \\\\\\\\\np_2a_1 & p_2a_2 & \\dots & p_2a_M \\\\\\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\\\\\np_Ra_1 & p_Ra_2 & \\dots & p_Ra_M \\\\\n\\end{pmatrix}$$\n其中 $p_i$是一个行向量，表示第i个基， $a_j$是一个列向量，表示第j个原始数据记录。    \n特别要注意的是，这里R可以小于N，而R决定了变换后数据的维数。也就是说，我们可以将一N维数据变换到更低维度的空间中去，变换后的维度取决于基的数量。因此这种矩阵相乘的表示也可以表示降维变换。    \n最后，上述分析同时给矩阵相乘找到了一种物理解释： **两个矩阵相乘的意义是将右边矩阵中的每一列列向量变换到左边矩阵中每一行行向量为基所表示的空间中去**。更抽象的说，一个矩阵可以表示一种线性变换。很多同学在学线性代数时对矩阵相乘的方法感到奇怪，但是如果明白了矩阵相乘的物理意义，其合理性就一目了然了。    \n\n### 协方差矩阵及优化目标\n\n上面我们讨论了选择不同的基可以对同样一组数据给出不同的表示，而且如果基的数量少于向量本身的维数，则可以达到降维的效果。但是我们还没有回答一个最最关键的问题：如何选择基才是最优的。或者说，如果我们有一组N维向量，现在要将其降到K维（K小于N），那么我们应该如何选择K个基才能最大程度保留原有的信息？    \n要完全数学化这个问题非常繁杂，这里我们用一种非形式化的直观方法来看这个问题。\n\n为了避免过于抽象的讨论，我们仍以一个具体的例子展开。假设我们的数据由五条记录组成，将它们表示成矩阵形式：\n$$ \\begin{pmatrix}\n1 & 1 &2 & 4 & 2 \\\\\\\\\n1 & 3 & 3 & 4 & 4 \\\\\n\\end{pmatrix}$$\n其中每一列为一条数据记录，而一行为一个字段。为了后续处理方便，我们首先将每个字段内所有值都减去字段均值，其结果是将每个字段都变为均值为0（这样做的道理和好处后面会看到）。    \n我们看上面的数据，第一个字段均值为2，第二个字段均值为3，所以变换后：\n$$ \\begin{pmatrix}\n-1 & -1 & 0 & 2 & 0 \\\\\\\\\n-2 & 0 & 0 & 1 & 1 \\\\\n\\end{pmatrix}$$\n我们可以看下五条数据在平面直角坐标系内的样子：\n![](06.png)\n现在问题来了：如果我们必须使用一维来表示这些数据，又希望尽量保留原始的信息，你要如何选择？    \n\n通过上一节对基变换的讨论我们知道，这个问题实际上是要在二维平面中选择一个方向，将所有数据都投影到这个方向所在直线上，用投影值表示原始记录。这是一个实际的二维降到一维的问题。    \n\n那么如何选择这个方向（或者说基）才能尽量保留最多的原始信息呢？一种直观的看法是：希望投影后的投影值尽可能分散。    \n\n以上图为例，可以看出如果向x轴投影，那么最左边的两个点会重叠在一起，中间的两个点也会重叠在一起，于是本身四个各不相同的二维点投影后只剩下两个不同的值了，这是一种严重的信息丢失，同理，如果向y轴投影最上面的两个点和分布在x轴上的两个点也会重叠。所以看来x和y轴都不是最好的投影选择。我们直观目测，如果向通过第一象限和第三象限的斜线投影，则五个点在投影后还是可以区分的。    \n下面，我们用数学方法表述这个问题。\n\n### 方差\n\n上文说到，我们希望投影后投影值尽可能分散，而这种分散程度，可以用数学上的方差来表述。此处，一个字段的方差可以看做是每个元素与字段均值的差的平方和的均值，即：\n$$Var(a)=\\frac{1}{m} \\sum_{i=1}^{m}(a_i- \\mu)^2$$\n由于上面我们已经将每个字段的均值都化为0了，因此方差可以直接用每个元素的平方和除以元素个数表示：\n$$Var(a) = \\frac{1}{m} \\sum_{i=1}^{m}a_i^2$$\n于是上面的问题被形式化表述为：寻找一个一维基，使得所有数据变换为这个基上的坐标表示后，方差值最大。    \n\n### 协方差\n对于上面二维降成一维的问题来说，找到那个使得方差最大的方向就可以了。不过对于更高维，还有一个问题需要解决。考虑三维降到二维问题。与之前相同，首先我们希望找到一个方向使得投影后方差最大，这样就完成了第一个方向的选择，继而我们选择第二个投影方向。    \n如果我们还是单纯只选择方差最大的方向，很明显，这个方向与第一个方向应该是“几乎重合在一起”，显然这样的维度是没有用的，因此，应该有其他约束条件。从直观上说，让两个字段尽可能表示更多的原始信息，我们是不希望它们之间存在（线性）相关性的，因为相关性意味着两个字段不是完全独立，必然存在重复表示的信息。    \n数学上可以用两个字段的协方差表示其相关性，由于已经让每个字段均值为0，则：\n$$Cov(a,b)=\\frac{1}{m} \\sum_{i=1}^{m}a_ib_i$$\n可以看到，在字段均值为0的情况下，两个字段的协方差简洁的表示为其内积除以元素数m。\n\n当协方差为0时，表示两个字段完全独立。为了让协方差为0，我们选择第二个基时只能在与第一个基正交的方向上选择。因此最终选择的两个方向一定是正交的。\n\n至此，我们得到了降维问题的优化目标：**将一组N维向量降为K维（K大于0，小于N），其目标是选择K个单位（模为1）正交基，使得原始数据变换到这组基上后，各字段两两间协方差为0，而字段的方差则尽可能大（在正交的约束下，取最大的K个方差）**。\n\n### 协方差矩阵\n\n上面我们导出了优化目标，但是这个目标似乎不能直接作为操作指南（或者说算法），因为它只说要什么，但根本没有说怎么做。所以我们要继续在数学上研究计算方案。\n\n我们看到，最终要达到的目的与字段内方差及字段间协方差有密切关系。因此我们希望能将两者统一表示，仔细观察发现，两者均可以表示为内积的形式，而内积又与矩阵相乘密切相关。于是我们来了灵感：\n\n假设我们只有a和b两个字段，那么我们将它们按行组成矩阵X：\n\n$$ X = \\begin{pmatrix}\na_1 & a_2 & \\dots & a_m \\\\\\\\\nb_1 & b_2 & \\dots & b_m \\\\\n\\end{pmatrix}$$\n然后我们用X乘以X的转置，并乘上系数 $\\frac{1}{m}$：\n$$\\frac{1}{m} \\begin{pmatrix}\n\\frac{1}{m} \\sum_{i=1}^{m}a_i^2 & \\frac{1}{m} \\sum_{i=1}^{m}a_ib_i \\\\\\\\\n\\frac{1}{m} \\sum_{i=1}^{m}a_ib_i & \\frac{1}{m} \\sum_{i=1}^{m}b_i^2 \\\\\n\\end{pmatrix}$$\n\n奇迹出现了！这个矩阵对角线上的两个元素分别是两个字段的方差，而其它元素是a和b的协方差。两者被统一到了一个矩阵的。\n\n根据矩阵相乘的运算法则，这个结论很容易被推广到一般情况：\n\n**设我们有m个n维数据记录，将其按列排成n乘m的矩阵X，设 $C = \\frac{1}{m}XX^T$,则C是一个对称矩阵，其对角线分别个各个字段的方差，而第i行j列和j行i列元素相同，表示i和j两个字段的协方差。**\n\n### 协方差矩阵对角化\n\n根据上述推导，我们发现要达到优化目前，等价于将协方差矩阵对角化：即除对角线外的其它元素化为0，并且在对角线上将元素按大小从上到下排列，这样我们就达到了优化目的。这样说可能还不是很明晰，我们进一步看下原矩阵与基变换后矩阵协方差矩阵的关系：\n\n设原始数据矩阵X对应的协方差矩阵为C，而P是一组基按行组成的矩阵，设Y=PX，则Y为X对P做基变换后的数据。设Y的协方差矩阵为D，我们推导一下D与C的关系：\n$$\\begin{align}\nD &= \\frac{1}{m}YY^T \\\\\\\\\n  &= \\frac{1}{m}(PX)(PX)^T \\\\\\\\\n  &= \\frac{1}{m}PXX^T P^T \\\\\\\\\n  &= P(\\frac{1}{m}XX^T)P^T \\\\\\\\\n  &= PCP^T\n\\end{align}$$\n\n现在事情很明白了！我们要找的P不是别的，而是能让原始协方差矩阵对角化的P。换句话说，优化目标变成了寻找一个矩阵P，满足 $PCP^T$ 是一个对角矩阵，并且对角元素按从大到小依次排列，那么P的前K行就是要寻找的基，用P的前K行组成的矩阵乘以X就使得X从N维降到了K维并满足上述优化条件。    \n现在所有焦点都聚焦在了协方差矩阵对角化问题上，有时，我们真应该感谢数学家的先行，因为矩阵对角化在线性代数领域已经属于被玩烂了的东西，所以这在数学上根本不是问题。\n\n由上文知道，协方差矩阵C是一个是对称矩阵，在线性代数上，实对称矩阵有一系列非常好的性质：\n1. 实对称矩阵不同特征值对应的特征向量必然正交\n2. 设特征向量λ重数为r，则必然存在r个线性无关的特征向量对应于λ，因此可以将这r个特征向量单位正交化。    \n由上面两条可知，一个n行n列的实对称矩阵一定可以找到n个单位正交特征向量，设这n个特征向量为 $e_1,e_2,\\dots,e_n,$ 我们将其按列组成矩阵：\n$$E = \\begin{pmatrix}\ne_1 & e_2 & \\dots & e_n \\\\\n\\end{pmatrix}$$\n则对协方差矩阵C有如下结论：\n$$E_TCE = \\Lambda = \\begin{pmatrix}\n\\lambda_1 & & & \\\\\\\\\n & \\lambda_2 & & \\\\\\\\\n & & \\ddots & \\\\\\\\\n & & & \\lambda_n \\\\\n \\end{pmatrix}$$\n其中 $Lambda$为对角矩阵，其对角元素为各特征向量对应的特征值（可能有重复）。\n\n以上结论不再给出严格的数学证明，对证明感兴趣的朋友可以参考线性代数书籍关于“实对称矩阵对角化”的内容。\n\n到这里，我们发现我们已经找到了需要的矩阵P：\n$$P = E^T$$\n\nP是协方差矩阵的特征向量单位化后按行排列出的矩阵，其中每一行都是C的一个特征向量。如果设P按照Λ中特征值的从大到小，将特征向量从上到下排列，则用P的前K行组成的矩阵乘以原始数据矩阵X，就得到了我们需要的降维后的数据矩阵Y。\n","slug":"PCA原理分析","published":1,"updated":"2020-02-24T10:49:41.378Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0te001m74jumo69b3ho","content":"<p>参考资料<br><a href=\"PCA.pdf\">PCA原理分析</a></p>\n<h1 id=\"PCA的数学原理\"><a href=\"#PCA的数学原理\" class=\"headerlink\" title=\"PCA的数学原理\"></a>PCA的数学原理</h1><p>PCA（Principal Component Analysis）是一种常用的数据分析方法。PCA通过线性变换将原始数据变换为一组各维度线性无关的表示，可用于提取数据的主要特征分量，常用于高维数据的降维。</p>\n<h2 id=\"数据的向量表示以及降维问题\"><a href=\"#数据的向量表示以及降维问题\" class=\"headerlink\" title=\"数据的向量表示以及降维问题\"></a>数据的向量表示以及降维问题</h2><p>一般情况下，在数据挖掘和机器学习中，数据被表示为向量。例如某个外卖商家2018年全年的流量及交易记录可以看成是一组数据的集合，其中每一天的数据是一条记录。记录的格式如下:<br>(日期, 浏览量，访客数，下单数，成交数，成交金额)<br>其中”日期”是一个记录标志而非度量值，而数据挖掘关心的大多是度量值，因此如果我们忽略日期这个字段后，我们得到一组记录，每条记录可以被表示为一个五维向量，其中一条看起来大约是这个样子：<br>$$(1000, 580, 300, 240, 3000)^T$$<br>注意这里用了转置，习惯上使用列向量来表示一条记录。本文说到的向量默认都是列向量。    </p>\n<p>我们当然可以对这一组五维向量进行分析和挖掘，不过很多机器学习算法的复杂度和数据的维数有着密切关系，甚至与维数呈指数级关联。当然，这里区区五维的数据，也许还无所谓，但是实际机器学习中处理成千上万甚至几十万维的情况也并不罕见，在这种情况下，机器学习的资源消耗是不可接受的，因此我们必须对数据进行降维。</p>\n<p>降维当然意味着信息的丢失，不过鉴于实际数据本身常常存在的相关性，我们可以想办法在降维的同时将信息的损失尽量降低。    </p>\n<p>举一个例子，假如某学籍数据有两列M和F，其中M列的取值是如何此学生为男性取值1，为女性取值0；而F列是学生为女性取值1，男性取值0。此时如果我们统计全部学籍数据，会发现对于任何一条记录来说，当M为1时F必定为0，反之当M为0时F必定为1。在这种情况下，我们将M或F去掉实际上没有任何信息的损失，因为只要保留一列就可以完全还原另一列。<br>当然上面是一个极端的情况，在现实中也许不会出现，不过类似的情况还是很常见的。例如上面淘宝店铺的数据，从经验我们可以知道，“浏览量”和“访客数”往往具有较强的相关关系，而“下单数”和“成交数”也具有较强的相关关系。这里我们非正式的使用“ <strong>相关关系</strong>”这个词，可以直观理解为“当某一天这个店铺的浏览量较高（或较低）时，我们应该很大程度上认为这天的访客数也较高（或较低）”。<br>这种情况表明，如果我们删除浏览量或访客数其中一个指标，我们应该期待并不会丢失太多信息。因此我们可以删除一个，以降低机器学习算法的复杂度。    </p>\n<p>上面给出的是降维的朴素思想描述，可以有助于直观理解降维的动机和可行性，但并不具有操作指导意义。例如，我们到底删除哪一列损失的信息才最小？亦或根本不是单纯删除几列，而是通过某些变换将原始数据变为更少的列但又使得丢失的信息最小？到底如何度量丢失信息的多少？如何根据原始数据决定具体的降维操作步骤？下面对降维问题进行数学化和形式化的讨论</p>\n<h2 id=\"向量的表示及基变换\"><a href=\"#向量的表示及基变换\" class=\"headerlink\" title=\"向量的表示及基变换\"></a>向量的表示及基变换</h2><h3 id=\"内积与投影\"><a href=\"#内积与投影\" class=\"headerlink\" title=\"内积与投影\"></a>内积与投影</h3><p>下面先来看一个高中就学过的向量运算：内积。两个维数相同的向量的内积被定义为：</p>\n<p>$$(a_1, a_2, \\dots ,a_n)^T \\cdot (b_1, b_2, \\dots , b_n)^T = a_1b_1 + a_2b_2 + \\dots + a_nb_n)$$<br>内积运算将两个向量映射为一个实数。其计算方式非常容易理解，但是其意义并不明显。下面我们分析内积的几何意义。假设A和B是两个n维向量，我们知道n维向量可以等价表示为n维空间中的一条从原点发射的有向线段，为了简单起见我们假设A和B均为二维向量,则 $A = (x_1,y_1)$, $B = (x_2,y_2)$. 则在二维平面上A和B可以用两条发自原点的有向线段表示，见下图：<br><img src=\"01.png\" alt><br>好，现在我们从A点向B所在直线引一条垂线。我们知道垂线与B的交点叫做A在B上的投影，再设A与B的夹角是a，则投影的矢量长度为|A|cos(a),其中 $|A| = \\sqrt{x_1^2 + y_1^2}$ 是向量A的模，也就是A线段的标量长度。<br>注意这里我们专门区分了矢量长度和标量长度，标量长度总是大于等于0，值就是线段的长度；而矢量长度可能为负，其绝对值是线段长度，而符号取决于其方向与标准方向相同或相反。<br>到这里还是看不出内积和这东西有什么关系，不过如果我们将内积表示为另一种我们熟悉的形式：<br>$$ A \\cdot B = |A||B|cos(a)$$</p>\n<p>现在事情似乎是有点眉目了：A与B的内积等于A到B的投影长度乘以B的模。再进一步，如果我们假设B的模为1，即让|B|=1，那么就变成了：<br>$$A \\cdot B = |A|cos(a)$$<br>也就是说， <strong>设向量B的模为1，则A与B的内积值等于A向B所在直线投影的矢量长度！</strong>这就是内积的一种几何解释，也是我们得到的第一个重要结论。在后面的推导中，将反复使用这个结论。</p>\n<h3 id=\"基\"><a href=\"#基\" class=\"headerlink\" title=\"基\"></a>基</h3><p>下面我们继续在二维空间内讨论向量。上文说过，一个二维向量可以对应二维笛卡尔直角坐标系中从原点出发的一个有向线段。例如下面这个向量：<br><img src=\"02.png\" alt><br>在代数表示方面，我们经常用线段终点的点坐标表示向量，例如上面的向量可以表示为(3,2)，这是我们再熟悉不过的向量表示。<br>不过我们常常忽略， <strong>只有一个(3,2)本身是不能够精确表示一个向量的</strong>。我们仔细看一下，这里的3实际表示的是向量在x轴上的投影值是3，在y轴上的投影值是2。也就是说我们其实隐式引入了一个定义：以x轴和y轴上正方向长度为1的向量为标准。那么一个向量(3,2)实际是说在x轴投影为3而y轴的投影为2。注意投影是一个矢量，所以可以为负。<br>更正式的说，向量(x,y)实际上表示线性组合：<br>$$x(1,0)^T + y(0,1)^T$$<br>不难证明所有二维向量都可以表示为这样的线性组合。此处(1,0)和(0,1)叫做二维空间中的一组基。<br><img src=\"03.png\" alt><br>所以， <strong>要准确描述向量，首先要确定一组基，然后给出在基所在的各个直线上的投影值，就可以了</strong>。只不过我们经常省略第一步，而默认以(1,0)和(0,1)为基。<br>我们之所以默认选择(1,0)和(0,1)为基，当然是比较方便，因为它们分别是x和y轴正方向上的单位向量，因此就使得二维平面上点坐标和向量一一对应，非常方便。但实际上任何两个线性无关的二维向量都可以成为一组基，所谓线性无关在二维平面内可以直观认为是两个不在一条直线上的向量。    </p>\n<p>例如，(1,1)和(-1,1)也可以成为一组基。一般来说，我们希望基的模是1，因为从内积的意义可以看到，如果基的模是1，那么就可以方便的用向量点乘基而直接获得其在新基上的坐标了！实际上，对应任何一个向量我们总可以找到其同方向上模为1的向量，只要让两个分量分别除以模就好了。例如，上面的基可以变为 $(\\frac{1}{\\sqrt 2},\\frac{1}{\\sqrt 2})$ 和 $(\\frac{-1}{\\sqrt 2},\\frac{1}{\\sqrt 2})$.<br>现在，我们想获得(3,2)在新基上的坐标，即在两个方向上的投影矢量值，那么根据内积的几何意义，我们只要分别计算(3,2)和两个基的内积，不难得到新的坐标为 $(\\frac{5}{\\sqrt 2},\\frac{-1}{\\sqrt 2})$。下图给出了新的基以及(3,2)在新基上坐标值的示意图：<br><img src=\"05.png\" alt><br>一要求就是线性无关，非正交的基也是可以的。不过因为正交基有较好的性质，所以一般使用的基都是正交的。</p>\n<h3 id=\"基变换的矩阵表示\"><a href=\"#基变换的矩阵表示\" class=\"headerlink\" title=\"基变换的矩阵表示\"></a>基变换的矩阵表示</h3><p>下面我们找一种简便的方式来表示基变换。还是拿上面的例子，想一下，将(3,2)变换为新基上的坐标，就是用(3,2)与第一个基做内积运算，作为第一个新的坐标分量，然后用(3,2)与第二个基做内积运算，作为第二个新坐标的分量。实际上，我们可以用矩阵相乘的形式简洁的表示这个变换：<br>$$\\begin{pmatrix}<br>1/ \\sqrt 2 &amp; 1/ \\sqrt 2 \\\\\\<br>-1/ \\sqrt 2 &amp; 1/ \\sqrt 2 \\<br>\\end{pmatrix}<br>\\begin{pmatrix}<br>3 \\\\\\<br>2 \\<br>\\end{pmatrix} = \\begin{pmatrix}<br>5 / \\sqrt 2 \\\\\\<br>-1/ \\sqrt 2 \\<br>\\end{pmatrix}$$</p>\n<p>太漂亮了！其中矩阵的两行分别为两个基，乘以原向量，其结果刚好为新基的坐标。可以稍微推广一下，如果我们有m个二维向量，只要将二维向量按列排成一个两行m列矩阵，然后用“基矩阵”乘以这个矩阵，就得到了所有这些向量在新基下的值。例如 $(1,1)，(2,2)，(3,3)$，想变换到刚才那组基上，则可以这样表示：</p>\n<p>$$\\begin{pmatrix}<br>1 / \\sqrt 2 &amp; 1/ \\sqrt 2 \\\\\\<br>-1 / \\sqrt 2 &amp; 1/ \\sqrt 2 \\<br>\\end{pmatrix}<br>\\begin{pmatrix}<br>1 &amp; 2 &amp; 3 \\\\\\<br>1 &amp; 2 &amp; 3 \\<br>\\end{pmatrix} = \\begin{pmatrix}<br>2 / \\sqrt 2 &amp; 4 / \\sqrt 2 &amp; 6 / \\sqrt 2 \\\\\\<br>0 &amp; 0 &amp; 0 \\<br>\\end{pmatrix}$$</p>\n<p>于是一组向量的基变换被干净的表示为矩阵的相乘。<br><strong>一般的，如果我们有M个N维向量，想将其变换为由R个N维向量表示的新空间中，那么首先将R个基按行组成矩阵A，然后将向量按列组成矩阵B，那么两矩阵的乘积AB就是变换结果，其中AB的第m列为A中第m列变换后的结果。</strong><br>数学表示为：<br>$$\\begin{pmatrix}<br>p_1 \\\\\\<br>p_2 \\\\\\<br>\\vdots \\\\\\<br>p_R \\<br>\\end{pmatrix}<br>\\begin{pmatrix}<br>a_1 &amp; a_2 &amp; \\dots &amp; a_M \\<br>\\end{pmatrix} = \\begin{pmatrix}<br>p_1a_1 &amp; p_1a_2 &amp; \\dots &amp; p_1a_M \\\\\\<br>p_2a_1 &amp; p_2a_2 &amp; \\dots &amp; p_2a_M \\\\\\<br>\\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\\\<br>p_Ra_1 &amp; p_Ra_2 &amp; \\dots &amp; p_Ra_M \\<br>\\end{pmatrix}$$<br>其中 $p_i$是一个行向量，表示第i个基， $a_j$是一个列向量，表示第j个原始数据记录。<br>特别要注意的是，这里R可以小于N，而R决定了变换后数据的维数。也就是说，我们可以将一N维数据变换到更低维度的空间中去，变换后的维度取决于基的数量。因此这种矩阵相乘的表示也可以表示降维变换。<br>最后，上述分析同时给矩阵相乘找到了一种物理解释： <strong>两个矩阵相乘的意义是将右边矩阵中的每一列列向量变换到左边矩阵中每一行行向量为基所表示的空间中去</strong>。更抽象的说，一个矩阵可以表示一种线性变换。很多同学在学线性代数时对矩阵相乘的方法感到奇怪，但是如果明白了矩阵相乘的物理意义，其合理性就一目了然了。    </p>\n<h3 id=\"协方差矩阵及优化目标\"><a href=\"#协方差矩阵及优化目标\" class=\"headerlink\" title=\"协方差矩阵及优化目标\"></a>协方差矩阵及优化目标</h3><p>上面我们讨论了选择不同的基可以对同样一组数据给出不同的表示，而且如果基的数量少于向量本身的维数，则可以达到降维的效果。但是我们还没有回答一个最最关键的问题：如何选择基才是最优的。或者说，如果我们有一组N维向量，现在要将其降到K维（K小于N），那么我们应该如何选择K个基才能最大程度保留原有的信息？<br>要完全数学化这个问题非常繁杂，这里我们用一种非形式化的直观方法来看这个问题。</p>\n<p>为了避免过于抽象的讨论，我们仍以一个具体的例子展开。假设我们的数据由五条记录组成，将它们表示成矩阵形式：<br>$$ \\begin{pmatrix}<br>1 &amp; 1 &amp;2 &amp; 4 &amp; 2 \\\\\\<br>1 &amp; 3 &amp; 3 &amp; 4 &amp; 4 \\<br>\\end{pmatrix}$$<br>其中每一列为一条数据记录，而一行为一个字段。为了后续处理方便，我们首先将每个字段内所有值都减去字段均值，其结果是将每个字段都变为均值为0（这样做的道理和好处后面会看到）。<br>我们看上面的数据，第一个字段均值为2，第二个字段均值为3，所以变换后：<br>$$ \\begin{pmatrix}<br>-1 &amp; -1 &amp; 0 &amp; 2 &amp; 0 \\\\\\<br>-2 &amp; 0 &amp; 0 &amp; 1 &amp; 1 \\<br>\\end{pmatrix}$$<br>我们可以看下五条数据在平面直角坐标系内的样子：<br><img src=\"06.png\" alt><br>现在问题来了：如果我们必须使用一维来表示这些数据，又希望尽量保留原始的信息，你要如何选择？    </p>\n<p>通过上一节对基变换的讨论我们知道，这个问题实际上是要在二维平面中选择一个方向，将所有数据都投影到这个方向所在直线上，用投影值表示原始记录。这是一个实际的二维降到一维的问题。    </p>\n<p>那么如何选择这个方向（或者说基）才能尽量保留最多的原始信息呢？一种直观的看法是：希望投影后的投影值尽可能分散。    </p>\n<p>以上图为例，可以看出如果向x轴投影，那么最左边的两个点会重叠在一起，中间的两个点也会重叠在一起，于是本身四个各不相同的二维点投影后只剩下两个不同的值了，这是一种严重的信息丢失，同理，如果向y轴投影最上面的两个点和分布在x轴上的两个点也会重叠。所以看来x和y轴都不是最好的投影选择。我们直观目测，如果向通过第一象限和第三象限的斜线投影，则五个点在投影后还是可以区分的。<br>下面，我们用数学方法表述这个问题。</p>\n<h3 id=\"方差\"><a href=\"#方差\" class=\"headerlink\" title=\"方差\"></a>方差</h3><p>上文说到，我们希望投影后投影值尽可能分散，而这种分散程度，可以用数学上的方差来表述。此处，一个字段的方差可以看做是每个元素与字段均值的差的平方和的均值，即：<br>$$Var(a)=\\frac{1}{m} \\sum_{i=1}^{m}(a_i- \\mu)^2$$<br>由于上面我们已经将每个字段的均值都化为0了，因此方差可以直接用每个元素的平方和除以元素个数表示：<br>$$Var(a) = \\frac{1}{m} \\sum_{i=1}^{m}a_i^2$$<br>于是上面的问题被形式化表述为：寻找一个一维基，使得所有数据变换为这个基上的坐标表示后，方差值最大。    </p>\n<h3 id=\"协方差\"><a href=\"#协方差\" class=\"headerlink\" title=\"协方差\"></a>协方差</h3><p>对于上面二维降成一维的问题来说，找到那个使得方差最大的方向就可以了。不过对于更高维，还有一个问题需要解决。考虑三维降到二维问题。与之前相同，首先我们希望找到一个方向使得投影后方差最大，这样就完成了第一个方向的选择，继而我们选择第二个投影方向。<br>如果我们还是单纯只选择方差最大的方向，很明显，这个方向与第一个方向应该是“几乎重合在一起”，显然这样的维度是没有用的，因此，应该有其他约束条件。从直观上说，让两个字段尽可能表示更多的原始信息，我们是不希望它们之间存在（线性）相关性的，因为相关性意味着两个字段不是完全独立，必然存在重复表示的信息。<br>数学上可以用两个字段的协方差表示其相关性，由于已经让每个字段均值为0，则：<br>$$Cov(a,b)=\\frac{1}{m} \\sum_{i=1}^{m}a_ib_i$$<br>可以看到，在字段均值为0的情况下，两个字段的协方差简洁的表示为其内积除以元素数m。</p>\n<p>当协方差为0时，表示两个字段完全独立。为了让协方差为0，我们选择第二个基时只能在与第一个基正交的方向上选择。因此最终选择的两个方向一定是正交的。</p>\n<p>至此，我们得到了降维问题的优化目标：<strong>将一组N维向量降为K维（K大于0，小于N），其目标是选择K个单位（模为1）正交基，使得原始数据变换到这组基上后，各字段两两间协方差为0，而字段的方差则尽可能大（在正交的约束下，取最大的K个方差）</strong>。</p>\n<h3 id=\"协方差矩阵\"><a href=\"#协方差矩阵\" class=\"headerlink\" title=\"协方差矩阵\"></a>协方差矩阵</h3><p>上面我们导出了优化目标，但是这个目标似乎不能直接作为操作指南（或者说算法），因为它只说要什么，但根本没有说怎么做。所以我们要继续在数学上研究计算方案。</p>\n<p>我们看到，最终要达到的目的与字段内方差及字段间协方差有密切关系。因此我们希望能将两者统一表示，仔细观察发现，两者均可以表示为内积的形式，而内积又与矩阵相乘密切相关。于是我们来了灵感：</p>\n<p>假设我们只有a和b两个字段，那么我们将它们按行组成矩阵X：</p>\n<p>$$ X = \\begin{pmatrix}<br>a_1 &amp; a_2 &amp; \\dots &amp; a_m \\\\\\<br>b_1 &amp; b_2 &amp; \\dots &amp; b_m \\<br>\\end{pmatrix}$$<br>然后我们用X乘以X的转置，并乘上系数 $\\frac{1}{m}$：<br>$$\\frac{1}{m} \\begin{pmatrix}<br>\\frac{1}{m} \\sum_{i=1}^{m}a_i^2 &amp; \\frac{1}{m} \\sum_{i=1}^{m}a_ib_i \\\\\\<br>\\frac{1}{m} \\sum_{i=1}^{m}a_ib_i &amp; \\frac{1}{m} \\sum_{i=1}^{m}b_i^2 \\<br>\\end{pmatrix}$$</p>\n<p>奇迹出现了！这个矩阵对角线上的两个元素分别是两个字段的方差，而其它元素是a和b的协方差。两者被统一到了一个矩阵的。</p>\n<p>根据矩阵相乘的运算法则，这个结论很容易被推广到一般情况：</p>\n<p><strong>设我们有m个n维数据记录，将其按列排成n乘m的矩阵X，设 $C = \\frac{1}{m}XX^T$,则C是一个对称矩阵，其对角线分别个各个字段的方差，而第i行j列和j行i列元素相同，表示i和j两个字段的协方差。</strong></p>\n<h3 id=\"协方差矩阵对角化\"><a href=\"#协方差矩阵对角化\" class=\"headerlink\" title=\"协方差矩阵对角化\"></a>协方差矩阵对角化</h3><p>根据上述推导，我们发现要达到优化目前，等价于将协方差矩阵对角化：即除对角线外的其它元素化为0，并且在对角线上将元素按大小从上到下排列，这样我们就达到了优化目的。这样说可能还不是很明晰，我们进一步看下原矩阵与基变换后矩阵协方差矩阵的关系：</p>\n<p>设原始数据矩阵X对应的协方差矩阵为C，而P是一组基按行组成的矩阵，设Y=PX，则Y为X对P做基变换后的数据。设Y的协方差矩阵为D，我们推导一下D与C的关系：<br>$$\\begin{align}<br>D &amp;= \\frac{1}{m}YY^T \\\\\\<br>  &amp;= \\frac{1}{m}(PX)(PX)^T \\\\\\<br>  &amp;= \\frac{1}{m}PXX^T P^T \\\\\\<br>  &amp;= P(\\frac{1}{m}XX^T)P^T \\\\\\<br>  &amp;= PCP^T<br>\\end{align}$$</p>\n<p>现在事情很明白了！我们要找的P不是别的，而是能让原始协方差矩阵对角化的P。换句话说，优化目标变成了寻找一个矩阵P，满足 $PCP^T$ 是一个对角矩阵，并且对角元素按从大到小依次排列，那么P的前K行就是要寻找的基，用P的前K行组成的矩阵乘以X就使得X从N维降到了K维并满足上述优化条件。<br>现在所有焦点都聚焦在了协方差矩阵对角化问题上，有时，我们真应该感谢数学家的先行，因为矩阵对角化在线性代数领域已经属于被玩烂了的东西，所以这在数学上根本不是问题。</p>\n<p>由上文知道，协方差矩阵C是一个是对称矩阵，在线性代数上，实对称矩阵有一系列非常好的性质：</p>\n<ol>\n<li>实对称矩阵不同特征值对应的特征向量必然正交</li>\n<li>设特征向量λ重数为r，则必然存在r个线性无关的特征向量对应于λ，因此可以将这r个特征向量单位正交化。<br>由上面两条可知，一个n行n列的实对称矩阵一定可以找到n个单位正交特征向量，设这n个特征向量为 $e_1,e_2,\\dots,e_n,$ 我们将其按列组成矩阵：<br>$$E = \\begin{pmatrix}<br>e_1 &amp; e_2 &amp; \\dots &amp; e_n \\<br>\\end{pmatrix}$$<br>则对协方差矩阵C有如下结论：<br>$$E_TCE = \\Lambda = \\begin{pmatrix}<br>\\lambda_1 &amp; &amp; &amp; \\\\\\<br>&amp; \\lambda_2 &amp; &amp; \\\\\\<br>&amp; &amp; \\ddots &amp; \\\\\\<br>&amp; &amp; &amp; \\lambda_n \\<br>\\end{pmatrix}$$<br>其中 $Lambda$为对角矩阵，其对角元素为各特征向量对应的特征值（可能有重复）。</li>\n</ol>\n<p>以上结论不再给出严格的数学证明，对证明感兴趣的朋友可以参考线性代数书籍关于“实对称矩阵对角化”的内容。</p>\n<p>到这里，我们发现我们已经找到了需要的矩阵P：<br>$$P = E^T$$</p>\n<p>P是协方差矩阵的特征向量单位化后按行排列出的矩阵，其中每一行都是C的一个特征向量。如果设P按照Λ中特征值的从大到小，将特征向量从上到下排列，则用P的前K行组成的矩阵乘以原始数据矩阵X，就得到了我们需要的降维后的数据矩阵Y。</p>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<p>参考资料<br><a href=\"PCA.pdf\">PCA原理分析</a></p>\n<h1 id=\"PCA的数学原理\"><a href=\"#PCA的数学原理\" class=\"headerlink\" title=\"PCA的数学原理\"></a>PCA的数学原理</h1><p>PCA（Principal Component Analysis）是一种常用的数据分析方法。PCA通过线性变换将原始数据变换为一组各维度线性无关的表示，可用于提取数据的主要特征分量，常用于高维数据的降维。</p>\n<h2 id=\"数据的向量表示以及降维问题\"><a href=\"#数据的向量表示以及降维问题\" class=\"headerlink\" title=\"数据的向量表示以及降维问题\"></a>数据的向量表示以及降维问题</h2><p>一般情况下，在数据挖掘和机器学习中，数据被表示为向量。例如某个外卖商家2018年全年的流量及交易记录可以看成是一组数据的集合，其中每一天的数据是一条记录。记录的格式如下:<br>(日期, 浏览量，访客数，下单数，成交数，成交金额)<br>其中”日期”是一个记录标志而非度量值，而数据挖掘关心的大多是度量值，因此如果我们忽略日期这个字段后，我们得到一组记录，每条记录可以被表示为一个五维向量，其中一条看起来大约是这个样子：<br>$$(1000, 580, 300, 240, 3000)^T$$<br>注意这里用了转置，习惯上使用列向量来表示一条记录。本文说到的向量默认都是列向量。    </p>\n<p>我们当然可以对这一组五维向量进行分析和挖掘，不过很多机器学习算法的复杂度和数据的维数有着密切关系，甚至与维数呈指数级关联。当然，这里区区五维的数据，也许还无所谓，但是实际机器学习中处理成千上万甚至几十万维的情况也并不罕见，在这种情况下，机器学习的资源消耗是不可接受的，因此我们必须对数据进行降维。</p>\n<p>降维当然意味着信息的丢失，不过鉴于实际数据本身常常存在的相关性，我们可以想办法在降维的同时将信息的损失尽量降低。    </p>\n<p>举一个例子，假如某学籍数据有两列M和F，其中M列的取值是如何此学生为男性取值1，为女性取值0；而F列是学生为女性取值1，男性取值0。此时如果我们统计全部学籍数据，会发现对于任何一条记录来说，当M为1时F必定为0，反之当M为0时F必定为1。在这种情况下，我们将M或F去掉实际上没有任何信息的损失，因为只要保留一列就可以完全还原另一列。<br>当然上面是一个极端的情况，在现实中也许不会出现，不过类似的情况还是很常见的。例如上面淘宝店铺的数据，从经验我们可以知道，“浏览量”和“访客数”往往具有较强的相关关系，而“下单数”和“成交数”也具有较强的相关关系。这里我们非正式的使用“ <strong>相关关系</strong>”这个词，可以直观理解为“当某一天这个店铺的浏览量较高（或较低）时，我们应该很大程度上认为这天的访客数也较高（或较低）”。<br>这种情况表明，如果我们删除浏览量或访客数其中一个指标，我们应该期待并不会丢失太多信息。因此我们可以删除一个，以降低机器学习算法的复杂度。    </p>\n<p>上面给出的是降维的朴素思想描述，可以有助于直观理解降维的动机和可行性，但并不具有操作指导意义。例如，我们到底删除哪一列损失的信息才最小？亦或根本不是单纯删除几列，而是通过某些变换将原始数据变为更少的列但又使得丢失的信息最小？到底如何度量丢失信息的多少？如何根据原始数据决定具体的降维操作步骤？下面对降维问题进行数学化和形式化的讨论</p>\n<h2 id=\"向量的表示及基变换\"><a href=\"#向量的表示及基变换\" class=\"headerlink\" title=\"向量的表示及基变换\"></a>向量的表示及基变换</h2><h3 id=\"内积与投影\"><a href=\"#内积与投影\" class=\"headerlink\" title=\"内积与投影\"></a>内积与投影</h3><p>下面先来看一个高中就学过的向量运算：内积。两个维数相同的向量的内积被定义为：</p>\n<p>$$(a_1, a_2, \\dots ,a_n)^T \\cdot (b_1, b_2, \\dots , b_n)^T = a_1b_1 + a_2b_2 + \\dots + a_nb_n)$$<br>内积运算将两个向量映射为一个实数。其计算方式非常容易理解，但是其意义并不明显。下面我们分析内积的几何意义。假设A和B是两个n维向量，我们知道n维向量可以等价表示为n维空间中的一条从原点发射的有向线段，为了简单起见我们假设A和B均为二维向量,则 $A = (x_1,y_1)$, $B = (x_2,y_2)$. 则在二维平面上A和B可以用两条发自原点的有向线段表示，见下图：<br><img src=\"01.png\" alt><br>好，现在我们从A点向B所在直线引一条垂线。我们知道垂线与B的交点叫做A在B上的投影，再设A与B的夹角是a，则投影的矢量长度为|A|cos(a),其中 $|A| = \\sqrt{x_1^2 + y_1^2}$ 是向量A的模，也就是A线段的标量长度。<br>注意这里我们专门区分了矢量长度和标量长度，标量长度总是大于等于0，值就是线段的长度；而矢量长度可能为负，其绝对值是线段长度，而符号取决于其方向与标准方向相同或相反。<br>到这里还是看不出内积和这东西有什么关系，不过如果我们将内积表示为另一种我们熟悉的形式：<br>$$ A \\cdot B = |A||B|cos(a)$$</p>\n<p>现在事情似乎是有点眉目了：A与B的内积等于A到B的投影长度乘以B的模。再进一步，如果我们假设B的模为1，即让|B|=1，那么就变成了：<br>$$A \\cdot B = |A|cos(a)$$<br>也就是说， <strong>设向量B的模为1，则A与B的内积值等于A向B所在直线投影的矢量长度！</strong>这就是内积的一种几何解释，也是我们得到的第一个重要结论。在后面的推导中，将反复使用这个结论。</p>\n<h3 id=\"基\"><a href=\"#基\" class=\"headerlink\" title=\"基\"></a>基</h3><p>下面我们继续在二维空间内讨论向量。上文说过，一个二维向量可以对应二维笛卡尔直角坐标系中从原点出发的一个有向线段。例如下面这个向量：<br><img src=\"02.png\" alt><br>在代数表示方面，我们经常用线段终点的点坐标表示向量，例如上面的向量可以表示为(3,2)，这是我们再熟悉不过的向量表示。<br>不过我们常常忽略， <strong>只有一个(3,2)本身是不能够精确表示一个向量的</strong>。我们仔细看一下，这里的3实际表示的是向量在x轴上的投影值是3，在y轴上的投影值是2。也就是说我们其实隐式引入了一个定义：以x轴和y轴上正方向长度为1的向量为标准。那么一个向量(3,2)实际是说在x轴投影为3而y轴的投影为2。注意投影是一个矢量，所以可以为负。<br>更正式的说，向量(x,y)实际上表示线性组合：<br>$$x(1,0)^T + y(0,1)^T$$<br>不难证明所有二维向量都可以表示为这样的线性组合。此处(1,0)和(0,1)叫做二维空间中的一组基。<br><img src=\"03.png\" alt><br>所以， <strong>要准确描述向量，首先要确定一组基，然后给出在基所在的各个直线上的投影值，就可以了</strong>。只不过我们经常省略第一步，而默认以(1,0)和(0,1)为基。<br>我们之所以默认选择(1,0)和(0,1)为基，当然是比较方便，因为它们分别是x和y轴正方向上的单位向量，因此就使得二维平面上点坐标和向量一一对应，非常方便。但实际上任何两个线性无关的二维向量都可以成为一组基，所谓线性无关在二维平面内可以直观认为是两个不在一条直线上的向量。    </p>\n<p>例如，(1,1)和(-1,1)也可以成为一组基。一般来说，我们希望基的模是1，因为从内积的意义可以看到，如果基的模是1，那么就可以方便的用向量点乘基而直接获得其在新基上的坐标了！实际上，对应任何一个向量我们总可以找到其同方向上模为1的向量，只要让两个分量分别除以模就好了。例如，上面的基可以变为 $(\\frac{1}{\\sqrt 2},\\frac{1}{\\sqrt 2})$ 和 $(\\frac{-1}{\\sqrt 2},\\frac{1}{\\sqrt 2})$.<br>现在，我们想获得(3,2)在新基上的坐标，即在两个方向上的投影矢量值，那么根据内积的几何意义，我们只要分别计算(3,2)和两个基的内积，不难得到新的坐标为 $(\\frac{5}{\\sqrt 2},\\frac{-1}{\\sqrt 2})$。下图给出了新的基以及(3,2)在新基上坐标值的示意图：<br><img src=\"05.png\" alt><br>一要求就是线性无关，非正交的基也是可以的。不过因为正交基有较好的性质，所以一般使用的基都是正交的。</p>\n<h3 id=\"基变换的矩阵表示\"><a href=\"#基变换的矩阵表示\" class=\"headerlink\" title=\"基变换的矩阵表示\"></a>基变换的矩阵表示</h3><p>下面我们找一种简便的方式来表示基变换。还是拿上面的例子，想一下，将(3,2)变换为新基上的坐标，就是用(3,2)与第一个基做内积运算，作为第一个新的坐标分量，然后用(3,2)与第二个基做内积运算，作为第二个新坐标的分量。实际上，我们可以用矩阵相乘的形式简洁的表示这个变换：<br>$$\\begin{pmatrix}<br>1/ \\sqrt 2 &amp; 1/ \\sqrt 2 \\\\\\<br>-1/ \\sqrt 2 &amp; 1/ \\sqrt 2 \\<br>\\end{pmatrix}<br>\\begin{pmatrix}<br>3 \\\\\\<br>2 \\<br>\\end{pmatrix} = \\begin{pmatrix}<br>5 / \\sqrt 2 \\\\\\<br>-1/ \\sqrt 2 \\<br>\\end{pmatrix}$$</p>\n<p>太漂亮了！其中矩阵的两行分别为两个基，乘以原向量，其结果刚好为新基的坐标。可以稍微推广一下，如果我们有m个二维向量，只要将二维向量按列排成一个两行m列矩阵，然后用“基矩阵”乘以这个矩阵，就得到了所有这些向量在新基下的值。例如 $(1,1)，(2,2)，(3,3)$，想变换到刚才那组基上，则可以这样表示：</p>\n<p>$$\\begin{pmatrix}<br>1 / \\sqrt 2 &amp; 1/ \\sqrt 2 \\\\\\<br>-1 / \\sqrt 2 &amp; 1/ \\sqrt 2 \\<br>\\end{pmatrix}<br>\\begin{pmatrix}<br>1 &amp; 2 &amp; 3 \\\\\\<br>1 &amp; 2 &amp; 3 \\<br>\\end{pmatrix} = \\begin{pmatrix}<br>2 / \\sqrt 2 &amp; 4 / \\sqrt 2 &amp; 6 / \\sqrt 2 \\\\\\<br>0 &amp; 0 &amp; 0 \\<br>\\end{pmatrix}$$</p>\n<p>于是一组向量的基变换被干净的表示为矩阵的相乘。<br><strong>一般的，如果我们有M个N维向量，想将其变换为由R个N维向量表示的新空间中，那么首先将R个基按行组成矩阵A，然后将向量按列组成矩阵B，那么两矩阵的乘积AB就是变换结果，其中AB的第m列为A中第m列变换后的结果。</strong><br>数学表示为：<br>$$\\begin{pmatrix}<br>p_1 \\\\\\<br>p_2 \\\\\\<br>\\vdots \\\\\\<br>p_R \\<br>\\end{pmatrix}<br>\\begin{pmatrix}<br>a_1 &amp; a_2 &amp; \\dots &amp; a_M \\<br>\\end{pmatrix} = \\begin{pmatrix}<br>p_1a_1 &amp; p_1a_2 &amp; \\dots &amp; p_1a_M \\\\\\<br>p_2a_1 &amp; p_2a_2 &amp; \\dots &amp; p_2a_M \\\\\\<br>\\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\\\<br>p_Ra_1 &amp; p_Ra_2 &amp; \\dots &amp; p_Ra_M \\<br>\\end{pmatrix}$$<br>其中 $p_i$是一个行向量，表示第i个基， $a_j$是一个列向量，表示第j个原始数据记录。<br>特别要注意的是，这里R可以小于N，而R决定了变换后数据的维数。也就是说，我们可以将一N维数据变换到更低维度的空间中去，变换后的维度取决于基的数量。因此这种矩阵相乘的表示也可以表示降维变换。<br>最后，上述分析同时给矩阵相乘找到了一种物理解释： <strong>两个矩阵相乘的意义是将右边矩阵中的每一列列向量变换到左边矩阵中每一行行向量为基所表示的空间中去</strong>。更抽象的说，一个矩阵可以表示一种线性变换。很多同学在学线性代数时对矩阵相乘的方法感到奇怪，但是如果明白了矩阵相乘的物理意义，其合理性就一目了然了。    </p>\n<h3 id=\"协方差矩阵及优化目标\"><a href=\"#协方差矩阵及优化目标\" class=\"headerlink\" title=\"协方差矩阵及优化目标\"></a>协方差矩阵及优化目标</h3><p>上面我们讨论了选择不同的基可以对同样一组数据给出不同的表示，而且如果基的数量少于向量本身的维数，则可以达到降维的效果。但是我们还没有回答一个最最关键的问题：如何选择基才是最优的。或者说，如果我们有一组N维向量，现在要将其降到K维（K小于N），那么我们应该如何选择K个基才能最大程度保留原有的信息？<br>要完全数学化这个问题非常繁杂，这里我们用一种非形式化的直观方法来看这个问题。</p>\n<p>为了避免过于抽象的讨论，我们仍以一个具体的例子展开。假设我们的数据由五条记录组成，将它们表示成矩阵形式：<br>$$ \\begin{pmatrix}<br>1 &amp; 1 &amp;2 &amp; 4 &amp; 2 \\\\\\<br>1 &amp; 3 &amp; 3 &amp; 4 &amp; 4 \\<br>\\end{pmatrix}$$<br>其中每一列为一条数据记录，而一行为一个字段。为了后续处理方便，我们首先将每个字段内所有值都减去字段均值，其结果是将每个字段都变为均值为0（这样做的道理和好处后面会看到）。<br>我们看上面的数据，第一个字段均值为2，第二个字段均值为3，所以变换后：<br>$$ \\begin{pmatrix}<br>-1 &amp; -1 &amp; 0 &amp; 2 &amp; 0 \\\\\\<br>-2 &amp; 0 &amp; 0 &amp; 1 &amp; 1 \\<br>\\end{pmatrix}$$<br>我们可以看下五条数据在平面直角坐标系内的样子：<br><img src=\"06.png\" alt><br>现在问题来了：如果我们必须使用一维来表示这些数据，又希望尽量保留原始的信息，你要如何选择？    </p>\n<p>通过上一节对基变换的讨论我们知道，这个问题实际上是要在二维平面中选择一个方向，将所有数据都投影到这个方向所在直线上，用投影值表示原始记录。这是一个实际的二维降到一维的问题。    </p>\n<p>那么如何选择这个方向（或者说基）才能尽量保留最多的原始信息呢？一种直观的看法是：希望投影后的投影值尽可能分散。    </p>\n<p>以上图为例，可以看出如果向x轴投影，那么最左边的两个点会重叠在一起，中间的两个点也会重叠在一起，于是本身四个各不相同的二维点投影后只剩下两个不同的值了，这是一种严重的信息丢失，同理，如果向y轴投影最上面的两个点和分布在x轴上的两个点也会重叠。所以看来x和y轴都不是最好的投影选择。我们直观目测，如果向通过第一象限和第三象限的斜线投影，则五个点在投影后还是可以区分的。<br>下面，我们用数学方法表述这个问题。</p>\n<h3 id=\"方差\"><a href=\"#方差\" class=\"headerlink\" title=\"方差\"></a>方差</h3><p>上文说到，我们希望投影后投影值尽可能分散，而这种分散程度，可以用数学上的方差来表述。此处，一个字段的方差可以看做是每个元素与字段均值的差的平方和的均值，即：<br>$$Var(a)=\\frac{1}{m} \\sum_{i=1}^{m}(a_i- \\mu)^2$$<br>由于上面我们已经将每个字段的均值都化为0了，因此方差可以直接用每个元素的平方和除以元素个数表示：<br>$$Var(a) = \\frac{1}{m} \\sum_{i=1}^{m}a_i^2$$<br>于是上面的问题被形式化表述为：寻找一个一维基，使得所有数据变换为这个基上的坐标表示后，方差值最大。    </p>\n<h3 id=\"协方差\"><a href=\"#协方差\" class=\"headerlink\" title=\"协方差\"></a>协方差</h3><p>对于上面二维降成一维的问题来说，找到那个使得方差最大的方向就可以了。不过对于更高维，还有一个问题需要解决。考虑三维降到二维问题。与之前相同，首先我们希望找到一个方向使得投影后方差最大，这样就完成了第一个方向的选择，继而我们选择第二个投影方向。<br>如果我们还是单纯只选择方差最大的方向，很明显，这个方向与第一个方向应该是“几乎重合在一起”，显然这样的维度是没有用的，因此，应该有其他约束条件。从直观上说，让两个字段尽可能表示更多的原始信息，我们是不希望它们之间存在（线性）相关性的，因为相关性意味着两个字段不是完全独立，必然存在重复表示的信息。<br>数学上可以用两个字段的协方差表示其相关性，由于已经让每个字段均值为0，则：<br>$$Cov(a,b)=\\frac{1}{m} \\sum_{i=1}^{m}a_ib_i$$<br>可以看到，在字段均值为0的情况下，两个字段的协方差简洁的表示为其内积除以元素数m。</p>\n<p>当协方差为0时，表示两个字段完全独立。为了让协方差为0，我们选择第二个基时只能在与第一个基正交的方向上选择。因此最终选择的两个方向一定是正交的。</p>\n<p>至此，我们得到了降维问题的优化目标：<strong>将一组N维向量降为K维（K大于0，小于N），其目标是选择K个单位（模为1）正交基，使得原始数据变换到这组基上后，各字段两两间协方差为0，而字段的方差则尽可能大（在正交的约束下，取最大的K个方差）</strong>。</p>\n<h3 id=\"协方差矩阵\"><a href=\"#协方差矩阵\" class=\"headerlink\" title=\"协方差矩阵\"></a>协方差矩阵</h3><p>上面我们导出了优化目标，但是这个目标似乎不能直接作为操作指南（或者说算法），因为它只说要什么，但根本没有说怎么做。所以我们要继续在数学上研究计算方案。</p>\n<p>我们看到，最终要达到的目的与字段内方差及字段间协方差有密切关系。因此我们希望能将两者统一表示，仔细观察发现，两者均可以表示为内积的形式，而内积又与矩阵相乘密切相关。于是我们来了灵感：</p>\n<p>假设我们只有a和b两个字段，那么我们将它们按行组成矩阵X：</p>\n<p>$$ X = \\begin{pmatrix}<br>a_1 &amp; a_2 &amp; \\dots &amp; a_m \\\\\\<br>b_1 &amp; b_2 &amp; \\dots &amp; b_m \\<br>\\end{pmatrix}$$<br>然后我们用X乘以X的转置，并乘上系数 $\\frac{1}{m}$：<br>$$\\frac{1}{m} \\begin{pmatrix}<br>\\frac{1}{m} \\sum_{i=1}^{m}a_i^2 &amp; \\frac{1}{m} \\sum_{i=1}^{m}a_ib_i \\\\\\<br>\\frac{1}{m} \\sum_{i=1}^{m}a_ib_i &amp; \\frac{1}{m} \\sum_{i=1}^{m}b_i^2 \\<br>\\end{pmatrix}$$</p>\n<p>奇迹出现了！这个矩阵对角线上的两个元素分别是两个字段的方差，而其它元素是a和b的协方差。两者被统一到了一个矩阵的。</p>\n<p>根据矩阵相乘的运算法则，这个结论很容易被推广到一般情况：</p>\n<p><strong>设我们有m个n维数据记录，将其按列排成n乘m的矩阵X，设 $C = \\frac{1}{m}XX^T$,则C是一个对称矩阵，其对角线分别个各个字段的方差，而第i行j列和j行i列元素相同，表示i和j两个字段的协方差。</strong></p>\n<h3 id=\"协方差矩阵对角化\"><a href=\"#协方差矩阵对角化\" class=\"headerlink\" title=\"协方差矩阵对角化\"></a>协方差矩阵对角化</h3><p>根据上述推导，我们发现要达到优化目前，等价于将协方差矩阵对角化：即除对角线外的其它元素化为0，并且在对角线上将元素按大小从上到下排列，这样我们就达到了优化目的。这样说可能还不是很明晰，我们进一步看下原矩阵与基变换后矩阵协方差矩阵的关系：</p>\n<p>设原始数据矩阵X对应的协方差矩阵为C，而P是一组基按行组成的矩阵，设Y=PX，则Y为X对P做基变换后的数据。设Y的协方差矩阵为D，我们推导一下D与C的关系：<br>$$\\begin{align}<br>D &amp;= \\frac{1}{m}YY^T \\\\\\<br>  &amp;= \\frac{1}{m}(PX)(PX)^T \\\\\\<br>  &amp;= \\frac{1}{m}PXX^T P^T \\\\\\<br>  &amp;= P(\\frac{1}{m}XX^T)P^T \\\\\\<br>  &amp;= PCP^T<br>\\end{align}$$</p>\n<p>现在事情很明白了！我们要找的P不是别的，而是能让原始协方差矩阵对角化的P。换句话说，优化目标变成了寻找一个矩阵P，满足 $PCP^T$ 是一个对角矩阵，并且对角元素按从大到小依次排列，那么P的前K行就是要寻找的基，用P的前K行组成的矩阵乘以X就使得X从N维降到了K维并满足上述优化条件。<br>现在所有焦点都聚焦在了协方差矩阵对角化问题上，有时，我们真应该感谢数学家的先行，因为矩阵对角化在线性代数领域已经属于被玩烂了的东西，所以这在数学上根本不是问题。</p>\n<p>由上文知道，协方差矩阵C是一个是对称矩阵，在线性代数上，实对称矩阵有一系列非常好的性质：</p>\n<ol>\n<li>实对称矩阵不同特征值对应的特征向量必然正交</li>\n<li>设特征向量λ重数为r，则必然存在r个线性无关的特征向量对应于λ，因此可以将这r个特征向量单位正交化。<br>由上面两条可知，一个n行n列的实对称矩阵一定可以找到n个单位正交特征向量，设这n个特征向量为 $e_1,e_2,\\dots,e_n,$ 我们将其按列组成矩阵：<br>$$E = \\begin{pmatrix}<br>e_1 &amp; e_2 &amp; \\dots &amp; e_n \\<br>\\end{pmatrix}$$<br>则对协方差矩阵C有如下结论：<br>$$E_TCE = \\Lambda = \\begin{pmatrix}<br>\\lambda_1 &amp; &amp; &amp; \\\\\\<br>&amp; \\lambda_2 &amp; &amp; \\\\\\<br>&amp; &amp; \\ddots &amp; \\\\\\<br>&amp; &amp; &amp; \\lambda_n \\<br>\\end{pmatrix}$$<br>其中 $Lambda$为对角矩阵，其对角元素为各特征向量对应的特征值（可能有重复）。</li>\n</ol>\n<p>以上结论不再给出严格的数学证明，对证明感兴趣的朋友可以参考线性代数书籍关于“实对称矩阵对角化”的内容。</p>\n<p>到这里，我们发现我们已经找到了需要的矩阵P：<br>$$P = E^T$$</p>\n<p>P是协方差矩阵的特征向量单位化后按行排列出的矩阵，其中每一行都是C的一个特征向量。如果设P按照Λ中特征值的从大到小，将特征向量从上到下排列，则用P的前K行组成的矩阵乘以原始数据矩阵X，就得到了我们需要的降维后的数据矩阵Y。</p>\n"},{"title":"PCA算法实现","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-08-07T01:48:10.000Z","password":null,"summary":"PCA算法实例及C++实现","_content":"# PCA算法实例及C++实现\n\n## PCA算法\n总结一下PCA的算法步骤：\n\n设有m条n维数据。\n\n1. 将原始数据按列组成n行m列矩阵X\n2. 将X的每一行（代表一个属性字段）进行零均值化，即减去这一行的均值\n3. 求出协方差矩阵 $C=\\frac{1}{m}XX^\\mathsf{T}$\n4. 求出协方差矩阵的特征值及对应的特征向量\n5. 将特征向量按对应特征值大小从上到下按行排列成矩阵，取前k行组成矩阵P\n6. $Y = PX$即为降维到k维后的数据\n\n## 实例\n\n以\n$$ \\begin{pmatrix}\n  -1 & -1 & 0 & 2 & 0 \\\\\\\\\n  -2 & 0 & 0 & 1 & 1 \\\\\n\\end{pmatrix} $$\n为例，我们用PCA方法将这组二维数据其降到一维。\n\n因为这个矩阵的每行已经是零均值，这里我们直接求协方差矩阵：\n$$ C=\\frac{1}{5}\\begin{pmatrix}\n  -1 & -1 & 0 & 2 & 0 \\\\\\\\\n  -2 & 0 & 0 & 1 & 1 \\\\\n\\end{pmatrix}\\begin{pmatrix}\n  -1 & -2 \\\\\\\\\n  -1 & 0  \\\\\\\\\n  0  & 0  \\\\\\\\\n  2  & 1  \\\\\\\\\n  0  & 1 \\\\\n\\end{pmatrix}=\\begin{pmatrix}\n  \\frac{6}{5} & \\frac{4}{5} \\\\\\\\\n  \\frac{4}{5} & \\frac{6}{5} \\\\\n\\end{pmatrix}$$\n然后求其特征值和特征向量，具体求解方法不再详述，可以参考相关资料。求解后特征值为：\n$$\\lambda_1=2,\\lambda_2=2/5$$\n其对应的特征向量分别是：\n$$c_1\\begin{pmatrix}\n  1 \\\\\\\\\n  1\n\\end{pmatrix},c_2\\begin{pmatrix}\n  -1 \\\\\\\\\n  1\n\\end{pmatrix}$$\n其中对应的特征向量分别是一个通解， $c_1$和 $c_2$ 可取任意实数。那么标准化后的特征向量为：\n$$\\begin{pmatrix}\n  1/\\sqrt{2} \\\\\\\\\n  1/\\sqrt{2}\n\\end{pmatrix},\\begin{pmatrix}\n  -1/\\sqrt{2} \\\\\\\\\n  1/\\sqrt{2}\n\\end{pmatrix}$$\n因此我们的矩阵P是：\n$$P=\\begin{pmatrix}\n  1/\\sqrt{2}  & 1/\\sqrt{2}  \\\\\\\\\n  -1/\\sqrt{2} & 1/\\sqrt{2}\n\\end{pmatrix}$$\n最后我们用P的第一行乘以数据矩阵，就得到了降维后的表示：\n$$Y=\\begin{pmatrix}\n  1/\\sqrt{2} & 1/\\sqrt{2}\n\\end{pmatrix}\\begin{pmatrix}\n  -1 & -1 & 0 & 2 & 0 \\\\\\\\\n  -2 & 0 & 0 & 1 & 1\n\\end{pmatrix}=\\begin{pmatrix}\n  -3/\\sqrt{2} & -1/\\sqrt{2} & 0 & 3/\\sqrt{2} & -1/\\sqrt{2}\n\\end{pmatrix}$$\n可以验证协方差矩阵C的对角化：\n$$PCP^\\mathsf{T}=\\begin{pmatrix}\n  1/\\sqrt{2}  & 1/\\sqrt{2}  \\\\\\\\\n  -1/\\sqrt{2} & 1/\\sqrt{2}\n\\end{pmatrix}\\begin{pmatrix}\n  6/5 & 4/5 \\\\\\\\\n  4/5 & 6/5\n\\end{pmatrix}\\begin{pmatrix}\n  1/\\sqrt{2} & -1/\\sqrt{2}  \\\\\\\\\n  1/\\sqrt{2} & 1/\\sqrt{2}\n\\end{pmatrix}=\\begin{pmatrix}\n  2 & 0  \\\\\\\\\n  0 & 2/5\n\\end{pmatrix}$$\n![](02.png)\n\n## C++实现\n因为要对一组图片信息进行训练，所以我写了一部分通过摄像头截取图片帧的代码，`get_img()`函数。这里提取了5个特征脸和一个均值脸\n\n```cpp\n#include <opencv2/core/core.hpp>\n#include <opencv2/highgui/highgui.hpp>\n#include <opencv2/imgproc/imgproc.hpp>\n#include <opencv2/objdetect/objdetect.hpp>\n\n#include <iostream>\n#include <fstream>\n#include <sstream>\n#define img_num 300 //训练图片的张数\nusing namespace cv;\nusing namespace std;\n//通过摄像头保存要训练的图片\n\n//打开摄像头\nint get_img(){\n  VideoCapture cap(0);\n  if(!cap.isOpened())\n  {\n    return -1;\n  }\n  Mat frame;\n  bool stop = false;\n  int i = 1;\n  while(!stop){\n    cap >> frame;\n    printf(\"%d\\n\", i);\n    if (frame.empty())\n      stop = true;\n    //string filename = format(\"%d.jpg\", i);\n    char filename[20];\n    sprintf(filename, \"Img/%d.jpg\", i);\n    imwrite(filename, frame);\n    i++;\n    imshow(\"frame\", frame);\n    waitKey(30);\n    if(i > img_num)\n      break;\n    \n  }\nreturn -1;\n\n}\n//把图像归一化为0-255\nMat norm_0_255(const Mat& src){\n  Mat dst;\n  switch(src.channels()){\n    case 1:\n        cv::normalize(src, dst, 0, 255, NORM_MINMAX, CV_8UC1);\n        break;\n    case 3:\n        cv::normalize(src, dst, 0, 255, NORM_MINMAX, CV_8UC3);\n        break;\n    default:\n        src.copyTo(dst);\n        break;\n  }\n  return dst;\n}\n\n//将给定的图像转化为行矩阵\nMat asRowMatrix(const vector<Mat>& src, int rtype, double alpha = 1, double beta = 0){\n  // 样本数量\n  size_t n = src.size();\n  //没有样本，返回空矩阵\n  if (n == 0)\n    return Mat();\n\n  //样本的维数\n  size_t d = src[0].total();\n\n  Mat data(n, d, rtype);\n\n  //拷贝数据\n  for (int i = 0; i < n; i++){\n    if(src[i].empty()){\n      string error_message = format(\"Image number %d was empty, please check your input data.\", i);\n      CV_Error(CV_StsBadArg, error_message);\n    }\n\n    //确保数据能被reshape\n    if(src[i].total() != d){\n      string error_message = format(\"Wrong number of elements in matrix #%d! Expected %d was %d.\", i, d, src[i].total());\n      CV_Error(CV_StsBadArg, error_message);\n    }\n    Mat xi = data.row(i);\n    //转化为1行，n列的格式\n    if(src[i].isContinuous()){\n      src[i].reshape(1, 1).convertTo(xi, rtype, alpha, beta);\n    }\n    else {\n      src[i].clone().reshape(1, 1).convertTo(xi, rtype, alpha, beta);\n    }\n  }\n  return data;\n}\n\nint main(int argc, const char* argv[]){\n  vector<Mat> db;\n  //get_img();\n  for(int i=1; i<img_num;i++){\n\n    string filename = format(\"Img/%d.jpg\", i);\n    db.push_back(imread(filename, IMREAD_GRAYSCALE));\n  }\n  // Build a matrix with the observations in row:\n    Mat data = asRowMatrix(db, CV_32FC1);\n\n    // PCA算法保持5主成分分量\n    int num_components = 5;\n\n    //执行pca算法\n    PCA pca(data, Mat(), CV_PCA_DATA_AS_ROW, num_components);\n\n    //copy  pca算法结果\n    Mat mean = pca.mean.clone();\n    Mat eigenvalues = pca.eigenvalues.clone();\n    Mat eigenvectors = pca.eigenvectors.clone();\n        //均值脸\n    imshow(\"avg\", norm_0_255(mean.reshape(1, db[0].rows)));\n\n    //五个特征脸\n    imshow(\"pc1\", norm_0_255(pca.eigenvectors.row(0)).reshape(1, db[0].rows));\n    imshow(\"pc2\", norm_0_255(pca.eigenvectors.row(1)).reshape(1, db[0].rows));\n    imshow(\"pc3\", norm_0_255(pca.eigenvectors.row(2)).reshape(1, db[0].rows));\n    imshow(\"pc4\", norm_0_255(pca.eigenvectors.row(3)).reshape(1, db[0].rows));\n    imshow(\"pc5\", norm_0_255(pca.eigenvectors.row(4)).reshape(1, db[0].rows));\n\n    while(1)\n        waitKey(0);\n\n    // Success!\n    return 0;\n\n}\n```\n![](01.png)\n","source":"_posts/PCA算法实现.md","raw":"---\ntitle: PCA算法实现\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-08-07 09:48:10\npassword:\nsummary: PCA算法实例及C++实现\ntags:\n- 图像处理\n- PCA\n- OpenCV\n- c++\ncategories:\n- 算法\n---\n# PCA算法实例及C++实现\n\n## PCA算法\n总结一下PCA的算法步骤：\n\n设有m条n维数据。\n\n1. 将原始数据按列组成n行m列矩阵X\n2. 将X的每一行（代表一个属性字段）进行零均值化，即减去这一行的均值\n3. 求出协方差矩阵 $C=\\frac{1}{m}XX^\\mathsf{T}$\n4. 求出协方差矩阵的特征值及对应的特征向量\n5. 将特征向量按对应特征值大小从上到下按行排列成矩阵，取前k行组成矩阵P\n6. $Y = PX$即为降维到k维后的数据\n\n## 实例\n\n以\n$$ \\begin{pmatrix}\n  -1 & -1 & 0 & 2 & 0 \\\\\\\\\n  -2 & 0 & 0 & 1 & 1 \\\\\n\\end{pmatrix} $$\n为例，我们用PCA方法将这组二维数据其降到一维。\n\n因为这个矩阵的每行已经是零均值，这里我们直接求协方差矩阵：\n$$ C=\\frac{1}{5}\\begin{pmatrix}\n  -1 & -1 & 0 & 2 & 0 \\\\\\\\\n  -2 & 0 & 0 & 1 & 1 \\\\\n\\end{pmatrix}\\begin{pmatrix}\n  -1 & -2 \\\\\\\\\n  -1 & 0  \\\\\\\\\n  0  & 0  \\\\\\\\\n  2  & 1  \\\\\\\\\n  0  & 1 \\\\\n\\end{pmatrix}=\\begin{pmatrix}\n  \\frac{6}{5} & \\frac{4}{5} \\\\\\\\\n  \\frac{4}{5} & \\frac{6}{5} \\\\\n\\end{pmatrix}$$\n然后求其特征值和特征向量，具体求解方法不再详述，可以参考相关资料。求解后特征值为：\n$$\\lambda_1=2,\\lambda_2=2/5$$\n其对应的特征向量分别是：\n$$c_1\\begin{pmatrix}\n  1 \\\\\\\\\n  1\n\\end{pmatrix},c_2\\begin{pmatrix}\n  -1 \\\\\\\\\n  1\n\\end{pmatrix}$$\n其中对应的特征向量分别是一个通解， $c_1$和 $c_2$ 可取任意实数。那么标准化后的特征向量为：\n$$\\begin{pmatrix}\n  1/\\sqrt{2} \\\\\\\\\n  1/\\sqrt{2}\n\\end{pmatrix},\\begin{pmatrix}\n  -1/\\sqrt{2} \\\\\\\\\n  1/\\sqrt{2}\n\\end{pmatrix}$$\n因此我们的矩阵P是：\n$$P=\\begin{pmatrix}\n  1/\\sqrt{2}  & 1/\\sqrt{2}  \\\\\\\\\n  -1/\\sqrt{2} & 1/\\sqrt{2}\n\\end{pmatrix}$$\n最后我们用P的第一行乘以数据矩阵，就得到了降维后的表示：\n$$Y=\\begin{pmatrix}\n  1/\\sqrt{2} & 1/\\sqrt{2}\n\\end{pmatrix}\\begin{pmatrix}\n  -1 & -1 & 0 & 2 & 0 \\\\\\\\\n  -2 & 0 & 0 & 1 & 1\n\\end{pmatrix}=\\begin{pmatrix}\n  -3/\\sqrt{2} & -1/\\sqrt{2} & 0 & 3/\\sqrt{2} & -1/\\sqrt{2}\n\\end{pmatrix}$$\n可以验证协方差矩阵C的对角化：\n$$PCP^\\mathsf{T}=\\begin{pmatrix}\n  1/\\sqrt{2}  & 1/\\sqrt{2}  \\\\\\\\\n  -1/\\sqrt{2} & 1/\\sqrt{2}\n\\end{pmatrix}\\begin{pmatrix}\n  6/5 & 4/5 \\\\\\\\\n  4/5 & 6/5\n\\end{pmatrix}\\begin{pmatrix}\n  1/\\sqrt{2} & -1/\\sqrt{2}  \\\\\\\\\n  1/\\sqrt{2} & 1/\\sqrt{2}\n\\end{pmatrix}=\\begin{pmatrix}\n  2 & 0  \\\\\\\\\n  0 & 2/5\n\\end{pmatrix}$$\n![](02.png)\n\n## C++实现\n因为要对一组图片信息进行训练，所以我写了一部分通过摄像头截取图片帧的代码，`get_img()`函数。这里提取了5个特征脸和一个均值脸\n\n```cpp\n#include <opencv2/core/core.hpp>\n#include <opencv2/highgui/highgui.hpp>\n#include <opencv2/imgproc/imgproc.hpp>\n#include <opencv2/objdetect/objdetect.hpp>\n\n#include <iostream>\n#include <fstream>\n#include <sstream>\n#define img_num 300 //训练图片的张数\nusing namespace cv;\nusing namespace std;\n//通过摄像头保存要训练的图片\n\n//打开摄像头\nint get_img(){\n  VideoCapture cap(0);\n  if(!cap.isOpened())\n  {\n    return -1;\n  }\n  Mat frame;\n  bool stop = false;\n  int i = 1;\n  while(!stop){\n    cap >> frame;\n    printf(\"%d\\n\", i);\n    if (frame.empty())\n      stop = true;\n    //string filename = format(\"%d.jpg\", i);\n    char filename[20];\n    sprintf(filename, \"Img/%d.jpg\", i);\n    imwrite(filename, frame);\n    i++;\n    imshow(\"frame\", frame);\n    waitKey(30);\n    if(i > img_num)\n      break;\n    \n  }\nreturn -1;\n\n}\n//把图像归一化为0-255\nMat norm_0_255(const Mat& src){\n  Mat dst;\n  switch(src.channels()){\n    case 1:\n        cv::normalize(src, dst, 0, 255, NORM_MINMAX, CV_8UC1);\n        break;\n    case 3:\n        cv::normalize(src, dst, 0, 255, NORM_MINMAX, CV_8UC3);\n        break;\n    default:\n        src.copyTo(dst);\n        break;\n  }\n  return dst;\n}\n\n//将给定的图像转化为行矩阵\nMat asRowMatrix(const vector<Mat>& src, int rtype, double alpha = 1, double beta = 0){\n  // 样本数量\n  size_t n = src.size();\n  //没有样本，返回空矩阵\n  if (n == 0)\n    return Mat();\n\n  //样本的维数\n  size_t d = src[0].total();\n\n  Mat data(n, d, rtype);\n\n  //拷贝数据\n  for (int i = 0; i < n; i++){\n    if(src[i].empty()){\n      string error_message = format(\"Image number %d was empty, please check your input data.\", i);\n      CV_Error(CV_StsBadArg, error_message);\n    }\n\n    //确保数据能被reshape\n    if(src[i].total() != d){\n      string error_message = format(\"Wrong number of elements in matrix #%d! Expected %d was %d.\", i, d, src[i].total());\n      CV_Error(CV_StsBadArg, error_message);\n    }\n    Mat xi = data.row(i);\n    //转化为1行，n列的格式\n    if(src[i].isContinuous()){\n      src[i].reshape(1, 1).convertTo(xi, rtype, alpha, beta);\n    }\n    else {\n      src[i].clone().reshape(1, 1).convertTo(xi, rtype, alpha, beta);\n    }\n  }\n  return data;\n}\n\nint main(int argc, const char* argv[]){\n  vector<Mat> db;\n  //get_img();\n  for(int i=1; i<img_num;i++){\n\n    string filename = format(\"Img/%d.jpg\", i);\n    db.push_back(imread(filename, IMREAD_GRAYSCALE));\n  }\n  // Build a matrix with the observations in row:\n    Mat data = asRowMatrix(db, CV_32FC1);\n\n    // PCA算法保持5主成分分量\n    int num_components = 5;\n\n    //执行pca算法\n    PCA pca(data, Mat(), CV_PCA_DATA_AS_ROW, num_components);\n\n    //copy  pca算法结果\n    Mat mean = pca.mean.clone();\n    Mat eigenvalues = pca.eigenvalues.clone();\n    Mat eigenvectors = pca.eigenvectors.clone();\n        //均值脸\n    imshow(\"avg\", norm_0_255(mean.reshape(1, db[0].rows)));\n\n    //五个特征脸\n    imshow(\"pc1\", norm_0_255(pca.eigenvectors.row(0)).reshape(1, db[0].rows));\n    imshow(\"pc2\", norm_0_255(pca.eigenvectors.row(1)).reshape(1, db[0].rows));\n    imshow(\"pc3\", norm_0_255(pca.eigenvectors.row(2)).reshape(1, db[0].rows));\n    imshow(\"pc4\", norm_0_255(pca.eigenvectors.row(3)).reshape(1, db[0].rows));\n    imshow(\"pc5\", norm_0_255(pca.eigenvectors.row(4)).reshape(1, db[0].rows));\n\n    while(1)\n        waitKey(0);\n\n    // Success!\n    return 0;\n\n}\n```\n![](01.png)\n","slug":"PCA算法实现","published":1,"updated":"2020-02-24T10:49:41.418Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0tf001o74jug5fdjm8t","content":"<h1 id=\"PCA算法实例及C-实现\"><a href=\"#PCA算法实例及C-实现\" class=\"headerlink\" title=\"PCA算法实例及C++实现\"></a>PCA算法实例及C++实现</h1><h2 id=\"PCA算法\"><a href=\"#PCA算法\" class=\"headerlink\" title=\"PCA算法\"></a>PCA算法</h2><p>总结一下PCA的算法步骤：</p>\n<p>设有m条n维数据。</p>\n<ol>\n<li>将原始数据按列组成n行m列矩阵X</li>\n<li>将X的每一行（代表一个属性字段）进行零均值化，即减去这一行的均值</li>\n<li>求出协方差矩阵 $C=\\frac{1}{m}XX^\\mathsf{T}$</li>\n<li>求出协方差矩阵的特征值及对应的特征向量</li>\n<li>将特征向量按对应特征值大小从上到下按行排列成矩阵，取前k行组成矩阵P</li>\n<li>$Y = PX$即为降维到k维后的数据</li>\n</ol>\n<h2 id=\"实例\"><a href=\"#实例\" class=\"headerlink\" title=\"实例\"></a>实例</h2><p>以<br>$$ \\begin{pmatrix}<br>  -1 &amp; -1 &amp; 0 &amp; 2 &amp; 0 \\\\\\<br>  -2 &amp; 0 &amp; 0 &amp; 1 &amp; 1 \\<br>\\end{pmatrix} $$<br>为例，我们用PCA方法将这组二维数据其降到一维。</p>\n<p>因为这个矩阵的每行已经是零均值，这里我们直接求协方差矩阵：<br>$$ C=\\frac{1}{5}\\begin{pmatrix}<br>  -1 &amp; -1 &amp; 0 &amp; 2 &amp; 0 \\\\\\<br>  -2 &amp; 0 &amp; 0 &amp; 1 &amp; 1 \\<br>\\end{pmatrix}\\begin{pmatrix}<br>  -1 &amp; -2 \\\\\\<br>  -1 &amp; 0  \\\\\\<br>  0  &amp; 0  \\\\\\<br>  2  &amp; 1  \\\\\\<br>  0  &amp; 1 \\<br>\\end{pmatrix}=\\begin{pmatrix}<br>  \\frac{6}{5} &amp; \\frac{4}{5} \\\\\\<br>  \\frac{4}{5} &amp; \\frac{6}{5} \\<br>\\end{pmatrix}$$<br>然后求其特征值和特征向量，具体求解方法不再详述，可以参考相关资料。求解后特征值为：<br>$$\\lambda_1=2,\\lambda_2=2/5$$<br>其对应的特征向量分别是：<br>$$c_1\\begin{pmatrix}<br>  1 \\\\\\<br>  1<br>\\end{pmatrix},c_2\\begin{pmatrix}<br>  -1 \\\\\\<br>  1<br>\\end{pmatrix}$$<br>其中对应的特征向量分别是一个通解， $c_1$和 $c_2$ 可取任意实数。那么标准化后的特征向量为：<br>$$\\begin{pmatrix}<br>  1/\\sqrt{2} \\\\\\<br>  1/\\sqrt{2}<br>\\end{pmatrix},\\begin{pmatrix}<br>  -1/\\sqrt{2} \\\\\\<br>  1/\\sqrt{2}<br>\\end{pmatrix}$$<br>因此我们的矩阵P是：<br>$$P=\\begin{pmatrix}<br>  1/\\sqrt{2}  &amp; 1/\\sqrt{2}  \\\\\\<br>  -1/\\sqrt{2} &amp; 1/\\sqrt{2}<br>\\end{pmatrix}$$<br>最后我们用P的第一行乘以数据矩阵，就得到了降维后的表示：<br>$$Y=\\begin{pmatrix}<br>  1/\\sqrt{2} &amp; 1/\\sqrt{2}<br>\\end{pmatrix}\\begin{pmatrix}<br>  -1 &amp; -1 &amp; 0 &amp; 2 &amp; 0 \\\\\\<br>  -2 &amp; 0 &amp; 0 &amp; 1 &amp; 1<br>\\end{pmatrix}=\\begin{pmatrix}<br>  -3/\\sqrt{2} &amp; -1/\\sqrt{2} &amp; 0 &amp; 3/\\sqrt{2} &amp; -1/\\sqrt{2}<br>\\end{pmatrix}$$<br>可以验证协方差矩阵C的对角化：<br>$$PCP^\\mathsf{T}=\\begin{pmatrix}<br>  1/\\sqrt{2}  &amp; 1/\\sqrt{2}  \\\\\\<br>  -1/\\sqrt{2} &amp; 1/\\sqrt{2}<br>\\end{pmatrix}\\begin{pmatrix}<br>  6/5 &amp; 4/5 \\\\\\<br>  4/5 &amp; 6/5<br>\\end{pmatrix}\\begin{pmatrix}<br>  1/\\sqrt{2} &amp; -1/\\sqrt{2}  \\\\\\<br>  1/\\sqrt{2} &amp; 1/\\sqrt{2}<br>\\end{pmatrix}=\\begin{pmatrix}<br>  2 &amp; 0  \\\\\\<br>  0 &amp; 2/5<br>\\end{pmatrix}$$<br><img src=\"02.png\" alt></p>\n<h2 id=\"C-实现\"><a href=\"#C-实现\" class=\"headerlink\" title=\"C++实现\"></a>C++实现</h2><p>因为要对一组图片信息进行训练，所以我写了一部分通过摄像头截取图片帧的代码，<code>get_img()</code>函数。这里提取了5个特征脸和一个均值脸</p>\n<pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/core/core.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/highgui/highgui.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/imgproc/imgproc.hpp></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/objdetect/objdetect.hpp></span></span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;fstream></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sstream></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> img_num 300 </span><span class=\"token comment\" spellcheck=\"true\">//训练图片的张数</span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> cv<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> std<span class=\"token punctuation\">;</span>\n<span class=\"token comment\" spellcheck=\"true\">//通过摄像头保存要训练的图片</span>\n\n<span class=\"token comment\" spellcheck=\"true\">//打开摄像头</span>\n<span class=\"token keyword\">int</span> <span class=\"token function\">get_img</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  VideoCapture <span class=\"token function\">cap</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>cap<span class=\"token punctuation\">.</span><span class=\"token function\">isOpened</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  Mat frame<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">bool</span> stop <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>stop<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    cap <span class=\"token operator\">>></span> frame<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\\n\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      stop <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">//string filename = format(\"%d.jpg\", i);</span>\n    <span class=\"token keyword\">char</span> filename<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Img/%d.jpg\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">imwrite</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> frame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    i<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"frame\"</span><span class=\"token punctuation\">,</span> frame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">waitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">></span> img_num<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\" spellcheck=\"true\">//把图像归一化为0-255</span>\nMat <span class=\"token function\">norm_0_255</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> Mat<span class=\"token operator\">&amp;</span> src<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  Mat dst<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">switch</span><span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">.</span><span class=\"token function\">channels</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span>\n        cv<span class=\"token operator\">::</span><span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">,</span> dst<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> NORM_MINMAX<span class=\"token punctuation\">,</span> CV_8UC1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span>\n        cv<span class=\"token operator\">::</span><span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">,</span> dst<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> NORM_MINMAX<span class=\"token punctuation\">,</span> CV_8UC3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n        src<span class=\"token punctuation\">.</span><span class=\"token function\">copyTo</span><span class=\"token punctuation\">(</span>dst<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> dst<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\" spellcheck=\"true\">//将给定的图像转化为行矩阵</span>\nMat <span class=\"token function\">asRowMatrix</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> vector<span class=\"token operator\">&lt;</span>Mat<span class=\"token operator\">></span><span class=\"token operator\">&amp;</span> src<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> rtype<span class=\"token punctuation\">,</span> <span class=\"token keyword\">double</span> alpha <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">double</span> beta <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\" spellcheck=\"true\">// 样本数量</span>\n  size_t n <span class=\"token operator\">=</span> src<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\" spellcheck=\"true\">//没有样本，返回空矩阵</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">//样本的维数</span>\n  size_t d <span class=\"token operator\">=</span> src<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">total</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  Mat <span class=\"token function\">data</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> rtype<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">//拷贝数据</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      string error_message <span class=\"token operator\">=</span> <span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Image number %d was empty, please check your input data.\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">CV_Error</span><span class=\"token punctuation\">(</span>CV_StsBadArg<span class=\"token punctuation\">,</span> error_message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//确保数据能被reshape</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">total</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      string error_message <span class=\"token operator\">=</span> <span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Wrong number of elements in matrix #%d! Expected %d was %d.\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> src<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">total</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">CV_Error</span><span class=\"token punctuation\">(</span>CV_StsBadArg<span class=\"token punctuation\">,</span> error_message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    Mat xi <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">row</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">//转化为1行，n列的格式</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">isContinuous</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      src<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">reshape</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">convertTo</span><span class=\"token punctuation\">(</span>xi<span class=\"token punctuation\">,</span> rtype<span class=\"token punctuation\">,</span> alpha<span class=\"token punctuation\">,</span> beta<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      src<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">reshape</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">convertTo</span><span class=\"token punctuation\">(</span>xi<span class=\"token punctuation\">,</span> rtype<span class=\"token punctuation\">,</span> alpha<span class=\"token punctuation\">,</span> beta<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> data<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  vector<span class=\"token operator\">&lt;</span>Mat<span class=\"token operator\">></span> db<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\" spellcheck=\"true\">//get_img();</span>\n  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>img_num<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\n    string filename <span class=\"token operator\">=</span> <span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Img/%d.jpg\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    db<span class=\"token punctuation\">.</span><span class=\"token function\">push_back</span><span class=\"token punctuation\">(</span><span class=\"token function\">imread</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> IMREAD_GRAYSCALE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\" spellcheck=\"true\">// Build a matrix with the observations in row:</span>\n    Mat data <span class=\"token operator\">=</span> <span class=\"token function\">asRowMatrix</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">,</span> CV_32FC1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// PCA算法保持5主成分分量</span>\n    <span class=\"token keyword\">int</span> num_components <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//执行pca算法</span>\n    PCA <span class=\"token function\">pca</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> CV_PCA_DATA_AS_ROW<span class=\"token punctuation\">,</span> num_components<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//copy  pca算法结果</span>\n    Mat mean <span class=\"token operator\">=</span> pca<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">.</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat eigenvalues <span class=\"token operator\">=</span> pca<span class=\"token punctuation\">.</span>eigenvalues<span class=\"token punctuation\">.</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat eigenvectors <span class=\"token operator\">=</span> pca<span class=\"token punctuation\">.</span>eigenvectors<span class=\"token punctuation\">.</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">//均值脸</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"avg\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">norm_0_255</span><span class=\"token punctuation\">(</span>mean<span class=\"token punctuation\">.</span><span class=\"token function\">reshape</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> db<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>rows<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//五个特征脸</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pc1\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">norm_0_255</span><span class=\"token punctuation\">(</span>pca<span class=\"token punctuation\">.</span>eigenvectors<span class=\"token punctuation\">.</span><span class=\"token function\">row</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">reshape</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> db<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>rows<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pc2\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">norm_0_255</span><span class=\"token punctuation\">(</span>pca<span class=\"token punctuation\">.</span>eigenvectors<span class=\"token punctuation\">.</span><span class=\"token function\">row</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">reshape</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> db<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>rows<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pc3\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">norm_0_255</span><span class=\"token punctuation\">(</span>pca<span class=\"token punctuation\">.</span>eigenvectors<span class=\"token punctuation\">.</span><span class=\"token function\">row</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">reshape</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> db<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>rows<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pc4\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">norm_0_255</span><span class=\"token punctuation\">(</span>pca<span class=\"token punctuation\">.</span>eigenvectors<span class=\"token punctuation\">.</span><span class=\"token function\">row</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">reshape</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> db<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>rows<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pc5\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">norm_0_255</span><span class=\"token punctuation\">(</span>pca<span class=\"token punctuation\">.</span>eigenvectors<span class=\"token punctuation\">.</span><span class=\"token function\">row</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">reshape</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> db<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>rows<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">waitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// Success!</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span></code></pre>\n<p><img src=\"01.png\" alt></p>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"PCA算法实例及C-实现\"><a href=\"#PCA算法实例及C-实现\" class=\"headerlink\" title=\"PCA算法实例及C++实现\"></a>PCA算法实例及C++实现</h1><h2 id=\"PCA算法\"><a href=\"#PCA算法\" class=\"headerlink\" title=\"PCA算法\"></a>PCA算法</h2><p>总结一下PCA的算法步骤：</p>\n<p>设有m条n维数据。</p>\n<ol>\n<li>将原始数据按列组成n行m列矩阵X</li>\n<li>将X的每一行（代表一个属性字段）进行零均值化，即减去这一行的均值</li>\n<li>求出协方差矩阵 $C=\\frac{1}{m}XX^\\mathsf{T}$</li>\n<li>求出协方差矩阵的特征值及对应的特征向量</li>\n<li>将特征向量按对应特征值大小从上到下按行排列成矩阵，取前k行组成矩阵P</li>\n<li>$Y = PX$即为降维到k维后的数据</li>\n</ol>\n<h2 id=\"实例\"><a href=\"#实例\" class=\"headerlink\" title=\"实例\"></a>实例</h2><p>以<br>$$ \\begin{pmatrix}<br>  -1 &amp; -1 &amp; 0 &amp; 2 &amp; 0 \\\\\\<br>  -2 &amp; 0 &amp; 0 &amp; 1 &amp; 1 \\<br>\\end{pmatrix} $$<br>为例，我们用PCA方法将这组二维数据其降到一维。</p>\n<p>因为这个矩阵的每行已经是零均值，这里我们直接求协方差矩阵：<br>$$ C=\\frac{1}{5}\\begin{pmatrix}<br>  -1 &amp; -1 &amp; 0 &amp; 2 &amp; 0 \\\\\\<br>  -2 &amp; 0 &amp; 0 &amp; 1 &amp; 1 \\<br>\\end{pmatrix}\\begin{pmatrix}<br>  -1 &amp; -2 \\\\\\<br>  -1 &amp; 0  \\\\\\<br>  0  &amp; 0  \\\\\\<br>  2  &amp; 1  \\\\\\<br>  0  &amp; 1 \\<br>\\end{pmatrix}=\\begin{pmatrix}<br>  \\frac{6}{5} &amp; \\frac{4}{5} \\\\\\<br>  \\frac{4}{5} &amp; \\frac{6}{5} \\<br>\\end{pmatrix}$$<br>然后求其特征值和特征向量，具体求解方法不再详述，可以参考相关资料。求解后特征值为：<br>$$\\lambda_1=2,\\lambda_2=2/5$$<br>其对应的特征向量分别是：<br>$$c_1\\begin{pmatrix}<br>  1 \\\\\\<br>  1<br>\\end{pmatrix},c_2\\begin{pmatrix}<br>  -1 \\\\\\<br>  1<br>\\end{pmatrix}$$<br>其中对应的特征向量分别是一个通解， $c_1$和 $c_2$ 可取任意实数。那么标准化后的特征向量为：<br>$$\\begin{pmatrix}<br>  1/\\sqrt{2} \\\\\\<br>  1/\\sqrt{2}<br>\\end{pmatrix},\\begin{pmatrix}<br>  -1/\\sqrt{2} \\\\\\<br>  1/\\sqrt{2}<br>\\end{pmatrix}$$<br>因此我们的矩阵P是：<br>$$P=\\begin{pmatrix}<br>  1/\\sqrt{2}  &amp; 1/\\sqrt{2}  \\\\\\<br>  -1/\\sqrt{2} &amp; 1/\\sqrt{2}<br>\\end{pmatrix}$$<br>最后我们用P的第一行乘以数据矩阵，就得到了降维后的表示：<br>$$Y=\\begin{pmatrix}<br>  1/\\sqrt{2} &amp; 1/\\sqrt{2}<br>\\end{pmatrix}\\begin{pmatrix}<br>  -1 &amp; -1 &amp; 0 &amp; 2 &amp; 0 \\\\\\<br>  -2 &amp; 0 &amp; 0 &amp; 1 &amp; 1<br>\\end{pmatrix}=\\begin{pmatrix}<br>  -3/\\sqrt{2} &amp; -1/\\sqrt{2} &amp; 0 &amp; 3/\\sqrt{2} &amp; -1/\\sqrt{2}<br>\\end{pmatrix}$$<br>可以验证协方差矩阵C的对角化：<br>$$PCP^\\mathsf{T}=\\begin{pmatrix}<br>  1/\\sqrt{2}  &amp; 1/\\sqrt{2}  \\\\\\<br>  -1/\\sqrt{2} &amp; 1/\\sqrt{2}<br>\\end{pmatrix}\\begin{pmatrix}<br>  6/5 &amp; 4/5 \\\\\\<br>  4/5 &amp; 6/5<br>\\end{pmatrix}\\begin{pmatrix}<br>  1/\\sqrt{2} &amp; -1/\\sqrt{2}  \\\\\\<br>  1/\\sqrt{2} &amp; 1/\\sqrt{2}<br>\\end{pmatrix}=\\begin{pmatrix}<br>  2 &amp; 0  \\\\\\<br>  0 &amp; 2/5<br>\\end{pmatrix}$$<br><img src=\"02.png\" alt></p>\n<h2 id=\"C-实现\"><a href=\"#C-实现\" class=\"headerlink\" title=\"C++实现\"></a>C++实现</h2><p>因为要对一组图片信息进行训练，所以我写了一部分通过摄像头截取图片帧的代码，<code>get_img()</code>函数。这里提取了5个特征脸和一个均值脸</p>\n<pre><code class=\"cpp\">#include &lt;opencv2/core/core.hpp&gt;\n#include &lt;opencv2/highgui/highgui.hpp&gt;\n#include &lt;opencv2/imgproc/imgproc.hpp&gt;\n#include &lt;opencv2/objdetect/objdetect.hpp&gt;\n\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#define img_num 300 //训练图片的张数\nusing namespace cv;\nusing namespace std;\n//通过摄像头保存要训练的图片\n\n//打开摄像头\nint get_img(){\n  VideoCapture cap(0);\n  if(!cap.isOpened())\n  {\n    return -1;\n  }\n  Mat frame;\n  bool stop = false;\n  int i = 1;\n  while(!stop){\n    cap &gt;&gt; frame;\n    printf(&quot;%d\\n&quot;, i);\n    if (frame.empty())\n      stop = true;\n    //string filename = format(&quot;%d.jpg&quot;, i);\n    char filename[20];\n    sprintf(filename, &quot;Img/%d.jpg&quot;, i);\n    imwrite(filename, frame);\n    i++;\n    imshow(&quot;frame&quot;, frame);\n    waitKey(30);\n    if(i &gt; img_num)\n      break;\n\n  }\nreturn -1;\n\n}\n//把图像归一化为0-255\nMat norm_0_255(const Mat&amp; src){\n  Mat dst;\n  switch(src.channels()){\n    case 1:\n        cv::normalize(src, dst, 0, 255, NORM_MINMAX, CV_8UC1);\n        break;\n    case 3:\n        cv::normalize(src, dst, 0, 255, NORM_MINMAX, CV_8UC3);\n        break;\n    default:\n        src.copyTo(dst);\n        break;\n  }\n  return dst;\n}\n\n//将给定的图像转化为行矩阵\nMat asRowMatrix(const vector&lt;Mat&gt;&amp; src, int rtype, double alpha = 1, double beta = 0){\n  // 样本数量\n  size_t n = src.size();\n  //没有样本，返回空矩阵\n  if (n == 0)\n    return Mat();\n\n  //样本的维数\n  size_t d = src[0].total();\n\n  Mat data(n, d, rtype);\n\n  //拷贝数据\n  for (int i = 0; i &lt; n; i++){\n    if(src[i].empty()){\n      string error_message = format(&quot;Image number %d was empty, please check your input data.&quot;, i);\n      CV_Error(CV_StsBadArg, error_message);\n    }\n\n    //确保数据能被reshape\n    if(src[i].total() != d){\n      string error_message = format(&quot;Wrong number of elements in matrix #%d! Expected %d was %d.&quot;, i, d, src[i].total());\n      CV_Error(CV_StsBadArg, error_message);\n    }\n    Mat xi = data.row(i);\n    //转化为1行，n列的格式\n    if(src[i].isContinuous()){\n      src[i].reshape(1, 1).convertTo(xi, rtype, alpha, beta);\n    }\n    else {\n      src[i].clone().reshape(1, 1).convertTo(xi, rtype, alpha, beta);\n    }\n  }\n  return data;\n}\n\nint main(int argc, const char* argv[]){\n  vector&lt;Mat&gt; db;\n  //get_img();\n  for(int i=1; i&lt;img_num;i++){\n\n    string filename = format(&quot;Img/%d.jpg&quot;, i);\n    db.push_back(imread(filename, IMREAD_GRAYSCALE));\n  }\n  // Build a matrix with the observations in row:\n    Mat data = asRowMatrix(db, CV_32FC1);\n\n    // PCA算法保持5主成分分量\n    int num_components = 5;\n\n    //执行pca算法\n    PCA pca(data, Mat(), CV_PCA_DATA_AS_ROW, num_components);\n\n    //copy  pca算法结果\n    Mat mean = pca.mean.clone();\n    Mat eigenvalues = pca.eigenvalues.clone();\n    Mat eigenvectors = pca.eigenvectors.clone();\n        //均值脸\n    imshow(&quot;avg&quot;, norm_0_255(mean.reshape(1, db[0].rows)));\n\n    //五个特征脸\n    imshow(&quot;pc1&quot;, norm_0_255(pca.eigenvectors.row(0)).reshape(1, db[0].rows));\n    imshow(&quot;pc2&quot;, norm_0_255(pca.eigenvectors.row(1)).reshape(1, db[0].rows));\n    imshow(&quot;pc3&quot;, norm_0_255(pca.eigenvectors.row(2)).reshape(1, db[0].rows));\n    imshow(&quot;pc4&quot;, norm_0_255(pca.eigenvectors.row(3)).reshape(1, db[0].rows));\n    imshow(&quot;pc5&quot;, norm_0_255(pca.eigenvectors.row(4)).reshape(1, db[0].rows));\n\n    while(1)\n        waitKey(0);\n\n    // Success!\n    return 0;\n\n}</code></pre>\n<p><img src=\"01.png\" alt></p>\n"},{"title":"SORT","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-01-29T06:20:02.000Z","img":"https://i.loli.net/2020/01/29/tGwhsVWSLndoyYX.jpg","password":null,"summary":"Sort algorithms with python","_content":"\n## SORT\n\n### 1. BUBBLE SORT\n\n```python\nBUBBLE-SORT(A)\n//A:sort array\nfor i = 1 to A.length - 1\n  for j = A.length to i + 1\n    if A[j] < A[j-1]\n      swap(A[j], A[j-1]\n\n```\n\n![BUBBLE_SORT](BUBBLE_SORT.gif) \n\n$$ \\Theta (n^2) $$\n\n### 2. INSERTION SORT\n\n```python\nINSERTION-SORT(A)\n//A:sort array\n\nfor j = 2 to A.length\n  key = A[j]\n  //Insert A[j] into the sorted sequence A[1..j-1]\n  i = j - 1\n  while i > 0 and A[i] > key\n    A[i+1] = A[i]\n    i = i - 1\n  A[i+1] = key\n```\n\n![INSERTION_SORT](INSERTION_SORT.gif) \n\n$$ \\Theta (n^2) $$\n\n### 3. SELECT SORT\n\n```python\nSELECT-SORT(A)\n//A:sort array\nfor i = 1 to range(i,A.length)\n  min = A[i]\n  for j = 1 to A.length\n    if min > A[j]\n      min = A[j]\n      min_index = j\n  swap(A[i],A[min_index])\n```\n\n![SELECT_SORT](SELECT_SORT.gif) \n\n$$ \\Theta (n^2) $$\n\n### 4. MERGE SORT\n\n```python\nMERGE-SORT(A, p, r)\n//A:sort array\n//p:begin index\n//r:end index\n\nif p < r\n  q = [(p + r) / 2]\n  MERGE-SORT(A, p, q)\n  MERGE-SORT(A, q+1, r)\n  MERGE(A, p, q, r)\n\nMERGE(A, p, q, r)\n//A:sort array\n//p:begin index\n//q:mid index\n//r:end index\n\nn1 = q - p + 1\nn2 = r - q\nLet L[1..n1 + 1] and R[1..n2 + 1] be new arrays\nfor i = 1 to n1\n  L[i] = A[p + i - 1]\nfor j = 1 to n2\n  R[j] = A[q + j]\nL[n1 + 1] = infinity\nR[n2 + 1] = infinity\ni = 1\nj = 1\nfor k = p to r\n  if L[i] <= R[j]\n    A[k] = L[i]\n    i = i + 1\n  else\n    A[k] = R[j]\n    j = j + 1\n```\n\n![MERGE_SORT](MERGE_SORT.gif) \n\n$$ \\Theta (n) $$\n","source":"_posts/SORT.md","raw":"---\ntitle: SORT\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-01-29 14:20:02\nimg: https://i.loli.net/2020/01/29/tGwhsVWSLndoyYX.jpg\npassword:\nsummary: Sort algorithms with python\ntags:\n- python\ncategories:\n- Algorithms\n---\n\n## SORT\n\n### 1. BUBBLE SORT\n\n```python\nBUBBLE-SORT(A)\n//A:sort array\nfor i = 1 to A.length - 1\n  for j = A.length to i + 1\n    if A[j] < A[j-1]\n      swap(A[j], A[j-1]\n\n```\n\n![BUBBLE_SORT](BUBBLE_SORT.gif) \n\n$$ \\Theta (n^2) $$\n\n### 2. INSERTION SORT\n\n```python\nINSERTION-SORT(A)\n//A:sort array\n\nfor j = 2 to A.length\n  key = A[j]\n  //Insert A[j] into the sorted sequence A[1..j-1]\n  i = j - 1\n  while i > 0 and A[i] > key\n    A[i+1] = A[i]\n    i = i - 1\n  A[i+1] = key\n```\n\n![INSERTION_SORT](INSERTION_SORT.gif) \n\n$$ \\Theta (n^2) $$\n\n### 3. SELECT SORT\n\n```python\nSELECT-SORT(A)\n//A:sort array\nfor i = 1 to range(i,A.length)\n  min = A[i]\n  for j = 1 to A.length\n    if min > A[j]\n      min = A[j]\n      min_index = j\n  swap(A[i],A[min_index])\n```\n\n![SELECT_SORT](SELECT_SORT.gif) \n\n$$ \\Theta (n^2) $$\n\n### 4. MERGE SORT\n\n```python\nMERGE-SORT(A, p, r)\n//A:sort array\n//p:begin index\n//r:end index\n\nif p < r\n  q = [(p + r) / 2]\n  MERGE-SORT(A, p, q)\n  MERGE-SORT(A, q+1, r)\n  MERGE(A, p, q, r)\n\nMERGE(A, p, q, r)\n//A:sort array\n//p:begin index\n//q:mid index\n//r:end index\n\nn1 = q - p + 1\nn2 = r - q\nLet L[1..n1 + 1] and R[1..n2 + 1] be new arrays\nfor i = 1 to n1\n  L[i] = A[p + i - 1]\nfor j = 1 to n2\n  R[j] = A[q + j]\nL[n1 + 1] = infinity\nR[n2 + 1] = infinity\ni = 1\nj = 1\nfor k = p to r\n  if L[i] <= R[j]\n    A[k] = L[i]\n    i = i + 1\n  else\n    A[k] = R[j]\n    j = j + 1\n```\n\n![MERGE_SORT](MERGE_SORT.gif) \n\n$$ \\Theta (n) $$\n","slug":"SORT","published":1,"updated":"2020-02-24T10:49:41.424Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0tg001r74jumzscsu3w","content":"<h2 id=\"SORT\"><a href=\"#SORT\" class=\"headerlink\" title=\"SORT\"></a>SORT</h2><h3 id=\"1-BUBBLE-SORT\"><a href=\"#1-BUBBLE-SORT\" class=\"headerlink\" title=\"1. BUBBLE SORT\"></a>1. BUBBLE SORT</h3><pre class=\" language-python\"><code class=\"language-python\">BUBBLE<span class=\"token operator\">-</span>SORT<span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">//</span>A<span class=\"token punctuation\">:</span>sort array\n<span class=\"token keyword\">for</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span> to A<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n  <span class=\"token keyword\">for</span> j <span class=\"token operator\">=</span> A<span class=\"token punctuation\">.</span>length to i <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">if</span> A<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> A<span class=\"token punctuation\">[</span>j<span class=\"token number\">-1</span><span class=\"token punctuation\">]</span>\n      swap<span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> A<span class=\"token punctuation\">[</span>j<span class=\"token number\">-1</span><span class=\"token punctuation\">]</span>\n</code></pre>\n<p><img src=\"BUBBLE_SORT.gif\" alt=\"BUBBLE_SORT\"> </p>\n<p>$$ \\Theta (n^2) $$</p>\n<h3 id=\"2-INSERTION-SORT\"><a href=\"#2-INSERTION-SORT\" class=\"headerlink\" title=\"2. INSERTION SORT\"></a>2. INSERTION SORT</h3><pre class=\" language-python\"><code class=\"language-python\">INSERTION<span class=\"token operator\">-</span>SORT<span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">//</span>A<span class=\"token punctuation\">:</span>sort array\n\n<span class=\"token keyword\">for</span> j <span class=\"token operator\">=</span> <span class=\"token number\">2</span> to A<span class=\"token punctuation\">.</span>length\n  key <span class=\"token operator\">=</span> A<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span>\n  <span class=\"token operator\">//</span>Insert A<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> into the sorted sequence A<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>j<span class=\"token number\">-1</span><span class=\"token punctuation\">]</span>\n  i <span class=\"token operator\">=</span> j <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n  <span class=\"token keyword\">while</span> i <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">and</span> A<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> key\n    A<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> A<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n    i <span class=\"token operator\">=</span> i <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n  A<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> key</code></pre>\n<p><img src=\"INSERTION_SORT.gif\" alt=\"INSERTION_SORT\"> </p>\n<p>$$ \\Theta (n^2) $$</p>\n<h3 id=\"3-SELECT-SORT\"><a href=\"#3-SELECT-SORT\" class=\"headerlink\" title=\"3. SELECT SORT\"></a>3. SELECT SORT</h3><pre class=\" language-python\"><code class=\"language-python\">SELECT<span class=\"token operator\">-</span>SORT<span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">//</span>A<span class=\"token punctuation\">:</span>sort array\n<span class=\"token keyword\">for</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span> to range<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span>A<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span>\n  min <span class=\"token operator\">=</span> A<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">for</span> j <span class=\"token operator\">=</span> <span class=\"token number\">1</span> to A<span class=\"token punctuation\">.</span>length\n    <span class=\"token keyword\">if</span> min <span class=\"token operator\">></span> A<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span>\n      min <span class=\"token operator\">=</span> A<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span>\n      min_index <span class=\"token operator\">=</span> j\n  swap<span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>A<span class=\"token punctuation\">[</span>min_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre>\n<p><img src=\"SELECT_SORT.gif\" alt=\"SELECT_SORT\"> </p>\n<p>$$ \\Theta (n^2) $$</p>\n<h3 id=\"4-MERGE-SORT\"><a href=\"#4-MERGE-SORT\" class=\"headerlink\" title=\"4. MERGE SORT\"></a>4. MERGE SORT</h3><pre class=\" language-python\"><code class=\"language-python\">MERGE<span class=\"token operator\">-</span>SORT<span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">//</span>A<span class=\"token punctuation\">:</span>sort array\n<span class=\"token operator\">//</span>p<span class=\"token punctuation\">:</span>begin index\n<span class=\"token operator\">//</span>r<span class=\"token punctuation\">:</span>end index\n\n<span class=\"token keyword\">if</span> p <span class=\"token operator\">&lt;</span> r\n  q <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>p <span class=\"token operator\">+</span> r<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n  MERGE<span class=\"token operator\">-</span>SORT<span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">,</span> q<span class=\"token punctuation\">)</span>\n  MERGE<span class=\"token operator\">-</span>SORT<span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">,</span> q<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">)</span>\n  MERGE<span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">,</span> q<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">)</span>\n\nMERGE<span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">,</span> q<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">//</span>A<span class=\"token punctuation\">:</span>sort array\n<span class=\"token operator\">//</span>p<span class=\"token punctuation\">:</span>begin index\n<span class=\"token operator\">//</span>q<span class=\"token punctuation\">:</span>mid index\n<span class=\"token operator\">//</span>r<span class=\"token punctuation\">:</span>end index\n\nn1 <span class=\"token operator\">=</span> q <span class=\"token operator\">-</span> p <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\nn2 <span class=\"token operator\">=</span> r <span class=\"token operator\">-</span> q\nLet L<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>n1 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">and</span> R<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>n2 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> be new arrays\n<span class=\"token keyword\">for</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span> to n1\n  L<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> A<span class=\"token punctuation\">[</span>p <span class=\"token operator\">+</span> i <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> j <span class=\"token operator\">=</span> <span class=\"token number\">1</span> to n2\n  R<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> A<span class=\"token punctuation\">[</span>q <span class=\"token operator\">+</span> j<span class=\"token punctuation\">]</span>\nL<span class=\"token punctuation\">[</span>n1 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> infinity\nR<span class=\"token punctuation\">[</span>n2 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> infinity\ni <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nj <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">for</span> k <span class=\"token operator\">=</span> p to r\n  <span class=\"token keyword\">if</span> L<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span> R<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span>\n    A<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> L<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n    i <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n  <span class=\"token keyword\">else</span>\n    A<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> R<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span>\n    j <span class=\"token operator\">=</span> j <span class=\"token operator\">+</span> <span class=\"token number\">1</span></code></pre>\n<p><img src=\"MERGE_SORT.gif\" alt=\"MERGE_SORT\"> </p>\n<p>$$ \\Theta (n) $$</p>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h2 id=\"SORT\"><a href=\"#SORT\" class=\"headerlink\" title=\"SORT\"></a>SORT</h2><h3 id=\"1-BUBBLE-SORT\"><a href=\"#1-BUBBLE-SORT\" class=\"headerlink\" title=\"1. BUBBLE SORT\"></a>1. BUBBLE SORT</h3><pre><code class=\"python\">BUBBLE-SORT(A)\n//A:sort array\nfor i = 1 to A.length - 1\n  for j = A.length to i + 1\n    if A[j] &lt; A[j-1]\n      swap(A[j], A[j-1]\n</code></pre>\n<p><img src=\"BUBBLE_SORT.gif\" alt=\"BUBBLE_SORT\"> </p>\n<p>$$ \\Theta (n^2) $$</p>\n<h3 id=\"2-INSERTION-SORT\"><a href=\"#2-INSERTION-SORT\" class=\"headerlink\" title=\"2. INSERTION SORT\"></a>2. INSERTION SORT</h3><pre><code class=\"python\">INSERTION-SORT(A)\n//A:sort array\n\nfor j = 2 to A.length\n  key = A[j]\n  //Insert A[j] into the sorted sequence A[1..j-1]\n  i = j - 1\n  while i &gt; 0 and A[i] &gt; key\n    A[i+1] = A[i]\n    i = i - 1\n  A[i+1] = key</code></pre>\n<p><img src=\"INSERTION_SORT.gif\" alt=\"INSERTION_SORT\"> </p>\n<p>$$ \\Theta (n^2) $$</p>\n<h3 id=\"3-SELECT-SORT\"><a href=\"#3-SELECT-SORT\" class=\"headerlink\" title=\"3. SELECT SORT\"></a>3. SELECT SORT</h3><pre><code class=\"python\">SELECT-SORT(A)\n//A:sort array\nfor i = 1 to range(i,A.length)\n  min = A[i]\n  for j = 1 to A.length\n    if min &gt; A[j]\n      min = A[j]\n      min_index = j\n  swap(A[i],A[min_index])</code></pre>\n<p><img src=\"SELECT_SORT.gif\" alt=\"SELECT_SORT\"> </p>\n<p>$$ \\Theta (n^2) $$</p>\n<h3 id=\"4-MERGE-SORT\"><a href=\"#4-MERGE-SORT\" class=\"headerlink\" title=\"4. MERGE SORT\"></a>4. MERGE SORT</h3><pre><code class=\"python\">MERGE-SORT(A, p, r)\n//A:sort array\n//p:begin index\n//r:end index\n\nif p &lt; r\n  q = [(p + r) / 2]\n  MERGE-SORT(A, p, q)\n  MERGE-SORT(A, q+1, r)\n  MERGE(A, p, q, r)\n\nMERGE(A, p, q, r)\n//A:sort array\n//p:begin index\n//q:mid index\n//r:end index\n\nn1 = q - p + 1\nn2 = r - q\nLet L[1..n1 + 1] and R[1..n2 + 1] be new arrays\nfor i = 1 to n1\n  L[i] = A[p + i - 1]\nfor j = 1 to n2\n  R[j] = A[q + j]\nL[n1 + 1] = infinity\nR[n2 + 1] = infinity\ni = 1\nj = 1\nfor k = p to r\n  if L[i] &lt;= R[j]\n    A[k] = L[i]\n    i = i + 1\n  else\n    A[k] = R[j]\n    j = j + 1</code></pre>\n<p><img src=\"MERGE_SORT.gif\" alt=\"MERGE_SORT\"> </p>\n<p>$$ \\Theta (n) $$</p>\n"},{"title":"Vim","top":true,"img":"https://i.loli.net/2019/11/23/EKUi4P2qMnZoktG.jpg","cover":false,"toc":true,"mathjax":false,"date":"2019-11-23T14:10:56.000Z","password":null,"summary":"Vim is a highly configurable text editor for efficiently creating and changing any kind of text.","_content":"\n## - My Vim(Neovim) Config\n\n[GitHub Link](https://github.com/liuyaanng/NeoVim-Config)\n\n### Basic Mappings\n\n![Vim-cheat-sheet](vim_cheat_sheet.png)\n![Colemak Keyboard](colemak.png)\n\n- **set &lt; LEADER &gt; as &lt;SPACE &gt;**\n\n- The Keyboard i use is **Colemak**, so i change some keys.\n\n- Cursor Movement\n  - Up: u\n  - Down: e\n  - Left: n\n  - Right: i\n\nAfter | Before | Function\n:---: | :---: | :---:\nl | u | Undo operations\nL |   | Undotree\nCtrl + l | Ctrl + u | Undo in Insert mode\nk | i | Insert key\nK | I | Insert key\nH | J | Joining (two) to one line\nh | e | end of word\n&lt; | &lt;&lt; | Indentation(left)\n &gt; |  &gt; &gt; | Indentation(right)\n&lt;LEADER &gt;&lt;CR &gt; | :nohlstarch&lt;CR &gt; | Eliminate the yellow shadow after the search\n= | nzz | Down the search(zz:center cursor line in window)\n- | Nzz | Up the search\n&lt;LEADER &gt;dw |\n&lt;LEADER &gt;o | za | Folding\nu | k | Up\ne | j | Down\nn | h | Left\ni | l | Right\nU | 5e | Up(faster)\nE | 5j | Down(faster)\nN | 0 | Go to the start of the line\nI | $ | Go to the end of the line\nW | 5w | Next word(Faster in-line navigation)\nB | 5b | Prev word(Faster in-line navigation)\nCtrl + U | 5Ctrl + y | Move up the view port without moving the cursor\nCtrl + E | 5Ctrl + e | Move down the view port without moving the cursor\ns | &lt;nop &gt; | Nothing\n&lt;LEADER &gt;w | Ctrl + w w | Moving the cursor to the next windows\n&lt;LEADER &gt;u | Ctrl + w j | Moving the cursor to the up windows\n&lt;LEADER &gt;e | Ctrl + w k | Moving the cursor to the down windows\n&lt;LEADER &gt;n | Ctrl + w h | Moving the cursor to the left windows\n&lt;LEADER &gt;i | Ctrl + w l | Moving the cursor to the right windows\n\n\n| Shortcuts | Function |\n:----:   | :----:\nQ | quit\nS | save\n&lt;LEADER &gt;rc | Open the vimrc file anytime\n&lt;LEADER &gt;st | Open Startify\nsu | split the screens to up\nse | split the screens to down\nsn | split the screens to left\nsi | split the screens to right\n&lt;UP &gt; | Horizontal +5\n&lt;Down &gt; | Horizontal -5\n&lt;LEFT &gt; | Vertical -5\n&lt;RIGHT &gt; | Vertical +5\nsh | Place the two screens up and down\nsv | Place the two screens side by side\nsrh | Rotate the screens in horizontal direction\nsrv | Rotate the screens in vertical direction\n&lt;LEADER &gt;/ | Opening a terminal window\n&lt;LEADER &gt;&lt;LEADER &gt; | Jump to the next '&lt; ++ &gt;' and edit it\n\n\n","source":"_posts/Vim.md","raw":"---\ntitle: Vim\ntop: true\nimg: https://i.loli.net/2019/11/23/EKUi4P2qMnZoktG.jpg\ncover: false\ntoc: true\nmathjax: false\ndate: 2019-11-23 22:10:56\npassword:\nsummary: Vim is a highly configurable text editor for efficiently creating and changing any kind of text.\ntags:\n- Vim\n- Linux\ncategories:\n- 教程\n---\n\n## - My Vim(Neovim) Config\n\n[GitHub Link](https://github.com/liuyaanng/NeoVim-Config)\n\n### Basic Mappings\n\n![Vim-cheat-sheet](vim_cheat_sheet.png)\n![Colemak Keyboard](colemak.png)\n\n- **set &lt; LEADER &gt; as &lt;SPACE &gt;**\n\n- The Keyboard i use is **Colemak**, so i change some keys.\n\n- Cursor Movement\n  - Up: u\n  - Down: e\n  - Left: n\n  - Right: i\n\nAfter | Before | Function\n:---: | :---: | :---:\nl | u | Undo operations\nL |   | Undotree\nCtrl + l | Ctrl + u | Undo in Insert mode\nk | i | Insert key\nK | I | Insert key\nH | J | Joining (two) to one line\nh | e | end of word\n&lt; | &lt;&lt; | Indentation(left)\n &gt; |  &gt; &gt; | Indentation(right)\n&lt;LEADER &gt;&lt;CR &gt; | :nohlstarch&lt;CR &gt; | Eliminate the yellow shadow after the search\n= | nzz | Down the search(zz:center cursor line in window)\n- | Nzz | Up the search\n&lt;LEADER &gt;dw |\n&lt;LEADER &gt;o | za | Folding\nu | k | Up\ne | j | Down\nn | h | Left\ni | l | Right\nU | 5e | Up(faster)\nE | 5j | Down(faster)\nN | 0 | Go to the start of the line\nI | $ | Go to the end of the line\nW | 5w | Next word(Faster in-line navigation)\nB | 5b | Prev word(Faster in-line navigation)\nCtrl + U | 5Ctrl + y | Move up the view port without moving the cursor\nCtrl + E | 5Ctrl + e | Move down the view port without moving the cursor\ns | &lt;nop &gt; | Nothing\n&lt;LEADER &gt;w | Ctrl + w w | Moving the cursor to the next windows\n&lt;LEADER &gt;u | Ctrl + w j | Moving the cursor to the up windows\n&lt;LEADER &gt;e | Ctrl + w k | Moving the cursor to the down windows\n&lt;LEADER &gt;n | Ctrl + w h | Moving the cursor to the left windows\n&lt;LEADER &gt;i | Ctrl + w l | Moving the cursor to the right windows\n\n\n| Shortcuts | Function |\n:----:   | :----:\nQ | quit\nS | save\n&lt;LEADER &gt;rc | Open the vimrc file anytime\n&lt;LEADER &gt;st | Open Startify\nsu | split the screens to up\nse | split the screens to down\nsn | split the screens to left\nsi | split the screens to right\n&lt;UP &gt; | Horizontal +5\n&lt;Down &gt; | Horizontal -5\n&lt;LEFT &gt; | Vertical -5\n&lt;RIGHT &gt; | Vertical +5\nsh | Place the two screens up and down\nsv | Place the two screens side by side\nsrh | Rotate the screens in horizontal direction\nsrv | Rotate the screens in vertical direction\n&lt;LEADER &gt;/ | Opening a terminal window\n&lt;LEADER &gt;&lt;LEADER &gt; | Jump to the next '&lt; ++ &gt;' and edit it\n\n\n","slug":"Vim","published":1,"updated":"2020-02-24T10:49:41.437Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0ti001v74ju9iq0plt0","content":"<h2 id=\"My-Vim-Neovim-Config\"><a href=\"#My-Vim-Neovim-Config\" class=\"headerlink\" title=\"- My Vim(Neovim) Config\"></a>- My Vim(Neovim) Config</h2><p><a href=\"https://github.com/liuyaanng/NeoVim-Config\" target=\"_blank\" rel=\"noopener\">GitHub Link</a></p>\n<h3 id=\"Basic-Mappings\"><a href=\"#Basic-Mappings\" class=\"headerlink\" title=\"Basic Mappings\"></a>Basic Mappings</h3><p><img src=\"vim_cheat_sheet.png\" alt=\"Vim-cheat-sheet\"><br><img src=\"colemak.png\" alt=\"Colemak Keyboard\"></p>\n<ul>\n<li><p><strong>set &lt; LEADER &gt; as &lt;SPACE &gt;</strong></p>\n</li>\n<li><p>The Keyboard i use is <strong>Colemak</strong>, so i change some keys.</p>\n</li>\n<li><p>Cursor Movement</p>\n<ul>\n<li>Up: u</li>\n<li>Down: e</li>\n<li>Left: n</li>\n<li>Right: i</li>\n</ul>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">After</th>\n<th align=\"center\">Before</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">l</td>\n<td align=\"center\">u</td>\n<td align=\"center\">Undo operations</td>\n</tr>\n<tr>\n<td align=\"center\">L</td>\n<td align=\"center\"></td>\n<td align=\"center\">Undotree</td>\n</tr>\n<tr>\n<td align=\"center\">Ctrl + l</td>\n<td align=\"center\">Ctrl + u</td>\n<td align=\"center\">Undo in Insert mode</td>\n</tr>\n<tr>\n<td align=\"center\">k</td>\n<td align=\"center\">i</td>\n<td align=\"center\">Insert key</td>\n</tr>\n<tr>\n<td align=\"center\">K</td>\n<td align=\"center\">I</td>\n<td align=\"center\">Insert key</td>\n</tr>\n<tr>\n<td align=\"center\">H</td>\n<td align=\"center\">J</td>\n<td align=\"center\">Joining (two) to one line</td>\n</tr>\n<tr>\n<td align=\"center\">h</td>\n<td align=\"center\">e</td>\n<td align=\"center\">end of word</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;</td>\n<td align=\"center\">&lt;&lt;</td>\n<td align=\"center\">Indentation(left)</td>\n</tr>\n<tr>\n<td align=\"center\">&gt;</td>\n<td align=\"center\">&gt; &gt;</td>\n<td align=\"center\">Indentation(right)</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;&lt;CR &gt;</td>\n<td align=\"center\">:nohlstarch&lt;CR &gt;</td>\n<td align=\"center\">Eliminate the yellow shadow after the search</td>\n</tr>\n<tr>\n<td align=\"center\">=</td>\n<td align=\"center\">nzz</td>\n<td align=\"center\">Down the search(zz:center cursor line in window)</td>\n</tr>\n<tr>\n<td align=\"center\">-</td>\n<td align=\"center\">Nzz</td>\n<td align=\"center\">Up the search</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;dw</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;o</td>\n<td align=\"center\">za</td>\n<td align=\"center\">Folding</td>\n</tr>\n<tr>\n<td align=\"center\">u</td>\n<td align=\"center\">k</td>\n<td align=\"center\">Up</td>\n</tr>\n<tr>\n<td align=\"center\">e</td>\n<td align=\"center\">j</td>\n<td align=\"center\">Down</td>\n</tr>\n<tr>\n<td align=\"center\">n</td>\n<td align=\"center\">h</td>\n<td align=\"center\">Left</td>\n</tr>\n<tr>\n<td align=\"center\">i</td>\n<td align=\"center\">l</td>\n<td align=\"center\">Right</td>\n</tr>\n<tr>\n<td align=\"center\">U</td>\n<td align=\"center\">5e</td>\n<td align=\"center\">Up(faster)</td>\n</tr>\n<tr>\n<td align=\"center\">E</td>\n<td align=\"center\">5j</td>\n<td align=\"center\">Down(faster)</td>\n</tr>\n<tr>\n<td align=\"center\">N</td>\n<td align=\"center\">0</td>\n<td align=\"center\">Go to the start of the line</td>\n</tr>\n<tr>\n<td align=\"center\">I</td>\n<td align=\"center\">$</td>\n<td align=\"center\">Go to the end of the line</td>\n</tr>\n<tr>\n<td align=\"center\">W</td>\n<td align=\"center\">5w</td>\n<td align=\"center\">Next word(Faster in-line navigation)</td>\n</tr>\n<tr>\n<td align=\"center\">B</td>\n<td align=\"center\">5b</td>\n<td align=\"center\">Prev word(Faster in-line navigation)</td>\n</tr>\n<tr>\n<td align=\"center\">Ctrl + U</td>\n<td align=\"center\">5Ctrl + y</td>\n<td align=\"center\">Move up the view port without moving the cursor</td>\n</tr>\n<tr>\n<td align=\"center\">Ctrl + E</td>\n<td align=\"center\">5Ctrl + e</td>\n<td align=\"center\">Move down the view port without moving the cursor</td>\n</tr>\n<tr>\n<td align=\"center\">s</td>\n<td align=\"center\">&lt;nop &gt;</td>\n<td align=\"center\">Nothing</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;w</td>\n<td align=\"center\">Ctrl + w w</td>\n<td align=\"center\">Moving the cursor to the next windows</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;u</td>\n<td align=\"center\">Ctrl + w j</td>\n<td align=\"center\">Moving the cursor to the up windows</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;e</td>\n<td align=\"center\">Ctrl + w k</td>\n<td align=\"center\">Moving the cursor to the down windows</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;n</td>\n<td align=\"center\">Ctrl + w h</td>\n<td align=\"center\">Moving the cursor to the left windows</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;i</td>\n<td align=\"center\">Ctrl + w l</td>\n<td align=\"center\">Moving the cursor to the right windows</td>\n</tr>\n</tbody></table>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Shortcuts</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">Q</td>\n<td align=\"center\">quit</td>\n</tr>\n<tr>\n<td align=\"center\">S</td>\n<td align=\"center\">save</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;rc</td>\n<td align=\"center\">Open the vimrc file anytime</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;st</td>\n<td align=\"center\">Open Startify</td>\n</tr>\n<tr>\n<td align=\"center\">su</td>\n<td align=\"center\">split the screens to up</td>\n</tr>\n<tr>\n<td align=\"center\">se</td>\n<td align=\"center\">split the screens to down</td>\n</tr>\n<tr>\n<td align=\"center\">sn</td>\n<td align=\"center\">split the screens to left</td>\n</tr>\n<tr>\n<td align=\"center\">si</td>\n<td align=\"center\">split the screens to right</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;UP &gt;</td>\n<td align=\"center\">Horizontal +5</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;Down &gt;</td>\n<td align=\"center\">Horizontal -5</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEFT &gt;</td>\n<td align=\"center\">Vertical -5</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;RIGHT &gt;</td>\n<td align=\"center\">Vertical +5</td>\n</tr>\n<tr>\n<td align=\"center\">sh</td>\n<td align=\"center\">Place the two screens up and down</td>\n</tr>\n<tr>\n<td align=\"center\">sv</td>\n<td align=\"center\">Place the two screens side by side</td>\n</tr>\n<tr>\n<td align=\"center\">srh</td>\n<td align=\"center\">Rotate the screens in horizontal direction</td>\n</tr>\n<tr>\n<td align=\"center\">srv</td>\n<td align=\"center\">Rotate the screens in vertical direction</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;/</td>\n<td align=\"center\">Opening a terminal window</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;&lt;LEADER &gt;</td>\n<td align=\"center\">Jump to the next ‘&lt; ++ &gt;’ and edit it</td>\n</tr>\n</tbody></table>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h2 id=\"My-Vim-Neovim-Config\"><a href=\"#My-Vim-Neovim-Config\" class=\"headerlink\" title=\"- My Vim(Neovim) Config\"></a>- My Vim(Neovim) Config</h2><p><a href=\"https://github.com/liuyaanng/NeoVim-Config\" target=\"_blank\" rel=\"noopener\">GitHub Link</a></p>\n<h3 id=\"Basic-Mappings\"><a href=\"#Basic-Mappings\" class=\"headerlink\" title=\"Basic Mappings\"></a>Basic Mappings</h3><p><img src=\"vim_cheat_sheet.png\" alt=\"Vim-cheat-sheet\"><br><img src=\"colemak.png\" alt=\"Colemak Keyboard\"></p>\n<ul>\n<li><p><strong>set &lt; LEADER &gt; as &lt;SPACE &gt;</strong></p>\n</li>\n<li><p>The Keyboard i use is <strong>Colemak</strong>, so i change some keys.</p>\n</li>\n<li><p>Cursor Movement</p>\n<ul>\n<li>Up: u</li>\n<li>Down: e</li>\n<li>Left: n</li>\n<li>Right: i</li>\n</ul>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">After</th>\n<th align=\"center\">Before</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">l</td>\n<td align=\"center\">u</td>\n<td align=\"center\">Undo operations</td>\n</tr>\n<tr>\n<td align=\"center\">L</td>\n<td align=\"center\"></td>\n<td align=\"center\">Undotree</td>\n</tr>\n<tr>\n<td align=\"center\">Ctrl + l</td>\n<td align=\"center\">Ctrl + u</td>\n<td align=\"center\">Undo in Insert mode</td>\n</tr>\n<tr>\n<td align=\"center\">k</td>\n<td align=\"center\">i</td>\n<td align=\"center\">Insert key</td>\n</tr>\n<tr>\n<td align=\"center\">K</td>\n<td align=\"center\">I</td>\n<td align=\"center\">Insert key</td>\n</tr>\n<tr>\n<td align=\"center\">H</td>\n<td align=\"center\">J</td>\n<td align=\"center\">Joining (two) to one line</td>\n</tr>\n<tr>\n<td align=\"center\">h</td>\n<td align=\"center\">e</td>\n<td align=\"center\">end of word</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;</td>\n<td align=\"center\">&lt;&lt;</td>\n<td align=\"center\">Indentation(left)</td>\n</tr>\n<tr>\n<td align=\"center\">&gt;</td>\n<td align=\"center\">&gt; &gt;</td>\n<td align=\"center\">Indentation(right)</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;&lt;CR &gt;</td>\n<td align=\"center\">:nohlstarch&lt;CR &gt;</td>\n<td align=\"center\">Eliminate the yellow shadow after the search</td>\n</tr>\n<tr>\n<td align=\"center\">=</td>\n<td align=\"center\">nzz</td>\n<td align=\"center\">Down the search(zz:center cursor line in window)</td>\n</tr>\n<tr>\n<td align=\"center\">-</td>\n<td align=\"center\">Nzz</td>\n<td align=\"center\">Up the search</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;dw</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;o</td>\n<td align=\"center\">za</td>\n<td align=\"center\">Folding</td>\n</tr>\n<tr>\n<td align=\"center\">u</td>\n<td align=\"center\">k</td>\n<td align=\"center\">Up</td>\n</tr>\n<tr>\n<td align=\"center\">e</td>\n<td align=\"center\">j</td>\n<td align=\"center\">Down</td>\n</tr>\n<tr>\n<td align=\"center\">n</td>\n<td align=\"center\">h</td>\n<td align=\"center\">Left</td>\n</tr>\n<tr>\n<td align=\"center\">i</td>\n<td align=\"center\">l</td>\n<td align=\"center\">Right</td>\n</tr>\n<tr>\n<td align=\"center\">U</td>\n<td align=\"center\">5e</td>\n<td align=\"center\">Up(faster)</td>\n</tr>\n<tr>\n<td align=\"center\">E</td>\n<td align=\"center\">5j</td>\n<td align=\"center\">Down(faster)</td>\n</tr>\n<tr>\n<td align=\"center\">N</td>\n<td align=\"center\">0</td>\n<td align=\"center\">Go to the start of the line</td>\n</tr>\n<tr>\n<td align=\"center\">I</td>\n<td align=\"center\">$</td>\n<td align=\"center\">Go to the end of the line</td>\n</tr>\n<tr>\n<td align=\"center\">W</td>\n<td align=\"center\">5w</td>\n<td align=\"center\">Next word(Faster in-line navigation)</td>\n</tr>\n<tr>\n<td align=\"center\">B</td>\n<td align=\"center\">5b</td>\n<td align=\"center\">Prev word(Faster in-line navigation)</td>\n</tr>\n<tr>\n<td align=\"center\">Ctrl + U</td>\n<td align=\"center\">5Ctrl + y</td>\n<td align=\"center\">Move up the view port without moving the cursor</td>\n</tr>\n<tr>\n<td align=\"center\">Ctrl + E</td>\n<td align=\"center\">5Ctrl + e</td>\n<td align=\"center\">Move down the view port without moving the cursor</td>\n</tr>\n<tr>\n<td align=\"center\">s</td>\n<td align=\"center\">&lt;nop &gt;</td>\n<td align=\"center\">Nothing</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;w</td>\n<td align=\"center\">Ctrl + w w</td>\n<td align=\"center\">Moving the cursor to the next windows</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;u</td>\n<td align=\"center\">Ctrl + w j</td>\n<td align=\"center\">Moving the cursor to the up windows</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;e</td>\n<td align=\"center\">Ctrl + w k</td>\n<td align=\"center\">Moving the cursor to the down windows</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;n</td>\n<td align=\"center\">Ctrl + w h</td>\n<td align=\"center\">Moving the cursor to the left windows</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;i</td>\n<td align=\"center\">Ctrl + w l</td>\n<td align=\"center\">Moving the cursor to the right windows</td>\n</tr>\n</tbody></table>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Shortcuts</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">Q</td>\n<td align=\"center\">quit</td>\n</tr>\n<tr>\n<td align=\"center\">S</td>\n<td align=\"center\">save</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;rc</td>\n<td align=\"center\">Open the vimrc file anytime</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;st</td>\n<td align=\"center\">Open Startify</td>\n</tr>\n<tr>\n<td align=\"center\">su</td>\n<td align=\"center\">split the screens to up</td>\n</tr>\n<tr>\n<td align=\"center\">se</td>\n<td align=\"center\">split the screens to down</td>\n</tr>\n<tr>\n<td align=\"center\">sn</td>\n<td align=\"center\">split the screens to left</td>\n</tr>\n<tr>\n<td align=\"center\">si</td>\n<td align=\"center\">split the screens to right</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;UP &gt;</td>\n<td align=\"center\">Horizontal +5</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;Down &gt;</td>\n<td align=\"center\">Horizontal -5</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEFT &gt;</td>\n<td align=\"center\">Vertical -5</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;RIGHT &gt;</td>\n<td align=\"center\">Vertical +5</td>\n</tr>\n<tr>\n<td align=\"center\">sh</td>\n<td align=\"center\">Place the two screens up and down</td>\n</tr>\n<tr>\n<td align=\"center\">sv</td>\n<td align=\"center\">Place the two screens side by side</td>\n</tr>\n<tr>\n<td align=\"center\">srh</td>\n<td align=\"center\">Rotate the screens in horizontal direction</td>\n</tr>\n<tr>\n<td align=\"center\">srv</td>\n<td align=\"center\">Rotate the screens in vertical direction</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;/</td>\n<td align=\"center\">Opening a terminal window</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;LEADER &gt;&lt;LEADER &gt;</td>\n<td align=\"center\">Jump to the next ‘&lt; ++ &gt;’ and edit it</td>\n</tr>\n</tbody></table>\n"},{"title":"hexo大坑","date":"2019-07-22T09:20:52.000Z","toc":true,"summary":"总结自己在使用hexo的过程中遇到的问题，持续更新中...","cover":false,"img":"https://i.loli.net/2019/07/22/5d358d83b3a0315599.png","_content":"\n## 坑一、Template render error 模板渲染错误\n写了一下午博文，高高兴兴地hexo g却发现报错了！   \n`INFO  Start processing\nFATAL Something's wrong. Maybe you can find the solution here: https://hexo.io/docs/troubleshooting.html\nNunjucks Error:  [Line 2, Column 6] unexpected token: }}\n at formatNunjucksError (/home/kevin/blog/node_modules/hexo/lib/extend/tag.js:102:13)\n    at Promise.fromCallback.catch.err (/home/kevin/blog/node_modules/hexo/lib/extend/tag.js:124:34)\n    at tryCatcher (/home/kevin/blog/node_modules/bluebird/js/release/util.js:16:23)\n    at Promise._settlePromiseFromHandler (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:517:31)\n    at Promise._settlePromise (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:574:18)\n    at Promise._settlePromise0 (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:619:10)\n    at Promise._settlePromises (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:695:18)\n    at _drainQueueStep (/home/kevin/blog/node_modules/bluebird/js/release/async.js:138:12)\n    at _drainQueue (/home/kevin/blog/node_modules/bluebird/js/release/async.js:131:9)\n    at Async._drainQueues (/home/kevin/blog/node_modules/bluebird/js/release/async.js:147:5)\n    at Immediate.Async.drainQueues [as _onImmediate] (/home/kevin/blog/node_modules/bluebird/js/release/async.js:17:14)\n    at processImmediate (internal/timers.js:443:21)`\n    \n原因是nunjucks模板标签导致MD文件解析报错的问题，我试验了一下，在md文档中出现`双大括号`,`左大括号+#`,`左大括号+%`等都会报错(原谅我这么打，因为我打出来符号的话这篇博客就发不出来了)，下面是一位大神的[解决办法](http://xcoding.tech/2018/08/08/hexo/%E5%A6%82%E4%BD%95%E4%BB%8E%E6%A0%B9%E6%9C%AC%E8%A7%A3%E5%86%B3hexo%E4%B8%8D%E5%85%BC%E5%AE%B9%7B%7B%7D%7D%E6%A0%87%E7%AD%BE%E9%97%AE%E9%A2%98/)，他提供了几种解决办法，讲的很详细，可以参考一下\n\n我觉得有点麻烦就没采用(说多了就是菜～),下面是我的办法:\n1. 既然出现上面的内容就会报错，那就尽量避免出现呗...(说的都是废话)\n2. 使用`\\lbrace`代替`\\{`,使用`\\rbrace`代替`\\}`\n推荐大神的解决办法，一劳永逸，以后就不用管了\n\n\n## 坑二、Markdown的空行\n在写表格的时候要把表格体前后各空一行，不然你写的表格是这样式儿的，崩溃啊！\n![](https://i.loli.net/2019/07/22/5d358cfee55f989745.png)\n\n有可能是hexo解析的问题，我在使用markdown-preview的时候看的是正常的\n","source":"_posts/hexo大坑.md","raw":"---\ntitle: hexo大坑\ndate: 2019-07-22 17:20:52\ntags: \n- hexo\ncategories: \n- 教程\ntoc: true\nsummary: 总结自己在使用hexo的过程中遇到的问题，持续更新中...\ncover: false\nimg: https://i.loli.net/2019/07/22/5d358d83b3a0315599.png\n---\n\n## 坑一、Template render error 模板渲染错误\n写了一下午博文，高高兴兴地hexo g却发现报错了！   \n`INFO  Start processing\nFATAL Something's wrong. Maybe you can find the solution here: https://hexo.io/docs/troubleshooting.html\nNunjucks Error:  [Line 2, Column 6] unexpected token: }}\n at formatNunjucksError (/home/kevin/blog/node_modules/hexo/lib/extend/tag.js:102:13)\n    at Promise.fromCallback.catch.err (/home/kevin/blog/node_modules/hexo/lib/extend/tag.js:124:34)\n    at tryCatcher (/home/kevin/blog/node_modules/bluebird/js/release/util.js:16:23)\n    at Promise._settlePromiseFromHandler (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:517:31)\n    at Promise._settlePromise (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:574:18)\n    at Promise._settlePromise0 (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:619:10)\n    at Promise._settlePromises (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:695:18)\n    at _drainQueueStep (/home/kevin/blog/node_modules/bluebird/js/release/async.js:138:12)\n    at _drainQueue (/home/kevin/blog/node_modules/bluebird/js/release/async.js:131:9)\n    at Async._drainQueues (/home/kevin/blog/node_modules/bluebird/js/release/async.js:147:5)\n    at Immediate.Async.drainQueues [as _onImmediate] (/home/kevin/blog/node_modules/bluebird/js/release/async.js:17:14)\n    at processImmediate (internal/timers.js:443:21)`\n    \n原因是nunjucks模板标签导致MD文件解析报错的问题，我试验了一下，在md文档中出现`双大括号`,`左大括号+#`,`左大括号+%`等都会报错(原谅我这么打，因为我打出来符号的话这篇博客就发不出来了)，下面是一位大神的[解决办法](http://xcoding.tech/2018/08/08/hexo/%E5%A6%82%E4%BD%95%E4%BB%8E%E6%A0%B9%E6%9C%AC%E8%A7%A3%E5%86%B3hexo%E4%B8%8D%E5%85%BC%E5%AE%B9%7B%7B%7D%7D%E6%A0%87%E7%AD%BE%E9%97%AE%E9%A2%98/)，他提供了几种解决办法，讲的很详细，可以参考一下\n\n我觉得有点麻烦就没采用(说多了就是菜～),下面是我的办法:\n1. 既然出现上面的内容就会报错，那就尽量避免出现呗...(说的都是废话)\n2. 使用`\\lbrace`代替`\\{`,使用`\\rbrace`代替`\\}`\n推荐大神的解决办法，一劳永逸，以后就不用管了\n\n\n## 坑二、Markdown的空行\n在写表格的时候要把表格体前后各空一行，不然你写的表格是这样式儿的，崩溃啊！\n![](https://i.loli.net/2019/07/22/5d358cfee55f989745.png)\n\n有可能是hexo解析的问题，我在使用markdown-preview的时候看的是正常的\n","slug":"hexo大坑","published":1,"updated":"2020-02-24T10:49:41.449Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0tj001z74ju18fz74mv","content":"<h2 id=\"坑一、Template-render-error-模板渲染错误\"><a href=\"#坑一、Template-render-error-模板渲染错误\" class=\"headerlink\" title=\"坑一、Template render error 模板渲染错误\"></a>坑一、Template render error 模板渲染错误</h2><p>写了一下午博文，高高兴兴地hexo g却发现报错了！<br><code>INFO  Start processing\nFATAL Something&#39;s wrong. Maybe you can find the solution here: https://hexo.io/docs/troubleshooting.html\nNunjucks Error:  [Line 2, Column 6] unexpected token: }}\n at formatNunjucksError (/home/kevin/blog/node_modules/hexo/lib/extend/tag.js:102:13)\n    at Promise.fromCallback.catch.err (/home/kevin/blog/node_modules/hexo/lib/extend/tag.js:124:34)\n    at tryCatcher (/home/kevin/blog/node_modules/bluebird/js/release/util.js:16:23)\n    at Promise._settlePromiseFromHandler (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:517:31)\n    at Promise._settlePromise (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:574:18)\n    at Promise._settlePromise0 (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:619:10)\n    at Promise._settlePromises (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:695:18)\n    at _drainQueueStep (/home/kevin/blog/node_modules/bluebird/js/release/async.js:138:12)\n    at _drainQueue (/home/kevin/blog/node_modules/bluebird/js/release/async.js:131:9)\n    at Async._drainQueues (/home/kevin/blog/node_modules/bluebird/js/release/async.js:147:5)\n    at Immediate.Async.drainQueues [as _onImmediate] (/home/kevin/blog/node_modules/bluebird/js/release/async.js:17:14)\n    at processImmediate (internal/timers.js:443:21)</code></p>\n<p>原因是nunjucks模板标签导致MD文件解析报错的问题，我试验了一下，在md文档中出现<code>双大括号</code>,<code>左大括号+#</code>,<code>左大括号+%</code>等都会报错(原谅我这么打，因为我打出来符号的话这篇博客就发不出来了)，下面是一位大神的<a href=\"http://xcoding.tech/2018/08/08/hexo/%E5%A6%82%E4%BD%95%E4%BB%8E%E6%A0%B9%E6%9C%AC%E8%A7%A3%E5%86%B3hexo%E4%B8%8D%E5%85%BC%E5%AE%B9%7B%7B%7D%7D%E6%A0%87%E7%AD%BE%E9%97%AE%E9%A2%98/\" target=\"_blank\" rel=\"noopener\">解决办法</a>，他提供了几种解决办法，讲的很详细，可以参考一下</p>\n<p>我觉得有点麻烦就没采用(说多了就是菜～),下面是我的办法:</p>\n<ol>\n<li>既然出现上面的内容就会报错，那就尽量避免出现呗…(说的都是废话)</li>\n<li>使用<code>\\lbrace</code>代替<code>\\{</code>,使用<code>\\rbrace</code>代替<code>\\}</code><br>推荐大神的解决办法，一劳永逸，以后就不用管了</li>\n</ol>\n<h2 id=\"坑二、Markdown的空行\"><a href=\"#坑二、Markdown的空行\" class=\"headerlink\" title=\"坑二、Markdown的空行\"></a>坑二、Markdown的空行</h2><p>在写表格的时候要把表格体前后各空一行，不然你写的表格是这样式儿的，崩溃啊！<br><img src=\"https://i.loli.net/2019/07/22/5d358cfee55f989745.png\" alt></p>\n<p>有可能是hexo解析的问题，我在使用markdown-preview的时候看的是正常的</p>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h2 id=\"坑一、Template-render-error-模板渲染错误\"><a href=\"#坑一、Template-render-error-模板渲染错误\" class=\"headerlink\" title=\"坑一、Template render error 模板渲染错误\"></a>坑一、Template render error 模板渲染错误</h2><p>写了一下午博文，高高兴兴地hexo g却发现报错了！<br><code>INFO  Start processing\nFATAL Something&#39;s wrong. Maybe you can find the solution here: https://hexo.io/docs/troubleshooting.html\nNunjucks Error:  [Line 2, Column 6] unexpected token: }}\n at formatNunjucksError (/home/kevin/blog/node_modules/hexo/lib/extend/tag.js:102:13)\n    at Promise.fromCallback.catch.err (/home/kevin/blog/node_modules/hexo/lib/extend/tag.js:124:34)\n    at tryCatcher (/home/kevin/blog/node_modules/bluebird/js/release/util.js:16:23)\n    at Promise._settlePromiseFromHandler (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:517:31)\n    at Promise._settlePromise (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:574:18)\n    at Promise._settlePromise0 (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:619:10)\n    at Promise._settlePromises (/home/kevin/blog/node_modules/bluebird/js/release/promise.js:695:18)\n    at _drainQueueStep (/home/kevin/blog/node_modules/bluebird/js/release/async.js:138:12)\n    at _drainQueue (/home/kevin/blog/node_modules/bluebird/js/release/async.js:131:9)\n    at Async._drainQueues (/home/kevin/blog/node_modules/bluebird/js/release/async.js:147:5)\n    at Immediate.Async.drainQueues [as _onImmediate] (/home/kevin/blog/node_modules/bluebird/js/release/async.js:17:14)\n    at processImmediate (internal/timers.js:443:21)</code></p>\n<p>原因是nunjucks模板标签导致MD文件解析报错的问题，我试验了一下，在md文档中出现<code>双大括号</code>,<code>左大括号+#</code>,<code>左大括号+%</code>等都会报错(原谅我这么打，因为我打出来符号的话这篇博客就发不出来了)，下面是一位大神的<a href=\"http://xcoding.tech/2018/08/08/hexo/%E5%A6%82%E4%BD%95%E4%BB%8E%E6%A0%B9%E6%9C%AC%E8%A7%A3%E5%86%B3hexo%E4%B8%8D%E5%85%BC%E5%AE%B9%7B%7B%7D%7D%E6%A0%87%E7%AD%BE%E9%97%AE%E9%A2%98/\" target=\"_blank\" rel=\"noopener\">解决办法</a>，他提供了几种解决办法，讲的很详细，可以参考一下</p>\n<p>我觉得有点麻烦就没采用(说多了就是菜～),下面是我的办法:</p>\n<ol>\n<li>既然出现上面的内容就会报错，那就尽量避免出现呗…(说的都是废话)</li>\n<li>使用<code>\\lbrace</code>代替<code>\\{</code>,使用<code>\\rbrace</code>代替<code>\\}</code><br>推荐大神的解决办法，一劳永逸，以后就不用管了</li>\n</ol>\n<h2 id=\"坑二、Markdown的空行\"><a href=\"#坑二、Markdown的空行\" class=\"headerlink\" title=\"坑二、Markdown的空行\"></a>坑二、Markdown的空行</h2><p>在写表格的时候要把表格体前后各空一行，不然你写的表格是这样式儿的，崩溃啊！<br><img src=\"https://i.loli.net/2019/07/22/5d358cfee55f989745.png\" alt></p>\n<p>有可能是hexo解析的问题，我在使用markdown-preview的时候看的是正常的</p>\n"},{"title":"ranger","top":false,"cover":false,"toc":true,"mathjax":false,"date":"2019-12-17T05:08:34.000Z","img":null,"password":null,"summary":"Ranger","_content":"## Ranger \n\n- If you want a tool to preview images or other file type can preview as images (pdf, videos), i recommended **ueberzug** , but note, you should use **ranger-git** by `yaourt -S ranger-git`\n## Ranger shortcut\n\n### Basic\n\n|  Shortcuts  |                    Function                   |\n|:-----------:|:---------------------------------------------:|\n|      e      |                      edit                     |\n|      q      |                      quit                     |\n|      q!     |                 Force to quit                 |\n|  qa & qall  |                    quit all                   |\n| qa! & qall! |               Force to quit all               |\n|     setl    |                    setlocal                   |\n|             |                                               |\n|      q      |                      quit                     |\n|      Q      |                    quit all                   |\n|      ;      |                    console                    |\n|      :      |                    console                    |\n|      V      |       use nvim to create or open a file       |\n|      T      |                 touch command                 |\n|      R      |                   reload cwd                  |\n|      F      |                  freeze files                 |\n|   Ctrl + r  |                     reset                     |\n|   Ctrl + l  |                 redraw window                 |\n|   Ctrl + c  |                     abort                     |\n|     ESC     |               change normal mode              |\n|      `      |             force to set viewmode             |\n|             |                      <++>                     |\n|     <++>    |                      <++>                     |\n|      W      |          display log(have some bugs)          |\n|      w      |                 open task view                |\n|      S      |      return to terminal in current foder      |\n|    Space    |                   mark files                  |\n|      v      |        mark all files in current foder        |\n|   Ctrl + v  |               toggle visual mode              |\n|      lv     |        toggle visual mode reverse=true        |\n|      df     | open colordiff(make sure colordiff installed) |\n|      M      |     create a folder and enter this folder     |\n|      +      |                     chmod                     |\n|      cw     |                     rename                    |\n|      a      |                rename - append                |\n|      A      |                  rename - add                 |\n|         |                      <++>                     |\n|     <++>    |                      <++>                     |\n|     <++>    |                      <++>                     |\n|     <++>    |                      <++>                     |\n|     <++>    |                      <++>                     |\n|     <++>    |                      <++>                     |\n|     <++>    |                      <++>                     |\n|     <++>    |                      <++>                     |\n\n### Change the line mode\n\n| shortcut |          function         |\n|:--------:|:-------------------------:|\n|    mf    |          filename         |\n|    mi    |          fileinfo         |\n|    mm    |         make time         |\n|    mh    |  human readable make time |\n|    mp    |        permissoions       |\n|    ms    |         size mtime        |\n|    mH    | size human readable mtime |\n\n### Jumping around\n\n| Shortcuts |        Function       |\n|:---------:|:---------------------:|\n|     to    |     go to a foler     |\n|     H     |     history_go -1     |\n|     L     |      history_go 1     |\n|     ]     |  move parent folder 1 |\n|     [     | move parent folder -1 |\n\n### Open lazygit\n\n| Shortcuts |   Function   |\n|:---------:|:------------:|\n|  Ctrl + g | open lazygit |\n\n### Some locations\n\n| Shortcuts |             Function             |\n|:---------:|:--------------------------------:|\n|     gh    |              go home             |\n|     gi    |             go Github            |\n|     gd    |            go Desktop            |\n|     gD    |            go Download           |\n|    gca    |       go .config/alacritty       |\n|    gcf    |            go .config            |\n|    gcr    |         go .config/ranger        |\n|    gcn    |          go .config/nvim         |\n|    gcm    |          go .config/mutt         |\n|    gcl    | go .config/jesseduffield/lazygit |\n|     gs    |           go ~/scripts           |\n|    gbe    |       go blog/source/_posts       |\n|     ge    |              go /etc             |\n|    guu    |              go /usr             |\n|    gub    |            go /usr/bin           |\n|    gul    |           go /usr/local          |\n|    gus    |           go /usr/share          |\n|    guf    |        go /usr/share/fonts       |\n|    gud    |         go /usr/share/doc        |\n|     gv    |              go /var             |\n|     gm    |           go /run/media          |\n|     gM    |              go /mnt             |\n|     gw    |      go Pictures/wallpapers      |\n\n### Vim-like\n\n| Shortcuts | Function |\n|:---------:|:--------:|\n|     u     |    up    |\n|     e     |   down   |\n|     n     |   left   |\n|     i     |   right  |\n|     gg    |   HOME   |\n|     G     |    END   |\n|     E     |  5 down  |\n|     U     |   5 up   |\n\n### External Programs\n\n| Shortcuts |                           Function                           |\n|:---------:|:------------------------------------------------------------:|\n|     du    | show the size of the every children folder in current folder |\n|     dU    |                         sort by size                         |\n|     yp    |                           yank path                          |\n|     yd    |                           yakn dir                           |\n|     yn    |                           yank name                          |\n|     y.    |                  yank name without eztension                 |\n\n\n\n\n\n\n","source":"_posts/ranger.md","raw":"---\ntitle: ranger\ntop: false\ncover: false\ntoc: true\nmathjax: false\ndate: 2019-12-17 13:08:34\nimg:\npassword:\nsummary: Ranger\ntags:\ncategories:\n---\n## Ranger \n\n- If you want a tool to preview images or other file type can preview as images (pdf, videos), i recommended **ueberzug** , but note, you should use **ranger-git** by `yaourt -S ranger-git`\n## Ranger shortcut\n\n### Basic\n\n|  Shortcuts  |                    Function                   |\n|:-----------:|:---------------------------------------------:|\n|      e      |                      edit                     |\n|      q      |                      quit                     |\n|      q!     |                 Force to quit                 |\n|  qa & qall  |                    quit all                   |\n| qa! & qall! |               Force to quit all               |\n|     setl    |                    setlocal                   |\n|             |                                               |\n|      q      |                      quit                     |\n|      Q      |                    quit all                   |\n|      ;      |                    console                    |\n|      :      |                    console                    |\n|      V      |       use nvim to create or open a file       |\n|      T      |                 touch command                 |\n|      R      |                   reload cwd                  |\n|      F      |                  freeze files                 |\n|   Ctrl + r  |                     reset                     |\n|   Ctrl + l  |                 redraw window                 |\n|   Ctrl + c  |                     abort                     |\n|     ESC     |               change normal mode              |\n|      `      |             force to set viewmode             |\n|             |                      <++>                     |\n|     <++>    |                      <++>                     |\n|      W      |          display log(have some bugs)          |\n|      w      |                 open task view                |\n|      S      |      return to terminal in current foder      |\n|    Space    |                   mark files                  |\n|      v      |        mark all files in current foder        |\n|   Ctrl + v  |               toggle visual mode              |\n|      lv     |        toggle visual mode reverse=true        |\n|      df     | open colordiff(make sure colordiff installed) |\n|      M      |     create a folder and enter this folder     |\n|      +      |                     chmod                     |\n|      cw     |                     rename                    |\n|      a      |                rename - append                |\n|      A      |                  rename - add                 |\n|         |                      <++>                     |\n|     <++>    |                      <++>                     |\n|     <++>    |                      <++>                     |\n|     <++>    |                      <++>                     |\n|     <++>    |                      <++>                     |\n|     <++>    |                      <++>                     |\n|     <++>    |                      <++>                     |\n|     <++>    |                      <++>                     |\n\n### Change the line mode\n\n| shortcut |          function         |\n|:--------:|:-------------------------:|\n|    mf    |          filename         |\n|    mi    |          fileinfo         |\n|    mm    |         make time         |\n|    mh    |  human readable make time |\n|    mp    |        permissoions       |\n|    ms    |         size mtime        |\n|    mH    | size human readable mtime |\n\n### Jumping around\n\n| Shortcuts |        Function       |\n|:---------:|:---------------------:|\n|     to    |     go to a foler     |\n|     H     |     history_go -1     |\n|     L     |      history_go 1     |\n|     ]     |  move parent folder 1 |\n|     [     | move parent folder -1 |\n\n### Open lazygit\n\n| Shortcuts |   Function   |\n|:---------:|:------------:|\n|  Ctrl + g | open lazygit |\n\n### Some locations\n\n| Shortcuts |             Function             |\n|:---------:|:--------------------------------:|\n|     gh    |              go home             |\n|     gi    |             go Github            |\n|     gd    |            go Desktop            |\n|     gD    |            go Download           |\n|    gca    |       go .config/alacritty       |\n|    gcf    |            go .config            |\n|    gcr    |         go .config/ranger        |\n|    gcn    |          go .config/nvim         |\n|    gcm    |          go .config/mutt         |\n|    gcl    | go .config/jesseduffield/lazygit |\n|     gs    |           go ~/scripts           |\n|    gbe    |       go blog/source/_posts       |\n|     ge    |              go /etc             |\n|    guu    |              go /usr             |\n|    gub    |            go /usr/bin           |\n|    gul    |           go /usr/local          |\n|    gus    |           go /usr/share          |\n|    guf    |        go /usr/share/fonts       |\n|    gud    |         go /usr/share/doc        |\n|     gv    |              go /var             |\n|     gm    |           go /run/media          |\n|     gM    |              go /mnt             |\n|     gw    |      go Pictures/wallpapers      |\n\n### Vim-like\n\n| Shortcuts | Function |\n|:---------:|:--------:|\n|     u     |    up    |\n|     e     |   down   |\n|     n     |   left   |\n|     i     |   right  |\n|     gg    |   HOME   |\n|     G     |    END   |\n|     E     |  5 down  |\n|     U     |   5 up   |\n\n### External Programs\n\n| Shortcuts |                           Function                           |\n|:---------:|:------------------------------------------------------------:|\n|     du    | show the size of the every children folder in current folder |\n|     dU    |                         sort by size                         |\n|     yp    |                           yank path                          |\n|     yd    |                           yakn dir                           |\n|     yn    |                           yank name                          |\n|     y.    |                  yank name without eztension                 |\n\n\n\n\n\n\n","slug":"ranger","published":1,"updated":"2020-02-24T10:49:41.449Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0tk002174jumy9xq2cs","content":"<h2 id=\"Ranger\"><a href=\"#Ranger\" class=\"headerlink\" title=\"Ranger\"></a>Ranger</h2><ul>\n<li>If you want a tool to preview images or other file type can preview as images (pdf, videos), i recommended <strong>ueberzug</strong> , but note, you should use <strong>ranger-git</strong> by <code>yaourt -S ranger-git</code><h2 id=\"Ranger-shortcut\"><a href=\"#Ranger-shortcut\" class=\"headerlink\" title=\"Ranger shortcut\"></a>Ranger shortcut</h2></li>\n</ul>\n<h3 id=\"Basic\"><a href=\"#Basic\" class=\"headerlink\" title=\"Basic\"></a>Basic</h3><table>\n<thead>\n<tr>\n<th align=\"center\">Shortcuts</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">e</td>\n<td align=\"center\">edit</td>\n</tr>\n<tr>\n<td align=\"center\">q</td>\n<td align=\"center\">quit</td>\n</tr>\n<tr>\n<td align=\"center\">q!</td>\n<td align=\"center\">Force to quit</td>\n</tr>\n<tr>\n<td align=\"center\">qa &amp; qall</td>\n<td align=\"center\">quit all</td>\n</tr>\n<tr>\n<td align=\"center\">qa! &amp; qall!</td>\n<td align=\"center\">Force to quit all</td>\n</tr>\n<tr>\n<td align=\"center\">setl</td>\n<td align=\"center\">setlocal</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">q</td>\n<td align=\"center\">quit</td>\n</tr>\n<tr>\n<td align=\"center\">Q</td>\n<td align=\"center\">quit all</td>\n</tr>\n<tr>\n<td align=\"center\">;</td>\n<td align=\"center\">console</td>\n</tr>\n<tr>\n<td align=\"center\">:</td>\n<td align=\"center\">console</td>\n</tr>\n<tr>\n<td align=\"center\">V</td>\n<td align=\"center\">use nvim to create or open a file</td>\n</tr>\n<tr>\n<td align=\"center\">T</td>\n<td align=\"center\">touch command</td>\n</tr>\n<tr>\n<td align=\"center\">R</td>\n<td align=\"center\">reload cwd</td>\n</tr>\n<tr>\n<td align=\"center\">F</td>\n<td align=\"center\">freeze files</td>\n</tr>\n<tr>\n<td align=\"center\">Ctrl + r</td>\n<td align=\"center\">reset</td>\n</tr>\n<tr>\n<td align=\"center\">Ctrl + l</td>\n<td align=\"center\">redraw window</td>\n</tr>\n<tr>\n<td align=\"center\">Ctrl + c</td>\n<td align=\"center\">abort</td>\n</tr>\n<tr>\n<td align=\"center\">ESC</td>\n<td align=\"center\">change normal mode</td>\n</tr>\n<tr>\n<td align=\"center\">`</td>\n<td align=\"center\">force to set viewmode</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">W</td>\n<td align=\"center\">display log(have some bugs)</td>\n</tr>\n<tr>\n<td align=\"center\">w</td>\n<td align=\"center\">open task view</td>\n</tr>\n<tr>\n<td align=\"center\">S</td>\n<td align=\"center\">return to terminal in current foder</td>\n</tr>\n<tr>\n<td align=\"center\">Space</td>\n<td align=\"center\">mark files</td>\n</tr>\n<tr>\n<td align=\"center\">v</td>\n<td align=\"center\">mark all files in current foder</td>\n</tr>\n<tr>\n<td align=\"center\">Ctrl + v</td>\n<td align=\"center\">toggle visual mode</td>\n</tr>\n<tr>\n<td align=\"center\">lv</td>\n<td align=\"center\">toggle visual mode reverse=true</td>\n</tr>\n<tr>\n<td align=\"center\">df</td>\n<td align=\"center\">open colordiff(make sure colordiff installed)</td>\n</tr>\n<tr>\n<td align=\"center\">M</td>\n<td align=\"center\">create a folder and enter this folder</td>\n</tr>\n<tr>\n<td align=\"center\">+</td>\n<td align=\"center\">chmod</td>\n</tr>\n<tr>\n<td align=\"center\">cw</td>\n<td align=\"center\">rename</td>\n</tr>\n<tr>\n<td align=\"center\">a</td>\n<td align=\"center\">rename - append</td>\n</tr>\n<tr>\n<td align=\"center\">A</td>\n<td align=\"center\">rename - add</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n</tbody></table>\n<h3 id=\"Change-the-line-mode\"><a href=\"#Change-the-line-mode\" class=\"headerlink\" title=\"Change the line mode\"></a>Change the line mode</h3><table>\n<thead>\n<tr>\n<th align=\"center\">shortcut</th>\n<th align=\"center\">function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">mf</td>\n<td align=\"center\">filename</td>\n</tr>\n<tr>\n<td align=\"center\">mi</td>\n<td align=\"center\">fileinfo</td>\n</tr>\n<tr>\n<td align=\"center\">mm</td>\n<td align=\"center\">make time</td>\n</tr>\n<tr>\n<td align=\"center\">mh</td>\n<td align=\"center\">human readable make time</td>\n</tr>\n<tr>\n<td align=\"center\">mp</td>\n<td align=\"center\">permissoions</td>\n</tr>\n<tr>\n<td align=\"center\">ms</td>\n<td align=\"center\">size mtime</td>\n</tr>\n<tr>\n<td align=\"center\">mH</td>\n<td align=\"center\">size human readable mtime</td>\n</tr>\n</tbody></table>\n<h3 id=\"Jumping-around\"><a href=\"#Jumping-around\" class=\"headerlink\" title=\"Jumping around\"></a>Jumping around</h3><table>\n<thead>\n<tr>\n<th align=\"center\">Shortcuts</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">to</td>\n<td align=\"center\">go to a foler</td>\n</tr>\n<tr>\n<td align=\"center\">H</td>\n<td align=\"center\">history_go -1</td>\n</tr>\n<tr>\n<td align=\"center\">L</td>\n<td align=\"center\">history_go 1</td>\n</tr>\n<tr>\n<td align=\"center\">]</td>\n<td align=\"center\">move parent folder 1</td>\n</tr>\n<tr>\n<td align=\"center\">[</td>\n<td align=\"center\">move parent folder -1</td>\n</tr>\n</tbody></table>\n<h3 id=\"Open-lazygit\"><a href=\"#Open-lazygit\" class=\"headerlink\" title=\"Open lazygit\"></a>Open lazygit</h3><table>\n<thead>\n<tr>\n<th align=\"center\">Shortcuts</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">Ctrl + g</td>\n<td align=\"center\">open lazygit</td>\n</tr>\n</tbody></table>\n<h3 id=\"Some-locations\"><a href=\"#Some-locations\" class=\"headerlink\" title=\"Some locations\"></a>Some locations</h3><table>\n<thead>\n<tr>\n<th align=\"center\">Shortcuts</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">gh</td>\n<td align=\"center\">go home</td>\n</tr>\n<tr>\n<td align=\"center\">gi</td>\n<td align=\"center\">go Github</td>\n</tr>\n<tr>\n<td align=\"center\">gd</td>\n<td align=\"center\">go Desktop</td>\n</tr>\n<tr>\n<td align=\"center\">gD</td>\n<td align=\"center\">go Download</td>\n</tr>\n<tr>\n<td align=\"center\">gca</td>\n<td align=\"center\">go .config/alacritty</td>\n</tr>\n<tr>\n<td align=\"center\">gcf</td>\n<td align=\"center\">go .config</td>\n</tr>\n<tr>\n<td align=\"center\">gcr</td>\n<td align=\"center\">go .config/ranger</td>\n</tr>\n<tr>\n<td align=\"center\">gcn</td>\n<td align=\"center\">go .config/nvim</td>\n</tr>\n<tr>\n<td align=\"center\">gcm</td>\n<td align=\"center\">go .config/mutt</td>\n</tr>\n<tr>\n<td align=\"center\">gcl</td>\n<td align=\"center\">go .config/jesseduffield/lazygit</td>\n</tr>\n<tr>\n<td align=\"center\">gs</td>\n<td align=\"center\">go ~/scripts</td>\n</tr>\n<tr>\n<td align=\"center\">gbe</td>\n<td align=\"center\">go blog/source/_posts</td>\n</tr>\n<tr>\n<td align=\"center\">ge</td>\n<td align=\"center\">go /etc</td>\n</tr>\n<tr>\n<td align=\"center\">guu</td>\n<td align=\"center\">go /usr</td>\n</tr>\n<tr>\n<td align=\"center\">gub</td>\n<td align=\"center\">go /usr/bin</td>\n</tr>\n<tr>\n<td align=\"center\">gul</td>\n<td align=\"center\">go /usr/local</td>\n</tr>\n<tr>\n<td align=\"center\">gus</td>\n<td align=\"center\">go /usr/share</td>\n</tr>\n<tr>\n<td align=\"center\">guf</td>\n<td align=\"center\">go /usr/share/fonts</td>\n</tr>\n<tr>\n<td align=\"center\">gud</td>\n<td align=\"center\">go /usr/share/doc</td>\n</tr>\n<tr>\n<td align=\"center\">gv</td>\n<td align=\"center\">go /var</td>\n</tr>\n<tr>\n<td align=\"center\">gm</td>\n<td align=\"center\">go /run/media</td>\n</tr>\n<tr>\n<td align=\"center\">gM</td>\n<td align=\"center\">go /mnt</td>\n</tr>\n<tr>\n<td align=\"center\">gw</td>\n<td align=\"center\">go Pictures/wallpapers</td>\n</tr>\n</tbody></table>\n<h3 id=\"Vim-like\"><a href=\"#Vim-like\" class=\"headerlink\" title=\"Vim-like\"></a>Vim-like</h3><table>\n<thead>\n<tr>\n<th align=\"center\">Shortcuts</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">u</td>\n<td align=\"center\">up</td>\n</tr>\n<tr>\n<td align=\"center\">e</td>\n<td align=\"center\">down</td>\n</tr>\n<tr>\n<td align=\"center\">n</td>\n<td align=\"center\">left</td>\n</tr>\n<tr>\n<td align=\"center\">i</td>\n<td align=\"center\">right</td>\n</tr>\n<tr>\n<td align=\"center\">gg</td>\n<td align=\"center\">HOME</td>\n</tr>\n<tr>\n<td align=\"center\">G</td>\n<td align=\"center\">END</td>\n</tr>\n<tr>\n<td align=\"center\">E</td>\n<td align=\"center\">5 down</td>\n</tr>\n<tr>\n<td align=\"center\">U</td>\n<td align=\"center\">5 up</td>\n</tr>\n</tbody></table>\n<h3 id=\"External-Programs\"><a href=\"#External-Programs\" class=\"headerlink\" title=\"External Programs\"></a>External Programs</h3><table>\n<thead>\n<tr>\n<th align=\"center\">Shortcuts</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">du</td>\n<td align=\"center\">show the size of the every children folder in current folder</td>\n</tr>\n<tr>\n<td align=\"center\">dU</td>\n<td align=\"center\">sort by size</td>\n</tr>\n<tr>\n<td align=\"center\">yp</td>\n<td align=\"center\">yank path</td>\n</tr>\n<tr>\n<td align=\"center\">yd</td>\n<td align=\"center\">yakn dir</td>\n</tr>\n<tr>\n<td align=\"center\">yn</td>\n<td align=\"center\">yank name</td>\n</tr>\n<tr>\n<td align=\"center\">y.</td>\n<td align=\"center\">yank name without eztension</td>\n</tr>\n</tbody></table>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h2 id=\"Ranger\"><a href=\"#Ranger\" class=\"headerlink\" title=\"Ranger\"></a>Ranger</h2><ul>\n<li>If you want a tool to preview images or other file type can preview as images (pdf, videos), i recommended <strong>ueberzug</strong> , but note, you should use <strong>ranger-git</strong> by <code>yaourt -S ranger-git</code><h2 id=\"Ranger-shortcut\"><a href=\"#Ranger-shortcut\" class=\"headerlink\" title=\"Ranger shortcut\"></a>Ranger shortcut</h2></li>\n</ul>\n<h3 id=\"Basic\"><a href=\"#Basic\" class=\"headerlink\" title=\"Basic\"></a>Basic</h3><table>\n<thead>\n<tr>\n<th align=\"center\">Shortcuts</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">e</td>\n<td align=\"center\">edit</td>\n</tr>\n<tr>\n<td align=\"center\">q</td>\n<td align=\"center\">quit</td>\n</tr>\n<tr>\n<td align=\"center\">q!</td>\n<td align=\"center\">Force to quit</td>\n</tr>\n<tr>\n<td align=\"center\">qa &amp; qall</td>\n<td align=\"center\">quit all</td>\n</tr>\n<tr>\n<td align=\"center\">qa! &amp; qall!</td>\n<td align=\"center\">Force to quit all</td>\n</tr>\n<tr>\n<td align=\"center\">setl</td>\n<td align=\"center\">setlocal</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">q</td>\n<td align=\"center\">quit</td>\n</tr>\n<tr>\n<td align=\"center\">Q</td>\n<td align=\"center\">quit all</td>\n</tr>\n<tr>\n<td align=\"center\">;</td>\n<td align=\"center\">console</td>\n</tr>\n<tr>\n<td align=\"center\">:</td>\n<td align=\"center\">console</td>\n</tr>\n<tr>\n<td align=\"center\">V</td>\n<td align=\"center\">use nvim to create or open a file</td>\n</tr>\n<tr>\n<td align=\"center\">T</td>\n<td align=\"center\">touch command</td>\n</tr>\n<tr>\n<td align=\"center\">R</td>\n<td align=\"center\">reload cwd</td>\n</tr>\n<tr>\n<td align=\"center\">F</td>\n<td align=\"center\">freeze files</td>\n</tr>\n<tr>\n<td align=\"center\">Ctrl + r</td>\n<td align=\"center\">reset</td>\n</tr>\n<tr>\n<td align=\"center\">Ctrl + l</td>\n<td align=\"center\">redraw window</td>\n</tr>\n<tr>\n<td align=\"center\">Ctrl + c</td>\n<td align=\"center\">abort</td>\n</tr>\n<tr>\n<td align=\"center\">ESC</td>\n<td align=\"center\">change normal mode</td>\n</tr>\n<tr>\n<td align=\"center\">`</td>\n<td align=\"center\">force to set viewmode</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">W</td>\n<td align=\"center\">display log(have some bugs)</td>\n</tr>\n<tr>\n<td align=\"center\">w</td>\n<td align=\"center\">open task view</td>\n</tr>\n<tr>\n<td align=\"center\">S</td>\n<td align=\"center\">return to terminal in current foder</td>\n</tr>\n<tr>\n<td align=\"center\">Space</td>\n<td align=\"center\">mark files</td>\n</tr>\n<tr>\n<td align=\"center\">v</td>\n<td align=\"center\">mark all files in current foder</td>\n</tr>\n<tr>\n<td align=\"center\">Ctrl + v</td>\n<td align=\"center\">toggle visual mode</td>\n</tr>\n<tr>\n<td align=\"center\">lv</td>\n<td align=\"center\">toggle visual mode reverse=true</td>\n</tr>\n<tr>\n<td align=\"center\">df</td>\n<td align=\"center\">open colordiff(make sure colordiff installed)</td>\n</tr>\n<tr>\n<td align=\"center\">M</td>\n<td align=\"center\">create a folder and enter this folder</td>\n</tr>\n<tr>\n<td align=\"center\">+</td>\n<td align=\"center\">chmod</td>\n</tr>\n<tr>\n<td align=\"center\">cw</td>\n<td align=\"center\">rename</td>\n</tr>\n<tr>\n<td align=\"center\">a</td>\n<td align=\"center\">rename - append</td>\n</tr>\n<tr>\n<td align=\"center\">A</td>\n<td align=\"center\">rename - add</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;++&gt;</td>\n<td align=\"center\">&lt;++&gt;</td>\n</tr>\n</tbody></table>\n<h3 id=\"Change-the-line-mode\"><a href=\"#Change-the-line-mode\" class=\"headerlink\" title=\"Change the line mode\"></a>Change the line mode</h3><table>\n<thead>\n<tr>\n<th align=\"center\">shortcut</th>\n<th align=\"center\">function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">mf</td>\n<td align=\"center\">filename</td>\n</tr>\n<tr>\n<td align=\"center\">mi</td>\n<td align=\"center\">fileinfo</td>\n</tr>\n<tr>\n<td align=\"center\">mm</td>\n<td align=\"center\">make time</td>\n</tr>\n<tr>\n<td align=\"center\">mh</td>\n<td align=\"center\">human readable make time</td>\n</tr>\n<tr>\n<td align=\"center\">mp</td>\n<td align=\"center\">permissoions</td>\n</tr>\n<tr>\n<td align=\"center\">ms</td>\n<td align=\"center\">size mtime</td>\n</tr>\n<tr>\n<td align=\"center\">mH</td>\n<td align=\"center\">size human readable mtime</td>\n</tr>\n</tbody></table>\n<h3 id=\"Jumping-around\"><a href=\"#Jumping-around\" class=\"headerlink\" title=\"Jumping around\"></a>Jumping around</h3><table>\n<thead>\n<tr>\n<th align=\"center\">Shortcuts</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">to</td>\n<td align=\"center\">go to a foler</td>\n</tr>\n<tr>\n<td align=\"center\">H</td>\n<td align=\"center\">history_go -1</td>\n</tr>\n<tr>\n<td align=\"center\">L</td>\n<td align=\"center\">history_go 1</td>\n</tr>\n<tr>\n<td align=\"center\">]</td>\n<td align=\"center\">move parent folder 1</td>\n</tr>\n<tr>\n<td align=\"center\">[</td>\n<td align=\"center\">move parent folder -1</td>\n</tr>\n</tbody></table>\n<h3 id=\"Open-lazygit\"><a href=\"#Open-lazygit\" class=\"headerlink\" title=\"Open lazygit\"></a>Open lazygit</h3><table>\n<thead>\n<tr>\n<th align=\"center\">Shortcuts</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">Ctrl + g</td>\n<td align=\"center\">open lazygit</td>\n</tr>\n</tbody></table>\n<h3 id=\"Some-locations\"><a href=\"#Some-locations\" class=\"headerlink\" title=\"Some locations\"></a>Some locations</h3><table>\n<thead>\n<tr>\n<th align=\"center\">Shortcuts</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">gh</td>\n<td align=\"center\">go home</td>\n</tr>\n<tr>\n<td align=\"center\">gi</td>\n<td align=\"center\">go Github</td>\n</tr>\n<tr>\n<td align=\"center\">gd</td>\n<td align=\"center\">go Desktop</td>\n</tr>\n<tr>\n<td align=\"center\">gD</td>\n<td align=\"center\">go Download</td>\n</tr>\n<tr>\n<td align=\"center\">gca</td>\n<td align=\"center\">go .config/alacritty</td>\n</tr>\n<tr>\n<td align=\"center\">gcf</td>\n<td align=\"center\">go .config</td>\n</tr>\n<tr>\n<td align=\"center\">gcr</td>\n<td align=\"center\">go .config/ranger</td>\n</tr>\n<tr>\n<td align=\"center\">gcn</td>\n<td align=\"center\">go .config/nvim</td>\n</tr>\n<tr>\n<td align=\"center\">gcm</td>\n<td align=\"center\">go .config/mutt</td>\n</tr>\n<tr>\n<td align=\"center\">gcl</td>\n<td align=\"center\">go .config/jesseduffield/lazygit</td>\n</tr>\n<tr>\n<td align=\"center\">gs</td>\n<td align=\"center\">go ~/scripts</td>\n</tr>\n<tr>\n<td align=\"center\">gbe</td>\n<td align=\"center\">go blog/source/_posts</td>\n</tr>\n<tr>\n<td align=\"center\">ge</td>\n<td align=\"center\">go /etc</td>\n</tr>\n<tr>\n<td align=\"center\">guu</td>\n<td align=\"center\">go /usr</td>\n</tr>\n<tr>\n<td align=\"center\">gub</td>\n<td align=\"center\">go /usr/bin</td>\n</tr>\n<tr>\n<td align=\"center\">gul</td>\n<td align=\"center\">go /usr/local</td>\n</tr>\n<tr>\n<td align=\"center\">gus</td>\n<td align=\"center\">go /usr/share</td>\n</tr>\n<tr>\n<td align=\"center\">guf</td>\n<td align=\"center\">go /usr/share/fonts</td>\n</tr>\n<tr>\n<td align=\"center\">gud</td>\n<td align=\"center\">go /usr/share/doc</td>\n</tr>\n<tr>\n<td align=\"center\">gv</td>\n<td align=\"center\">go /var</td>\n</tr>\n<tr>\n<td align=\"center\">gm</td>\n<td align=\"center\">go /run/media</td>\n</tr>\n<tr>\n<td align=\"center\">gM</td>\n<td align=\"center\">go /mnt</td>\n</tr>\n<tr>\n<td align=\"center\">gw</td>\n<td align=\"center\">go Pictures/wallpapers</td>\n</tr>\n</tbody></table>\n<h3 id=\"Vim-like\"><a href=\"#Vim-like\" class=\"headerlink\" title=\"Vim-like\"></a>Vim-like</h3><table>\n<thead>\n<tr>\n<th align=\"center\">Shortcuts</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">u</td>\n<td align=\"center\">up</td>\n</tr>\n<tr>\n<td align=\"center\">e</td>\n<td align=\"center\">down</td>\n</tr>\n<tr>\n<td align=\"center\">n</td>\n<td align=\"center\">left</td>\n</tr>\n<tr>\n<td align=\"center\">i</td>\n<td align=\"center\">right</td>\n</tr>\n<tr>\n<td align=\"center\">gg</td>\n<td align=\"center\">HOME</td>\n</tr>\n<tr>\n<td align=\"center\">G</td>\n<td align=\"center\">END</td>\n</tr>\n<tr>\n<td align=\"center\">E</td>\n<td align=\"center\">5 down</td>\n</tr>\n<tr>\n<td align=\"center\">U</td>\n<td align=\"center\">5 up</td>\n</tr>\n</tbody></table>\n<h3 id=\"External-Programs\"><a href=\"#External-Programs\" class=\"headerlink\" title=\"External Programs\"></a>External Programs</h3><table>\n<thead>\n<tr>\n<th align=\"center\">Shortcuts</th>\n<th align=\"center\">Function</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">du</td>\n<td align=\"center\">show the size of the every children folder in current folder</td>\n</tr>\n<tr>\n<td align=\"center\">dU</td>\n<td align=\"center\">sort by size</td>\n</tr>\n<tr>\n<td align=\"center\">yp</td>\n<td align=\"center\">yank path</td>\n</tr>\n<tr>\n<td align=\"center\">yd</td>\n<td align=\"center\">yakn dir</td>\n</tr>\n<tr>\n<td align=\"center\">yn</td>\n<td align=\"center\">yank name</td>\n</tr>\n<tr>\n<td align=\"center\">y.</td>\n<td align=\"center\">yank name without eztension</td>\n</tr>\n</tbody></table>\n"},{"title":"图像分割","top":false,"cover":false,"img":"https://i.loli.net/2019/07/17/5d2e73bb14bd344648.png","toc":true,"mathjax":true,"date":"2019-07-24T03:25:37.000Z","password":null,"summary":"孤立点检测、线检测、基本边缘检测","_content":"\n# 图像分割\n---\n> 整体等于部分之和    \n>                 -----欧几里德\n\n---\n图像分割把图像细分为它的组成要素或物体，细分的水平取决于要解决的问题。    \n单色分割的分割算法通常是基于图像亮度值的两个基本特征:不连续性和相似性。第一类，方法是基于亮度的突变来分割一幅图像，比如边缘;第二类，主要方法是根据事先定义好的准则把图像分割成相似的区域\n\n## 点、线和基本边缘检测\n\n### 背景知识\n1. 边缘像素是图像中灰度突变的像素，边缘是连接的边缘像素的集合\n2. 一条线可以视为一条边缘线段，该线段两侧的背景灰度要么远亮于该线像素的灰度，要么远暗于该线像素的灰度。孤立点可视为一条线，只是长度和宽度都是一个像素\n3. 局部变化检测可以用微分(一阶微分和二阶微分)    \n   - 对于一阶导数的任何近似，约定:\n      - 在恒定灰度区域必须为0\n      - 在灰度台阶和或斜坡开始处必须不为0\n      - 在沿灰度斜坡点处也必须不为0\n   - 类似的对于二阶导数的近似\n      - 在恒定灰度区域必须为0\n      - 在灰度台阶或斜坡开始除和结束处必须不为0\n      - 沿灰度斜坡必须为0\n   - 一维函数展开为关于x的泰勒级数,结果差分\n   $$ \\frac{\\partial f}{\\partial x}=f'(x)=f(x+1)-f(x)$$\n    二阶导数\n    $$ \\frac{\\partial ^2 f}{\\partial ^2 x}=f''(x)=f(x+1)+f(x-1)-2f(x)$$\n    - 可以得出结论:\n      - 一阶导数通常在图像中产生较粗的边缘\n      - 二阶导数对精细细节，如细线、孤立点和噪声有较强的响应\n      - 二阶导数在灰度斜坡和灰度台阶过渡处会产生双边缘响应\n      - 二阶导数的符号可用于确定边缘的过程是从亮到暗还是从暗到亮\n    - 计算图像中每个像素位置的一阶导数和二阶导数的可选择方法是空间滤波器。模板在该区域中心点处的响应为\n    $$R = w_1z_1 + w_2z_2 + ... + w_9z_9 = \\sum_{k=1}^{9}w_kz_k$$\n\n$w_1$ | $w_2$ | $w_3$\n:---: | :---: | :---:\n$w_4$ | $w_5$ | $w_6$\n$w_7$ | $w_8$ | $w_9$\n\n这是一个普通的3×3空间滤波器掩模\n\n### 孤立点检测\n- 点的检测应以二阶导数为基础，这意味着使用laplace\n$$\\triangledown ^2f(x,y) = \\frac{\\partial ^2 f}{\\partial x^2} + \\frac{\\partial ^2 f}{\\partial y^2}$$\n偏微分之后可求得laplace为\n$$\\triangledown ^2f(x,y) = f(x+1,y)+f(x-1,y)+f(x,y+1)+f(x,y-1)-4f(x,y)$$\n点检测laplace模板\n\n1 | 1 | 1\n:---:  | :---: | :---:\n1 | -8 | 1\n1 | 1 | 1\n\n\n如果在某点处的该模板的响应的绝对值超过了一个指定的阈值，那么就说在模板中心位置(x,y)处的该点已经被检测到。在输出图像中，这样的点被标注为1,所有其他点被标注为0\n$$g(x,y)=\\begin{cases}\n1,\\quad |R(x,y)| \\geqq T\\\\\n0, \\quad 其他\n\\end{cases}\n$$\n- MATLAB实现\n\n```matlab\nf = imread('moon.jpg');\n\nf = rgb2gray(f);\n\nw = [-1 -1 -1; -1 8 -1; -1 -1 -1];\n\ng = abs(imfilter(f, w));\n\nT = max(g(:));\n\ng = g >= T;\n\nfigure(1);\n\nsubplot(1,2,1)\n\nimshow(f)\n\nsubplot(1,2,2)\n\nimshow(g)\n```\n结果：\n![](https://i.loli.net/2019/07/24/5d37b3a82234833730.jpg)\n\n### 线检测\n可以预期，二阶导数将导致更强的响应，并产生比一阶导数更细的线\n\n线检测模板\n- 水平\n\n-1 | -1 | -1\n:---:  | :---: | :---:\n2 | 2 | 2\n-1 | -1 | -1\n\n- +45度\n\n2 -| -1 | -1\n:---:  | :---: | :---:\n-1 | 2  | -1\n-1 | -1 | 2\n\n- 垂直\n\n-1 | 2 | -1\n:---:  | :---: | :---:\n-1 | 2 | -1\n-1 | 2 | -1\n\n- -45度\n\n-1 | -1 | 2\n:---:  | :---: | :---:\n-1 | 2  | -1\n2 | -1 | -1\n\n对于恒定的背景，当线通过模板的中间一行时可能产生更大的响应。    \n每个模板的系数之和为0,这表示在恒定亮度区域内，模板的响应为0.\n- MATLAB实现检测指定方向上的线\n\n```matlab\nclc\n\nclear\n\nf = imread('11111.jpg');\n\nf = rgb2gray(f);\n\nfigure(1);\n\nsubplot(2,3,1)\n\nimshow(f);\n\nw = [-1, 2, -1; -1 2 -1; -1 2 -1];\n\n% g = imfilter(tofloat(f),w);\n\ng = imfilter(f,w);\n\nsubplot(2,3,2)\n\nimshow(g, [ ]);\n\ngtop = g(1:120, 1:120);\n\n% gtop = pixeldup(gtop, 4);\n\nsubplot(2,3,3)\n\nimshow(gtop, [ ]);\n\ngbot = g(end - 119:end, end - 119:end);\n\n% gbot = pixeldup(gbot, 4);\n\nsubplot(2,3,4)\n\nimshow(gbot, [ ]);\n\n\ng = abs(g);\n\nsubplot(2,3,5)\n\nimshow(g, [])\n\n\nT = max(g(:));\n\ng = g >= T;\n\nsubplot(2,3,6);\n\nimshow(g)\n\n```\n\n结果:\n![](https://i.loli.net/2019/07/24/5d37b3a815b7125153.jpg)\n可能会用到的M函数pixeldup\n\n```matlab\nfunction B=pixeldup(A,m,n)%pixeldup用来重复像素的，在水平方向复制m倍，在垂直方向复制n倍，m，n必须为整数，n没有赋值默认为m%检查输入参数个数\nif nargin<2\n\terror('At least two inputs are required.');\n\tend\nif nargin==2\n\tn=m;\n\tend\nu=1:size(A,1);%产生一个向量，其向量中元素的个数为A的行数%复制向量中每个元素m次m=round(m);%防止m为非整数u=u(ones(1,m),:);\nu=u(:);%在垂直方向重复操作\nv=1:size(A,2);\nn=round(n);\nv=v(ones(1,n),:);\nv=v(:);\nB=A(u,v);\n```\n\n**慎用tofloat函数**\n\n### 基本边缘检测\n\n#### 边缘模型\n\n- 台阶模型\n在一个像素的距离上发生两次灰度级间理想的过渡\n- 斜坡模型\n数字图像存在被模糊或有噪声的边缘，这时的边缘被建模成一个更接近灰度斜坡的剖面，斜坡的斜度与边缘的模糊程度成反比\n- 屋顶模型\n通过一个区域的线的模型，屋顶边缘的基底(宽度)由该线的宽度和尖锐度决定\n![](https://i.loli.net/2019/07/24/5d382004cd3e437707.jpg)\n\n结合前面提到的一阶导数和二阶导数的性质，可以得出结论:\n1. 一阶导数的幅值可用于检测图像中的某个点处是否存在一个边缘\n2. 二阶导数的符号可用于确定一个边缘像素位于该边缘的暗的一侧还是亮的一侧\n3. 对图像的每个边缘，二阶导数生成两个值\n4. 二阶导数的零交叉点可用于定位粗边缘的中心\n- 执行边缘检测的三个步骤:    \n  1. 为降噪对图像进行平滑处理\n  2. 边缘点的检测\n  3. 边缘定位\n\n#### 梯度\n##### 梯度概念\n梯度是一个可以确定图像f的(x,y)位置处的边缘方向和强度的工具，用 $\\triangledown f$来表示，用 **向量**来定义\n\n$$\\triangledown f = \\begin{bmatrix} g_x \\\\ g_y \\\\ \\end{bmatrix} = \\begin{bmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial x} \\end{bmatrix}$$\n\n##### 梯度性质\n\n1. 梯度向量大小。    \n$\\triangledown f$的大小为M(x,y)\n$$\\triangledown f = mag(\\triangledown f)=[g_x^2+g_y^2]^{\n1/2}= [(\\partial f/\\partial x)^2+(\\partial f/\\partial y)^2]^{1/2}$$\n这是梯度向量方向变化率的值。其中$g_x$,$g_y$和M(x,y)都是和原图像大小相同的图像。称M(x,y)为梯度图像。\n\n2. 梯度向量的方向\n$$\\alpha (x,y) = tan^{-1}(\\frac{g_x}{g_y})$$\n同理，　$\\alpha(x,y)$也是由$g_x$和$g_y$阵列创建的尺寸相同的图像。    \n任意点(x,y)处的一个边缘的方向与该点处梯度向量的方向$\\alpha(x,y)$正交。  \n梯度向量有时也称为边缘法线\n\n3. 梯度指出f在(x,y)处的最大变化率的方向\n\n##### 梯度算子\n###### 一维模板\n\n$$g_x = \\frac{\\partial f(x,y)}{\\partial x} = f(x+1,y) - f(x,y)$$\n和\n$$g_y = \\frac{\\partial f(x,y)}{\\partial y} = f(x,y+1)-f(x,y)$$\n\n###### 二维模板\n\n罗伯特交叉梯度算子(Roberts),ROberts算子以求对角像素之差为基础:\n$$g_x = \\frac{\\partial f}{\\partial x} = (z_9 - z_5)$$\n和\n$$g_y = \\frac{\\partial f}{\\partial y} = (z_8 - z_6)$$\n\n###### 3×3模板\n\n1. Prewitt算子\n$$g_x = (z_7 + z_8 + z_9)-(z_1 + z_2 + z_3)$$\n和\n$$g_y = (z_3 + z_6 + z_9) - (z_1 + z_4 + z_7)$$\n\n2. Sobel算子\n\n$$g_x = (z_7 + 2z_8 + z_9)-(z_1 +2 z_2 + z_3)$$\n和\n$$g_y = (z_3 + 2z_6 + z_9) - (z_1 +2 z_4 + z_7)$$\n\n在中心位置处使用2可以平滑图像\n\n注意:所有模板中的系数之和为0，这意味着恒定灰度的响应为0.\n\n#### 使用函数edge的边缘检测\n- 语法\n\n```matlab\n[g,t] = edge(f, 'method', parameters);\n```\n\nf是输入图像，method是边缘检测方法，parameters是附加参数\n#### 边缘检测算子\n图像邻域如下图所示:\n\n$z_1$ | $z_2$ | $z_3$\n:---: | :---: | :---:\n$z_4$ | $z_5$ | $z_6$\n$z_7$ | $z_8$ | $z_9$\n\n##### Sobel边缘检测算子\n- Sobel边缘检测算子模板\n\n-1 | -2 | -1\n:---: | :---: | :---:\n0 | 0 | 0\n1 | 2 | 1\n\n$$g_x=(z_7+2z_8+z_9)-(z_1+2z_2+z_3)$$\n\n-1 | 0 | 1\n:---:  | :---: | :---:\n-2 | 0 | 2\n-1 | 0 | 1\n\n$$g_y = (z_3+2z_6+z_9)-(z_1+2z_4+z_7)$$\n每一行和每一列的中心像素用2来加权以提供平滑\n- MATLAB语法\n\n```matlab\n[g, t] = edge(f, 'sobel', T, dir);\n```\nf是输入的图像，T是指定的阀值，dir是指定的检测边缘的首选方向:'horizontal','vertical','both'(默认值)    \nt是可选的，T未指定，则t自动设置\n\n##### Prewitt边缘检测算子\n- Prewitt边缘检测算子模板\n\n-1 | -1 | -1\n:---:  | :---: | :---:\n0 | 0 | 0\n1 | 1 | 1\n\n$$g_x = (z_7 + z_8 + z_9)-(z_1 + z_2 + z_3)$$\n\n-1 | 0 | 1\n:---:  | :---: | :---:\n-1 | 0 | 1\n-1 | 0 | 1\n\n$$g_y = (z_3 + z_6 + z_9) - (z_1 + z_4 + z_7)$$\n\n- MATLAB语法\n\n```matlab\n[g, t] = edge(f, 'prewitt', T ,dir);\n```\n\n计算简单，但容易产生噪声\n\n##### Roberts边缘检测算子\n- Roberts边缘检测算子模板\n\n-1 | 0\n:---:  | :---: \n0 | 1\n\n$$g_x = z_9 - z_5$$\n\n0 | 1\n:---:  | :---:\n1 | 0\n\n$$g_y = z_8 - z_6$$\n\n- MATLAB语法\n\n```matlab\n[g, t] = edge(f, 'roberts', T , dir);\n```\n##### LoG检测算子\n- LoG\n\n考虑高斯函数\n$$G(x,y) = e^{-\\frac{x^2 + y^2}{2\\sigma ^2}}$$\n$\\sigma$是标准差。这是平滑函数，如果和图像卷积，会使图像变模糊，模糊程度由$\\sigma$决定    \n这个函数的Laplace算法是:\n$$\\triangledown^2G(x,y) = \\frac{\\partial ^2 G(x,y)}{\\partial x^2}+\\frac{\\partial ^2 G(x,y)}{\\partial y^2} = [\\frac{x^2 + y^2-2\\sigma ^2}{\\sigma ^4}]^{e^{-\\frac{x^2 + y^2}{2\\sigma ^2}}}$$\n\n用$\\triangledown ^2G(x,y)$卷积(滤波)这幅图像与先用平滑函数对图像卷积，再对结果进行Laplace变换的结果是一样的    \n用$\\triangledown ^2G(x,y)$卷积图像，可以得到两个效果:平滑图像(因而减少了噪声);计算Laplace，从而产生双边缘图像，然后在双边缘之间定位由发现的零交叉组成的边缘\n- MATLAB语法\n\n```matlab\n[g, t] = edge(f, 'log', T , sigma);\n```\n\nsigma默认值是2\n\n##### 零交叉检测算子\n- 基于LoG，卷积使用特殊的滤波函数H来完成\n- MATLAB语法\n\n```matlab\n[g, t] = edge(f, 'zerocross', T , H);\n```\n\n##### Canny检测算子\n- edge函数中最强的边缘检测算子\n- MATLAB语法\n\n```matlab\n[g, t] = edge(f, 'canny', T , sigma);\n```\n\n#### MATLAB实现\n- 几种边缘检测算法的比较(Sobel,LoG,Canny)\n\n```matlab\nf = imread('timg1.jpg'); \nimshow(f),title('currect image');\nf = rgb2gray(f);\n%Default Output\n[gSobel_default,ts] = edge(f, 'sobel');\n[gLoG_default, tlog] = edge(f, 'log');\n[gCanny_default, tc] = edge(f,'canny');\n\n%Best Output\n\ngSobel_best = edge(f,'sobel',0.165);\ngLoG_best = edge(f,'log',0.008, 2.25);\ngCanny_best = edge(f,'canny',[0.05, 0.4], 1.5);\n\n\nfigure,imshow(f),title('Gary images');\nfigure,imshow(gSobel_default),title('gSobel default');\nfigure,imshow(gSobel_best),title('gSobel best');\nfigure,imshow(gLoG_default),title('gLoG default');\nfigure,imshow(gLoG_best),title('gLoG best');\nfigure,imshow(gCanny_default),title('gCanny default');\nfigure,imshow(gCanny_best),title('gCanny best');\n```\n\n其中最佳输出的阀值是根据得到的ts,tlog,tc的值来确定的\n结果:\n![](https://i.loli.net/2019/07/24/5d37d6b4bec1777947.jpg)\n![](https://i.loli.net/2019/07/24/5d37d6b5886d994031.jpg)\n![](https://i.loli.net/2019/07/24/5d37d6b3ad9b270352.jpg)\n![](https://i.loli.net/2019/07/24/5d37d6b573bae72055.jpg)\n![](https://i.loli.net/2019/07/24/5d37d6b61724d14715.jpg)\n![](https://i.loli.net/2019/07/24/5d37d6b51df2874618.jpg)\n![](https://i.loli.net/2019/07/24/5d37d6b65663011930.jpg)\n![](https://i.loli.net/2019/07/24/5d37d6b3e566366232.jpg)\n综合结果来看，Canny边缘检测算子可以得到最好的结果\n\n","source":"_posts/图像分割.md","raw":"---\ntitle: 图像分割\ntop: false\ncover: false\nimg: https://i.loli.net/2019/07/17/5d2e73bb14bd344648.png\ntoc: true\nmathjax: true\ndate: 2019-07-24 11:25:37\npassword:\nsummary: 孤立点检测、线检测、基本边缘检测\ntags:\n- 图像处理\n- Matlab\ncategories:\n- Digital Image Processing\n---\n\n# 图像分割\n---\n> 整体等于部分之和    \n>                 -----欧几里德\n\n---\n图像分割把图像细分为它的组成要素或物体，细分的水平取决于要解决的问题。    \n单色分割的分割算法通常是基于图像亮度值的两个基本特征:不连续性和相似性。第一类，方法是基于亮度的突变来分割一幅图像，比如边缘;第二类，主要方法是根据事先定义好的准则把图像分割成相似的区域\n\n## 点、线和基本边缘检测\n\n### 背景知识\n1. 边缘像素是图像中灰度突变的像素，边缘是连接的边缘像素的集合\n2. 一条线可以视为一条边缘线段，该线段两侧的背景灰度要么远亮于该线像素的灰度，要么远暗于该线像素的灰度。孤立点可视为一条线，只是长度和宽度都是一个像素\n3. 局部变化检测可以用微分(一阶微分和二阶微分)    \n   - 对于一阶导数的任何近似，约定:\n      - 在恒定灰度区域必须为0\n      - 在灰度台阶和或斜坡开始处必须不为0\n      - 在沿灰度斜坡点处也必须不为0\n   - 类似的对于二阶导数的近似\n      - 在恒定灰度区域必须为0\n      - 在灰度台阶或斜坡开始除和结束处必须不为0\n      - 沿灰度斜坡必须为0\n   - 一维函数展开为关于x的泰勒级数,结果差分\n   $$ \\frac{\\partial f}{\\partial x}=f'(x)=f(x+1)-f(x)$$\n    二阶导数\n    $$ \\frac{\\partial ^2 f}{\\partial ^2 x}=f''(x)=f(x+1)+f(x-1)-2f(x)$$\n    - 可以得出结论:\n      - 一阶导数通常在图像中产生较粗的边缘\n      - 二阶导数对精细细节，如细线、孤立点和噪声有较强的响应\n      - 二阶导数在灰度斜坡和灰度台阶过渡处会产生双边缘响应\n      - 二阶导数的符号可用于确定边缘的过程是从亮到暗还是从暗到亮\n    - 计算图像中每个像素位置的一阶导数和二阶导数的可选择方法是空间滤波器。模板在该区域中心点处的响应为\n    $$R = w_1z_1 + w_2z_2 + ... + w_9z_9 = \\sum_{k=1}^{9}w_kz_k$$\n\n$w_1$ | $w_2$ | $w_3$\n:---: | :---: | :---:\n$w_4$ | $w_5$ | $w_6$\n$w_7$ | $w_8$ | $w_9$\n\n这是一个普通的3×3空间滤波器掩模\n\n### 孤立点检测\n- 点的检测应以二阶导数为基础，这意味着使用laplace\n$$\\triangledown ^2f(x,y) = \\frac{\\partial ^2 f}{\\partial x^2} + \\frac{\\partial ^2 f}{\\partial y^2}$$\n偏微分之后可求得laplace为\n$$\\triangledown ^2f(x,y) = f(x+1,y)+f(x-1,y)+f(x,y+1)+f(x,y-1)-4f(x,y)$$\n点检测laplace模板\n\n1 | 1 | 1\n:---:  | :---: | :---:\n1 | -8 | 1\n1 | 1 | 1\n\n\n如果在某点处的该模板的响应的绝对值超过了一个指定的阈值，那么就说在模板中心位置(x,y)处的该点已经被检测到。在输出图像中，这样的点被标注为1,所有其他点被标注为0\n$$g(x,y)=\\begin{cases}\n1,\\quad |R(x,y)| \\geqq T\\\\\n0, \\quad 其他\n\\end{cases}\n$$\n- MATLAB实现\n\n```matlab\nf = imread('moon.jpg');\n\nf = rgb2gray(f);\n\nw = [-1 -1 -1; -1 8 -1; -1 -1 -1];\n\ng = abs(imfilter(f, w));\n\nT = max(g(:));\n\ng = g >= T;\n\nfigure(1);\n\nsubplot(1,2,1)\n\nimshow(f)\n\nsubplot(1,2,2)\n\nimshow(g)\n```\n结果：\n![](https://i.loli.net/2019/07/24/5d37b3a82234833730.jpg)\n\n### 线检测\n可以预期，二阶导数将导致更强的响应，并产生比一阶导数更细的线\n\n线检测模板\n- 水平\n\n-1 | -1 | -1\n:---:  | :---: | :---:\n2 | 2 | 2\n-1 | -1 | -1\n\n- +45度\n\n2 -| -1 | -1\n:---:  | :---: | :---:\n-1 | 2  | -1\n-1 | -1 | 2\n\n- 垂直\n\n-1 | 2 | -1\n:---:  | :---: | :---:\n-1 | 2 | -1\n-1 | 2 | -1\n\n- -45度\n\n-1 | -1 | 2\n:---:  | :---: | :---:\n-1 | 2  | -1\n2 | -1 | -1\n\n对于恒定的背景，当线通过模板的中间一行时可能产生更大的响应。    \n每个模板的系数之和为0,这表示在恒定亮度区域内，模板的响应为0.\n- MATLAB实现检测指定方向上的线\n\n```matlab\nclc\n\nclear\n\nf = imread('11111.jpg');\n\nf = rgb2gray(f);\n\nfigure(1);\n\nsubplot(2,3,1)\n\nimshow(f);\n\nw = [-1, 2, -1; -1 2 -1; -1 2 -1];\n\n% g = imfilter(tofloat(f),w);\n\ng = imfilter(f,w);\n\nsubplot(2,3,2)\n\nimshow(g, [ ]);\n\ngtop = g(1:120, 1:120);\n\n% gtop = pixeldup(gtop, 4);\n\nsubplot(2,3,3)\n\nimshow(gtop, [ ]);\n\ngbot = g(end - 119:end, end - 119:end);\n\n% gbot = pixeldup(gbot, 4);\n\nsubplot(2,3,4)\n\nimshow(gbot, [ ]);\n\n\ng = abs(g);\n\nsubplot(2,3,5)\n\nimshow(g, [])\n\n\nT = max(g(:));\n\ng = g >= T;\n\nsubplot(2,3,6);\n\nimshow(g)\n\n```\n\n结果:\n![](https://i.loli.net/2019/07/24/5d37b3a815b7125153.jpg)\n可能会用到的M函数pixeldup\n\n```matlab\nfunction B=pixeldup(A,m,n)%pixeldup用来重复像素的，在水平方向复制m倍，在垂直方向复制n倍，m，n必须为整数，n没有赋值默认为m%检查输入参数个数\nif nargin<2\n\terror('At least two inputs are required.');\n\tend\nif nargin==2\n\tn=m;\n\tend\nu=1:size(A,1);%产生一个向量，其向量中元素的个数为A的行数%复制向量中每个元素m次m=round(m);%防止m为非整数u=u(ones(1,m),:);\nu=u(:);%在垂直方向重复操作\nv=1:size(A,2);\nn=round(n);\nv=v(ones(1,n),:);\nv=v(:);\nB=A(u,v);\n```\n\n**慎用tofloat函数**\n\n### 基本边缘检测\n\n#### 边缘模型\n\n- 台阶模型\n在一个像素的距离上发生两次灰度级间理想的过渡\n- 斜坡模型\n数字图像存在被模糊或有噪声的边缘，这时的边缘被建模成一个更接近灰度斜坡的剖面，斜坡的斜度与边缘的模糊程度成反比\n- 屋顶模型\n通过一个区域的线的模型，屋顶边缘的基底(宽度)由该线的宽度和尖锐度决定\n![](https://i.loli.net/2019/07/24/5d382004cd3e437707.jpg)\n\n结合前面提到的一阶导数和二阶导数的性质，可以得出结论:\n1. 一阶导数的幅值可用于检测图像中的某个点处是否存在一个边缘\n2. 二阶导数的符号可用于确定一个边缘像素位于该边缘的暗的一侧还是亮的一侧\n3. 对图像的每个边缘，二阶导数生成两个值\n4. 二阶导数的零交叉点可用于定位粗边缘的中心\n- 执行边缘检测的三个步骤:    \n  1. 为降噪对图像进行平滑处理\n  2. 边缘点的检测\n  3. 边缘定位\n\n#### 梯度\n##### 梯度概念\n梯度是一个可以确定图像f的(x,y)位置处的边缘方向和强度的工具，用 $\\triangledown f$来表示，用 **向量**来定义\n\n$$\\triangledown f = \\begin{bmatrix} g_x \\\\ g_y \\\\ \\end{bmatrix} = \\begin{bmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial x} \\end{bmatrix}$$\n\n##### 梯度性质\n\n1. 梯度向量大小。    \n$\\triangledown f$的大小为M(x,y)\n$$\\triangledown f = mag(\\triangledown f)=[g_x^2+g_y^2]^{\n1/2}= [(\\partial f/\\partial x)^2+(\\partial f/\\partial y)^2]^{1/2}$$\n这是梯度向量方向变化率的值。其中$g_x$,$g_y$和M(x,y)都是和原图像大小相同的图像。称M(x,y)为梯度图像。\n\n2. 梯度向量的方向\n$$\\alpha (x,y) = tan^{-1}(\\frac{g_x}{g_y})$$\n同理，　$\\alpha(x,y)$也是由$g_x$和$g_y$阵列创建的尺寸相同的图像。    \n任意点(x,y)处的一个边缘的方向与该点处梯度向量的方向$\\alpha(x,y)$正交。  \n梯度向量有时也称为边缘法线\n\n3. 梯度指出f在(x,y)处的最大变化率的方向\n\n##### 梯度算子\n###### 一维模板\n\n$$g_x = \\frac{\\partial f(x,y)}{\\partial x} = f(x+1,y) - f(x,y)$$\n和\n$$g_y = \\frac{\\partial f(x,y)}{\\partial y} = f(x,y+1)-f(x,y)$$\n\n###### 二维模板\n\n罗伯特交叉梯度算子(Roberts),ROberts算子以求对角像素之差为基础:\n$$g_x = \\frac{\\partial f}{\\partial x} = (z_9 - z_5)$$\n和\n$$g_y = \\frac{\\partial f}{\\partial y} = (z_8 - z_6)$$\n\n###### 3×3模板\n\n1. Prewitt算子\n$$g_x = (z_7 + z_8 + z_9)-(z_1 + z_2 + z_3)$$\n和\n$$g_y = (z_3 + z_6 + z_9) - (z_1 + z_4 + z_7)$$\n\n2. Sobel算子\n\n$$g_x = (z_7 + 2z_8 + z_9)-(z_1 +2 z_2 + z_3)$$\n和\n$$g_y = (z_3 + 2z_6 + z_9) - (z_1 +2 z_4 + z_7)$$\n\n在中心位置处使用2可以平滑图像\n\n注意:所有模板中的系数之和为0，这意味着恒定灰度的响应为0.\n\n#### 使用函数edge的边缘检测\n- 语法\n\n```matlab\n[g,t] = edge(f, 'method', parameters);\n```\n\nf是输入图像，method是边缘检测方法，parameters是附加参数\n#### 边缘检测算子\n图像邻域如下图所示:\n\n$z_1$ | $z_2$ | $z_3$\n:---: | :---: | :---:\n$z_4$ | $z_5$ | $z_6$\n$z_7$ | $z_8$ | $z_9$\n\n##### Sobel边缘检测算子\n- Sobel边缘检测算子模板\n\n-1 | -2 | -1\n:---: | :---: | :---:\n0 | 0 | 0\n1 | 2 | 1\n\n$$g_x=(z_7+2z_8+z_9)-(z_1+2z_2+z_3)$$\n\n-1 | 0 | 1\n:---:  | :---: | :---:\n-2 | 0 | 2\n-1 | 0 | 1\n\n$$g_y = (z_3+2z_6+z_9)-(z_1+2z_4+z_7)$$\n每一行和每一列的中心像素用2来加权以提供平滑\n- MATLAB语法\n\n```matlab\n[g, t] = edge(f, 'sobel', T, dir);\n```\nf是输入的图像，T是指定的阀值，dir是指定的检测边缘的首选方向:'horizontal','vertical','both'(默认值)    \nt是可选的，T未指定，则t自动设置\n\n##### Prewitt边缘检测算子\n- Prewitt边缘检测算子模板\n\n-1 | -1 | -1\n:---:  | :---: | :---:\n0 | 0 | 0\n1 | 1 | 1\n\n$$g_x = (z_7 + z_8 + z_9)-(z_1 + z_2 + z_3)$$\n\n-1 | 0 | 1\n:---:  | :---: | :---:\n-1 | 0 | 1\n-1 | 0 | 1\n\n$$g_y = (z_3 + z_6 + z_9) - (z_1 + z_4 + z_7)$$\n\n- MATLAB语法\n\n```matlab\n[g, t] = edge(f, 'prewitt', T ,dir);\n```\n\n计算简单，但容易产生噪声\n\n##### Roberts边缘检测算子\n- Roberts边缘检测算子模板\n\n-1 | 0\n:---:  | :---: \n0 | 1\n\n$$g_x = z_9 - z_5$$\n\n0 | 1\n:---:  | :---:\n1 | 0\n\n$$g_y = z_8 - z_6$$\n\n- MATLAB语法\n\n```matlab\n[g, t] = edge(f, 'roberts', T , dir);\n```\n##### LoG检测算子\n- LoG\n\n考虑高斯函数\n$$G(x,y) = e^{-\\frac{x^2 + y^2}{2\\sigma ^2}}$$\n$\\sigma$是标准差。这是平滑函数，如果和图像卷积，会使图像变模糊，模糊程度由$\\sigma$决定    \n这个函数的Laplace算法是:\n$$\\triangledown^2G(x,y) = \\frac{\\partial ^2 G(x,y)}{\\partial x^2}+\\frac{\\partial ^2 G(x,y)}{\\partial y^2} = [\\frac{x^2 + y^2-2\\sigma ^2}{\\sigma ^4}]^{e^{-\\frac{x^2 + y^2}{2\\sigma ^2}}}$$\n\n用$\\triangledown ^2G(x,y)$卷积(滤波)这幅图像与先用平滑函数对图像卷积，再对结果进行Laplace变换的结果是一样的    \n用$\\triangledown ^2G(x,y)$卷积图像，可以得到两个效果:平滑图像(因而减少了噪声);计算Laplace，从而产生双边缘图像，然后在双边缘之间定位由发现的零交叉组成的边缘\n- MATLAB语法\n\n```matlab\n[g, t] = edge(f, 'log', T , sigma);\n```\n\nsigma默认值是2\n\n##### 零交叉检测算子\n- 基于LoG，卷积使用特殊的滤波函数H来完成\n- MATLAB语法\n\n```matlab\n[g, t] = edge(f, 'zerocross', T , H);\n```\n\n##### Canny检测算子\n- edge函数中最强的边缘检测算子\n- MATLAB语法\n\n```matlab\n[g, t] = edge(f, 'canny', T , sigma);\n```\n\n#### MATLAB实现\n- 几种边缘检测算法的比较(Sobel,LoG,Canny)\n\n```matlab\nf = imread('timg1.jpg'); \nimshow(f),title('currect image');\nf = rgb2gray(f);\n%Default Output\n[gSobel_default,ts] = edge(f, 'sobel');\n[gLoG_default, tlog] = edge(f, 'log');\n[gCanny_default, tc] = edge(f,'canny');\n\n%Best Output\n\ngSobel_best = edge(f,'sobel',0.165);\ngLoG_best = edge(f,'log',0.008, 2.25);\ngCanny_best = edge(f,'canny',[0.05, 0.4], 1.5);\n\n\nfigure,imshow(f),title('Gary images');\nfigure,imshow(gSobel_default),title('gSobel default');\nfigure,imshow(gSobel_best),title('gSobel best');\nfigure,imshow(gLoG_default),title('gLoG default');\nfigure,imshow(gLoG_best),title('gLoG best');\nfigure,imshow(gCanny_default),title('gCanny default');\nfigure,imshow(gCanny_best),title('gCanny best');\n```\n\n其中最佳输出的阀值是根据得到的ts,tlog,tc的值来确定的\n结果:\n![](https://i.loli.net/2019/07/24/5d37d6b4bec1777947.jpg)\n![](https://i.loli.net/2019/07/24/5d37d6b5886d994031.jpg)\n![](https://i.loli.net/2019/07/24/5d37d6b3ad9b270352.jpg)\n![](https://i.loli.net/2019/07/24/5d37d6b573bae72055.jpg)\n![](https://i.loli.net/2019/07/24/5d37d6b61724d14715.jpg)\n![](https://i.loli.net/2019/07/24/5d37d6b51df2874618.jpg)\n![](https://i.loli.net/2019/07/24/5d37d6b65663011930.jpg)\n![](https://i.loli.net/2019/07/24/5d37d6b3e566366232.jpg)\n综合结果来看，Canny边缘检测算子可以得到最好的结果\n\n","slug":"图像分割","published":1,"updated":"2020-02-24T10:49:41.449Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0tl002474jun49b4hwr","content":"<h1 id=\"图像分割\"><a href=\"#图像分割\" class=\"headerlink\" title=\"图像分割\"></a>图像分割</h1><hr>\n<blockquote>\n<p>整体等于部分之和<br>                —–欧几里德</p>\n</blockquote>\n<hr>\n<p>图像分割把图像细分为它的组成要素或物体，细分的水平取决于要解决的问题。<br>单色分割的分割算法通常是基于图像亮度值的两个基本特征:不连续性和相似性。第一类，方法是基于亮度的突变来分割一幅图像，比如边缘;第二类，主要方法是根据事先定义好的准则把图像分割成相似的区域</p>\n<h2 id=\"点、线和基本边缘检测\"><a href=\"#点、线和基本边缘检测\" class=\"headerlink\" title=\"点、线和基本边缘检测\"></a>点、线和基本边缘检测</h2><h3 id=\"背景知识\"><a href=\"#背景知识\" class=\"headerlink\" title=\"背景知识\"></a>背景知识</h3><ol>\n<li>边缘像素是图像中灰度突变的像素，边缘是连接的边缘像素的集合</li>\n<li>一条线可以视为一条边缘线段，该线段两侧的背景灰度要么远亮于该线像素的灰度，要么远暗于该线像素的灰度。孤立点可视为一条线，只是长度和宽度都是一个像素</li>\n<li>局部变化检测可以用微分(一阶微分和二阶微分)    <ul>\n<li>对于一阶导数的任何近似，约定:<ul>\n<li>在恒定灰度区域必须为0</li>\n<li>在灰度台阶和或斜坡开始处必须不为0</li>\n<li>在沿灰度斜坡点处也必须不为0</li>\n</ul>\n</li>\n<li>类似的对于二阶导数的近似<ul>\n<li>在恒定灰度区域必须为0</li>\n<li>在灰度台阶或斜坡开始除和结束处必须不为0</li>\n<li>沿灰度斜坡必须为0</li>\n</ul>\n</li>\n<li>一维函数展开为关于x的泰勒级数,结果差分<br>$$ \\frac{\\partial f}{\\partial x}=f’(x)=f(x+1)-f(x)$$<br>二阶导数<br>$$ \\frac{\\partial ^2 f}{\\partial ^2 x}=f’’(x)=f(x+1)+f(x-1)-2f(x)$$<ul>\n<li>可以得出结论:<ul>\n<li>一阶导数通常在图像中产生较粗的边缘</li>\n<li>二阶导数对精细细节，如细线、孤立点和噪声有较强的响应</li>\n<li>二阶导数在灰度斜坡和灰度台阶过渡处会产生双边缘响应</li>\n<li>二阶导数的符号可用于确定边缘的过程是从亮到暗还是从暗到亮</li>\n</ul>\n</li>\n<li>计算图像中每个像素位置的一阶导数和二阶导数的可选择方法是空间滤波器。模板在该区域中心点处的响应为<br>$$R = w_1z_1 + w_2z_2 + … + w_9z_9 = \\sum_{k=1}^{9}w_kz_k$$</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th align=\"center\">$w_1$</th>\n<th align=\"center\">$w_2$</th>\n<th align=\"center\">$w_3$</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">$w_4$</td>\n<td align=\"center\">$w_5$</td>\n<td align=\"center\">$w_6$</td>\n</tr>\n<tr>\n<td align=\"center\">$w_7$</td>\n<td align=\"center\">$w_8$</td>\n<td align=\"center\">$w_9$</td>\n</tr>\n</tbody></table>\n<p>这是一个普通的3×3空间滤波器掩模</p>\n<h3 id=\"孤立点检测\"><a href=\"#孤立点检测\" class=\"headerlink\" title=\"孤立点检测\"></a>孤立点检测</h3><ul>\n<li>点的检测应以二阶导数为基础，这意味着使用laplace<br>$$\\triangledown ^2f(x,y) = \\frac{\\partial ^2 f}{\\partial x^2} + \\frac{\\partial ^2 f}{\\partial y^2}$$<br>偏微分之后可求得laplace为<br>$$\\triangledown ^2f(x,y) = f(x+1,y)+f(x-1,y)+f(x,y+1)+f(x,y-1)-4f(x,y)$$<br>点检测laplace模板</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">1</th>\n<th align=\"center\">1</th>\n<th align=\"center\">1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">1</td>\n<td align=\"center\">-8</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n</tr>\n</tbody></table>\n<p>如果在某点处的该模板的响应的绝对值超过了一个指定的阈值，那么就说在模板中心位置(x,y)处的该点已经被检测到。在输出图像中，这样的点被标注为1,所有其他点被标注为0<br>$$g(x,y)=\\begin{cases}<br>1,\\quad |R(x,y)| \\geqq T\\<br>0, \\quad 其他<br>\\end{cases}<br>$$</p>\n<ul>\n<li>MATLAB实现</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">f <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">'moon.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nf <span class=\"token operator\">=</span> <span class=\"token function\">rgb2gray</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nw <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token number\">8</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\ng <span class=\"token operator\">=</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span><span class=\"token function\">imfilter</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nT <span class=\"token operator\">=</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ng <span class=\"token operator\">=</span> g <span class=\"token operator\">>=</span> T<span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span></code></pre>\n<p>结果：<br><img src=\"https://i.loli.net/2019/07/24/5d37b3a82234833730.jpg\" alt></p>\n<h3 id=\"线检测\"><a href=\"#线检测\" class=\"headerlink\" title=\"线检测\"></a>线检测</h3><p>可以预期，二阶导数将导致更强的响应，并产生比一阶导数更细的线</p>\n<p>线检测模板</p>\n<ul>\n<li>水平</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">-1</th>\n<th align=\"center\">-1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">2</td>\n<td align=\"center\">2</td>\n<td align=\"center\">2</td>\n</tr>\n<tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">-1</td>\n<td align=\"center\">-1</td>\n</tr>\n</tbody></table>\n<ul>\n<li>+45度</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">2 -</th>\n<th align=\"center\">-1</th>\n<th align=\"center\">-1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">2</td>\n<td align=\"center\">-1</td>\n</tr>\n<tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">-1</td>\n<td align=\"center\">2</td>\n</tr>\n</tbody></table>\n<ul>\n<li>垂直</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">2</th>\n<th align=\"center\">-1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">2</td>\n<td align=\"center\">-1</td>\n</tr>\n<tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">2</td>\n<td align=\"center\">-1</td>\n</tr>\n</tbody></table>\n<ul>\n<li>-45度</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">-1</th>\n<th align=\"center\">2</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">2</td>\n<td align=\"center\">-1</td>\n</tr>\n<tr>\n<td align=\"center\">2</td>\n<td align=\"center\">-1</td>\n<td align=\"center\">-1</td>\n</tr>\n</tbody></table>\n<p>对于恒定的背景，当线通过模板的中间一行时可能产生更大的响应。<br>每个模板的系数之和为0,这表示在恒定亮度区域内，模板的响应为0.</p>\n<ul>\n<li>MATLAB实现检测指定方向上的线</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">clc\n\nclear\n\nf <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">'11111.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nf <span class=\"token operator\">=</span> <span class=\"token function\">rgb2gray</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nw <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token number\">2</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token number\">2</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">% g = imfilter(tofloat(f),w);</span>\n\ng <span class=\"token operator\">=</span> <span class=\"token function\">imfilter</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span>w<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ngtop <span class=\"token operator\">=</span> <span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">120</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">120</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">% gtop = pixeldup(gtop, 4);</span>\n\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>gtop<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ngbot <span class=\"token operator\">=</span> <span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">end</span> <span class=\"token operator\">-</span> <span class=\"token number\">119</span><span class=\"token operator\">:</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">end</span> <span class=\"token operator\">-</span> <span class=\"token number\">119</span><span class=\"token operator\">:</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">% gbot = pixeldup(gbot, 4);</span>\n\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>gbot<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\ng <span class=\"token operator\">=</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n\nT <span class=\"token operator\">=</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ng <span class=\"token operator\">=</span> g <span class=\"token operator\">>=</span> T<span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>结果:<br><img src=\"https://i.loli.net/2019/07/24/5d37b3a815b7125153.jpg\" alt><br>可能会用到的M函数pixeldup</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token keyword\">function</span> B<span class=\"token operator\">=</span><span class=\"token function\">pixeldup</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">,</span>m<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span><span class=\"token comment\" spellcheck=\"true\">%pixeldup用来重复像素的，在水平方向复制m倍，在垂直方向复制n倍，m，n必须为整数，n没有赋值默认为m%检查输入参数个数</span>\n<span class=\"token keyword\">if</span> nargin<span class=\"token operator\">&lt;</span><span class=\"token number\">2</span>\n    <span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'At least two inputs are required.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">if</span> nargin<span class=\"token operator\">==</span><span class=\"token number\">2</span>\n    n<span class=\"token operator\">=</span>m<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">end</span>\nu<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\" spellcheck=\"true\">%产生一个向量，其向量中元素的个数为A的行数%复制向量中每个元素m次m=round(m);%防止m为非整数u=u(ones(1,m),:);</span>\nu<span class=\"token operator\">=</span><span class=\"token function\">u</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\" spellcheck=\"true\">%在垂直方向重复操作</span>\nv<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nn<span class=\"token operator\">=</span><span class=\"token function\">round</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nv<span class=\"token operator\">=</span><span class=\"token function\">v</span><span class=\"token punctuation\">(</span><span class=\"token function\">ones</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nv<span class=\"token operator\">=</span><span class=\"token function\">v</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nB<span class=\"token operator\">=</span><span class=\"token function\">A</span><span class=\"token punctuation\">(</span>u<span class=\"token punctuation\">,</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p><strong>慎用tofloat函数</strong></p>\n<h3 id=\"基本边缘检测\"><a href=\"#基本边缘检测\" class=\"headerlink\" title=\"基本边缘检测\"></a>基本边缘检测</h3><h4 id=\"边缘模型\"><a href=\"#边缘模型\" class=\"headerlink\" title=\"边缘模型\"></a>边缘模型</h4><ul>\n<li>台阶模型<br>在一个像素的距离上发生两次灰度级间理想的过渡</li>\n<li>斜坡模型<br>数字图像存在被模糊或有噪声的边缘，这时的边缘被建模成一个更接近灰度斜坡的剖面，斜坡的斜度与边缘的模糊程度成反比</li>\n<li>屋顶模型<br>通过一个区域的线的模型，屋顶边缘的基底(宽度)由该线的宽度和尖锐度决定<br><img src=\"https://i.loli.net/2019/07/24/5d382004cd3e437707.jpg\" alt></li>\n</ul>\n<p>结合前面提到的一阶导数和二阶导数的性质，可以得出结论:</p>\n<ol>\n<li>一阶导数的幅值可用于检测图像中的某个点处是否存在一个边缘</li>\n<li>二阶导数的符号可用于确定一个边缘像素位于该边缘的暗的一侧还是亮的一侧</li>\n<li>对图像的每个边缘，二阶导数生成两个值</li>\n<li>二阶导数的零交叉点可用于定位粗边缘的中心</li>\n</ol>\n<ul>\n<li>执行边缘检测的三个步骤:    <ol>\n<li>为降噪对图像进行平滑处理</li>\n<li>边缘点的检测</li>\n<li>边缘定位</li>\n</ol>\n</li>\n</ul>\n<h4 id=\"梯度\"><a href=\"#梯度\" class=\"headerlink\" title=\"梯度\"></a>梯度</h4><h5 id=\"梯度概念\"><a href=\"#梯度概念\" class=\"headerlink\" title=\"梯度概念\"></a>梯度概念</h5><p>梯度是一个可以确定图像f的(x,y)位置处的边缘方向和强度的工具，用 $\\triangledown f$来表示，用 <strong>向量</strong>来定义</p>\n<p>$$\\triangledown f = \\begin{bmatrix} g_x \\\\ g_y \\\\ \\end{bmatrix} = \\begin{bmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial x} \\end{bmatrix}$$</p>\n<h5 id=\"梯度性质\"><a href=\"#梯度性质\" class=\"headerlink\" title=\"梯度性质\"></a>梯度性质</h5><ol>\n<li><p>梯度向量大小。<br>$\\triangledown f$的大小为M(x,y)<br>$$\\triangledown f = mag(\\triangledown f)=[g_x^2+g_y^2]^{<br>1/2}= [(\\partial f/\\partial x)^2+(\\partial f/\\partial y)^2]^{1/2}$$<br>这是梯度向量方向变化率的值。其中$g_x$,$g_y$和M(x,y)都是和原图像大小相同的图像。称M(x,y)为梯度图像。</p>\n</li>\n<li><p>梯度向量的方向<br>$$\\alpha (x,y) = tan^{-1}(\\frac{g_x}{g_y})$$<br>同理，　$\\alpha(x,y)$也是由$g_x$和$g_y$阵列创建的尺寸相同的图像。<br>任意点(x,y)处的一个边缘的方向与该点处梯度向量的方向$\\alpha(x,y)$正交。<br>梯度向量有时也称为边缘法线</p>\n</li>\n<li><p>梯度指出f在(x,y)处的最大变化率的方向</p>\n</li>\n</ol>\n<h5 id=\"梯度算子\"><a href=\"#梯度算子\" class=\"headerlink\" title=\"梯度算子\"></a>梯度算子</h5><h6 id=\"一维模板\"><a href=\"#一维模板\" class=\"headerlink\" title=\"一维模板\"></a>一维模板</h6><p>$$g_x = \\frac{\\partial f(x,y)}{\\partial x} = f(x+1,y) - f(x,y)$$<br>和<br>$$g_y = \\frac{\\partial f(x,y)}{\\partial y} = f(x,y+1)-f(x,y)$$</p>\n<h6 id=\"二维模板\"><a href=\"#二维模板\" class=\"headerlink\" title=\"二维模板\"></a>二维模板</h6><p>罗伯特交叉梯度算子(Roberts),ROberts算子以求对角像素之差为基础:<br>$$g_x = \\frac{\\partial f}{\\partial x} = (z_9 - z_5)$$<br>和<br>$$g_y = \\frac{\\partial f}{\\partial y} = (z_8 - z_6)$$</p>\n<h6 id=\"3×3模板\"><a href=\"#3×3模板\" class=\"headerlink\" title=\"3×3模板\"></a>3×3模板</h6><ol>\n<li><p>Prewitt算子<br>$$g_x = (z_7 + z_8 + z_9)-(z_1 + z_2 + z_3)$$<br>和<br>$$g_y = (z_3 + z_6 + z_9) - (z_1 + z_4 + z_7)$$</p>\n</li>\n<li><p>Sobel算子</p>\n</li>\n</ol>\n<p>$$g_x = (z_7 + 2z_8 + z_9)-(z_1 +2 z_2 + z_3)$$<br>和<br>$$g_y = (z_3 + 2z_6 + z_9) - (z_1 +2 z_4 + z_7)$$</p>\n<p>在中心位置处使用2可以平滑图像</p>\n<p>注意:所有模板中的系数之和为0，这意味着恒定灰度的响应为0.</p>\n<h4 id=\"使用函数edge的边缘检测\"><a href=\"#使用函数edge的边缘检测\" class=\"headerlink\" title=\"使用函数edge的边缘检测\"></a>使用函数edge的边缘检测</h4><ul>\n<li>语法</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token punctuation\">[</span>g<span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">edge</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token string\">'method'</span><span class=\"token punctuation\">,</span> parameters<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>f是输入图像，method是边缘检测方法，parameters是附加参数</p>\n<h4 id=\"边缘检测算子\"><a href=\"#边缘检测算子\" class=\"headerlink\" title=\"边缘检测算子\"></a>边缘检测算子</h4><p>图像邻域如下图所示:</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">$z_1$</th>\n<th align=\"center\">$z_2$</th>\n<th align=\"center\">$z_3$</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">$z_4$</td>\n<td align=\"center\">$z_5$</td>\n<td align=\"center\">$z_6$</td>\n</tr>\n<tr>\n<td align=\"center\">$z_7$</td>\n<td align=\"center\">$z_8$</td>\n<td align=\"center\">$z_9$</td>\n</tr>\n</tbody></table>\n<h5 id=\"Sobel边缘检测算子\"><a href=\"#Sobel边缘检测算子\" class=\"headerlink\" title=\"Sobel边缘检测算子\"></a>Sobel边缘检测算子</h5><ul>\n<li>Sobel边缘检测算子模板</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">-2</th>\n<th align=\"center\">-1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">0</td>\n<td align=\"center\">0</td>\n<td align=\"center\">0</td>\n</tr>\n<tr>\n<td align=\"center\">1</td>\n<td align=\"center\">2</td>\n<td align=\"center\">1</td>\n</tr>\n</tbody></table>\n<p>$$g_x=(z_7+2z_8+z_9)-(z_1+2z_2+z_3)$$</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">0</th>\n<th align=\"center\">1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-2</td>\n<td align=\"center\">0</td>\n<td align=\"center\">2</td>\n</tr>\n<tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">0</td>\n<td align=\"center\">1</td>\n</tr>\n</tbody></table>\n<p>$$g_y = (z_3+2z_6+z_9)-(z_1+2z_4+z_7)$$<br>每一行和每一列的中心像素用2来加权以提供平滑</p>\n<ul>\n<li>MATLAB语法</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token punctuation\">[</span>g<span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">edge</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token string\">'sobel'</span><span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">,</span> dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>f是输入的图像，T是指定的阀值，dir是指定的检测边缘的首选方向:’horizontal’,’vertical’,’both’(默认值)<br>t是可选的，T未指定，则t自动设置</p>\n<h5 id=\"Prewitt边缘检测算子\"><a href=\"#Prewitt边缘检测算子\" class=\"headerlink\" title=\"Prewitt边缘检测算子\"></a>Prewitt边缘检测算子</h5><ul>\n<li>Prewitt边缘检测算子模板</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">-1</th>\n<th align=\"center\">-1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">0</td>\n<td align=\"center\">0</td>\n<td align=\"center\">0</td>\n</tr>\n<tr>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n</tr>\n</tbody></table>\n<p>$$g_x = (z_7 + z_8 + z_9)-(z_1 + z_2 + z_3)$$</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">0</th>\n<th align=\"center\">1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">0</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">0</td>\n<td align=\"center\">1</td>\n</tr>\n</tbody></table>\n<p>$$g_y = (z_3 + z_6 + z_9) - (z_1 + z_4 + z_7)$$</p>\n<ul>\n<li>MATLAB语法</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token punctuation\">[</span>g<span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">edge</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token string\">'prewitt'</span><span class=\"token punctuation\">,</span> T <span class=\"token punctuation\">,</span>dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>计算简单，但容易产生噪声</p>\n<h5 id=\"Roberts边缘检测算子\"><a href=\"#Roberts边缘检测算子\" class=\"headerlink\" title=\"Roberts边缘检测算子\"></a>Roberts边缘检测算子</h5><ul>\n<li>Roberts边缘检测算子模板</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">0</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">0</td>\n<td align=\"center\">1</td>\n</tr>\n</tbody></table>\n<p>$$g_x = z_9 - z_5$$</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">0</th>\n<th align=\"center\">1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">1</td>\n<td align=\"center\">0</td>\n</tr>\n</tbody></table>\n<p>$$g_y = z_8 - z_6$$</p>\n<ul>\n<li>MATLAB语法</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token punctuation\">[</span>g<span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">edge</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token string\">'roberts'</span><span class=\"token punctuation\">,</span> T <span class=\"token punctuation\">,</span> dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<h5 id=\"LoG检测算子\"><a href=\"#LoG检测算子\" class=\"headerlink\" title=\"LoG检测算子\"></a>LoG检测算子</h5><ul>\n<li>LoG</li>\n</ul>\n<p>考虑高斯函数<br>$$G(x,y) = e^{-\\frac{x^2 + y^2}{2\\sigma ^2}}$$<br>$\\sigma$是标准差。这是平滑函数，如果和图像卷积，会使图像变模糊，模糊程度由$\\sigma$决定<br>这个函数的Laplace算法是:<br>$$\\triangledown^2G(x,y) = \\frac{\\partial ^2 G(x,y)}{\\partial x^2}+\\frac{\\partial ^2 G(x,y)}{\\partial y^2} = [\\frac{x^2 + y^2-2\\sigma ^2}{\\sigma ^4}]^{e^{-\\frac{x^2 + y^2}{2\\sigma ^2}}}$$</p>\n<p>用$\\triangledown ^2G(x,y)$卷积(滤波)这幅图像与先用平滑函数对图像卷积，再对结果进行Laplace变换的结果是一样的<br>用$\\triangledown ^2G(x,y)$卷积图像，可以得到两个效果:平滑图像(因而减少了噪声);计算Laplace，从而产生双边缘图像，然后在双边缘之间定位由发现的零交叉组成的边缘</p>\n<ul>\n<li>MATLAB语法</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token punctuation\">[</span>g<span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">edge</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token string\">'log'</span><span class=\"token punctuation\">,</span> T <span class=\"token punctuation\">,</span> sigma<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>sigma默认值是2</p>\n<h5 id=\"零交叉检测算子\"><a href=\"#零交叉检测算子\" class=\"headerlink\" title=\"零交叉检测算子\"></a>零交叉检测算子</h5><ul>\n<li>基于LoG，卷积使用特殊的滤波函数H来完成</li>\n<li>MATLAB语法</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token punctuation\">[</span>g<span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">edge</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token string\">'zerocross'</span><span class=\"token punctuation\">,</span> T <span class=\"token punctuation\">,</span> H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<h5 id=\"Canny检测算子\"><a href=\"#Canny检测算子\" class=\"headerlink\" title=\"Canny检测算子\"></a>Canny检测算子</h5><ul>\n<li>edge函数中最强的边缘检测算子</li>\n<li>MATLAB语法</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token punctuation\">[</span>g<span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">edge</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token string\">'canny'</span><span class=\"token punctuation\">,</span> T <span class=\"token punctuation\">,</span> sigma<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<h4 id=\"MATLAB实现\"><a href=\"#MATLAB实现\" class=\"headerlink\" title=\"MATLAB实现\"></a>MATLAB实现</h4><ul>\n<li>几种边缘检测算法的比较(Sobel,LoG,Canny)</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">f <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">'timg1.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'currect image'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nf <span class=\"token operator\">=</span> <span class=\"token function\">rgb2gray</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\" spellcheck=\"true\">%Default Output</span>\n<span class=\"token punctuation\">[</span>gSobel_default<span class=\"token punctuation\">,</span>ts<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">edge</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token string\">'sobel'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">[</span>gLoG_default<span class=\"token punctuation\">,</span> tlog<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">edge</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token string\">'log'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">[</span>gCanny_default<span class=\"token punctuation\">,</span> tc<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">edge</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span><span class=\"token string\">'canny'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%Best Output</span>\n\ngSobel_best <span class=\"token operator\">=</span> <span class=\"token function\">edge</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span><span class=\"token string\">'sobel'</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.165</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngLoG_best <span class=\"token operator\">=</span> <span class=\"token function\">edge</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span><span class=\"token string\">'log'</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.008</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngCanny_best <span class=\"token operator\">=</span> <span class=\"token function\">edge</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span><span class=\"token string\">'canny'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\nfigure<span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Gary images'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfigure<span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>gSobel_default<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gSobel default'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfigure<span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>gSobel_best<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gSobel best'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfigure<span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>gLoG_default<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gLoG default'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfigure<span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>gLoG_best<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gLoG best'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfigure<span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>gCanny_default<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gCanny default'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfigure<span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>gCanny_best<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gCanny best'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>其中最佳输出的阀值是根据得到的ts,tlog,tc的值来确定的<br>结果:<br><img src=\"https://i.loli.net/2019/07/24/5d37d6b4bec1777947.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d37d6b5886d994031.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d37d6b3ad9b270352.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d37d6b573bae72055.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d37d6b61724d14715.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d37d6b51df2874618.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d37d6b65663011930.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d37d6b3e566366232.jpg\" alt><br>综合结果来看，Canny边缘检测算子可以得到最好的结果</p>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"图像分割\"><a href=\"#图像分割\" class=\"headerlink\" title=\"图像分割\"></a>图像分割</h1><hr>\n<blockquote>\n<p>整体等于部分之和<br>                —–欧几里德</p>\n</blockquote>\n<hr>\n<p>图像分割把图像细分为它的组成要素或物体，细分的水平取决于要解决的问题。<br>单色分割的分割算法通常是基于图像亮度值的两个基本特征:不连续性和相似性。第一类，方法是基于亮度的突变来分割一幅图像，比如边缘;第二类，主要方法是根据事先定义好的准则把图像分割成相似的区域</p>\n<h2 id=\"点、线和基本边缘检测\"><a href=\"#点、线和基本边缘检测\" class=\"headerlink\" title=\"点、线和基本边缘检测\"></a>点、线和基本边缘检测</h2><h3 id=\"背景知识\"><a href=\"#背景知识\" class=\"headerlink\" title=\"背景知识\"></a>背景知识</h3><ol>\n<li>边缘像素是图像中灰度突变的像素，边缘是连接的边缘像素的集合</li>\n<li>一条线可以视为一条边缘线段，该线段两侧的背景灰度要么远亮于该线像素的灰度，要么远暗于该线像素的灰度。孤立点可视为一条线，只是长度和宽度都是一个像素</li>\n<li>局部变化检测可以用微分(一阶微分和二阶微分)    <ul>\n<li>对于一阶导数的任何近似，约定:<ul>\n<li>在恒定灰度区域必须为0</li>\n<li>在灰度台阶和或斜坡开始处必须不为0</li>\n<li>在沿灰度斜坡点处也必须不为0</li>\n</ul>\n</li>\n<li>类似的对于二阶导数的近似<ul>\n<li>在恒定灰度区域必须为0</li>\n<li>在灰度台阶或斜坡开始除和结束处必须不为0</li>\n<li>沿灰度斜坡必须为0</li>\n</ul>\n</li>\n<li>一维函数展开为关于x的泰勒级数,结果差分<br>$$ \\frac{\\partial f}{\\partial x}=f’(x)=f(x+1)-f(x)$$<br>二阶导数<br>$$ \\frac{\\partial ^2 f}{\\partial ^2 x}=f’’(x)=f(x+1)+f(x-1)-2f(x)$$<ul>\n<li>可以得出结论:<ul>\n<li>一阶导数通常在图像中产生较粗的边缘</li>\n<li>二阶导数对精细细节，如细线、孤立点和噪声有较强的响应</li>\n<li>二阶导数在灰度斜坡和灰度台阶过渡处会产生双边缘响应</li>\n<li>二阶导数的符号可用于确定边缘的过程是从亮到暗还是从暗到亮</li>\n</ul>\n</li>\n<li>计算图像中每个像素位置的一阶导数和二阶导数的可选择方法是空间滤波器。模板在该区域中心点处的响应为<br>$$R = w_1z_1 + w_2z_2 + … + w_9z_9 = \\sum_{k=1}^{9}w_kz_k$$</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th align=\"center\">$w_1$</th>\n<th align=\"center\">$w_2$</th>\n<th align=\"center\">$w_3$</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">$w_4$</td>\n<td align=\"center\">$w_5$</td>\n<td align=\"center\">$w_6$</td>\n</tr>\n<tr>\n<td align=\"center\">$w_7$</td>\n<td align=\"center\">$w_8$</td>\n<td align=\"center\">$w_9$</td>\n</tr>\n</tbody></table>\n<p>这是一个普通的3×3空间滤波器掩模</p>\n<h3 id=\"孤立点检测\"><a href=\"#孤立点检测\" class=\"headerlink\" title=\"孤立点检测\"></a>孤立点检测</h3><ul>\n<li>点的检测应以二阶导数为基础，这意味着使用laplace<br>$$\\triangledown ^2f(x,y) = \\frac{\\partial ^2 f}{\\partial x^2} + \\frac{\\partial ^2 f}{\\partial y^2}$$<br>偏微分之后可求得laplace为<br>$$\\triangledown ^2f(x,y) = f(x+1,y)+f(x-1,y)+f(x,y+1)+f(x,y-1)-4f(x,y)$$<br>点检测laplace模板</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">1</th>\n<th align=\"center\">1</th>\n<th align=\"center\">1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">1</td>\n<td align=\"center\">-8</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n</tr>\n</tbody></table>\n<p>如果在某点处的该模板的响应的绝对值超过了一个指定的阈值，那么就说在模板中心位置(x,y)处的该点已经被检测到。在输出图像中，这样的点被标注为1,所有其他点被标注为0<br>$$g(x,y)=\\begin{cases}<br>1,\\quad |R(x,y)| \\geqq T\\<br>0, \\quad 其他<br>\\end{cases}<br>$$</p>\n<ul>\n<li>MATLAB实现</li>\n</ul>\n<pre><code class=\"matlab\">f = imread(&#39;moon.jpg&#39;);\n\nf = rgb2gray(f);\n\nw = [-1 -1 -1; -1 8 -1; -1 -1 -1];\n\ng = abs(imfilter(f, w));\n\nT = max(g(:));\n\ng = g &gt;= T;\n\nfigure(1);\n\nsubplot(1,2,1)\n\nimshow(f)\n\nsubplot(1,2,2)\n\nimshow(g)</code></pre>\n<p>结果：<br><img src=\"https://i.loli.net/2019/07/24/5d37b3a82234833730.jpg\" alt></p>\n<h3 id=\"线检测\"><a href=\"#线检测\" class=\"headerlink\" title=\"线检测\"></a>线检测</h3><p>可以预期，二阶导数将导致更强的响应，并产生比一阶导数更细的线</p>\n<p>线检测模板</p>\n<ul>\n<li>水平</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">-1</th>\n<th align=\"center\">-1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">2</td>\n<td align=\"center\">2</td>\n<td align=\"center\">2</td>\n</tr>\n<tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">-1</td>\n<td align=\"center\">-1</td>\n</tr>\n</tbody></table>\n<ul>\n<li>+45度</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">2 -</th>\n<th align=\"center\">-1</th>\n<th align=\"center\">-1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">2</td>\n<td align=\"center\">-1</td>\n</tr>\n<tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">-1</td>\n<td align=\"center\">2</td>\n</tr>\n</tbody></table>\n<ul>\n<li>垂直</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">2</th>\n<th align=\"center\">-1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">2</td>\n<td align=\"center\">-1</td>\n</tr>\n<tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">2</td>\n<td align=\"center\">-1</td>\n</tr>\n</tbody></table>\n<ul>\n<li>-45度</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">-1</th>\n<th align=\"center\">2</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">2</td>\n<td align=\"center\">-1</td>\n</tr>\n<tr>\n<td align=\"center\">2</td>\n<td align=\"center\">-1</td>\n<td align=\"center\">-1</td>\n</tr>\n</tbody></table>\n<p>对于恒定的背景，当线通过模板的中间一行时可能产生更大的响应。<br>每个模板的系数之和为0,这表示在恒定亮度区域内，模板的响应为0.</p>\n<ul>\n<li>MATLAB实现检测指定方向上的线</li>\n</ul>\n<pre><code class=\"matlab\">clc\n\nclear\n\nf = imread(&#39;11111.jpg&#39;);\n\nf = rgb2gray(f);\n\nfigure(1);\n\nsubplot(2,3,1)\n\nimshow(f);\n\nw = [-1, 2, -1; -1 2 -1; -1 2 -1];\n\n% g = imfilter(tofloat(f),w);\n\ng = imfilter(f,w);\n\nsubplot(2,3,2)\n\nimshow(g, [ ]);\n\ngtop = g(1:120, 1:120);\n\n% gtop = pixeldup(gtop, 4);\n\nsubplot(2,3,3)\n\nimshow(gtop, [ ]);\n\ngbot = g(end - 119:end, end - 119:end);\n\n% gbot = pixeldup(gbot, 4);\n\nsubplot(2,3,4)\n\nimshow(gbot, [ ]);\n\n\ng = abs(g);\n\nsubplot(2,3,5)\n\nimshow(g, [])\n\n\nT = max(g(:));\n\ng = g &gt;= T;\n\nsubplot(2,3,6);\n\nimshow(g)\n</code></pre>\n<p>结果:<br><img src=\"https://i.loli.net/2019/07/24/5d37b3a815b7125153.jpg\" alt><br>可能会用到的M函数pixeldup</p>\n<pre><code class=\"matlab\">function B=pixeldup(A,m,n)%pixeldup用来重复像素的，在水平方向复制m倍，在垂直方向复制n倍，m，n必须为整数，n没有赋值默认为m%检查输入参数个数\nif nargin&lt;2\n    error(&#39;At least two inputs are required.&#39;);\n    end\nif nargin==2\n    n=m;\n    end\nu=1:size(A,1);%产生一个向量，其向量中元素的个数为A的行数%复制向量中每个元素m次m=round(m);%防止m为非整数u=u(ones(1,m),:);\nu=u(:);%在垂直方向重复操作\nv=1:size(A,2);\nn=round(n);\nv=v(ones(1,n),:);\nv=v(:);\nB=A(u,v);</code></pre>\n<p><strong>慎用tofloat函数</strong></p>\n<h3 id=\"基本边缘检测\"><a href=\"#基本边缘检测\" class=\"headerlink\" title=\"基本边缘检测\"></a>基本边缘检测</h3><h4 id=\"边缘模型\"><a href=\"#边缘模型\" class=\"headerlink\" title=\"边缘模型\"></a>边缘模型</h4><ul>\n<li>台阶模型<br>在一个像素的距离上发生两次灰度级间理想的过渡</li>\n<li>斜坡模型<br>数字图像存在被模糊或有噪声的边缘，这时的边缘被建模成一个更接近灰度斜坡的剖面，斜坡的斜度与边缘的模糊程度成反比</li>\n<li>屋顶模型<br>通过一个区域的线的模型，屋顶边缘的基底(宽度)由该线的宽度和尖锐度决定<br><img src=\"https://i.loli.net/2019/07/24/5d382004cd3e437707.jpg\" alt></li>\n</ul>\n<p>结合前面提到的一阶导数和二阶导数的性质，可以得出结论:</p>\n<ol>\n<li>一阶导数的幅值可用于检测图像中的某个点处是否存在一个边缘</li>\n<li>二阶导数的符号可用于确定一个边缘像素位于该边缘的暗的一侧还是亮的一侧</li>\n<li>对图像的每个边缘，二阶导数生成两个值</li>\n<li>二阶导数的零交叉点可用于定位粗边缘的中心</li>\n</ol>\n<ul>\n<li>执行边缘检测的三个步骤:    <ol>\n<li>为降噪对图像进行平滑处理</li>\n<li>边缘点的检测</li>\n<li>边缘定位</li>\n</ol>\n</li>\n</ul>\n<h4 id=\"梯度\"><a href=\"#梯度\" class=\"headerlink\" title=\"梯度\"></a>梯度</h4><h5 id=\"梯度概念\"><a href=\"#梯度概念\" class=\"headerlink\" title=\"梯度概念\"></a>梯度概念</h5><p>梯度是一个可以确定图像f的(x,y)位置处的边缘方向和强度的工具，用 $\\triangledown f$来表示，用 <strong>向量</strong>来定义</p>\n<p>$$\\triangledown f = \\begin{bmatrix} g_x \\\\ g_y \\\\ \\end{bmatrix} = \\begin{bmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial x} \\end{bmatrix}$$</p>\n<h5 id=\"梯度性质\"><a href=\"#梯度性质\" class=\"headerlink\" title=\"梯度性质\"></a>梯度性质</h5><ol>\n<li><p>梯度向量大小。<br>$\\triangledown f$的大小为M(x,y)<br>$$\\triangledown f = mag(\\triangledown f)=[g_x^2+g_y^2]^{<br>1/2}= [(\\partial f/\\partial x)^2+(\\partial f/\\partial y)^2]^{1/2}$$<br>这是梯度向量方向变化率的值。其中$g_x$,$g_y$和M(x,y)都是和原图像大小相同的图像。称M(x,y)为梯度图像。</p>\n</li>\n<li><p>梯度向量的方向<br>$$\\alpha (x,y) = tan^{-1}(\\frac{g_x}{g_y})$$<br>同理，　$\\alpha(x,y)$也是由$g_x$和$g_y$阵列创建的尺寸相同的图像。<br>任意点(x,y)处的一个边缘的方向与该点处梯度向量的方向$\\alpha(x,y)$正交。<br>梯度向量有时也称为边缘法线</p>\n</li>\n<li><p>梯度指出f在(x,y)处的最大变化率的方向</p>\n</li>\n</ol>\n<h5 id=\"梯度算子\"><a href=\"#梯度算子\" class=\"headerlink\" title=\"梯度算子\"></a>梯度算子</h5><h6 id=\"一维模板\"><a href=\"#一维模板\" class=\"headerlink\" title=\"一维模板\"></a>一维模板</h6><p>$$g_x = \\frac{\\partial f(x,y)}{\\partial x} = f(x+1,y) - f(x,y)$$<br>和<br>$$g_y = \\frac{\\partial f(x,y)}{\\partial y} = f(x,y+1)-f(x,y)$$</p>\n<h6 id=\"二维模板\"><a href=\"#二维模板\" class=\"headerlink\" title=\"二维模板\"></a>二维模板</h6><p>罗伯特交叉梯度算子(Roberts),ROberts算子以求对角像素之差为基础:<br>$$g_x = \\frac{\\partial f}{\\partial x} = (z_9 - z_5)$$<br>和<br>$$g_y = \\frac{\\partial f}{\\partial y} = (z_8 - z_6)$$</p>\n<h6 id=\"3×3模板\"><a href=\"#3×3模板\" class=\"headerlink\" title=\"3×3模板\"></a>3×3模板</h6><ol>\n<li><p>Prewitt算子<br>$$g_x = (z_7 + z_8 + z_9)-(z_1 + z_2 + z_3)$$<br>和<br>$$g_y = (z_3 + z_6 + z_9) - (z_1 + z_4 + z_7)$$</p>\n</li>\n<li><p>Sobel算子</p>\n</li>\n</ol>\n<p>$$g_x = (z_7 + 2z_8 + z_9)-(z_1 +2 z_2 + z_3)$$<br>和<br>$$g_y = (z_3 + 2z_6 + z_9) - (z_1 +2 z_4 + z_7)$$</p>\n<p>在中心位置处使用2可以平滑图像</p>\n<p>注意:所有模板中的系数之和为0，这意味着恒定灰度的响应为0.</p>\n<h4 id=\"使用函数edge的边缘检测\"><a href=\"#使用函数edge的边缘检测\" class=\"headerlink\" title=\"使用函数edge的边缘检测\"></a>使用函数edge的边缘检测</h4><ul>\n<li>语法</li>\n</ul>\n<pre><code class=\"matlab\">[g,t] = edge(f, &#39;method&#39;, parameters);</code></pre>\n<p>f是输入图像，method是边缘检测方法，parameters是附加参数</p>\n<h4 id=\"边缘检测算子\"><a href=\"#边缘检测算子\" class=\"headerlink\" title=\"边缘检测算子\"></a>边缘检测算子</h4><p>图像邻域如下图所示:</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">$z_1$</th>\n<th align=\"center\">$z_2$</th>\n<th align=\"center\">$z_3$</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">$z_4$</td>\n<td align=\"center\">$z_5$</td>\n<td align=\"center\">$z_6$</td>\n</tr>\n<tr>\n<td align=\"center\">$z_7$</td>\n<td align=\"center\">$z_8$</td>\n<td align=\"center\">$z_9$</td>\n</tr>\n</tbody></table>\n<h5 id=\"Sobel边缘检测算子\"><a href=\"#Sobel边缘检测算子\" class=\"headerlink\" title=\"Sobel边缘检测算子\"></a>Sobel边缘检测算子</h5><ul>\n<li>Sobel边缘检测算子模板</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">-2</th>\n<th align=\"center\">-1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">0</td>\n<td align=\"center\">0</td>\n<td align=\"center\">0</td>\n</tr>\n<tr>\n<td align=\"center\">1</td>\n<td align=\"center\">2</td>\n<td align=\"center\">1</td>\n</tr>\n</tbody></table>\n<p>$$g_x=(z_7+2z_8+z_9)-(z_1+2z_2+z_3)$$</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">0</th>\n<th align=\"center\">1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-2</td>\n<td align=\"center\">0</td>\n<td align=\"center\">2</td>\n</tr>\n<tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">0</td>\n<td align=\"center\">1</td>\n</tr>\n</tbody></table>\n<p>$$g_y = (z_3+2z_6+z_9)-(z_1+2z_4+z_7)$$<br>每一行和每一列的中心像素用2来加权以提供平滑</p>\n<ul>\n<li>MATLAB语法</li>\n</ul>\n<pre><code class=\"matlab\">[g, t] = edge(f, &#39;sobel&#39;, T, dir);</code></pre>\n<p>f是输入的图像，T是指定的阀值，dir是指定的检测边缘的首选方向:’horizontal’,’vertical’,’both’(默认值)<br>t是可选的，T未指定，则t自动设置</p>\n<h5 id=\"Prewitt边缘检测算子\"><a href=\"#Prewitt边缘检测算子\" class=\"headerlink\" title=\"Prewitt边缘检测算子\"></a>Prewitt边缘检测算子</h5><ul>\n<li>Prewitt边缘检测算子模板</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">-1</th>\n<th align=\"center\">-1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">0</td>\n<td align=\"center\">0</td>\n<td align=\"center\">0</td>\n</tr>\n<tr>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n</tr>\n</tbody></table>\n<p>$$g_x = (z_7 + z_8 + z_9)-(z_1 + z_2 + z_3)$$</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">0</th>\n<th align=\"center\">1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">0</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td align=\"center\">-1</td>\n<td align=\"center\">0</td>\n<td align=\"center\">1</td>\n</tr>\n</tbody></table>\n<p>$$g_y = (z_3 + z_6 + z_9) - (z_1 + z_4 + z_7)$$</p>\n<ul>\n<li>MATLAB语法</li>\n</ul>\n<pre><code class=\"matlab\">[g, t] = edge(f, &#39;prewitt&#39;, T ,dir);</code></pre>\n<p>计算简单，但容易产生噪声</p>\n<h5 id=\"Roberts边缘检测算子\"><a href=\"#Roberts边缘检测算子\" class=\"headerlink\" title=\"Roberts边缘检测算子\"></a>Roberts边缘检测算子</h5><ul>\n<li>Roberts边缘检测算子模板</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">-1</th>\n<th align=\"center\">0</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">0</td>\n<td align=\"center\">1</td>\n</tr>\n</tbody></table>\n<p>$$g_x = z_9 - z_5$$</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">0</th>\n<th align=\"center\">1</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">1</td>\n<td align=\"center\">0</td>\n</tr>\n</tbody></table>\n<p>$$g_y = z_8 - z_6$$</p>\n<ul>\n<li>MATLAB语法</li>\n</ul>\n<pre><code class=\"matlab\">[g, t] = edge(f, &#39;roberts&#39;, T , dir);</code></pre>\n<h5 id=\"LoG检测算子\"><a href=\"#LoG检测算子\" class=\"headerlink\" title=\"LoG检测算子\"></a>LoG检测算子</h5><ul>\n<li>LoG</li>\n</ul>\n<p>考虑高斯函数<br>$$G(x,y) = e^{-\\frac{x^2 + y^2}{2\\sigma ^2}}$$<br>$\\sigma$是标准差。这是平滑函数，如果和图像卷积，会使图像变模糊，模糊程度由$\\sigma$决定<br>这个函数的Laplace算法是:<br>$$\\triangledown^2G(x,y) = \\frac{\\partial ^2 G(x,y)}{\\partial x^2}+\\frac{\\partial ^2 G(x,y)}{\\partial y^2} = [\\frac{x^2 + y^2-2\\sigma ^2}{\\sigma ^4}]^{e^{-\\frac{x^2 + y^2}{2\\sigma ^2}}}$$</p>\n<p>用$\\triangledown ^2G(x,y)$卷积(滤波)这幅图像与先用平滑函数对图像卷积，再对结果进行Laplace变换的结果是一样的<br>用$\\triangledown ^2G(x,y)$卷积图像，可以得到两个效果:平滑图像(因而减少了噪声);计算Laplace，从而产生双边缘图像，然后在双边缘之间定位由发现的零交叉组成的边缘</p>\n<ul>\n<li>MATLAB语法</li>\n</ul>\n<pre><code class=\"matlab\">[g, t] = edge(f, &#39;log&#39;, T , sigma);</code></pre>\n<p>sigma默认值是2</p>\n<h5 id=\"零交叉检测算子\"><a href=\"#零交叉检测算子\" class=\"headerlink\" title=\"零交叉检测算子\"></a>零交叉检测算子</h5><ul>\n<li>基于LoG，卷积使用特殊的滤波函数H来完成</li>\n<li>MATLAB语法</li>\n</ul>\n<pre><code class=\"matlab\">[g, t] = edge(f, &#39;zerocross&#39;, T , H);</code></pre>\n<h5 id=\"Canny检测算子\"><a href=\"#Canny检测算子\" class=\"headerlink\" title=\"Canny检测算子\"></a>Canny检测算子</h5><ul>\n<li>edge函数中最强的边缘检测算子</li>\n<li>MATLAB语法</li>\n</ul>\n<pre><code class=\"matlab\">[g, t] = edge(f, &#39;canny&#39;, T , sigma);</code></pre>\n<h4 id=\"MATLAB实现\"><a href=\"#MATLAB实现\" class=\"headerlink\" title=\"MATLAB实现\"></a>MATLAB实现</h4><ul>\n<li>几种边缘检测算法的比较(Sobel,LoG,Canny)</li>\n</ul>\n<pre><code class=\"matlab\">f = imread(&#39;timg1.jpg&#39;); \nimshow(f),title(&#39;currect image&#39;);\nf = rgb2gray(f);\n%Default Output\n[gSobel_default,ts] = edge(f, &#39;sobel&#39;);\n[gLoG_default, tlog] = edge(f, &#39;log&#39;);\n[gCanny_default, tc] = edge(f,&#39;canny&#39;);\n\n%Best Output\n\ngSobel_best = edge(f,&#39;sobel&#39;,0.165);\ngLoG_best = edge(f,&#39;log&#39;,0.008, 2.25);\ngCanny_best = edge(f,&#39;canny&#39;,[0.05, 0.4], 1.5);\n\n\nfigure,imshow(f),title(&#39;Gary images&#39;);\nfigure,imshow(gSobel_default),title(&#39;gSobel default&#39;);\nfigure,imshow(gSobel_best),title(&#39;gSobel best&#39;);\nfigure,imshow(gLoG_default),title(&#39;gLoG default&#39;);\nfigure,imshow(gLoG_best),title(&#39;gLoG best&#39;);\nfigure,imshow(gCanny_default),title(&#39;gCanny default&#39;);\nfigure,imshow(gCanny_best),title(&#39;gCanny best&#39;);</code></pre>\n<p>其中最佳输出的阀值是根据得到的ts,tlog,tc的值来确定的<br>结果:<br><img src=\"https://i.loli.net/2019/07/24/5d37d6b4bec1777947.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d37d6b5886d994031.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d37d6b3ad9b270352.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d37d6b573bae72055.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d37d6b61724d14715.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d37d6b51df2874618.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d37d6b65663011930.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d37d6b3e566366232.jpg\" alt><br>综合结果来看，Canny边缘检测算子可以得到最好的结果</p>\n"},{"title":"图形绘制","top":false,"cover":false,"img":"https://i.loli.net/2019/08/03/e2qDLXKy9vWnpfa.png","toc":true,"mathjax":false,"date":"2019-07-30T05:52:23.000Z","password":null,"summary":"OpenCV下一些基本图形的绘制","_content":"\n# OpenCV基本图形绘制\n\n\n","source":"_posts/图形绘制.md","raw":"---\ntitle: 图形绘制\ntop: false\ncover: false\nimg: https://i.loli.net/2019/08/03/e2qDLXKy9vWnpfa.png\ntoc: true\nmathjax: false\ndate: 2019-07-30 13:52:23\npassword:\nsummary: OpenCV下一些基本图形的绘制\ntags:\n- OpenCV\ncategories:\n- OpenCV学习笔记\n---\n\n# OpenCV基本图形绘制\n\n\n","slug":"图形绘制","published":1,"updated":"2020-02-24T10:49:41.449Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0tn002774juaj1rmsbo","content":"<h1 id=\"OpenCV基本图形绘制\"><a href=\"#OpenCV基本图形绘制\" class=\"headerlink\" title=\"OpenCV基本图形绘制\"></a>OpenCV基本图形绘制</h1>","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"OpenCV基本图形绘制\"><a href=\"#OpenCV基本图形绘制\" class=\"headerlink\" title=\"OpenCV基本图形绘制\"></a>OpenCV基本图形绘制</h1>"},{"title":"圆形检测","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-07-26T04:08:10.000Z","password":null,"summary":"基于霍夫变换的圆形检测","_content":"\n# 基于霍夫变换的圆形检测\n\n## 霍夫变换的原理\n\n\nHough 变换就是利用图像全局特征将边缘像素连接起来组成区域封闭边界，它将图像空间转换到参数空间，在参数空间对点进行描述，达到检测图像边缘的目的。该方法把所有可能落在边缘上的点进行统计计算，根据对数据的统计结果确定属于边缘的程度。Hough 变换的实质就是对图像进行坐标变换，把平面坐标变换为参数坐标，使变换的结果更易识别和检测。    \n具体原理: [霍夫变换](https://godliuyang.wang/2019/07/26/huo-fu-bian-huan/)\n\n---\n\n### 对霍夫变换圆形检测的原理的理解:\n已知圆的一般方程为:\n$$(x-a)^2 + (y-b)^2 = r^2 $$\n其中(a,b)代表圆心，r是圆的半径    \n依旧是把图像空间转换成参数空间，这里是将X-Y平面转化成a-b-r参数空间，则在图像空间中的一个过(x,y)点的圆，对应参数空间中高度变化的三维锥面。\n![](https://i.loli.net/2019/07/26/5d3ab8c50fc2a28962.jpg)\n同理，过图像空间的任意一点的圆都对应于参数空间的一个三维锥面，因此，过图像空间上同一圆的点，对应的参数空间中的三维锥面，在r平面必然相交于一点(a,b,r)，这样通过这一点就可以得到一个圆的参数。\n![](https://i.loli.net/2019/07/26/5d3ab8c4d635d79647.jpg)\n这里霍夫变换的圆检测就是在这三个参数组成的三维空间内进行的    \n换一种理解思路:在笛卡尔坐标下的圆的方程已给出，在极坐标系下，假设圆心为$(x_0,y_0)$,圆上的点可以表示为:\n$$x = x_0 + rcos\\theta, y = y_0 + rsin\\theta$$\n对于一个圆，假如中心像素点$(x_0,y_0)$，半径r已知，那么旋转360°，圆上的所有点就可以求得。同样，假如圆上的所有点，半径r已知，旋转360°，则会得到一个累加的极值点，那么这个点就是圆心了。\n\n---\n\n理论上霍夫变换可以检测任何形状，但复杂的形状需要的参数就多，霍夫空间的维数就多，因此在程序实现上所需的内存空间以及运行效率上都不利于把标准霍夫变换应用于实际复杂图形的检测中。所以一些改进的霍夫变换就相继提出，它们的基本原理就是尽可能减小霍夫空间的维数。\n\n在OpenCV中，HoughCircles函数实现了圆形检测，它使用的算法也是改进的霍夫变换——2-1霍夫变换（21HT）。也就是把霍夫变换分为两个阶段，从而减小了霍夫空间的维数。第一阶段用于检测圆心，第二阶段从圆心推导出圆半径。    \n检测圆心的原理是圆心是它所在圆周所有法线的交汇处，因此只要找到这个交点，即可确定圆心，该方法所用的霍夫空间与图像空间的性质相同，因此它仅仅是二维空间。检测圆半径的方法是从圆心到圆周上的任意一点的距离（即半径）是相同，只要确定一个阈值，只要相同距离的数量大于该阈值，我们就认为该距离就是该圆心所对应的圆半径，该方法只需要计算半径直方图，不使用霍夫空间。圆和半径知道了，圆自然就能求得。\n\n21HT的具体步骤:\n第一阶段：检测圆心\n\n1.1、对输入图像边缘检测；\n\n1.2、计算图形的梯度，并确定圆周线，其中圆周的梯度就是它的法线；\n\n1.3、在二维霍夫空间内，绘出所有图形的梯度直线，某坐标点上累加和的值越大，说明在该点上直线相交的次数越多，也就是越有可能是圆心；\n\n1.4、在霍夫空间的4邻域内进行非最大值抑制；\n\n1.5、设定一个阈值，霍夫空间内累加和大于该阈值的点就对应于圆心。\n\n第二阶段：检测圆半径\n\n2.1、计算某一个圆心到所有圆周线的距离，这些距离中就有该圆心所对应的圆的半径的值，这些半径值当然是相等的，并且这些圆半径的数量要远远大于其他距离值相等的数量；\n\n2.2、设定两个阈值，定义为最大半径和最小半径，保留距离在这两个半径之间的值，这意味着我们检测的圆不能太大，也不能太小；\n\n2.3、对保留下来的距离进行排序；\n\n2.4、找到距离相同的那些值，并计算相同值的数量；\n\n2.5、设定一个阈值，只有相同值的数量大于该阈值，才认为该值是该圆心对应的圆半径；\n\n2.6、对每一个圆心，完成上面的2.1～2.5步骤，得到所有的圆半径。\n\nHoughCircles函数的原型为：    \n`void HoughCircles (InputArray image,OutputArray circles, int method, double dp, double minDist,double param1=100, double param2=100, int minRadius=0,int maxRadius=0 )`    \nimage为输入图像，要求是灰度图像    \ncircles为输出圆向量，每个向量包括三个浮点型的元素——圆心横坐标，圆心纵坐标和圆半径    \nmethod为使用霍夫变换圆检测的算法，Opencv2.4.9只实现了2-1霍夫变换，它的参数是CV_HOUGH_GRADIENT    \ndp为第一阶段所使用的霍夫空间的分辨率，dp=1时表示霍夫空间与输入图像空间的大小一致，dp=2时霍夫空间是输入图像空间的一半，以此类推    \nminDist为圆心之间的最小距离，如果检测到的两个圆心之间距离小于该值，则认为它们是同一个圆心    \nparam1为边缘检测时使用Canny算子的高阈值    \nparam2为步骤1.5和步骤2.5中所共有的阈值    \nminRadius和maxRadius为所检测到的圆半径的最小值和最大值\n\n### 霍夫变换椭圆检测的实现\n\n运行环境: vs2017 + Opencv3.4\n由于HoughCircles函数是调用Canny函数进行边缘检测，OpenCV的Canny函数不包括平滑滤波，所以先对原图进行滤波处理，在这里使用的是高斯模糊\n\n```cpp\n#include \"opencv2/core/core.hpp\"\n#include \"opencv2/highgui/highgui.hpp\"\n#include \"opencv2/imgproc/imgproc.hpp\"\n#include <iostream>\nusing namespace cv;\nusing namespace std;\n \nint main( int argc, char** argv )\n{\n \tMat src, gray;\n\tsrc=imread(\"coins.jpg\");\n\tif( !src.data )  \n\t\treturn -1;  \n\t\n\tcvtColor( src, gray, CV_BGR2GRAY );\n    //高斯模糊平滑\n\tGaussianBlur( gray, gray, Size(9, 9), 2, 2 );\n \n    vector<Vec3f> circles;\n    //霍夫变换\n    HoughCircles( gray, circles, CV_HOUGH_GRADIENT, 1, gray.rows/20, 100, 60, 0, 0 );\n \n    //在原图中画出圆心和圆\n    for( size_t i = 0; i < circles.size(); i++ )\n    {\n        //提取出圆心坐标\n        Point center(cvRound(circles[i][0]), cvRound(circles[i][1]));\n        //提取出圆半径\n        int radius = cvRound(circles[i][2]);\n        //圆心\n        circle( src, center, 3, Scalar(0,255,0), -1, 8, 0 );\n        //圆\n        circle( src, center, radius, Scalar(0,0,255), 3, 8, 0 );\n   }\n \n    imshow( \"霍夫变换检测圆图\", src );\n \n    waitKey(0);\n    return 0;\n}\n```\n\n结果:\n![](https://i.loli.net/2019/07/26/5d3abf54a4c3b88169.jpg)\n\n\n","source":"_posts/圆形检测.md","raw":"---\ntitle: 圆形检测\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-07-26 12:08:10\npassword:\nsummary: 基于霍夫变换的圆形检测\ntags:\n- 图像处理\n- c++\n- OpenCV\ncategories:\n- Digital Image Processing\n---\n\n# 基于霍夫变换的圆形检测\n\n## 霍夫变换的原理\n\n\nHough 变换就是利用图像全局特征将边缘像素连接起来组成区域封闭边界，它将图像空间转换到参数空间，在参数空间对点进行描述，达到检测图像边缘的目的。该方法把所有可能落在边缘上的点进行统计计算，根据对数据的统计结果确定属于边缘的程度。Hough 变换的实质就是对图像进行坐标变换，把平面坐标变换为参数坐标，使变换的结果更易识别和检测。    \n具体原理: [霍夫变换](https://godliuyang.wang/2019/07/26/huo-fu-bian-huan/)\n\n---\n\n### 对霍夫变换圆形检测的原理的理解:\n已知圆的一般方程为:\n$$(x-a)^2 + (y-b)^2 = r^2 $$\n其中(a,b)代表圆心，r是圆的半径    \n依旧是把图像空间转换成参数空间，这里是将X-Y平面转化成a-b-r参数空间，则在图像空间中的一个过(x,y)点的圆，对应参数空间中高度变化的三维锥面。\n![](https://i.loli.net/2019/07/26/5d3ab8c50fc2a28962.jpg)\n同理，过图像空间的任意一点的圆都对应于参数空间的一个三维锥面，因此，过图像空间上同一圆的点，对应的参数空间中的三维锥面，在r平面必然相交于一点(a,b,r)，这样通过这一点就可以得到一个圆的参数。\n![](https://i.loli.net/2019/07/26/5d3ab8c4d635d79647.jpg)\n这里霍夫变换的圆检测就是在这三个参数组成的三维空间内进行的    \n换一种理解思路:在笛卡尔坐标下的圆的方程已给出，在极坐标系下，假设圆心为$(x_0,y_0)$,圆上的点可以表示为:\n$$x = x_0 + rcos\\theta, y = y_0 + rsin\\theta$$\n对于一个圆，假如中心像素点$(x_0,y_0)$，半径r已知，那么旋转360°，圆上的所有点就可以求得。同样，假如圆上的所有点，半径r已知，旋转360°，则会得到一个累加的极值点，那么这个点就是圆心了。\n\n---\n\n理论上霍夫变换可以检测任何形状，但复杂的形状需要的参数就多，霍夫空间的维数就多，因此在程序实现上所需的内存空间以及运行效率上都不利于把标准霍夫变换应用于实际复杂图形的检测中。所以一些改进的霍夫变换就相继提出，它们的基本原理就是尽可能减小霍夫空间的维数。\n\n在OpenCV中，HoughCircles函数实现了圆形检测，它使用的算法也是改进的霍夫变换——2-1霍夫变换（21HT）。也就是把霍夫变换分为两个阶段，从而减小了霍夫空间的维数。第一阶段用于检测圆心，第二阶段从圆心推导出圆半径。    \n检测圆心的原理是圆心是它所在圆周所有法线的交汇处，因此只要找到这个交点，即可确定圆心，该方法所用的霍夫空间与图像空间的性质相同，因此它仅仅是二维空间。检测圆半径的方法是从圆心到圆周上的任意一点的距离（即半径）是相同，只要确定一个阈值，只要相同距离的数量大于该阈值，我们就认为该距离就是该圆心所对应的圆半径，该方法只需要计算半径直方图，不使用霍夫空间。圆和半径知道了，圆自然就能求得。\n\n21HT的具体步骤:\n第一阶段：检测圆心\n\n1.1、对输入图像边缘检测；\n\n1.2、计算图形的梯度，并确定圆周线，其中圆周的梯度就是它的法线；\n\n1.3、在二维霍夫空间内，绘出所有图形的梯度直线，某坐标点上累加和的值越大，说明在该点上直线相交的次数越多，也就是越有可能是圆心；\n\n1.4、在霍夫空间的4邻域内进行非最大值抑制；\n\n1.5、设定一个阈值，霍夫空间内累加和大于该阈值的点就对应于圆心。\n\n第二阶段：检测圆半径\n\n2.1、计算某一个圆心到所有圆周线的距离，这些距离中就有该圆心所对应的圆的半径的值，这些半径值当然是相等的，并且这些圆半径的数量要远远大于其他距离值相等的数量；\n\n2.2、设定两个阈值，定义为最大半径和最小半径，保留距离在这两个半径之间的值，这意味着我们检测的圆不能太大，也不能太小；\n\n2.3、对保留下来的距离进行排序；\n\n2.4、找到距离相同的那些值，并计算相同值的数量；\n\n2.5、设定一个阈值，只有相同值的数量大于该阈值，才认为该值是该圆心对应的圆半径；\n\n2.6、对每一个圆心，完成上面的2.1～2.5步骤，得到所有的圆半径。\n\nHoughCircles函数的原型为：    \n`void HoughCircles (InputArray image,OutputArray circles, int method, double dp, double minDist,double param1=100, double param2=100, int minRadius=0,int maxRadius=0 )`    \nimage为输入图像，要求是灰度图像    \ncircles为输出圆向量，每个向量包括三个浮点型的元素——圆心横坐标，圆心纵坐标和圆半径    \nmethod为使用霍夫变换圆检测的算法，Opencv2.4.9只实现了2-1霍夫变换，它的参数是CV_HOUGH_GRADIENT    \ndp为第一阶段所使用的霍夫空间的分辨率，dp=1时表示霍夫空间与输入图像空间的大小一致，dp=2时霍夫空间是输入图像空间的一半，以此类推    \nminDist为圆心之间的最小距离，如果检测到的两个圆心之间距离小于该值，则认为它们是同一个圆心    \nparam1为边缘检测时使用Canny算子的高阈值    \nparam2为步骤1.5和步骤2.5中所共有的阈值    \nminRadius和maxRadius为所检测到的圆半径的最小值和最大值\n\n### 霍夫变换椭圆检测的实现\n\n运行环境: vs2017 + Opencv3.4\n由于HoughCircles函数是调用Canny函数进行边缘检测，OpenCV的Canny函数不包括平滑滤波，所以先对原图进行滤波处理，在这里使用的是高斯模糊\n\n```cpp\n#include \"opencv2/core/core.hpp\"\n#include \"opencv2/highgui/highgui.hpp\"\n#include \"opencv2/imgproc/imgproc.hpp\"\n#include <iostream>\nusing namespace cv;\nusing namespace std;\n \nint main( int argc, char** argv )\n{\n \tMat src, gray;\n\tsrc=imread(\"coins.jpg\");\n\tif( !src.data )  \n\t\treturn -1;  \n\t\n\tcvtColor( src, gray, CV_BGR2GRAY );\n    //高斯模糊平滑\n\tGaussianBlur( gray, gray, Size(9, 9), 2, 2 );\n \n    vector<Vec3f> circles;\n    //霍夫变换\n    HoughCircles( gray, circles, CV_HOUGH_GRADIENT, 1, gray.rows/20, 100, 60, 0, 0 );\n \n    //在原图中画出圆心和圆\n    for( size_t i = 0; i < circles.size(); i++ )\n    {\n        //提取出圆心坐标\n        Point center(cvRound(circles[i][0]), cvRound(circles[i][1]));\n        //提取出圆半径\n        int radius = cvRound(circles[i][2]);\n        //圆心\n        circle( src, center, 3, Scalar(0,255,0), -1, 8, 0 );\n        //圆\n        circle( src, center, radius, Scalar(0,0,255), 3, 8, 0 );\n   }\n \n    imshow( \"霍夫变换检测圆图\", src );\n \n    waitKey(0);\n    return 0;\n}\n```\n\n结果:\n![](https://i.loli.net/2019/07/26/5d3abf54a4c3b88169.jpg)\n\n\n","slug":"圆形检测","published":1,"updated":"2020-02-24T10:49:41.450Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0to002b74juh1rhjj1t","content":"<h1 id=\"基于霍夫变换的圆形检测\"><a href=\"#基于霍夫变换的圆形检测\" class=\"headerlink\" title=\"基于霍夫变换的圆形检测\"></a>基于霍夫变换的圆形检测</h1><h2 id=\"霍夫变换的原理\"><a href=\"#霍夫变换的原理\" class=\"headerlink\" title=\"霍夫变换的原理\"></a>霍夫变换的原理</h2><p>Hough 变换就是利用图像全局特征将边缘像素连接起来组成区域封闭边界，它将图像空间转换到参数空间，在参数空间对点进行描述，达到检测图像边缘的目的。该方法把所有可能落在边缘上的点进行统计计算，根据对数据的统计结果确定属于边缘的程度。Hough 变换的实质就是对图像进行坐标变换，把平面坐标变换为参数坐标，使变换的结果更易识别和检测。<br>具体原理: <a href=\"https://godliuyang.wang/2019/07/26/huo-fu-bian-huan/\" target=\"_blank\" rel=\"noopener\">霍夫变换</a></p>\n<hr>\n<h3 id=\"对霍夫变换圆形检测的原理的理解\"><a href=\"#对霍夫变换圆形检测的原理的理解\" class=\"headerlink\" title=\"对霍夫变换圆形检测的原理的理解:\"></a>对霍夫变换圆形检测的原理的理解:</h3><p>已知圆的一般方程为:<br>$$(x-a)^2 + (y-b)^2 = r^2 $$<br>其中(a,b)代表圆心，r是圆的半径<br>依旧是把图像空间转换成参数空间，这里是将X-Y平面转化成a-b-r参数空间，则在图像空间中的一个过(x,y)点的圆，对应参数空间中高度变化的三维锥面。<br><img src=\"https://i.loli.net/2019/07/26/5d3ab8c50fc2a28962.jpg\" alt><br>同理，过图像空间的任意一点的圆都对应于参数空间的一个三维锥面，因此，过图像空间上同一圆的点，对应的参数空间中的三维锥面，在r平面必然相交于一点(a,b,r)，这样通过这一点就可以得到一个圆的参数。<br><img src=\"https://i.loli.net/2019/07/26/5d3ab8c4d635d79647.jpg\" alt><br>这里霍夫变换的圆检测就是在这三个参数组成的三维空间内进行的<br>换一种理解思路:在笛卡尔坐标下的圆的方程已给出，在极坐标系下，假设圆心为$(x_0,y_0)$,圆上的点可以表示为:<br>$$x = x_0 + rcos\\theta, y = y_0 + rsin\\theta$$<br>对于一个圆，假如中心像素点$(x_0,y_0)$，半径r已知，那么旋转360°，圆上的所有点就可以求得。同样，假如圆上的所有点，半径r已知，旋转360°，则会得到一个累加的极值点，那么这个点就是圆心了。</p>\n<hr>\n<p>理论上霍夫变换可以检测任何形状，但复杂的形状需要的参数就多，霍夫空间的维数就多，因此在程序实现上所需的内存空间以及运行效率上都不利于把标准霍夫变换应用于实际复杂图形的检测中。所以一些改进的霍夫变换就相继提出，它们的基本原理就是尽可能减小霍夫空间的维数。</p>\n<p>在OpenCV中，HoughCircles函数实现了圆形检测，它使用的算法也是改进的霍夫变换——2-1霍夫变换（21HT）。也就是把霍夫变换分为两个阶段，从而减小了霍夫空间的维数。第一阶段用于检测圆心，第二阶段从圆心推导出圆半径。<br>检测圆心的原理是圆心是它所在圆周所有法线的交汇处，因此只要找到这个交点，即可确定圆心，该方法所用的霍夫空间与图像空间的性质相同，因此它仅仅是二维空间。检测圆半径的方法是从圆心到圆周上的任意一点的距离（即半径）是相同，只要确定一个阈值，只要相同距离的数量大于该阈值，我们就认为该距离就是该圆心所对应的圆半径，该方法只需要计算半径直方图，不使用霍夫空间。圆和半径知道了，圆自然就能求得。</p>\n<p>21HT的具体步骤:<br>第一阶段：检测圆心</p>\n<p>1.1、对输入图像边缘检测；</p>\n<p>1.2、计算图形的梯度，并确定圆周线，其中圆周的梯度就是它的法线；</p>\n<p>1.3、在二维霍夫空间内，绘出所有图形的梯度直线，某坐标点上累加和的值越大，说明在该点上直线相交的次数越多，也就是越有可能是圆心；</p>\n<p>1.4、在霍夫空间的4邻域内进行非最大值抑制；</p>\n<p>1.5、设定一个阈值，霍夫空间内累加和大于该阈值的点就对应于圆心。</p>\n<p>第二阶段：检测圆半径</p>\n<p>2.1、计算某一个圆心到所有圆周线的距离，这些距离中就有该圆心所对应的圆的半径的值，这些半径值当然是相等的，并且这些圆半径的数量要远远大于其他距离值相等的数量；</p>\n<p>2.2、设定两个阈值，定义为最大半径和最小半径，保留距离在这两个半径之间的值，这意味着我们检测的圆不能太大，也不能太小；</p>\n<p>2.3、对保留下来的距离进行排序；</p>\n<p>2.4、找到距离相同的那些值，并计算相同值的数量；</p>\n<p>2.5、设定一个阈值，只有相同值的数量大于该阈值，才认为该值是该圆心对应的圆半径；</p>\n<p>2.6、对每一个圆心，完成上面的2.1～2.5步骤，得到所有的圆半径。</p>\n<p>HoughCircles函数的原型为：<br><code>void HoughCircles (InputArray image,OutputArray circles, int method, double dp, double minDist,double param1=100, double param2=100, int minRadius=0,int maxRadius=0 )</code><br>image为输入图像，要求是灰度图像<br>circles为输出圆向量，每个向量包括三个浮点型的元素——圆心横坐标，圆心纵坐标和圆半径<br>method为使用霍夫变换圆检测的算法，Opencv2.4.9只实现了2-1霍夫变换，它的参数是CV_HOUGH_GRADIENT<br>dp为第一阶段所使用的霍夫空间的分辨率，dp=1时表示霍夫空间与输入图像空间的大小一致，dp=2时霍夫空间是输入图像空间的一半，以此类推<br>minDist为圆心之间的最小距离，如果检测到的两个圆心之间距离小于该值，则认为它们是同一个圆心<br>param1为边缘检测时使用Canny算子的高阈值<br>param2为步骤1.5和步骤2.5中所共有的阈值<br>minRadius和maxRadius为所检测到的圆半径的最小值和最大值</p>\n<h3 id=\"霍夫变换椭圆检测的实现\"><a href=\"#霍夫变换椭圆检测的实现\" class=\"headerlink\" title=\"霍夫变换椭圆检测的实现\"></a>霍夫变换椭圆检测的实现</h3><p>运行环境: vs2017 + Opencv3.4<br>由于HoughCircles函数是调用Canny函数进行边缘检测，OpenCV的Canny函数不包括平滑滤波，所以先对原图进行滤波处理，在这里使用的是高斯模糊</p>\n<pre class=\" language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"opencv2/core/core.hpp\"</span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"opencv2/highgui/highgui.hpp\"</span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"opencv2/imgproc/imgproc.hpp\"</span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream></span></span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> cv<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> std<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span> <span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> argv <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n     Mat src<span class=\"token punctuation\">,</span> gray<span class=\"token punctuation\">;</span>\n    src<span class=\"token operator\">=</span><span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"coins.jpg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">!</span>src<span class=\"token punctuation\">.</span>data <span class=\"token punctuation\">)</span>  \n        <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>  \n\n    <span class=\"token function\">cvtColor</span><span class=\"token punctuation\">(</span> src<span class=\"token punctuation\">,</span> gray<span class=\"token punctuation\">,</span> CV_BGR2GRAY <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">//高斯模糊平滑</span>\n    <span class=\"token function\">GaussianBlur</span><span class=\"token punctuation\">(</span> gray<span class=\"token punctuation\">,</span> gray<span class=\"token punctuation\">,</span> <span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    vector<span class=\"token operator\">&lt;</span>Vec3f<span class=\"token operator\">></span> circles<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">//霍夫变换</span>\n    <span class=\"token function\">HoughCircles</span><span class=\"token punctuation\">(</span> gray<span class=\"token punctuation\">,</span> circles<span class=\"token punctuation\">,</span> CV_HOUGH_GRADIENT<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> gray<span class=\"token punctuation\">.</span>rows<span class=\"token operator\">/</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//在原图中画出圆心和圆</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span> size_t i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> circles<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span> <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\" spellcheck=\"true\">//提取出圆心坐标</span>\n        Point <span class=\"token function\">center</span><span class=\"token punctuation\">(</span><span class=\"token function\">cvRound</span><span class=\"token punctuation\">(</span>circles<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">cvRound</span><span class=\"token punctuation\">(</span>circles<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">//提取出圆半径</span>\n        <span class=\"token keyword\">int</span> radius <span class=\"token operator\">=</span> <span class=\"token function\">cvRound</span><span class=\"token punctuation\">(</span>circles<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">//圆心</span>\n        <span class=\"token function\">circle</span><span class=\"token punctuation\">(</span> src<span class=\"token punctuation\">,</span> center<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Scalar</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">//圆</span>\n        <span class=\"token function\">circle</span><span class=\"token punctuation\">(</span> src<span class=\"token punctuation\">,</span> center<span class=\"token punctuation\">,</span> radius<span class=\"token punctuation\">,</span> <span class=\"token function\">Scalar</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span> <span class=\"token string\">\"霍夫变换检测圆图\"</span><span class=\"token punctuation\">,</span> src <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">waitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>结果:<br><img src=\"https://i.loli.net/2019/07/26/5d3abf54a4c3b88169.jpg\" alt></p>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"基于霍夫变换的圆形检测\"><a href=\"#基于霍夫变换的圆形检测\" class=\"headerlink\" title=\"基于霍夫变换的圆形检测\"></a>基于霍夫变换的圆形检测</h1><h2 id=\"霍夫变换的原理\"><a href=\"#霍夫变换的原理\" class=\"headerlink\" title=\"霍夫变换的原理\"></a>霍夫变换的原理</h2><p>Hough 变换就是利用图像全局特征将边缘像素连接起来组成区域封闭边界，它将图像空间转换到参数空间，在参数空间对点进行描述，达到检测图像边缘的目的。该方法把所有可能落在边缘上的点进行统计计算，根据对数据的统计结果确定属于边缘的程度。Hough 变换的实质就是对图像进行坐标变换，把平面坐标变换为参数坐标，使变换的结果更易识别和检测。<br>具体原理: <a href=\"https://godliuyang.wang/2019/07/26/huo-fu-bian-huan/\" target=\"_blank\" rel=\"noopener\">霍夫变换</a></p>\n<hr>\n<h3 id=\"对霍夫变换圆形检测的原理的理解\"><a href=\"#对霍夫变换圆形检测的原理的理解\" class=\"headerlink\" title=\"对霍夫变换圆形检测的原理的理解:\"></a>对霍夫变换圆形检测的原理的理解:</h3><p>已知圆的一般方程为:<br>$$(x-a)^2 + (y-b)^2 = r^2 $$<br>其中(a,b)代表圆心，r是圆的半径<br>依旧是把图像空间转换成参数空间，这里是将X-Y平面转化成a-b-r参数空间，则在图像空间中的一个过(x,y)点的圆，对应参数空间中高度变化的三维锥面。<br><img src=\"https://i.loli.net/2019/07/26/5d3ab8c50fc2a28962.jpg\" alt><br>同理，过图像空间的任意一点的圆都对应于参数空间的一个三维锥面，因此，过图像空间上同一圆的点，对应的参数空间中的三维锥面，在r平面必然相交于一点(a,b,r)，这样通过这一点就可以得到一个圆的参数。<br><img src=\"https://i.loli.net/2019/07/26/5d3ab8c4d635d79647.jpg\" alt><br>这里霍夫变换的圆检测就是在这三个参数组成的三维空间内进行的<br>换一种理解思路:在笛卡尔坐标下的圆的方程已给出，在极坐标系下，假设圆心为$(x_0,y_0)$,圆上的点可以表示为:<br>$$x = x_0 + rcos\\theta, y = y_0 + rsin\\theta$$<br>对于一个圆，假如中心像素点$(x_0,y_0)$，半径r已知，那么旋转360°，圆上的所有点就可以求得。同样，假如圆上的所有点，半径r已知，旋转360°，则会得到一个累加的极值点，那么这个点就是圆心了。</p>\n<hr>\n<p>理论上霍夫变换可以检测任何形状，但复杂的形状需要的参数就多，霍夫空间的维数就多，因此在程序实现上所需的内存空间以及运行效率上都不利于把标准霍夫变换应用于实际复杂图形的检测中。所以一些改进的霍夫变换就相继提出，它们的基本原理就是尽可能减小霍夫空间的维数。</p>\n<p>在OpenCV中，HoughCircles函数实现了圆形检测，它使用的算法也是改进的霍夫变换——2-1霍夫变换（21HT）。也就是把霍夫变换分为两个阶段，从而减小了霍夫空间的维数。第一阶段用于检测圆心，第二阶段从圆心推导出圆半径。<br>检测圆心的原理是圆心是它所在圆周所有法线的交汇处，因此只要找到这个交点，即可确定圆心，该方法所用的霍夫空间与图像空间的性质相同，因此它仅仅是二维空间。检测圆半径的方法是从圆心到圆周上的任意一点的距离（即半径）是相同，只要确定一个阈值，只要相同距离的数量大于该阈值，我们就认为该距离就是该圆心所对应的圆半径，该方法只需要计算半径直方图，不使用霍夫空间。圆和半径知道了，圆自然就能求得。</p>\n<p>21HT的具体步骤:<br>第一阶段：检测圆心</p>\n<p>1.1、对输入图像边缘检测；</p>\n<p>1.2、计算图形的梯度，并确定圆周线，其中圆周的梯度就是它的法线；</p>\n<p>1.3、在二维霍夫空间内，绘出所有图形的梯度直线，某坐标点上累加和的值越大，说明在该点上直线相交的次数越多，也就是越有可能是圆心；</p>\n<p>1.4、在霍夫空间的4邻域内进行非最大值抑制；</p>\n<p>1.5、设定一个阈值，霍夫空间内累加和大于该阈值的点就对应于圆心。</p>\n<p>第二阶段：检测圆半径</p>\n<p>2.1、计算某一个圆心到所有圆周线的距离，这些距离中就有该圆心所对应的圆的半径的值，这些半径值当然是相等的，并且这些圆半径的数量要远远大于其他距离值相等的数量；</p>\n<p>2.2、设定两个阈值，定义为最大半径和最小半径，保留距离在这两个半径之间的值，这意味着我们检测的圆不能太大，也不能太小；</p>\n<p>2.3、对保留下来的距离进行排序；</p>\n<p>2.4、找到距离相同的那些值，并计算相同值的数量；</p>\n<p>2.5、设定一个阈值，只有相同值的数量大于该阈值，才认为该值是该圆心对应的圆半径；</p>\n<p>2.6、对每一个圆心，完成上面的2.1～2.5步骤，得到所有的圆半径。</p>\n<p>HoughCircles函数的原型为：<br><code>void HoughCircles (InputArray image,OutputArray circles, int method, double dp, double minDist,double param1=100, double param2=100, int minRadius=0,int maxRadius=0 )</code><br>image为输入图像，要求是灰度图像<br>circles为输出圆向量，每个向量包括三个浮点型的元素——圆心横坐标，圆心纵坐标和圆半径<br>method为使用霍夫变换圆检测的算法，Opencv2.4.9只实现了2-1霍夫变换，它的参数是CV_HOUGH_GRADIENT<br>dp为第一阶段所使用的霍夫空间的分辨率，dp=1时表示霍夫空间与输入图像空间的大小一致，dp=2时霍夫空间是输入图像空间的一半，以此类推<br>minDist为圆心之间的最小距离，如果检测到的两个圆心之间距离小于该值，则认为它们是同一个圆心<br>param1为边缘检测时使用Canny算子的高阈值<br>param2为步骤1.5和步骤2.5中所共有的阈值<br>minRadius和maxRadius为所检测到的圆半径的最小值和最大值</p>\n<h3 id=\"霍夫变换椭圆检测的实现\"><a href=\"#霍夫变换椭圆检测的实现\" class=\"headerlink\" title=\"霍夫变换椭圆检测的实现\"></a>霍夫变换椭圆检测的实现</h3><p>运行环境: vs2017 + Opencv3.4<br>由于HoughCircles函数是调用Canny函数进行边缘检测，OpenCV的Canny函数不包括平滑滤波，所以先对原图进行滤波处理，在这里使用的是高斯模糊</p>\n<pre><code class=\"cpp\">#include &quot;opencv2/core/core.hpp&quot;\n#include &quot;opencv2/highgui/highgui.hpp&quot;\n#include &quot;opencv2/imgproc/imgproc.hpp&quot;\n#include &lt;iostream&gt;\nusing namespace cv;\nusing namespace std;\n\nint main( int argc, char** argv )\n{\n     Mat src, gray;\n    src=imread(&quot;coins.jpg&quot;);\n    if( !src.data )  \n        return -1;  \n\n    cvtColor( src, gray, CV_BGR2GRAY );\n    //高斯模糊平滑\n    GaussianBlur( gray, gray, Size(9, 9), 2, 2 );\n\n    vector&lt;Vec3f&gt; circles;\n    //霍夫变换\n    HoughCircles( gray, circles, CV_HOUGH_GRADIENT, 1, gray.rows/20, 100, 60, 0, 0 );\n\n    //在原图中画出圆心和圆\n    for( size_t i = 0; i &lt; circles.size(); i++ )\n    {\n        //提取出圆心坐标\n        Point center(cvRound(circles[i][0]), cvRound(circles[i][1]));\n        //提取出圆半径\n        int radius = cvRound(circles[i][2]);\n        //圆心\n        circle( src, center, 3, Scalar(0,255,0), -1, 8, 0 );\n        //圆\n        circle( src, center, radius, Scalar(0,0,255), 3, 8, 0 );\n   }\n\n    imshow( &quot;霍夫变换检测圆图&quot;, src );\n\n    waitKey(0);\n    return 0;\n}</code></pre>\n<p>结果:<br><img src=\"https://i.loli.net/2019/07/26/5d3abf54a4c3b88169.jpg\" alt></p>\n"},{"title":"形态学图像处理","top":false,"cover":false,"img":"https://i.loli.net/2019/07/17/5d2e73bb14bd344648.png","toc":true,"mathjax":true,"date":"2019-07-22T03:28:44.000Z","password":null,"summary":"形态学图像处理、二值图像上的运算、图像的腐蚀与膨胀","_content":"# 形态学图像处理\n从这里开始过渡，从输入输出都是图像，过渡到图像分析方法，输出以某种方法来描述图像的内容。\n## 集合理论基础\n令Z为整数集合，用于产生的数字图像的抽样处理可以看做是把xy平面分割成网格状，其中每个网格的**中心坐标**是来自笛卡尔积$Z^2$中的一对元素。在集合理论中，如果(x,y)是来自$Z^2$的整数,f是分配给每个不同坐标的对(x,y)的亮度值的映射，那么函数f(x,y)被成为数字图像。如果亮度值也为整数，那么这幅图像就变成了二维图像。   \n集合的基本操作:$\\in$,$\\notin$,$\\cup$,$\\cap$,+,-.除了这些基本操作，形态学操作还需要两个算子，他们特别针对元素均为像素坐标的集合\n1. 集合的反射$\\hat{B}$\n$$ \\hat{B} = \\{w|w=-b,b\\in B\\}$$\n2. 点z=($z_1$,$z_2$)集合的平移${(A)}_z$\n$$ (A)_z = \\{c|c=a+z,a\\in A\\}$$\n### 二值图像、集合及逻辑算子\n形态学理论把二值图像看成是前景(1值)像素的集合,集合的元素属于$Z^2$如果A和B都是二值图像，那么$C=A\\cup B$也是二值图像\n$$C(x,y)=\\begin{cases}\n1,\\quad A(x,y)或B(x,y)为1,或者两者均为1\\\\\n0 \\quad 其他\n\\end{cases}\n$$\n### 在MATLAB中使用逻辑表达式在二值图像上进行逻辑运算\n\n| 集合运算  | 二值图像的MATLAb语句 | 名称 |\n| -----     | :--------:           | ---  |\n| $A\\cap B$ | A & B                | 与   |\n| $A\\cup B$ | A $\\rvert$ B         | 或   |\n| $A^c$     | ~B                   | 非   |\n| $A-B$     | A &~ B               | 差   |\n\n## 腐蚀和膨胀\n### 膨胀\n膨胀是使图像中的目标\"生长\"或\"变粗\"的操作。程度由一种被称为**结构元**的形状来控制\nA被B膨胀，表示为$A \\oplus B$,作为集合操作\n$$ A\\oplus B=\\{ z|\\hat{B}_z\\cap A\\not= \\emptyset\\}$$\n约定: $A \\oplus B$ 的第一个操作数是图像，第二个操作数是结构元，结构元通常比图像小的多。\n![](https://i.loli.net/2019/07/22/5d35670a79cd611294.jpg)\n  - 工具箱函数imdilate(A, B)来执行膨胀\n\n```matlab\nf = imread('1111.jpg');\nB = [0 1 0; 1 1 1; 0 1 0];%自定义结构元\nD = imdilate(f, B);\nsubplot(1,2,1),imshow(f);\ntitle('原图')\nsubplot(1,2,2),imshow(D);\ntitle('膨胀后的图')\n```\n\n![](https://i.loli.net/2019/07/22/5d3564132fa1741100.jpg)\n### 腐蚀\n腐蚀\"收缩\"或\"细化\"二值图像中的物体。像膨胀一样，收缩的方法和程度由结构元控制。\nA被B腐蚀表示为$A\\ominus B$,定义为:\n$$ A\\ominus B = \\{z| (B)_z\\subseteq A\\} = \\{z| (B)_z\\cap A^c = \\emptyset\\}$$\n![](https://i.loli.net/2019/07/23/5d36cefa2813d95731.jpg)\n\n工具箱函数imerode(A,B)来执腐蚀\n\n```matlab\nf = imread('tig.jpg');\nB = [0 1 0; 1 1 1; 0 1 0];%自定义结构元\nR = imerode(f, B);\nsubplot(1,2,1),imshow(f);\ntitle('原图')\nsubplot(1,2,2),imshow(R);\ntitle('腐蚀后的图')\n```\n\n![](https://i.loli.net/2019/07/22/5d356b5f7eed962952.jpg)\n### 结构元\nstrel函数，用来构造各种大小和形状的结构元\n\n```matlab\nse = strel(shape, parameters);\n```\n\nshape是希望形状的字符串，parameters是描述形状信息的参数列表\n![](https://i.loli.net/2019/07/22/5d35670a85b4f22579.jpg)\n![](https://i.loli.net/2019/07/22/5d35670a63e2817742.jpg)\n注意生成的se含有两项\n1. se.Neighborhood:[ ×  logical ]\n2. se.Demensionality: 2\n","source":"_posts/形态学图像处理.md","raw":"---\ntitle: 形态学图像处理\ntop: false\ncover: false\nimg: https://i.loli.net/2019/07/17/5d2e73bb14bd344648.png\ntoc: true\nmathjax: true\ndate: 2019-07-22 11:28:44\npassword:\nsummary: 形态学图像处理、二值图像上的运算、图像的腐蚀与膨胀\ntags:\n- 图像处理\n- Matlab\ncategories:\n- Digital Image Processing\n---\n# 形态学图像处理\n从这里开始过渡，从输入输出都是图像，过渡到图像分析方法，输出以某种方法来描述图像的内容。\n## 集合理论基础\n令Z为整数集合，用于产生的数字图像的抽样处理可以看做是把xy平面分割成网格状，其中每个网格的**中心坐标**是来自笛卡尔积$Z^2$中的一对元素。在集合理论中，如果(x,y)是来自$Z^2$的整数,f是分配给每个不同坐标的对(x,y)的亮度值的映射，那么函数f(x,y)被成为数字图像。如果亮度值也为整数，那么这幅图像就变成了二维图像。   \n集合的基本操作:$\\in$,$\\notin$,$\\cup$,$\\cap$,+,-.除了这些基本操作，形态学操作还需要两个算子，他们特别针对元素均为像素坐标的集合\n1. 集合的反射$\\hat{B}$\n$$ \\hat{B} = \\{w|w=-b,b\\in B\\}$$\n2. 点z=($z_1$,$z_2$)集合的平移${(A)}_z$\n$$ (A)_z = \\{c|c=a+z,a\\in A\\}$$\n### 二值图像、集合及逻辑算子\n形态学理论把二值图像看成是前景(1值)像素的集合,集合的元素属于$Z^2$如果A和B都是二值图像，那么$C=A\\cup B$也是二值图像\n$$C(x,y)=\\begin{cases}\n1,\\quad A(x,y)或B(x,y)为1,或者两者均为1\\\\\n0 \\quad 其他\n\\end{cases}\n$$\n### 在MATLAB中使用逻辑表达式在二值图像上进行逻辑运算\n\n| 集合运算  | 二值图像的MATLAb语句 | 名称 |\n| -----     | :--------:           | ---  |\n| $A\\cap B$ | A & B                | 与   |\n| $A\\cup B$ | A $\\rvert$ B         | 或   |\n| $A^c$     | ~B                   | 非   |\n| $A-B$     | A &~ B               | 差   |\n\n## 腐蚀和膨胀\n### 膨胀\n膨胀是使图像中的目标\"生长\"或\"变粗\"的操作。程度由一种被称为**结构元**的形状来控制\nA被B膨胀，表示为$A \\oplus B$,作为集合操作\n$$ A\\oplus B=\\{ z|\\hat{B}_z\\cap A\\not= \\emptyset\\}$$\n约定: $A \\oplus B$ 的第一个操作数是图像，第二个操作数是结构元，结构元通常比图像小的多。\n![](https://i.loli.net/2019/07/22/5d35670a79cd611294.jpg)\n  - 工具箱函数imdilate(A, B)来执行膨胀\n\n```matlab\nf = imread('1111.jpg');\nB = [0 1 0; 1 1 1; 0 1 0];%自定义结构元\nD = imdilate(f, B);\nsubplot(1,2,1),imshow(f);\ntitle('原图')\nsubplot(1,2,2),imshow(D);\ntitle('膨胀后的图')\n```\n\n![](https://i.loli.net/2019/07/22/5d3564132fa1741100.jpg)\n### 腐蚀\n腐蚀\"收缩\"或\"细化\"二值图像中的物体。像膨胀一样，收缩的方法和程度由结构元控制。\nA被B腐蚀表示为$A\\ominus B$,定义为:\n$$ A\\ominus B = \\{z| (B)_z\\subseteq A\\} = \\{z| (B)_z\\cap A^c = \\emptyset\\}$$\n![](https://i.loli.net/2019/07/23/5d36cefa2813d95731.jpg)\n\n工具箱函数imerode(A,B)来执腐蚀\n\n```matlab\nf = imread('tig.jpg');\nB = [0 1 0; 1 1 1; 0 1 0];%自定义结构元\nR = imerode(f, B);\nsubplot(1,2,1),imshow(f);\ntitle('原图')\nsubplot(1,2,2),imshow(R);\ntitle('腐蚀后的图')\n```\n\n![](https://i.loli.net/2019/07/22/5d356b5f7eed962952.jpg)\n### 结构元\nstrel函数，用来构造各种大小和形状的结构元\n\n```matlab\nse = strel(shape, parameters);\n```\n\nshape是希望形状的字符串，parameters是描述形状信息的参数列表\n![](https://i.loli.net/2019/07/22/5d35670a85b4f22579.jpg)\n![](https://i.loli.net/2019/07/22/5d35670a63e2817742.jpg)\n注意生成的se含有两项\n1. se.Neighborhood:[ ×  logical ]\n2. se.Demensionality: 2\n","slug":"形态学图像处理","published":1,"updated":"2020-02-24T10:49:41.450Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0tp002f74jur958wfar","content":"<h1 id=\"形态学图像处理\"><a href=\"#形态学图像处理\" class=\"headerlink\" title=\"形态学图像处理\"></a>形态学图像处理</h1><p>从这里开始过渡，从输入输出都是图像，过渡到图像分析方法，输出以某种方法来描述图像的内容。</p>\n<h2 id=\"集合理论基础\"><a href=\"#集合理论基础\" class=\"headerlink\" title=\"集合理论基础\"></a>集合理论基础</h2><p>令Z为整数集合，用于产生的数字图像的抽样处理可以看做是把xy平面分割成网格状，其中每个网格的<strong>中心坐标</strong>是来自笛卡尔积$Z^2$中的一对元素。在集合理论中，如果(x,y)是来自$Z^2$的整数,f是分配给每个不同坐标的对(x,y)的亮度值的映射，那么函数f(x,y)被成为数字图像。如果亮度值也为整数，那么这幅图像就变成了二维图像。<br>集合的基本操作:$\\in$,$\\notin$,$\\cup$,$\\cap$,+,-.除了这些基本操作，形态学操作还需要两个算子，他们特别针对元素均为像素坐标的集合</p>\n<ol>\n<li>集合的反射$\\hat{B}$<br>$$ \\hat{B} = \\{w|w=-b,b\\in B\\}$$</li>\n<li>点z=($z_1$,$z_2$)集合的平移${(A)}_z$<br>$$ (A)_z = \\{c|c=a+z,a\\in A\\}$$<h3 id=\"二值图像、集合及逻辑算子\"><a href=\"#二值图像、集合及逻辑算子\" class=\"headerlink\" title=\"二值图像、集合及逻辑算子\"></a>二值图像、集合及逻辑算子</h3>形态学理论把二值图像看成是前景(1值)像素的集合,集合的元素属于$Z^2$如果A和B都是二值图像，那么$C=A\\cup B$也是二值图像<br>$$C(x,y)=\\begin{cases}<br>1,\\quad A(x,y)或B(x,y)为1,或者两者均为1\\<br>0 \\quad 其他<br>\\end{cases}<br>$$<h3 id=\"在MATLAB中使用逻辑表达式在二值图像上进行逻辑运算\"><a href=\"#在MATLAB中使用逻辑表达式在二值图像上进行逻辑运算\" class=\"headerlink\" title=\"在MATLAB中使用逻辑表达式在二值图像上进行逻辑运算\"></a>在MATLAB中使用逻辑表达式在二值图像上进行逻辑运算</h3></li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>集合运算</th>\n<th align=\"center\">二值图像的MATLAb语句</th>\n<th>名称</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>$A\\cap B$</td>\n<td align=\"center\">A &amp; B</td>\n<td>与</td>\n</tr>\n<tr>\n<td>$A\\cup B$</td>\n<td align=\"center\">A $\\rvert$ B</td>\n<td>或</td>\n</tr>\n<tr>\n<td>$A^c$</td>\n<td align=\"center\">~B</td>\n<td>非</td>\n</tr>\n<tr>\n<td>$A-B$</td>\n<td align=\"center\">A &amp;~ B</td>\n<td>差</td>\n</tr>\n</tbody></table>\n<h2 id=\"腐蚀和膨胀\"><a href=\"#腐蚀和膨胀\" class=\"headerlink\" title=\"腐蚀和膨胀\"></a>腐蚀和膨胀</h2><h3 id=\"膨胀\"><a href=\"#膨胀\" class=\"headerlink\" title=\"膨胀\"></a>膨胀</h3><p>膨胀是使图像中的目标”生长”或”变粗”的操作。程度由一种被称为<strong>结构元</strong>的形状来控制<br>A被B膨胀，表示为$A \\oplus B$,作为集合操作<br>$$ A\\oplus B=\\{ z|\\hat{B}_z\\cap A\\not= \\emptyset\\}$$<br>约定: $A \\oplus B$ 的第一个操作数是图像，第二个操作数是结构元，结构元通常比图像小的多。<br><img src=\"https://i.loli.net/2019/07/22/5d35670a79cd611294.jpg\" alt></p>\n<ul>\n<li>工具箱函数imdilate(A, B)来执行膨胀</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">f <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1111.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nB <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span> <span class=\"token number\">1</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token number\">0</span> <span class=\"token number\">1</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token comment\" spellcheck=\"true\">%自定义结构元</span>\nD <span class=\"token operator\">=</span> <span class=\"token function\">imdilate</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> B<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'原图'</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>D<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'膨胀后的图'</span><span class=\"token punctuation\">)</span></code></pre>\n<p><img src=\"https://i.loli.net/2019/07/22/5d3564132fa1741100.jpg\" alt></p>\n<h3 id=\"腐蚀\"><a href=\"#腐蚀\" class=\"headerlink\" title=\"腐蚀\"></a>腐蚀</h3><p>腐蚀”收缩”或”细化”二值图像中的物体。像膨胀一样，收缩的方法和程度由结构元控制。<br>A被B腐蚀表示为$A\\ominus B$,定义为:<br>$$ A\\ominus B = \\{z| (B)_z\\subseteq A\\} = \\{z| (B)_z\\cap A^c = \\emptyset\\}$$<br><img src=\"https://i.loli.net/2019/07/23/5d36cefa2813d95731.jpg\" alt></p>\n<p>工具箱函数imerode(A,B)来执腐蚀</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">f <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tig.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nB <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span> <span class=\"token number\">1</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token number\">0</span> <span class=\"token number\">1</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token comment\" spellcheck=\"true\">%自定义结构元</span>\nR <span class=\"token operator\">=</span> <span class=\"token function\">imerode</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> B<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'原图'</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'腐蚀后的图'</span><span class=\"token punctuation\">)</span></code></pre>\n<p><img src=\"https://i.loli.net/2019/07/22/5d356b5f7eed962952.jpg\" alt></p>\n<h3 id=\"结构元\"><a href=\"#结构元\" class=\"headerlink\" title=\"结构元\"></a>结构元</h3><p>strel函数，用来构造各种大小和形状的结构元</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">se <span class=\"token operator\">=</span> <span class=\"token function\">strel</span><span class=\"token punctuation\">(</span>shape<span class=\"token punctuation\">,</span> parameters<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>shape是希望形状的字符串，parameters是描述形状信息的参数列表<br><img src=\"https://i.loli.net/2019/07/22/5d35670a85b4f22579.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/22/5d35670a63e2817742.jpg\" alt><br>注意生成的se含有两项</p>\n<ol>\n<li>se.Neighborhood:[ ×  logical ]</li>\n<li>se.Demensionality: 2</li>\n</ol>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"形态学图像处理\"><a href=\"#形态学图像处理\" class=\"headerlink\" title=\"形态学图像处理\"></a>形态学图像处理</h1><p>从这里开始过渡，从输入输出都是图像，过渡到图像分析方法，输出以某种方法来描述图像的内容。</p>\n<h2 id=\"集合理论基础\"><a href=\"#集合理论基础\" class=\"headerlink\" title=\"集合理论基础\"></a>集合理论基础</h2><p>令Z为整数集合，用于产生的数字图像的抽样处理可以看做是把xy平面分割成网格状，其中每个网格的<strong>中心坐标</strong>是来自笛卡尔积$Z^2$中的一对元素。在集合理论中，如果(x,y)是来自$Z^2$的整数,f是分配给每个不同坐标的对(x,y)的亮度值的映射，那么函数f(x,y)被成为数字图像。如果亮度值也为整数，那么这幅图像就变成了二维图像。<br>集合的基本操作:$\\in$,$\\notin$,$\\cup$,$\\cap$,+,-.除了这些基本操作，形态学操作还需要两个算子，他们特别针对元素均为像素坐标的集合</p>\n<ol>\n<li>集合的反射$\\hat{B}$<br>$$ \\hat{B} = \\{w|w=-b,b\\in B\\}$$</li>\n<li>点z=($z_1$,$z_2$)集合的平移${(A)}_z$<br>$$ (A)_z = \\{c|c=a+z,a\\in A\\}$$<h3 id=\"二值图像、集合及逻辑算子\"><a href=\"#二值图像、集合及逻辑算子\" class=\"headerlink\" title=\"二值图像、集合及逻辑算子\"></a>二值图像、集合及逻辑算子</h3>形态学理论把二值图像看成是前景(1值)像素的集合,集合的元素属于$Z^2$如果A和B都是二值图像，那么$C=A\\cup B$也是二值图像<br>$$C(x,y)=\\begin{cases}<br>1,\\quad A(x,y)或B(x,y)为1,或者两者均为1\\<br>0 \\quad 其他<br>\\end{cases}<br>$$<h3 id=\"在MATLAB中使用逻辑表达式在二值图像上进行逻辑运算\"><a href=\"#在MATLAB中使用逻辑表达式在二值图像上进行逻辑运算\" class=\"headerlink\" title=\"在MATLAB中使用逻辑表达式在二值图像上进行逻辑运算\"></a>在MATLAB中使用逻辑表达式在二值图像上进行逻辑运算</h3></li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>集合运算</th>\n<th align=\"center\">二值图像的MATLAb语句</th>\n<th>名称</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>$A\\cap B$</td>\n<td align=\"center\">A &amp; B</td>\n<td>与</td>\n</tr>\n<tr>\n<td>$A\\cup B$</td>\n<td align=\"center\">A $\\rvert$ B</td>\n<td>或</td>\n</tr>\n<tr>\n<td>$A^c$</td>\n<td align=\"center\">~B</td>\n<td>非</td>\n</tr>\n<tr>\n<td>$A-B$</td>\n<td align=\"center\">A &amp;~ B</td>\n<td>差</td>\n</tr>\n</tbody></table>\n<h2 id=\"腐蚀和膨胀\"><a href=\"#腐蚀和膨胀\" class=\"headerlink\" title=\"腐蚀和膨胀\"></a>腐蚀和膨胀</h2><h3 id=\"膨胀\"><a href=\"#膨胀\" class=\"headerlink\" title=\"膨胀\"></a>膨胀</h3><p>膨胀是使图像中的目标”生长”或”变粗”的操作。程度由一种被称为<strong>结构元</strong>的形状来控制<br>A被B膨胀，表示为$A \\oplus B$,作为集合操作<br>$$ A\\oplus B=\\{ z|\\hat{B}_z\\cap A\\not= \\emptyset\\}$$<br>约定: $A \\oplus B$ 的第一个操作数是图像，第二个操作数是结构元，结构元通常比图像小的多。<br><img src=\"https://i.loli.net/2019/07/22/5d35670a79cd611294.jpg\" alt></p>\n<ul>\n<li>工具箱函数imdilate(A, B)来执行膨胀</li>\n</ul>\n<pre><code class=\"matlab\">f = imread(&#39;1111.jpg&#39;);\nB = [0 1 0; 1 1 1; 0 1 0];%自定义结构元\nD = imdilate(f, B);\nsubplot(1,2,1),imshow(f);\ntitle(&#39;原图&#39;)\nsubplot(1,2,2),imshow(D);\ntitle(&#39;膨胀后的图&#39;)</code></pre>\n<p><img src=\"https://i.loli.net/2019/07/22/5d3564132fa1741100.jpg\" alt></p>\n<h3 id=\"腐蚀\"><a href=\"#腐蚀\" class=\"headerlink\" title=\"腐蚀\"></a>腐蚀</h3><p>腐蚀”收缩”或”细化”二值图像中的物体。像膨胀一样，收缩的方法和程度由结构元控制。<br>A被B腐蚀表示为$A\\ominus B$,定义为:<br>$$ A\\ominus B = \\{z| (B)_z\\subseteq A\\} = \\{z| (B)_z\\cap A^c = \\emptyset\\}$$<br><img src=\"https://i.loli.net/2019/07/23/5d36cefa2813d95731.jpg\" alt></p>\n<p>工具箱函数imerode(A,B)来执腐蚀</p>\n<pre><code class=\"matlab\">f = imread(&#39;tig.jpg&#39;);\nB = [0 1 0; 1 1 1; 0 1 0];%自定义结构元\nR = imerode(f, B);\nsubplot(1,2,1),imshow(f);\ntitle(&#39;原图&#39;)\nsubplot(1,2,2),imshow(R);\ntitle(&#39;腐蚀后的图&#39;)</code></pre>\n<p><img src=\"https://i.loli.net/2019/07/22/5d356b5f7eed962952.jpg\" alt></p>\n<h3 id=\"结构元\"><a href=\"#结构元\" class=\"headerlink\" title=\"结构元\"></a>结构元</h3><p>strel函数，用来构造各种大小和形状的结构元</p>\n<pre><code class=\"matlab\">se = strel(shape, parameters);</code></pre>\n<p>shape是希望形状的字符串，parameters是描述形状信息的参数列表<br><img src=\"https://i.loli.net/2019/07/22/5d35670a85b4f22579.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/22/5d35670a63e2817742.jpg\" alt><br>注意生成的se含有两项</p>\n<ol>\n<li>se.Neighborhood:[ ×  logical ]</li>\n<li>se.Demensionality: 2</li>\n</ol>\n"},{"title":"空间滤波","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-07-17T01:42:48.000Z","password":null,"summary":"滤波的原理、滤波器及Matlab中滤波器的实现","img":"https://i.loli.net/2019/07/17/5d2e73bb14bd344648.png","_content":"\n# 空间滤波基础\n\n\n## 滤波的原理：     \n空间滤波是采用滤波处理的图像增强的方法，理论基础是空间卷积和空间相关，目的是改善图片质量\n## 线性空间滤波\n  - 移动滤波的模板w称为滤波器\n  - 相关 与 卷积：    \n  相关是指模板w按下图所示的方式进行图像数组的处理。在原理上，卷积是相同的处理过程，只不过在w通过之前先将它选旋转180度\n  ![](https://i.loli.net/2019/07/16/5d2d9d9ea213761403.jpg)\n  相关与卷积操作说明\n  ![](https://i.loli.net/2019/07/16/5d2d9dffdbc4911045.jpg)\n  需要注意的地方：    \n  1. 相关是滤波器位移的函数\n  2. 滤波器w与一个只包含一个1其余全是0的函数相关，得到的是旋转了180度的滤波器w，将这个函数称之为**离散单位冲激**     \n  结论: 一个函数与离散单位冲激相关，在该冲激位置产生这个函数的一个翻转版本    \n  一个函数与离散单位冲激相关激卷积，得到的是在该冲激处的这个函数的拷贝，这个复制的性质称为筛选    \n  这种定义推广到图像如下图所示\n  ![](https://i.loli.net/2019/07/17/5d2e77c7afba429201.jpg)\n  为了便于表达，以公式形式总结两种形式\n  +  大小为m×n的滤波模板w(x,y)与函数f(x,y)的相关\n            ![](https://i.loli.net/2019/07/17/5d2e78e52323950837.jpg)\n  +  大小为m×n的滤波模板w(x,y)与函数f(x,y)的卷积\n$$w(x,y)\\bigstar f(x,y)=\\sum_{s=-a}^{a}\\sum_{t=-b}^{b}w(s,t)f(x+s,y+t)$$\n  - Matlab的实现:    \n  工具箱使用imfilter来实现线性空间滤波，语法如下:\n        \n  ```matlab\n  g = imfilter(f, w, filtering_mode, boundary_options, size_options)\n  ```\n        \n  默认值为相关，若想执行卷积操作，有以下两种做法：\n        \n  ```matlab\n  g = imfilter(f, w, 'conv')\n  ```\n        \n  或者使用`rot90(w, 2)`来将w旋转180度\n        \n  ```matlab\n  g = imfilter(f, rot90(w, 2))\n  ```\n        \n  f是输入图像，w为滤波模板，g为滤波结果\n  其他参数如下\n  ![](https://i.loli.net/2019/07/17/5d2e84e556ad615011.jpg)\n  使用matlab实现为\n        \n  ```matlab\n  f = imread('filter.jpg');\n  F = im2double(f);\n  imshow(F);\n  title('current image');\n\n  w = ones(31);\n  gd = imfilter(F, w);\n  figure,imshow(gd, [ ]);\n  title('Default');\n\n  gr = imfilter(F, w, 'replicate');\n  figure,imshow(gr, [ ]);\n  title('replicate');\n\n  gs = imfilter(F, w, 'symmetric');\n  figure,imshow(gs, [ ]);\n  title('symmetric');\n\n  gc = imfilter(F, w, 'circular');\n  figure,imshow(gc, [ ]);\n  title('circular');\n\n  g = imfilter(f, w, 'replicate');\n  figure,imshow(g, [ ]);\n  title('replicate unit8');\n  ```\n        \n  这里开始读取的filter.jpg为uint8格式，故在处理之前先使用`im2double`将其转化为double类型以提高精度     \n  滤波结果如下\n  ![](https://i.loli.net/2019/07/17/5d2e8517ac67e80281.jpg)\n\n\n## 非线性空间滤波：     \n线性空间滤波基于计算乘积和，即线性操作，非线性空间滤波基于涉及邻域像素内的非线性操作，例如，使每个中心点的响应等于邻域内像素最大值的操作可以称为是非线性滤波操作      \n  - Matlab工具\n  1. nlfilter：直接执行二维操作\n  2. coldilt：按列组织数据，更多采用\n\n## 标准的 **空间滤波器**\n\n### 线性空间滤波器\n- 可以使用fspecial实现，生成滤波器w\n\n    ```matlab\n    w = fspecial('type', parameters)\n\n    ```\n\n    'type'表示滤波器的类型，'parameters'进一步定义指定的滤波器\n    应用参数如下：\n    ![](https://i.loli.net/2019/07/17/5d2eba0f5055d41026.jpg)\n    ![](https://i.loli.net/2019/07/17/5d2ec9491164776894.jpg)\n- Laplace滤波器的实现\n    + 原理：    \n    图像f(x,y)的laplace算子：\n    ![](https://i.loli.net/2019/07/17/5d2ec90e6a75162149.jpg)\n    Laplace算子增强公式：\n    $$g(x,y) = f(x,y)+c[\\triangledown ^2 f(x,y)]$$\n    注意：如果模板的中心系数为正，c为1;如果为负，c为0.\n\n    ```matlab\n    fspecial('laplacian', alpha)\n    ```\n\n    可以实现更为一般的laplace模板\n\n    - 下面是用laplace滤波器增强图像的例子：\n    首先设置滤波器\n\n    ```matlab\n    >> w = fspecial('laplacian', 0);\n    ```\n\n    ![](https://i.loli.net/2019/07/17/5d2ed6fcca83142276.jpg)\n\n    输入的图像为unit8类，\n\n    ```matlab\n    >> g1 = imfilter(f, w, 'replicate');\n    >> imshow(g1);\n    ```\n\n    得到结果，但存在问题，所有像素都是正的。原因：滤波器的中心参数为负值，为了解决这一问题，可以在滤波前将f转换为浮点数\n\n    ```matlab\n    >> ff = tofloat(f);\n    >> g2 = imfilter(ff, w, 'replicate');\n    >> imshow(g2);\n    ```\n\n    这里tofloat为M-IPT函数，实现代码如下：\n\n    ```matlab\n    function [out,revertclass] = tofloat(inputimage)\n    %Copy the book of Gonzales\n    identify = @(x) x;\n    tosingle = @im2single;\n    table = {'uint8',tosingle,@im2uint8\n    'uint16',tosingle,@im2uint16\n    'logical',tosingle,@logical\n    'double',identify,identify\n    'single',identify,identify};\n    classIndex = find(strcmp(class(inputimage),table(:,1)));\n    if isempty(classIndex)\n    error('不支持的图像类型');\n    end\n    out = table{classIndex,2}(inputimage);\n    revertclass = table{classIndex,3};\n    ```\n\n    导入workspace即可\n\n    最后用原始图像减去laplace图像来恢复失去的灰度层次(因为中心参数为负值)\n\n    ```matlab\n    >> g = ff - g2;\n    imshow(g);\n    ```\n\n    可以看到结果比原图象要清晰\n![](https://i.loli.net/2019/07/17/5d2ed69eaa47174206.jpg)\n\n\n### 非线性空间滤波器\n\n- 函数ordfilt2计算统计排序(order-statistic filter)滤波器(也叫做rank filter,即排序滤波器)\n语法为：\n\n```matlab\ng = ordfilt2(f, order, domain)\n```\n\n用邻域集合中的第order个元素去替换f中的每个元素的值来生成图像g，domain是由0和1组成的大小为m×n的矩阵，规定了在计算中使用的邻域中像素点的位置\n- 中值滤波器，最著名的统计排序滤波器，对应第50个百分位，对应奇数的m和n\n\n```matlab\ng = ordfilt2(f, (m*n + 1)/2, ones(m, n));\n\n```\n   - 这里提供了一个专门的二维中值滤波器:\n\n```matlab\ng = medfilt2(f, [m, n], padopt)\n```\n\n\n\n  padopt规定了三个可能的边缘填充选项:\n  1. 'zeros',默认值\n  2. 'symmetric',f按照镜像反射方式对称地沿边缘扩展\n  3. 'indexed'，f属于double类，用1填充;否则用0填充\n  - 中值滤波增强图像:\n  首先给图像添加黑白噪点发生概率为0.2的'椒盐噪声'\n\n    ```matlab\n    >> fn = imnoise(f, 'salt & pepper', 0.2)\n    ```\n\n   对带噪图像进行中值滤波处理\n\n    ```matlab\n    >> gm = medfilt2(fn)\n    ```\n\n   注意，在这里出现了错误，==A应为二维==\n   ![](https://i.loli.net/2019/07/17/5d2ed759e608448713.jpg)\n\n   原因:中值滤波medfilt2,输入的图像应为二维矩阵，实际输入的为imread读取的图像加上噪声，通常是三维RGB图，是三维矩阵\n   解决办法:先用rgb2gray(f)将图像转换为灰度矩阵图像\n\n    ```matlab\n    >> fn2 = rgb2gray(fn);\n    >> gm = medfilt2(fn2);\n    >> imshow(gm);\n    ```\n\n   减弱外圈黑点\n\n    ```matlab\n    >> gms = medfilt2(fn2, 'symmetric');\n    ```\n\n![](https://i.loli.net/2019/07/17/5d2ed7776b71a55041.jpg)\n\n","source":"_posts/空间滤波.md","raw":"---\ntitle: 空间滤波\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-07-17 09:42:48\npassword:\nsummary: 滤波的原理、滤波器及Matlab中滤波器的实现\nimg: https://i.loli.net/2019/07/17/5d2e73bb14bd344648.png\ntags:\n- 图像处理\n- Matlab\ncategories:\n- Digital Image Processing\n---\n\n# 空间滤波基础\n\n\n## 滤波的原理：     \n空间滤波是采用滤波处理的图像增强的方法，理论基础是空间卷积和空间相关，目的是改善图片质量\n## 线性空间滤波\n  - 移动滤波的模板w称为滤波器\n  - 相关 与 卷积：    \n  相关是指模板w按下图所示的方式进行图像数组的处理。在原理上，卷积是相同的处理过程，只不过在w通过之前先将它选旋转180度\n  ![](https://i.loli.net/2019/07/16/5d2d9d9ea213761403.jpg)\n  相关与卷积操作说明\n  ![](https://i.loli.net/2019/07/16/5d2d9dffdbc4911045.jpg)\n  需要注意的地方：    \n  1. 相关是滤波器位移的函数\n  2. 滤波器w与一个只包含一个1其余全是0的函数相关，得到的是旋转了180度的滤波器w，将这个函数称之为**离散单位冲激**     \n  结论: 一个函数与离散单位冲激相关，在该冲激位置产生这个函数的一个翻转版本    \n  一个函数与离散单位冲激相关激卷积，得到的是在该冲激处的这个函数的拷贝，这个复制的性质称为筛选    \n  这种定义推广到图像如下图所示\n  ![](https://i.loli.net/2019/07/17/5d2e77c7afba429201.jpg)\n  为了便于表达，以公式形式总结两种形式\n  +  大小为m×n的滤波模板w(x,y)与函数f(x,y)的相关\n            ![](https://i.loli.net/2019/07/17/5d2e78e52323950837.jpg)\n  +  大小为m×n的滤波模板w(x,y)与函数f(x,y)的卷积\n$$w(x,y)\\bigstar f(x,y)=\\sum_{s=-a}^{a}\\sum_{t=-b}^{b}w(s,t)f(x+s,y+t)$$\n  - Matlab的实现:    \n  工具箱使用imfilter来实现线性空间滤波，语法如下:\n        \n  ```matlab\n  g = imfilter(f, w, filtering_mode, boundary_options, size_options)\n  ```\n        \n  默认值为相关，若想执行卷积操作，有以下两种做法：\n        \n  ```matlab\n  g = imfilter(f, w, 'conv')\n  ```\n        \n  或者使用`rot90(w, 2)`来将w旋转180度\n        \n  ```matlab\n  g = imfilter(f, rot90(w, 2))\n  ```\n        \n  f是输入图像，w为滤波模板，g为滤波结果\n  其他参数如下\n  ![](https://i.loli.net/2019/07/17/5d2e84e556ad615011.jpg)\n  使用matlab实现为\n        \n  ```matlab\n  f = imread('filter.jpg');\n  F = im2double(f);\n  imshow(F);\n  title('current image');\n\n  w = ones(31);\n  gd = imfilter(F, w);\n  figure,imshow(gd, [ ]);\n  title('Default');\n\n  gr = imfilter(F, w, 'replicate');\n  figure,imshow(gr, [ ]);\n  title('replicate');\n\n  gs = imfilter(F, w, 'symmetric');\n  figure,imshow(gs, [ ]);\n  title('symmetric');\n\n  gc = imfilter(F, w, 'circular');\n  figure,imshow(gc, [ ]);\n  title('circular');\n\n  g = imfilter(f, w, 'replicate');\n  figure,imshow(g, [ ]);\n  title('replicate unit8');\n  ```\n        \n  这里开始读取的filter.jpg为uint8格式，故在处理之前先使用`im2double`将其转化为double类型以提高精度     \n  滤波结果如下\n  ![](https://i.loli.net/2019/07/17/5d2e8517ac67e80281.jpg)\n\n\n## 非线性空间滤波：     \n线性空间滤波基于计算乘积和，即线性操作，非线性空间滤波基于涉及邻域像素内的非线性操作，例如，使每个中心点的响应等于邻域内像素最大值的操作可以称为是非线性滤波操作      \n  - Matlab工具\n  1. nlfilter：直接执行二维操作\n  2. coldilt：按列组织数据，更多采用\n\n## 标准的 **空间滤波器**\n\n### 线性空间滤波器\n- 可以使用fspecial实现，生成滤波器w\n\n    ```matlab\n    w = fspecial('type', parameters)\n\n    ```\n\n    'type'表示滤波器的类型，'parameters'进一步定义指定的滤波器\n    应用参数如下：\n    ![](https://i.loli.net/2019/07/17/5d2eba0f5055d41026.jpg)\n    ![](https://i.loli.net/2019/07/17/5d2ec9491164776894.jpg)\n- Laplace滤波器的实现\n    + 原理：    \n    图像f(x,y)的laplace算子：\n    ![](https://i.loli.net/2019/07/17/5d2ec90e6a75162149.jpg)\n    Laplace算子增强公式：\n    $$g(x,y) = f(x,y)+c[\\triangledown ^2 f(x,y)]$$\n    注意：如果模板的中心系数为正，c为1;如果为负，c为0.\n\n    ```matlab\n    fspecial('laplacian', alpha)\n    ```\n\n    可以实现更为一般的laplace模板\n\n    - 下面是用laplace滤波器增强图像的例子：\n    首先设置滤波器\n\n    ```matlab\n    >> w = fspecial('laplacian', 0);\n    ```\n\n    ![](https://i.loli.net/2019/07/17/5d2ed6fcca83142276.jpg)\n\n    输入的图像为unit8类，\n\n    ```matlab\n    >> g1 = imfilter(f, w, 'replicate');\n    >> imshow(g1);\n    ```\n\n    得到结果，但存在问题，所有像素都是正的。原因：滤波器的中心参数为负值，为了解决这一问题，可以在滤波前将f转换为浮点数\n\n    ```matlab\n    >> ff = tofloat(f);\n    >> g2 = imfilter(ff, w, 'replicate');\n    >> imshow(g2);\n    ```\n\n    这里tofloat为M-IPT函数，实现代码如下：\n\n    ```matlab\n    function [out,revertclass] = tofloat(inputimage)\n    %Copy the book of Gonzales\n    identify = @(x) x;\n    tosingle = @im2single;\n    table = {'uint8',tosingle,@im2uint8\n    'uint16',tosingle,@im2uint16\n    'logical',tosingle,@logical\n    'double',identify,identify\n    'single',identify,identify};\n    classIndex = find(strcmp(class(inputimage),table(:,1)));\n    if isempty(classIndex)\n    error('不支持的图像类型');\n    end\n    out = table{classIndex,2}(inputimage);\n    revertclass = table{classIndex,3};\n    ```\n\n    导入workspace即可\n\n    最后用原始图像减去laplace图像来恢复失去的灰度层次(因为中心参数为负值)\n\n    ```matlab\n    >> g = ff - g2;\n    imshow(g);\n    ```\n\n    可以看到结果比原图象要清晰\n![](https://i.loli.net/2019/07/17/5d2ed69eaa47174206.jpg)\n\n\n### 非线性空间滤波器\n\n- 函数ordfilt2计算统计排序(order-statistic filter)滤波器(也叫做rank filter,即排序滤波器)\n语法为：\n\n```matlab\ng = ordfilt2(f, order, domain)\n```\n\n用邻域集合中的第order个元素去替换f中的每个元素的值来生成图像g，domain是由0和1组成的大小为m×n的矩阵，规定了在计算中使用的邻域中像素点的位置\n- 中值滤波器，最著名的统计排序滤波器，对应第50个百分位，对应奇数的m和n\n\n```matlab\ng = ordfilt2(f, (m*n + 1)/2, ones(m, n));\n\n```\n   - 这里提供了一个专门的二维中值滤波器:\n\n```matlab\ng = medfilt2(f, [m, n], padopt)\n```\n\n\n\n  padopt规定了三个可能的边缘填充选项:\n  1. 'zeros',默认值\n  2. 'symmetric',f按照镜像反射方式对称地沿边缘扩展\n  3. 'indexed'，f属于double类，用1填充;否则用0填充\n  - 中值滤波增强图像:\n  首先给图像添加黑白噪点发生概率为0.2的'椒盐噪声'\n\n    ```matlab\n    >> fn = imnoise(f, 'salt & pepper', 0.2)\n    ```\n\n   对带噪图像进行中值滤波处理\n\n    ```matlab\n    >> gm = medfilt2(fn)\n    ```\n\n   注意，在这里出现了错误，==A应为二维==\n   ![](https://i.loli.net/2019/07/17/5d2ed759e608448713.jpg)\n\n   原因:中值滤波medfilt2,输入的图像应为二维矩阵，实际输入的为imread读取的图像加上噪声，通常是三维RGB图，是三维矩阵\n   解决办法:先用rgb2gray(f)将图像转换为灰度矩阵图像\n\n    ```matlab\n    >> fn2 = rgb2gray(fn);\n    >> gm = medfilt2(fn2);\n    >> imshow(gm);\n    ```\n\n   减弱外圈黑点\n\n    ```matlab\n    >> gms = medfilt2(fn2, 'symmetric');\n    ```\n\n![](https://i.loli.net/2019/07/17/5d2ed7776b71a55041.jpg)\n\n","slug":"空间滤波","published":1,"updated":"2020-02-24T10:49:41.450Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0tq002j74ju7vgcoaki","content":"<h1 id=\"空间滤波基础\"><a href=\"#空间滤波基础\" class=\"headerlink\" title=\"空间滤波基础\"></a>空间滤波基础</h1><h2 id=\"滤波的原理：\"><a href=\"#滤波的原理：\" class=\"headerlink\" title=\"滤波的原理：\"></a>滤波的原理：</h2><p>空间滤波是采用滤波处理的图像增强的方法，理论基础是空间卷积和空间相关，目的是改善图片质量</p>\n<h2 id=\"线性空间滤波\"><a href=\"#线性空间滤波\" class=\"headerlink\" title=\"线性空间滤波\"></a>线性空间滤波</h2><ul>\n<li>移动滤波的模板w称为滤波器</li>\n<li>相关 与 卷积：<br>相关是指模板w按下图所示的方式进行图像数组的处理。在原理上，卷积是相同的处理过程，只不过在w通过之前先将它选旋转180度<br><img src=\"https://i.loli.net/2019/07/16/5d2d9d9ea213761403.jpg\" alt><br>相关与卷积操作说明<br><img src=\"https://i.loli.net/2019/07/16/5d2d9dffdbc4911045.jpg\" alt><br>需要注意的地方：    </li>\n</ul>\n<ol>\n<li>相关是滤波器位移的函数</li>\n<li>滤波器w与一个只包含一个1其余全是0的函数相关，得到的是旋转了180度的滤波器w，将这个函数称之为<strong>离散单位冲激</strong><br>结论: 一个函数与离散单位冲激相关，在该冲激位置产生这个函数的一个翻转版本<br>一个函数与离散单位冲激相关激卷积，得到的是在该冲激处的这个函数的拷贝，这个复制的性质称为筛选<br>这种定义推广到图像如下图所示<br><img src=\"https://i.loli.net/2019/07/17/5d2e77c7afba429201.jpg\" alt><br>为了便于表达，以公式形式总结两种形式</li>\n</ol>\n<ul>\n<li>大小为m×n的滤波模板w(x,y)与函数f(x,y)的相关<pre><code>   ![](https://i.loli.net/2019/07/17/5d2e78e52323950837.jpg)</code></pre></li>\n<li>大小为m×n的滤波模板w(x,y)与函数f(x,y)的卷积<br>$$w(x,y)\\bigstar f(x,y)=\\sum_{s=-a}^{a}\\sum_{t=-b}^{b}w(s,t)f(x+s,y+t)$$</li>\n</ul>\n<ul>\n<li><p>Matlab的实现:<br>工具箱使用imfilter来实现线性空间滤波，语法如下:</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">g <span class=\"token operator\">=</span> <span class=\"token function\">imfilter</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> filtering_mode<span class=\"token punctuation\">,</span> boundary_options<span class=\"token punctuation\">,</span> size_options<span class=\"token punctuation\">)</span></code></pre>\n<p>默认值为相关，若想执行卷积操作，有以下两种做法：</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">g <span class=\"token operator\">=</span> <span class=\"token function\">imfilter</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> <span class=\"token string\">'conv'</span><span class=\"token punctuation\">)</span></code></pre>\n<p>或者使用<code>rot90(w, 2)</code>来将w旋转180度</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">g <span class=\"token operator\">=</span> <span class=\"token function\">imfilter</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token function\">rot90</span><span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre>\n<p>f是输入图像，w为滤波模板，g为滤波结果<br>其他参数如下<br><img src=\"https://i.loli.net/2019/07/17/5d2e84e556ad615011.jpg\" alt><br>使用matlab实现为</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">f <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">'filter.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nF <span class=\"token operator\">=</span> <span class=\"token function\">im2double</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'current image'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nw <span class=\"token operator\">=</span> <span class=\"token function\">ones</span><span class=\"token punctuation\">(</span><span class=\"token number\">31</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngd <span class=\"token operator\">=</span> <span class=\"token function\">imfilter</span><span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfigure<span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>gd<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Default'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ngr <span class=\"token operator\">=</span> <span class=\"token function\">imfilter</span><span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> <span class=\"token string\">'replicate'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfigure<span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>gr<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'replicate'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ngs <span class=\"token operator\">=</span> <span class=\"token function\">imfilter</span><span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> <span class=\"token string\">'symmetric'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfigure<span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>gs<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'symmetric'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ngc <span class=\"token operator\">=</span> <span class=\"token function\">imfilter</span><span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> <span class=\"token string\">'circular'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfigure<span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>gc<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'circular'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ng <span class=\"token operator\">=</span> <span class=\"token function\">imfilter</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> <span class=\"token string\">'replicate'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfigure<span class=\"token punctuation\">,</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'replicate unit8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>这里开始读取的filter.jpg为uint8格式，故在处理之前先使用<code>im2double</code>将其转化为double类型以提高精度<br>滤波结果如下<br><img src=\"https://i.loli.net/2019/07/17/5d2e8517ac67e80281.jpg\" alt></p>\n</li>\n</ul>\n<h2 id=\"非线性空间滤波：\"><a href=\"#非线性空间滤波：\" class=\"headerlink\" title=\"非线性空间滤波：\"></a>非线性空间滤波：</h2><p>线性空间滤波基于计算乘积和，即线性操作，非线性空间滤波基于涉及邻域像素内的非线性操作，例如，使每个中心点的响应等于邻域内像素最大值的操作可以称为是非线性滤波操作      </p>\n<ul>\n<li>Matlab工具</li>\n</ul>\n<ol>\n<li>nlfilter：直接执行二维操作</li>\n<li>coldilt：按列组织数据，更多采用</li>\n</ol>\n<h2 id=\"标准的-空间滤波器\"><a href=\"#标准的-空间滤波器\" class=\"headerlink\" title=\"标准的 空间滤波器\"></a>标准的 <strong>空间滤波器</strong></h2><h3 id=\"线性空间滤波器\"><a href=\"#线性空间滤波器\" class=\"headerlink\" title=\"线性空间滤波器\"></a>线性空间滤波器</h3><ul>\n<li><p>可以使用fspecial实现，生成滤波器w</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">  w <span class=\"token operator\">=</span> <span class=\"token function\">fspecial</span><span class=\"token punctuation\">(</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">,</span> parameters<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>  ‘type’表示滤波器的类型，’parameters’进一步定义指定的滤波器<br>  应用参数如下：<br>  <img src=\"https://i.loli.net/2019/07/17/5d2eba0f5055d41026.jpg\" alt><br>  <img src=\"https://i.loli.net/2019/07/17/5d2ec9491164776894.jpg\" alt></p>\n</li>\n<li><p>Laplace滤波器的实现</p>\n<ul>\n<li><p>原理：<br>图像f(x,y)的laplace算子：<br><img src=\"https://i.loli.net/2019/07/17/5d2ec90e6a75162149.jpg\" alt><br>Laplace算子增强公式：<br>$$g(x,y) = f(x,y)+c[\\triangledown ^2 f(x,y)]$$<br>注意：如果模板的中心系数为正，c为1;如果为负，c为0.</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token function\">fspecial</span><span class=\"token punctuation\">(</span><span class=\"token string\">'laplacian'</span><span class=\"token punctuation\">,</span> alpha<span class=\"token punctuation\">)</span></code></pre>\n<p>可以实现更为一般的laplace模板</p>\n</li>\n</ul>\n<ul>\n<li><p>下面是用laplace滤波器增强图像的例子：<br>首先设置滤波器</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> w <span class=\"token operator\">=</span> <span class=\"token function\">fspecial</span><span class=\"token punctuation\">(</span><span class=\"token string\">'laplacian'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p><img src=\"https://i.loli.net/2019/07/17/5d2ed6fcca83142276.jpg\" alt></p>\n<p>输入的图像为unit8类，</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> g1 <span class=\"token operator\">=</span> <span class=\"token function\">imfilter</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> <span class=\"token string\">'replicate'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">></span><span class=\"token operator\">></span> <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>g1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>得到结果，但存在问题，所有像素都是正的。原因：滤波器的中心参数为负值，为了解决这一问题，可以在滤波前将f转换为浮点数</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> ff <span class=\"token operator\">=</span> <span class=\"token function\">tofloat</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">></span><span class=\"token operator\">></span> g2 <span class=\"token operator\">=</span> <span class=\"token function\">imfilter</span><span class=\"token punctuation\">(</span>ff<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> <span class=\"token string\">'replicate'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">></span><span class=\"token operator\">></span> <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>g2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>这里tofloat为M-IPT函数，实现代码如下：</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token keyword\">function</span> <span class=\"token punctuation\">[</span>out<span class=\"token punctuation\">,</span>revertclass<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">tofloat</span><span class=\"token punctuation\">(</span>inputimage<span class=\"token punctuation\">)</span>\n<span class=\"token comment\" spellcheck=\"true\">%Copy the book of Gonzales</span>\nidentify <span class=\"token operator\">=</span> <span class=\"token operator\">@</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> x<span class=\"token punctuation\">;</span>\ntosingle <span class=\"token operator\">=</span> <span class=\"token operator\">@</span>im2single<span class=\"token punctuation\">;</span>\ntable <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'uint8'</span><span class=\"token punctuation\">,</span>tosingle<span class=\"token punctuation\">,</span><span class=\"token operator\">@</span>im2uint8\n<span class=\"token string\">'uint16'</span><span class=\"token punctuation\">,</span>tosingle<span class=\"token punctuation\">,</span><span class=\"token operator\">@</span>im2uint16\n<span class=\"token string\">'logical'</span><span class=\"token punctuation\">,</span>tosingle<span class=\"token punctuation\">,</span><span class=\"token operator\">@</span>logical\n<span class=\"token string\">'double'</span><span class=\"token punctuation\">,</span>identify<span class=\"token punctuation\">,</span>identify\n<span class=\"token string\">'single'</span><span class=\"token punctuation\">,</span>identify<span class=\"token punctuation\">,</span>identify<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nclassIndex <span class=\"token operator\">=</span> <span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token function\">strcmp</span><span class=\"token punctuation\">(</span><span class=\"token function\">class</span><span class=\"token punctuation\">(</span>inputimage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">table</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token function\">isempty</span><span class=\"token punctuation\">(</span>classIndex<span class=\"token punctuation\">)</span>\n<span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'不支持的图像类型'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">end</span>\nout <span class=\"token operator\">=</span> table<span class=\"token punctuation\">{</span>classIndex<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span>inputimage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nrevertclass <span class=\"token operator\">=</span> table<span class=\"token punctuation\">{</span>classIndex<span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n<p>导入workspace即可</p>\n<p>最后用原始图像减去laplace图像来恢复失去的灰度层次(因为中心参数为负值)</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> g <span class=\"token operator\">=</span> ff <span class=\"token operator\">-</span> g2<span class=\"token punctuation\">;</span>\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>可以看到结果比原图象要清晰<br><img src=\"https://i.loli.net/2019/07/17/5d2ed69eaa47174206.jpg\" alt></p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"非线性空间滤波器\"><a href=\"#非线性空间滤波器\" class=\"headerlink\" title=\"非线性空间滤波器\"></a>非线性空间滤波器</h3><ul>\n<li>函数ordfilt2计算统计排序(order-statistic filter)滤波器(也叫做rank filter,即排序滤波器)<br>语法为：</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">g <span class=\"token operator\">=</span> <span class=\"token function\">ordfilt2</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> order<span class=\"token punctuation\">,</span> domain<span class=\"token punctuation\">)</span></code></pre>\n<p>用邻域集合中的第order个元素去替换f中的每个元素的值来生成图像g，domain是由0和1组成的大小为m×n的矩阵，规定了在计算中使用的邻域中像素点的位置</p>\n<ul>\n<li>中值滤波器，最著名的统计排序滤波器，对应第50个百分位，对应奇数的m和n</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">g <span class=\"token operator\">=</span> <span class=\"token function\">ordfilt2</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>m<span class=\"token operator\">*</span>n <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token function\">ones</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<ul>\n<li>这里提供了一个专门的二维中值滤波器:</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">g <span class=\"token operator\">=</span> <span class=\"token function\">medfilt2</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>m<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> padopt<span class=\"token punctuation\">)</span></code></pre>\n<p>  padopt规定了三个可能的边缘填充选项:</p>\n<ol>\n<li>‘zeros’,默认值</li>\n<li>‘symmetric’,f按照镜像反射方式对称地沿边缘扩展</li>\n<li>‘indexed’，f属于double类，用1填充;否则用0填充</li>\n</ol>\n<ul>\n<li><p>中值滤波增强图像:<br>首先给图像添加黑白噪点发生概率为0.2的’椒盐噪声’</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> fn <span class=\"token operator\">=</span> <span class=\"token function\">imnoise</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token string\">'salt &amp; pepper'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">)</span></code></pre>\n<p>对带噪图像进行中值滤波处理</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> gm <span class=\"token operator\">=</span> <span class=\"token function\">medfilt2</span><span class=\"token punctuation\">(</span>fn<span class=\"token punctuation\">)</span></code></pre>\n<p>注意，在这里出现了错误，==A应为二维==<br><img src=\"https://i.loli.net/2019/07/17/5d2ed759e608448713.jpg\" alt></p>\n<p>原因:中值滤波medfilt2,输入的图像应为二维矩阵，实际输入的为imread读取的图像加上噪声，通常是三维RGB图，是三维矩阵<br>解决办法:先用rgb2gray(f)将图像转换为灰度矩阵图像</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> fn2 <span class=\"token operator\">=</span> <span class=\"token function\">rgb2gray</span><span class=\"token punctuation\">(</span>fn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">></span><span class=\"token operator\">></span> gm <span class=\"token operator\">=</span> <span class=\"token function\">medfilt2</span><span class=\"token punctuation\">(</span>fn2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">></span><span class=\"token operator\">></span> <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>gm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>减弱外圈黑点</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> gms <span class=\"token operator\">=</span> <span class=\"token function\">medfilt2</span><span class=\"token punctuation\">(</span>fn2<span class=\"token punctuation\">,</span> <span class=\"token string\">'symmetric'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</li>\n</ul>\n<p><img src=\"https://i.loli.net/2019/07/17/5d2ed7776b71a55041.jpg\" alt></p>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"空间滤波基础\"><a href=\"#空间滤波基础\" class=\"headerlink\" title=\"空间滤波基础\"></a>空间滤波基础</h1><h2 id=\"滤波的原理：\"><a href=\"#滤波的原理：\" class=\"headerlink\" title=\"滤波的原理：\"></a>滤波的原理：</h2><p>空间滤波是采用滤波处理的图像增强的方法，理论基础是空间卷积和空间相关，目的是改善图片质量</p>\n<h2 id=\"线性空间滤波\"><a href=\"#线性空间滤波\" class=\"headerlink\" title=\"线性空间滤波\"></a>线性空间滤波</h2><ul>\n<li>移动滤波的模板w称为滤波器</li>\n<li>相关 与 卷积：<br>相关是指模板w按下图所示的方式进行图像数组的处理。在原理上，卷积是相同的处理过程，只不过在w通过之前先将它选旋转180度<br><img src=\"https://i.loli.net/2019/07/16/5d2d9d9ea213761403.jpg\" alt><br>相关与卷积操作说明<br><img src=\"https://i.loli.net/2019/07/16/5d2d9dffdbc4911045.jpg\" alt><br>需要注意的地方：    </li>\n</ul>\n<ol>\n<li>相关是滤波器位移的函数</li>\n<li>滤波器w与一个只包含一个1其余全是0的函数相关，得到的是旋转了180度的滤波器w，将这个函数称之为<strong>离散单位冲激</strong><br>结论: 一个函数与离散单位冲激相关，在该冲激位置产生这个函数的一个翻转版本<br>一个函数与离散单位冲激相关激卷积，得到的是在该冲激处的这个函数的拷贝，这个复制的性质称为筛选<br>这种定义推广到图像如下图所示<br><img src=\"https://i.loli.net/2019/07/17/5d2e77c7afba429201.jpg\" alt><br>为了便于表达，以公式形式总结两种形式</li>\n</ol>\n<ul>\n<li>大小为m×n的滤波模板w(x,y)与函数f(x,y)的相关<pre><code>   ![](https://i.loli.net/2019/07/17/5d2e78e52323950837.jpg)</code></pre></li>\n<li>大小为m×n的滤波模板w(x,y)与函数f(x,y)的卷积<br>$$w(x,y)\\bigstar f(x,y)=\\sum_{s=-a}^{a}\\sum_{t=-b}^{b}w(s,t)f(x+s,y+t)$$</li>\n</ul>\n<ul>\n<li><p>Matlab的实现:<br>工具箱使用imfilter来实现线性空间滤波，语法如下:</p>\n<pre><code class=\"matlab\">g = imfilter(f, w, filtering_mode, boundary_options, size_options)</code></pre>\n<p>默认值为相关，若想执行卷积操作，有以下两种做法：</p>\n<pre><code class=\"matlab\">g = imfilter(f, w, &#39;conv&#39;)</code></pre>\n<p>或者使用<code>rot90(w, 2)</code>来将w旋转180度</p>\n<pre><code class=\"matlab\">g = imfilter(f, rot90(w, 2))</code></pre>\n<p>f是输入图像，w为滤波模板，g为滤波结果<br>其他参数如下<br><img src=\"https://i.loli.net/2019/07/17/5d2e84e556ad615011.jpg\" alt><br>使用matlab实现为</p>\n<pre><code class=\"matlab\">f = imread(&#39;filter.jpg&#39;);\nF = im2double(f);\nimshow(F);\ntitle(&#39;current image&#39;);\n\nw = ones(31);\ngd = imfilter(F, w);\nfigure,imshow(gd, [ ]);\ntitle(&#39;Default&#39;);\n\ngr = imfilter(F, w, &#39;replicate&#39;);\nfigure,imshow(gr, [ ]);\ntitle(&#39;replicate&#39;);\n\ngs = imfilter(F, w, &#39;symmetric&#39;);\nfigure,imshow(gs, [ ]);\ntitle(&#39;symmetric&#39;);\n\ngc = imfilter(F, w, &#39;circular&#39;);\nfigure,imshow(gc, [ ]);\ntitle(&#39;circular&#39;);\n\ng = imfilter(f, w, &#39;replicate&#39;);\nfigure,imshow(g, [ ]);\ntitle(&#39;replicate unit8&#39;);</code></pre>\n<p>这里开始读取的filter.jpg为uint8格式，故在处理之前先使用<code>im2double</code>将其转化为double类型以提高精度<br>滤波结果如下<br><img src=\"https://i.loli.net/2019/07/17/5d2e8517ac67e80281.jpg\" alt></p>\n</li>\n</ul>\n<h2 id=\"非线性空间滤波：\"><a href=\"#非线性空间滤波：\" class=\"headerlink\" title=\"非线性空间滤波：\"></a>非线性空间滤波：</h2><p>线性空间滤波基于计算乘积和，即线性操作，非线性空间滤波基于涉及邻域像素内的非线性操作，例如，使每个中心点的响应等于邻域内像素最大值的操作可以称为是非线性滤波操作      </p>\n<ul>\n<li>Matlab工具</li>\n</ul>\n<ol>\n<li>nlfilter：直接执行二维操作</li>\n<li>coldilt：按列组织数据，更多采用</li>\n</ol>\n<h2 id=\"标准的-空间滤波器\"><a href=\"#标准的-空间滤波器\" class=\"headerlink\" title=\"标准的 空间滤波器\"></a>标准的 <strong>空间滤波器</strong></h2><h3 id=\"线性空间滤波器\"><a href=\"#线性空间滤波器\" class=\"headerlink\" title=\"线性空间滤波器\"></a>线性空间滤波器</h3><ul>\n<li><p>可以使用fspecial实现，生成滤波器w</p>\n<pre><code class=\"matlab\">  w = fspecial(&#39;type&#39;, parameters)\n</code></pre>\n<p>  ‘type’表示滤波器的类型，’parameters’进一步定义指定的滤波器<br>  应用参数如下：<br>  <img src=\"https://i.loli.net/2019/07/17/5d2eba0f5055d41026.jpg\" alt><br>  <img src=\"https://i.loli.net/2019/07/17/5d2ec9491164776894.jpg\" alt></p>\n</li>\n<li><p>Laplace滤波器的实现</p>\n<ul>\n<li><p>原理：<br>图像f(x,y)的laplace算子：<br><img src=\"https://i.loli.net/2019/07/17/5d2ec90e6a75162149.jpg\" alt><br>Laplace算子增强公式：<br>$$g(x,y) = f(x,y)+c[\\triangledown ^2 f(x,y)]$$<br>注意：如果模板的中心系数为正，c为1;如果为负，c为0.</p>\n<pre><code class=\"matlab\">fspecial(&#39;laplacian&#39;, alpha)</code></pre>\n<p>可以实现更为一般的laplace模板</p>\n</li>\n</ul>\n<ul>\n<li><p>下面是用laplace滤波器增强图像的例子：<br>首先设置滤波器</p>\n<pre><code class=\"matlab\">&gt;&gt; w = fspecial(&#39;laplacian&#39;, 0);</code></pre>\n<p><img src=\"https://i.loli.net/2019/07/17/5d2ed6fcca83142276.jpg\" alt></p>\n<p>输入的图像为unit8类，</p>\n<pre><code class=\"matlab\">&gt;&gt; g1 = imfilter(f, w, &#39;replicate&#39;);\n&gt;&gt; imshow(g1);</code></pre>\n<p>得到结果，但存在问题，所有像素都是正的。原因：滤波器的中心参数为负值，为了解决这一问题，可以在滤波前将f转换为浮点数</p>\n<pre><code class=\"matlab\">&gt;&gt; ff = tofloat(f);\n&gt;&gt; g2 = imfilter(ff, w, &#39;replicate&#39;);\n&gt;&gt; imshow(g2);</code></pre>\n<p>这里tofloat为M-IPT函数，实现代码如下：</p>\n<pre><code class=\"matlab\">function [out,revertclass] = tofloat(inputimage)\n%Copy the book of Gonzales\nidentify = @(x) x;\ntosingle = @im2single;\ntable = {&#39;uint8&#39;,tosingle,@im2uint8\n&#39;uint16&#39;,tosingle,@im2uint16\n&#39;logical&#39;,tosingle,@logical\n&#39;double&#39;,identify,identify\n&#39;single&#39;,identify,identify};\nclassIndex = find(strcmp(class(inputimage),table(:,1)));\nif isempty(classIndex)\nerror(&#39;不支持的图像类型&#39;);\nend\nout = table{classIndex,2}(inputimage);\nrevertclass = table{classIndex,3};</code></pre>\n<p>导入workspace即可</p>\n<p>最后用原始图像减去laplace图像来恢复失去的灰度层次(因为中心参数为负值)</p>\n<pre><code class=\"matlab\">&gt;&gt; g = ff - g2;\nimshow(g);</code></pre>\n<p>可以看到结果比原图象要清晰<br><img src=\"https://i.loli.net/2019/07/17/5d2ed69eaa47174206.jpg\" alt></p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"非线性空间滤波器\"><a href=\"#非线性空间滤波器\" class=\"headerlink\" title=\"非线性空间滤波器\"></a>非线性空间滤波器</h3><ul>\n<li>函数ordfilt2计算统计排序(order-statistic filter)滤波器(也叫做rank filter,即排序滤波器)<br>语法为：</li>\n</ul>\n<pre><code class=\"matlab\">g = ordfilt2(f, order, domain)</code></pre>\n<p>用邻域集合中的第order个元素去替换f中的每个元素的值来生成图像g，domain是由0和1组成的大小为m×n的矩阵，规定了在计算中使用的邻域中像素点的位置</p>\n<ul>\n<li>中值滤波器，最著名的统计排序滤波器，对应第50个百分位，对应奇数的m和n</li>\n</ul>\n<pre><code class=\"matlab\">g = ordfilt2(f, (m*n + 1)/2, ones(m, n));\n</code></pre>\n<ul>\n<li>这里提供了一个专门的二维中值滤波器:</li>\n</ul>\n<pre><code class=\"matlab\">g = medfilt2(f, [m, n], padopt)</code></pre>\n<p>  padopt规定了三个可能的边缘填充选项:</p>\n<ol>\n<li>‘zeros’,默认值</li>\n<li>‘symmetric’,f按照镜像反射方式对称地沿边缘扩展</li>\n<li>‘indexed’，f属于double类，用1填充;否则用0填充</li>\n</ol>\n<ul>\n<li><p>中值滤波增强图像:<br>首先给图像添加黑白噪点发生概率为0.2的’椒盐噪声’</p>\n<pre><code class=\"matlab\">&gt;&gt; fn = imnoise(f, &#39;salt &amp; pepper&#39;, 0.2)</code></pre>\n<p>对带噪图像进行中值滤波处理</p>\n<pre><code class=\"matlab\">&gt;&gt; gm = medfilt2(fn)</code></pre>\n<p>注意，在这里出现了错误，==A应为二维==<br><img src=\"https://i.loli.net/2019/07/17/5d2ed759e608448713.jpg\" alt></p>\n<p>原因:中值滤波medfilt2,输入的图像应为二维矩阵，实际输入的为imread读取的图像加上噪声，通常是三维RGB图，是三维矩阵<br>解决办法:先用rgb2gray(f)将图像转换为灰度矩阵图像</p>\n<pre><code class=\"matlab\">&gt;&gt; fn2 = rgb2gray(fn);\n&gt;&gt; gm = medfilt2(fn2);\n&gt;&gt; imshow(gm);</code></pre>\n<p>减弱外圈黑点</p>\n<pre><code class=\"matlab\">&gt;&gt; gms = medfilt2(fn2, &#39;symmetric&#39;);</code></pre>\n</li>\n</ul>\n<p><img src=\"https://i.loli.net/2019/07/17/5d2ed7776b71a55041.jpg\" alt></p>\n"},{"title":"霍夫变换","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-07-26T03:53:52.000Z","password":null,"summary":"霍夫变换的原理、利用霍夫变换实现线检测","_content":"\n# 霍夫变换\n## 介绍与应用场景\n\n[霍夫变换](https://zh.wikipedia.org/wiki/%E9%9C%8D%E5%A4%AB%E5%8F%98%E6%8D%A2)(Hough Transform)是图像处理中的一种特征提取技术，该过程在一个参数空间中通过计算累计结果的局部最大值得到一个符合该特定形状的集合作为霍夫变换结果。经典霍夫变换用来检测图像中的直线，后来霍夫变换扩展到任意形状物体的识别，多为圆和椭圆。霍夫变换运用两个坐标空间之间的变换将在一个空间中具有相同形状的曲线或直线映射到另一个坐标空间的一个点上形成峰值，从而把检测任意形状的问题转化为统计峰值问题。\n\n## 基本原理\n考虑点$(x_i,y_i)$及通过这个点的线,有无穷多的线通过点$(x_i,y_i)$，针对a和b的一些值，满足斜截式$y_i = ax_i + b$的所有线都通过该点。该公式也可以写为$b = -ax_i + y_i$，考虑ab平面(即**参数空间**)对固定点$(x_i,y_i)$得到一条线的方程。另外，第二个点$(x_j,y_j)$也有一条在参数空间中与之相关的线，这条线和与$(x_i,y_i)$**相关**的线交于点$(a',b')$，其中$a'$是斜率，$b'$是在**xy平面**上包含点$(x_i,y_i)$和$(x_j,y_j)$的线的截距。在**参数空间**中，这条线包含的所有点都有相交于$(a',b')$点的直线。    \n简单理解，直线由两个点$A(x_1,y_1)$和$B(x_2,y_2)$定义，在参数空间中，两条直线的唯一公共点是在原图像空间中表示连接点A和B的唯一存在的直线\n![](https://i.loli.net/2019/07/24/5d38129f0e9f156720.jpg)\n因此，给定很多点，判断这些点是否共线的问题，经由霍夫变换之后，变成判断一堆曲线(每一个点在$(r, \\theta)$平面上代表一条曲线)是否 在 $(r,\\theta)$平面上相交于同一点的问题\n另外用法线表示法:\n$$xcos\\theta + ysin\\theta = \\rho$$\n水平线的$\\theta$=0,$\\rho$等于正的x的截距，垂直线的$\\theta=90$度，$\\rho$等于正的y的截距\n![](https://i.loli.net/2019/07/24/5d382004e2bab23873.jpg)\n\n在坐标(i, j)的单元位置，累加器的值是 A(i, j)，对应于参数空间坐标$(\\rho_i,\\theta_j)$的正方形。最初， 这些单元位置为零。然后，对于每个图像平面上的非背景点$(x_k,y_k)$(就是 xy 平面)，我们令 θ 等 于在 θ 轴上允许的细分值，并通过公式$\\rho = x_kcos\\theta+y_ksin\\theta$解出相应的 ρ 值。然后，得到的 ρ 值四 舍五入为最接近的 ρ 轴上允许的单元值。相应的累加器单元增加一个增量。在这个过程的最后， 累加单元 A(i, j)中的值 Q 就意味着 xy 平面上位于线$xcos\\theta_j+ysin\\theta_j = \\rho_i$上的点有 Q 个。在$\\rho\\theta$平面上，细分的数目决定了这些点的共线的精确度。累加器数组在工具箱中叫做霍夫变换矩阵，简称霍夫变换。\n\n## MATLAB工具箱函数\n### hough函数\n默认语法\n\n```matlab\n[H, theta, rho] = hough(f)\n```\n\nH是霍夫变换矩阵，theta和rho是$\\theta$和$\\rho$的值    \n下面这个例子可以加深对霍夫变换的理解\n\n```matlab\nf = zeros(101,101);\n\nf(1,1) = 1;\n\nf(101,1) = 1;\n\nf(1,101) = 1;\n\nf(101, 101) = 1;\n\nf(51, 51) = 1;\n\n% H = hough(f);\n\n[H, theta, rho] = hough(f);\n\nimshow(H, [],'XData', theta,'YData', rho, 'InitialMagnification', 'fit')\n\naxis on, axis normal\n\nxlabel('\\theta'),ylabel('\\rho')\n```\n\n结果:\n![](https://i.loli.net/2019/07/24/5d381e6cd3ce994397.jpg)\n观察图可以看打到三条曲线在+45度和-45度处的交点指出:f中有两组三个共线的点。两条曲线在$(\\rho,\\theta)$ = (0,-90)、(-100,-90)、(0,0)、(100,0)处的交点指出:有4组位于**垂直线**和**水平线**上的公共点\n\n### houghpeaks函数\n寻找指定的峰值数    \n默认语法\n\n```matlab\npeaks = houghpeaks(H, NumPeaks)\n```\n\nH是霍夫变换矩阵\n\n### houghlines函数\n决定线的起点和终点\n默认语法\n\n```matlab\nlines = houghlines(f, theta, rho, peaks)\n```\n\n输出lines是结构数组，长度等于找到的线段。结构中的每个元素可以看成一条线，并含有下列字段:    \n  1. point1:两元素向量[r1,c1]，指定了线段终点的行列坐标。\n  2. point2:两元素向量[r2,c2]，指定了线段其他终点的行列坐标。\n  3. theta:与线相关的霍夫变换的以度计量的角度。\n  4. rho:与线相关的霍夫变换的$\\rho$轴位置。\n\n\n### MATLAB使用霍夫变换检测和连接线\n\n```matlab\nf = imread('timg1.jpg');\n\nf = rgb2gray(f);\n\nBW = edge(f,'canny');\n\n[H ,theta, rho] = hough(BW, 'ThetaResolution', 0.2);\n\nimshow(H, [],'XData', theta,'YData', rho, 'InitialMagnification', 'fit')\n\naxis on, axis normal\n\nxlabel('\\theta'),ylabel('\\rho')\n\npeaks = houghpeaks(H, 5);\n\nhold on\n\nplot(theta(peaks( :, 2)), rho(peaks(:, 1)),...\n\n    'linestyle', 'none', 'marker', 's', 'color', 'w');\n\n\nlines = houghlines(f, theta, rho, peaks);\n\nfigure, imshow(f), hold on\n\nfor k = 1:length(lines)\n\n    xy = [lines(k).point1 ; lines(k).point2];\n\n    plot(xy(:,1), xy(:,2), 'LineWidth', 4, 'color', 'red');\n\nend\n```\n\n结果:\n![](https://i.loli.net/2019/07/24/5d381d8d80bff63571.jpg)\n![](https://i.loli.net/2019/07/24/5d381de2778c421022.jpg)\n\n","source":"_posts/霍夫变换.md","raw":"---\ntitle: 霍夫变换\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-07-26 11:53:52\npassword:\nsummary: 霍夫变换的原理、利用霍夫变换实现线检测\ntags:\n- 图像处理\n- Matlab\ncategories:\n- 算法\n---\n\n# 霍夫变换\n## 介绍与应用场景\n\n[霍夫变换](https://zh.wikipedia.org/wiki/%E9%9C%8D%E5%A4%AB%E5%8F%98%E6%8D%A2)(Hough Transform)是图像处理中的一种特征提取技术，该过程在一个参数空间中通过计算累计结果的局部最大值得到一个符合该特定形状的集合作为霍夫变换结果。经典霍夫变换用来检测图像中的直线，后来霍夫变换扩展到任意形状物体的识别，多为圆和椭圆。霍夫变换运用两个坐标空间之间的变换将在一个空间中具有相同形状的曲线或直线映射到另一个坐标空间的一个点上形成峰值，从而把检测任意形状的问题转化为统计峰值问题。\n\n## 基本原理\n考虑点$(x_i,y_i)$及通过这个点的线,有无穷多的线通过点$(x_i,y_i)$，针对a和b的一些值，满足斜截式$y_i = ax_i + b$的所有线都通过该点。该公式也可以写为$b = -ax_i + y_i$，考虑ab平面(即**参数空间**)对固定点$(x_i,y_i)$得到一条线的方程。另外，第二个点$(x_j,y_j)$也有一条在参数空间中与之相关的线，这条线和与$(x_i,y_i)$**相关**的线交于点$(a',b')$，其中$a'$是斜率，$b'$是在**xy平面**上包含点$(x_i,y_i)$和$(x_j,y_j)$的线的截距。在**参数空间**中，这条线包含的所有点都有相交于$(a',b')$点的直线。    \n简单理解，直线由两个点$A(x_1,y_1)$和$B(x_2,y_2)$定义，在参数空间中，两条直线的唯一公共点是在原图像空间中表示连接点A和B的唯一存在的直线\n![](https://i.loli.net/2019/07/24/5d38129f0e9f156720.jpg)\n因此，给定很多点，判断这些点是否共线的问题，经由霍夫变换之后，变成判断一堆曲线(每一个点在$(r, \\theta)$平面上代表一条曲线)是否 在 $(r,\\theta)$平面上相交于同一点的问题\n另外用法线表示法:\n$$xcos\\theta + ysin\\theta = \\rho$$\n水平线的$\\theta$=0,$\\rho$等于正的x的截距，垂直线的$\\theta=90$度，$\\rho$等于正的y的截距\n![](https://i.loli.net/2019/07/24/5d382004e2bab23873.jpg)\n\n在坐标(i, j)的单元位置，累加器的值是 A(i, j)，对应于参数空间坐标$(\\rho_i,\\theta_j)$的正方形。最初， 这些单元位置为零。然后，对于每个图像平面上的非背景点$(x_k,y_k)$(就是 xy 平面)，我们令 θ 等 于在 θ 轴上允许的细分值，并通过公式$\\rho = x_kcos\\theta+y_ksin\\theta$解出相应的 ρ 值。然后，得到的 ρ 值四 舍五入为最接近的 ρ 轴上允许的单元值。相应的累加器单元增加一个增量。在这个过程的最后， 累加单元 A(i, j)中的值 Q 就意味着 xy 平面上位于线$xcos\\theta_j+ysin\\theta_j = \\rho_i$上的点有 Q 个。在$\\rho\\theta$平面上，细分的数目决定了这些点的共线的精确度。累加器数组在工具箱中叫做霍夫变换矩阵，简称霍夫变换。\n\n## MATLAB工具箱函数\n### hough函数\n默认语法\n\n```matlab\n[H, theta, rho] = hough(f)\n```\n\nH是霍夫变换矩阵，theta和rho是$\\theta$和$\\rho$的值    \n下面这个例子可以加深对霍夫变换的理解\n\n```matlab\nf = zeros(101,101);\n\nf(1,1) = 1;\n\nf(101,1) = 1;\n\nf(1,101) = 1;\n\nf(101, 101) = 1;\n\nf(51, 51) = 1;\n\n% H = hough(f);\n\n[H, theta, rho] = hough(f);\n\nimshow(H, [],'XData', theta,'YData', rho, 'InitialMagnification', 'fit')\n\naxis on, axis normal\n\nxlabel('\\theta'),ylabel('\\rho')\n```\n\n结果:\n![](https://i.loli.net/2019/07/24/5d381e6cd3ce994397.jpg)\n观察图可以看打到三条曲线在+45度和-45度处的交点指出:f中有两组三个共线的点。两条曲线在$(\\rho,\\theta)$ = (0,-90)、(-100,-90)、(0,0)、(100,0)处的交点指出:有4组位于**垂直线**和**水平线**上的公共点\n\n### houghpeaks函数\n寻找指定的峰值数    \n默认语法\n\n```matlab\npeaks = houghpeaks(H, NumPeaks)\n```\n\nH是霍夫变换矩阵\n\n### houghlines函数\n决定线的起点和终点\n默认语法\n\n```matlab\nlines = houghlines(f, theta, rho, peaks)\n```\n\n输出lines是结构数组，长度等于找到的线段。结构中的每个元素可以看成一条线，并含有下列字段:    \n  1. point1:两元素向量[r1,c1]，指定了线段终点的行列坐标。\n  2. point2:两元素向量[r2,c2]，指定了线段其他终点的行列坐标。\n  3. theta:与线相关的霍夫变换的以度计量的角度。\n  4. rho:与线相关的霍夫变换的$\\rho$轴位置。\n\n\n### MATLAB使用霍夫变换检测和连接线\n\n```matlab\nf = imread('timg1.jpg');\n\nf = rgb2gray(f);\n\nBW = edge(f,'canny');\n\n[H ,theta, rho] = hough(BW, 'ThetaResolution', 0.2);\n\nimshow(H, [],'XData', theta,'YData', rho, 'InitialMagnification', 'fit')\n\naxis on, axis normal\n\nxlabel('\\theta'),ylabel('\\rho')\n\npeaks = houghpeaks(H, 5);\n\nhold on\n\nplot(theta(peaks( :, 2)), rho(peaks(:, 1)),...\n\n    'linestyle', 'none', 'marker', 's', 'color', 'w');\n\n\nlines = houghlines(f, theta, rho, peaks);\n\nfigure, imshow(f), hold on\n\nfor k = 1:length(lines)\n\n    xy = [lines(k).point1 ; lines(k).point2];\n\n    plot(xy(:,1), xy(:,2), 'LineWidth', 4, 'color', 'red');\n\nend\n```\n\n结果:\n![](https://i.loli.net/2019/07/24/5d381d8d80bff63571.jpg)\n![](https://i.loli.net/2019/07/24/5d381de2778c421022.jpg)\n\n","slug":"霍夫变换","published":1,"updated":"2020-02-24T10:49:41.450Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0tr002n74ju8penhlsj","content":"<h1 id=\"霍夫变换\"><a href=\"#霍夫变换\" class=\"headerlink\" title=\"霍夫变换\"></a>霍夫变换</h1><h2 id=\"介绍与应用场景\"><a href=\"#介绍与应用场景\" class=\"headerlink\" title=\"介绍与应用场景\"></a>介绍与应用场景</h2><p><a href=\"https://zh.wikipedia.org/wiki/%E9%9C%8D%E5%A4%AB%E5%8F%98%E6%8D%A2\" target=\"_blank\" rel=\"noopener\">霍夫变换</a>(Hough Transform)是图像处理中的一种特征提取技术，该过程在一个参数空间中通过计算累计结果的局部最大值得到一个符合该特定形状的集合作为霍夫变换结果。经典霍夫变换用来检测图像中的直线，后来霍夫变换扩展到任意形状物体的识别，多为圆和椭圆。霍夫变换运用两个坐标空间之间的变换将在一个空间中具有相同形状的曲线或直线映射到另一个坐标空间的一个点上形成峰值，从而把检测任意形状的问题转化为统计峰值问题。</p>\n<h2 id=\"基本原理\"><a href=\"#基本原理\" class=\"headerlink\" title=\"基本原理\"></a>基本原理</h2><p>考虑点$(x_i,y_i)$及通过这个点的线,有无穷多的线通过点$(x_i,y_i)$，针对a和b的一些值，满足斜截式$y_i = ax_i + b$的所有线都通过该点。该公式也可以写为$b = -ax_i + y_i$，考虑ab平面(即<strong>参数空间</strong>)对固定点$(x_i,y_i)$得到一条线的方程。另外，第二个点$(x_j,y_j)$也有一条在参数空间中与之相关的线，这条线和与$(x_i,y_i)$<strong>相关</strong>的线交于点$(a’,b’)$，其中$a’$是斜率，$b’$是在<strong>xy平面</strong>上包含点$(x_i,y_i)$和$(x_j,y_j)$的线的截距。在<strong>参数空间</strong>中，这条线包含的所有点都有相交于$(a’,b’)$点的直线。<br>简单理解，直线由两个点$A(x_1,y_1)$和$B(x_2,y_2)$定义，在参数空间中，两条直线的唯一公共点是在原图像空间中表示连接点A和B的唯一存在的直线<br><img src=\"https://i.loli.net/2019/07/24/5d38129f0e9f156720.jpg\" alt><br>因此，给定很多点，判断这些点是否共线的问题，经由霍夫变换之后，变成判断一堆曲线(每一个点在$(r, \\theta)$平面上代表一条曲线)是否 在 $(r,\\theta)$平面上相交于同一点的问题<br>另外用法线表示法:<br>$$xcos\\theta + ysin\\theta = \\rho$$<br>水平线的$\\theta$=0,$\\rho$等于正的x的截距，垂直线的$\\theta=90$度，$\\rho$等于正的y的截距<br><img src=\"https://i.loli.net/2019/07/24/5d382004e2bab23873.jpg\" alt></p>\n<p>在坐标(i, j)的单元位置，累加器的值是 A(i, j)，对应于参数空间坐标$(\\rho_i,\\theta_j)$的正方形。最初， 这些单元位置为零。然后，对于每个图像平面上的非背景点$(x_k,y_k)$(就是 xy 平面)，我们令 θ 等 于在 θ 轴上允许的细分值，并通过公式$\\rho = x_kcos\\theta+y_ksin\\theta$解出相应的 ρ 值。然后，得到的 ρ 值四 舍五入为最接近的 ρ 轴上允许的单元值。相应的累加器单元增加一个增量。在这个过程的最后， 累加单元 A(i, j)中的值 Q 就意味着 xy 平面上位于线$xcos\\theta_j+ysin\\theta_j = \\rho_i$上的点有 Q 个。在$\\rho\\theta$平面上，细分的数目决定了这些点的共线的精确度。累加器数组在工具箱中叫做霍夫变换矩阵，简称霍夫变换。</p>\n<h2 id=\"MATLAB工具箱函数\"><a href=\"#MATLAB工具箱函数\" class=\"headerlink\" title=\"MATLAB工具箱函数\"></a>MATLAB工具箱函数</h2><h3 id=\"hough函数\"><a href=\"#hough函数\" class=\"headerlink\" title=\"hough函数\"></a>hough函数</h3><p>默认语法</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token punctuation\">[</span>H<span class=\"token punctuation\">,</span> theta<span class=\"token punctuation\">,</span> rho<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">hough</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span></code></pre>\n<p>H是霍夫变换矩阵，theta和rho是$\\theta$和$\\rho$的值<br>下面这个例子可以加深对霍夫变换的理解</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">f <span class=\"token operator\">=</span> <span class=\"token function\">zeros</span><span class=\"token punctuation\">(</span><span class=\"token number\">101</span><span class=\"token punctuation\">,</span><span class=\"token number\">101</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token number\">101</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">101</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token number\">51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">51</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">% H = hough(f);</span>\n\n<span class=\"token punctuation\">[</span>H<span class=\"token punctuation\">,</span> theta<span class=\"token punctuation\">,</span> rho<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">hough</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>H<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'XData'</span><span class=\"token punctuation\">,</span> theta<span class=\"token punctuation\">,</span><span class=\"token string\">'YData'</span><span class=\"token punctuation\">,</span> rho<span class=\"token punctuation\">,</span> <span class=\"token string\">'InitialMagnification'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'fit'</span><span class=\"token punctuation\">)</span>\n\naxis on<span class=\"token punctuation\">,</span> axis normal\n\n<span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\theta'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\rho'</span><span class=\"token punctuation\">)</span></code></pre>\n<p>结果:<br><img src=\"https://i.loli.net/2019/07/24/5d381e6cd3ce994397.jpg\" alt><br>观察图可以看打到三条曲线在+45度和-45度处的交点指出:f中有两组三个共线的点。两条曲线在$(\\rho,\\theta)$ = (0,-90)、(-100,-90)、(0,0)、(100,0)处的交点指出:有4组位于<strong>垂直线</strong>和<strong>水平线</strong>上的公共点</p>\n<h3 id=\"houghpeaks函数\"><a href=\"#houghpeaks函数\" class=\"headerlink\" title=\"houghpeaks函数\"></a>houghpeaks函数</h3><p>寻找指定的峰值数<br>默认语法</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">peaks <span class=\"token operator\">=</span> <span class=\"token function\">houghpeaks</span><span class=\"token punctuation\">(</span>H<span class=\"token punctuation\">,</span> NumPeaks<span class=\"token punctuation\">)</span></code></pre>\n<p>H是霍夫变换矩阵</p>\n<h3 id=\"houghlines函数\"><a href=\"#houghlines函数\" class=\"headerlink\" title=\"houghlines函数\"></a>houghlines函数</h3><p>决定线的起点和终点<br>默认语法</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">lines <span class=\"token operator\">=</span> <span class=\"token function\">houghlines</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> theta<span class=\"token punctuation\">,</span> rho<span class=\"token punctuation\">,</span> peaks<span class=\"token punctuation\">)</span></code></pre>\n<p>输出lines是结构数组，长度等于找到的线段。结构中的每个元素可以看成一条线，并含有下列字段:    </p>\n<ol>\n<li>point1:两元素向量[r1,c1]，指定了线段终点的行列坐标。</li>\n<li>point2:两元素向量[r2,c2]，指定了线段其他终点的行列坐标。</li>\n<li>theta:与线相关的霍夫变换的以度计量的角度。</li>\n<li>rho:与线相关的霍夫变换的$\\rho$轴位置。</li>\n</ol>\n<h3 id=\"MATLAB使用霍夫变换检测和连接线\"><a href=\"#MATLAB使用霍夫变换检测和连接线\" class=\"headerlink\" title=\"MATLAB使用霍夫变换检测和连接线\"></a>MATLAB使用霍夫变换检测和连接线</h3><pre class=\" language-matlab\"><code class=\"language-matlab\">f <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">'timg1.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nf <span class=\"token operator\">=</span> <span class=\"token function\">rgb2gray</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nBW <span class=\"token operator\">=</span> <span class=\"token function\">edge</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span><span class=\"token string\">'canny'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">[</span>H <span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span> rho<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">hough</span><span class=\"token punctuation\">(</span>BW<span class=\"token punctuation\">,</span> <span class=\"token string\">'ThetaResolution'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>H<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'XData'</span><span class=\"token punctuation\">,</span> theta<span class=\"token punctuation\">,</span><span class=\"token string\">'YData'</span><span class=\"token punctuation\">,</span> rho<span class=\"token punctuation\">,</span> <span class=\"token string\">'InitialMagnification'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'fit'</span><span class=\"token punctuation\">)</span>\n\naxis on<span class=\"token punctuation\">,</span> axis normal\n\n<span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\theta'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\rho'</span><span class=\"token punctuation\">)</span>\n\npeaks <span class=\"token operator\">=</span> <span class=\"token function\">houghpeaks</span><span class=\"token punctuation\">(</span>H<span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nhold on\n\n<span class=\"token function\">plot</span><span class=\"token punctuation\">(</span><span class=\"token function\">theta</span><span class=\"token punctuation\">(</span><span class=\"token function\">peaks</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">rho</span><span class=\"token punctuation\">(</span><span class=\"token function\">peaks</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">...</span>\n\n    <span class=\"token string\">'linestyle'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'none'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'marker'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'s'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'color'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\nlines <span class=\"token operator\">=</span> <span class=\"token function\">houghlines</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> theta<span class=\"token punctuation\">,</span> rho<span class=\"token punctuation\">,</span> peaks<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nfigure<span class=\"token punctuation\">,</span> <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> hold on\n\n<span class=\"token keyword\">for</span> k <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>lines<span class=\"token punctuation\">)</span>\n\n    xy <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token function\">lines</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>point1 <span class=\"token punctuation\">;</span> <span class=\"token function\">lines</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>point2<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">plot</span><span class=\"token punctuation\">(</span><span class=\"token function\">xy</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">xy</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'LineWidth'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'color'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'red'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">end</span></code></pre>\n<p>结果:<br><img src=\"https://i.loli.net/2019/07/24/5d381d8d80bff63571.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d381de2778c421022.jpg\" alt></p>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"霍夫变换\"><a href=\"#霍夫变换\" class=\"headerlink\" title=\"霍夫变换\"></a>霍夫变换</h1><h2 id=\"介绍与应用场景\"><a href=\"#介绍与应用场景\" class=\"headerlink\" title=\"介绍与应用场景\"></a>介绍与应用场景</h2><p><a href=\"https://zh.wikipedia.org/wiki/%E9%9C%8D%E5%A4%AB%E5%8F%98%E6%8D%A2\" target=\"_blank\" rel=\"noopener\">霍夫变换</a>(Hough Transform)是图像处理中的一种特征提取技术，该过程在一个参数空间中通过计算累计结果的局部最大值得到一个符合该特定形状的集合作为霍夫变换结果。经典霍夫变换用来检测图像中的直线，后来霍夫变换扩展到任意形状物体的识别，多为圆和椭圆。霍夫变换运用两个坐标空间之间的变换将在一个空间中具有相同形状的曲线或直线映射到另一个坐标空间的一个点上形成峰值，从而把检测任意形状的问题转化为统计峰值问题。</p>\n<h2 id=\"基本原理\"><a href=\"#基本原理\" class=\"headerlink\" title=\"基本原理\"></a>基本原理</h2><p>考虑点$(x_i,y_i)$及通过这个点的线,有无穷多的线通过点$(x_i,y_i)$，针对a和b的一些值，满足斜截式$y_i = ax_i + b$的所有线都通过该点。该公式也可以写为$b = -ax_i + y_i$，考虑ab平面(即<strong>参数空间</strong>)对固定点$(x_i,y_i)$得到一条线的方程。另外，第二个点$(x_j,y_j)$也有一条在参数空间中与之相关的线，这条线和与$(x_i,y_i)$<strong>相关</strong>的线交于点$(a’,b’)$，其中$a’$是斜率，$b’$是在<strong>xy平面</strong>上包含点$(x_i,y_i)$和$(x_j,y_j)$的线的截距。在<strong>参数空间</strong>中，这条线包含的所有点都有相交于$(a’,b’)$点的直线。<br>简单理解，直线由两个点$A(x_1,y_1)$和$B(x_2,y_2)$定义，在参数空间中，两条直线的唯一公共点是在原图像空间中表示连接点A和B的唯一存在的直线<br><img src=\"https://i.loli.net/2019/07/24/5d38129f0e9f156720.jpg\" alt><br>因此，给定很多点，判断这些点是否共线的问题，经由霍夫变换之后，变成判断一堆曲线(每一个点在$(r, \\theta)$平面上代表一条曲线)是否 在 $(r,\\theta)$平面上相交于同一点的问题<br>另外用法线表示法:<br>$$xcos\\theta + ysin\\theta = \\rho$$<br>水平线的$\\theta$=0,$\\rho$等于正的x的截距，垂直线的$\\theta=90$度，$\\rho$等于正的y的截距<br><img src=\"https://i.loli.net/2019/07/24/5d382004e2bab23873.jpg\" alt></p>\n<p>在坐标(i, j)的单元位置，累加器的值是 A(i, j)，对应于参数空间坐标$(\\rho_i,\\theta_j)$的正方形。最初， 这些单元位置为零。然后，对于每个图像平面上的非背景点$(x_k,y_k)$(就是 xy 平面)，我们令 θ 等 于在 θ 轴上允许的细分值，并通过公式$\\rho = x_kcos\\theta+y_ksin\\theta$解出相应的 ρ 值。然后，得到的 ρ 值四 舍五入为最接近的 ρ 轴上允许的单元值。相应的累加器单元增加一个增量。在这个过程的最后， 累加单元 A(i, j)中的值 Q 就意味着 xy 平面上位于线$xcos\\theta_j+ysin\\theta_j = \\rho_i$上的点有 Q 个。在$\\rho\\theta$平面上，细分的数目决定了这些点的共线的精确度。累加器数组在工具箱中叫做霍夫变换矩阵，简称霍夫变换。</p>\n<h2 id=\"MATLAB工具箱函数\"><a href=\"#MATLAB工具箱函数\" class=\"headerlink\" title=\"MATLAB工具箱函数\"></a>MATLAB工具箱函数</h2><h3 id=\"hough函数\"><a href=\"#hough函数\" class=\"headerlink\" title=\"hough函数\"></a>hough函数</h3><p>默认语法</p>\n<pre><code class=\"matlab\">[H, theta, rho] = hough(f)</code></pre>\n<p>H是霍夫变换矩阵，theta和rho是$\\theta$和$\\rho$的值<br>下面这个例子可以加深对霍夫变换的理解</p>\n<pre><code class=\"matlab\">f = zeros(101,101);\n\nf(1,1) = 1;\n\nf(101,1) = 1;\n\nf(1,101) = 1;\n\nf(101, 101) = 1;\n\nf(51, 51) = 1;\n\n% H = hough(f);\n\n[H, theta, rho] = hough(f);\n\nimshow(H, [],&#39;XData&#39;, theta,&#39;YData&#39;, rho, &#39;InitialMagnification&#39;, &#39;fit&#39;)\n\naxis on, axis normal\n\nxlabel(&#39;\\theta&#39;),ylabel(&#39;\\rho&#39;)</code></pre>\n<p>结果:<br><img src=\"https://i.loli.net/2019/07/24/5d381e6cd3ce994397.jpg\" alt><br>观察图可以看打到三条曲线在+45度和-45度处的交点指出:f中有两组三个共线的点。两条曲线在$(\\rho,\\theta)$ = (0,-90)、(-100,-90)、(0,0)、(100,0)处的交点指出:有4组位于<strong>垂直线</strong>和<strong>水平线</strong>上的公共点</p>\n<h3 id=\"houghpeaks函数\"><a href=\"#houghpeaks函数\" class=\"headerlink\" title=\"houghpeaks函数\"></a>houghpeaks函数</h3><p>寻找指定的峰值数<br>默认语法</p>\n<pre><code class=\"matlab\">peaks = houghpeaks(H, NumPeaks)</code></pre>\n<p>H是霍夫变换矩阵</p>\n<h3 id=\"houghlines函数\"><a href=\"#houghlines函数\" class=\"headerlink\" title=\"houghlines函数\"></a>houghlines函数</h3><p>决定线的起点和终点<br>默认语法</p>\n<pre><code class=\"matlab\">lines = houghlines(f, theta, rho, peaks)</code></pre>\n<p>输出lines是结构数组，长度等于找到的线段。结构中的每个元素可以看成一条线，并含有下列字段:    </p>\n<ol>\n<li>point1:两元素向量[r1,c1]，指定了线段终点的行列坐标。</li>\n<li>point2:两元素向量[r2,c2]，指定了线段其他终点的行列坐标。</li>\n<li>theta:与线相关的霍夫变换的以度计量的角度。</li>\n<li>rho:与线相关的霍夫变换的$\\rho$轴位置。</li>\n</ol>\n<h3 id=\"MATLAB使用霍夫变换检测和连接线\"><a href=\"#MATLAB使用霍夫变换检测和连接线\" class=\"headerlink\" title=\"MATLAB使用霍夫变换检测和连接线\"></a>MATLAB使用霍夫变换检测和连接线</h3><pre><code class=\"matlab\">f = imread(&#39;timg1.jpg&#39;);\n\nf = rgb2gray(f);\n\nBW = edge(f,&#39;canny&#39;);\n\n[H ,theta, rho] = hough(BW, &#39;ThetaResolution&#39;, 0.2);\n\nimshow(H, [],&#39;XData&#39;, theta,&#39;YData&#39;, rho, &#39;InitialMagnification&#39;, &#39;fit&#39;)\n\naxis on, axis normal\n\nxlabel(&#39;\\theta&#39;),ylabel(&#39;\\rho&#39;)\n\npeaks = houghpeaks(H, 5);\n\nhold on\n\nplot(theta(peaks( :, 2)), rho(peaks(:, 1)),...\n\n    &#39;linestyle&#39;, &#39;none&#39;, &#39;marker&#39;, &#39;s&#39;, &#39;color&#39;, &#39;w&#39;);\n\n\nlines = houghlines(f, theta, rho, peaks);\n\nfigure, imshow(f), hold on\n\nfor k = 1:length(lines)\n\n    xy = [lines(k).point1 ; lines(k).point2];\n\n    plot(xy(:,1), xy(:,2), &#39;LineWidth&#39;, 4, &#39;color&#39;, &#39;red&#39;);\n\nend</code></pre>\n<p>结果:<br><img src=\"https://i.loli.net/2019/07/24/5d381d8d80bff63571.jpg\" alt><br><img src=\"https://i.loli.net/2019/07/24/5d381de2778c421022.jpg\" alt></p>\n"},{"title":"频域滤波","top":false,"cover":false,"img":"https://i.loli.net/2019/07/17/5d2e73bb14bd344648.png","toc":true,"mathjax":true,"date":"2019-07-19T01:53:45.000Z","password":null,"summary":"二维傅立叶变换、Matlab实现傅立叶变换及其逆变换、DFT滤波","_content":"\n# 频域滤波\n\n1. 对图像平滑的低通滤波\n2. 对图像锐化的高通滤波\n3. 去除周期的选择性滤波\n\n## 二维傅里叶变换\n- 二维傅里叶变换:\n$$ F(u,v)=\\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} f(x,y)e^{-j2\\pi(ux + vy)}\\,\\mathrm{d}x \\mathrm{d}y $$\n\n- 二维傅里叶逆变换：\n$$ f(x,y) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} F(u,v)e^{j2\\pi(ux + vy)}\\,dxdy $$\n\n## 二维离散傅里叶变换\n\nf(x,y)代表一幅大小为M×N的图像，其中x=0,1,......,M-1,y=0,1,.....,N-1,DFT如下\n\n$$ F(u,v)=\\int_{x=0}^{M-1} \\int_{y=0}^{N-1} f(x,y)e^{-j2\\pi(\\frac{ux}{M}+\\frac{vy}{N})}\\,\\mathrm{d}x \\mathrm{d}y $$\n\nIDFT：\n\n$$ f(x,y)=\\frac{1}{MN}\\int_{x=0}^{M-1} \\int_{y=0}^{N-1} F(u,v)e^{j2\\pi(\\frac{ux}{M}+\\frac{vy}{N})}\\,\\mathrm{d}x \\mathrm{d}y $$\n\n这里的F(u,v)被称为展开的傅里叶级数\n\n频域原点出的变换的值F(0,0)称为傅里叶变换的直流(dc)分量，F(0,0)等于f(0,0)平均值的MN倍。要注意的是在MATLAB中索引是从1开始的而不是从0开始的\n\n## MATLAB实现对图像的Fourier变换和逆变换\n+ Fourier变换，f为原图像\n\n```matlab\n>> F = fft2(f);\n```\n\n+ Fourier谱\n\n```matlab\n>> S = abs(F);\n```\n\n该函数计算的是数组中每个元素的幅值( $ \\sqrt{r^2+i^2} $ )\n可以在这里观察到4个角的亮点，这就是周期特性的结果，不便观察\n+ 将交换的原点移动到频域矩形的中心\n\n```matlab\n>> Fc = fftshift(F)\n```\n\n频谱范围大，不便观察\n+ 取模，缩放\n\n```matlab\nS2 = log(1 + abs(Fc));\n```\n\n+ Fourier逆变换\n\n```matlab\n>> f = ifft2(F);\n```\n\n下面是完整代码\n\n```matlab\nimg=imread('moon.jpg');\nsubplot(2,2,1);\n    imshow(img);\n    title('原图');\n\nf=rgb2gray(img);    %对于RGB图像必须做的一步，也可以用im2double函数\nF=fft2(f);          %Fourier变换\nF1=log(abs(F)+1);   %取模,缩放\nsubplot(2,2,2);\n    imshow(F1,[]);\n    title('傅里叶变换频谱图');\n\nFs=fftshift(F);      %将频谱图中零频率成分移动至频谱图中心\nS=log(abs(Fs)+1);    %取模并进行缩放\nsubplot(2,2,3);\n    imshow(S,[]);\n    title('频移后的频谱图');\n\nfr=real(ifft2(ifftshift(Fs)));  %频率域反变换到空间域，并取实部\nret=im2uint8(mat2gray(fr));    %更改图像类型\nsubplot(2,2,4);\n    imshow(ret);\n    title('逆傅里叶变换');\n```\n\n结果\n![](https://i.loli.net/2019/07/18/5d3043778b4e114553.jpg)\n如果使用`>> f = im2double(img)`进行处理，则会出现以下结果\n![](https://i.loli.net/2019/07/18/5d304377bcc9554917.jpg)\n\n- 分析    \n1. 图像Fourier变换之后立即imshow会报错\n![](https://i.loli.net/2019/07/18/5d3043779bef722309.jpg)\n这是因为经过fourier变换之后的图像矩阵为复数矩阵，包含实部和虚部，此时进行`abs(f)`取复数矩阵的模，再显示。\n2. `rgb2gray()`和`im2double()`的使用\n这一点要特别注意，对于RGB图像，`imread()`是已三维矩阵的形式来存储的，要先进行类型转换，否则会出现空白    \n3. `rgb2gray()`转换为灰度图像,得到的图像呈灰色基调，见‘结果’\n4. `im2double()`转换成双精度图像，得到的图像呈白色基调，见‘结果’\n其他图像处理结果\n![](https://i.loli.net/2019/07/18/5d304377bd0c676784.jpg)\n\n![](https://i.loli.net/2019/07/18/5d304377b0b2610307.jpg)\n可以看到Fourier逆变换处理之后的图片为原图的灰度图片。\n## 对图像Fourier变换的意义分析\n\n对于一个图像，其频率是表征图像中灰度变化剧烈程度的指标，是灰度在平面空间的梯度。设f为一个能量有限的模拟信号，其傅里叶变换代表f的频谱。从纯粹的数学意义上来看，Fourier变换是将一个函数转换成一系列的周期函数来进行处理的。从物理角度来看，Fourier变换是将图像从空间域转换到频率域，逆变换是将图像从频率域转换到空间域。也就是说，Fourier变换是将图像的灰度分布函数变换成图像的频率分布函数。**这里要注意是灰度分布函数**,下面还会说到。\n\nFourie逆变换是将图像的频率分布函数转换成灰度分布函数(原始图像的灰度分布函数),图像的概念前边说过，用一个二维矩阵来表示空间上的各点，z=f(x,y)，但空间是三维的，因此空间上的物体在另一个维度上的关系必须由梯度来表示。\n\nFourier频谱图上的明暗点，意义是指图像上的某一点与邻域点差异的强弱，即梯度的大小。\n\n对频谱移频到原点之后，可以看出图像的频率分布是以原点为圆心，对称分布的.\n\n\n## DFT滤波\n\n### 滤波步骤\n1. 用函数`tofloat`把输入图像转换成浮点图像\n```matlab\n>> [f, revertclass] = tofloat(f);\n```\n2. 用函数`paddedsize`来获得填充参数\n```matlab\n>> PQ = paddedsize(size(f));\n```\n3. 得到有填充的Fourier变换\n```matlab\n>> F = fft2(f,PQ(1), PQ(2));\n```\n4. 生成大小为PQ(1)×PQ(2)的滤波函数H,函数类型要满足如下图所示,\n![](https://i.loli.net/2019/07/19/5d318dcf343b438405.jpg)    \n如果是类似这样的\n![](https://i.loli.net/2019/07/19/5d318dcf4915275796.jpg)    \n```matlab\n>> H = lpfilter('gaussian',PQ(1),PQ(2),2*sig);\n```\n在使用滤波器之前，要先`H = fftshift(H)`\n5. 用滤波器乘以FFT变换\n```matlab\n>> G = H .* F;\n```\n6. 获得G的逆Fourier变换\n```matlab\n>> g = ifft2(G);\n```\n7. 修剪左上部矩形为原始大小\n```matlab\n>> g = g(1:size(f, 1), 1:size(f, 2));\n```\n8. 把滤波后的图像变换为输入图像的类\n```matlab\n>> g = revertclass(g);\n```\n### Matlab实现\n\n```matlab\nf = imread('1.jpg');\n\nf = rgb2gray(f);\n\n%未填充的滤波\n\n[M,N] = size(f);\n\n[f, revertclass] = tofloat(f);\n\nF = fft2(f);\n\nsig = 10;\n\nH = lpfilter('gaussian', M, N, sig);\n\nG = H.*F;\n\ng = ifft2(G);\n\ng = revertclass(g);\n\nfigure(1);\n\nsubplot(1,2,1);\n\nimshow(g)\n\ntitle('未填充的滤波');\n\n%已填充的滤波\n\nPQ = paddedsize(size(f));\n\nFp = fft2(f,PQ(1),PQ(2));\n\nHp = lpfilter('gaussian',PQ(1),PQ(2),2*sig);\n\nGp = Hp.*Fp;\n\ngp = ifft2(Gp);\n\ngpc = gp(1:size(f,1),1:size(f,2));\n\ngpc = revertclass(gpc);\n\nsubplot(1,2,2);\n\nimshow(gpc);\n\ntitle('已填充的滤波');\n```\n\n这里展示了不填充滤波和填充滤波的两种情况，结果\n![](https://i.loli.net/2019/07/19/5d318dcf1e88071166.jpg)\n可以观察到未填充滤波处理后图像的垂直边缘未模糊\n\n涉及到的函数    \n- paddedsize函数\n\n```matlab\nfunction PQ = paddedsize(AB, CD, PARAM)\n\nif nargin == 1\n\nPQ = 2*AB;\n\nelseif nargin == 2 & ~ischar(CD) %如果CD不为字符串\n\nPQ = AB + CD -1;\n\nPQ = 2 *ceil(PQ / 2);\n\nelseif nargin == 2 %如果CD处为字符串\n\nm = max(AB);\n\nP = 2^nextpow2(2*m); %取2的整数次幂\n\nPQ = [P, P];\n\nelseif nargin == 3\n\nm = max([AB CD]);\n\nP = 2^nextpow2(2*m);\n\nPQ = [P, P];\n\nelse\n\nerror('wrong number of inputs.')\n\nend\n```\n- lpfilter函数\n\n```matlab\nfunction [ H, D ] = lpfilter( type,M,N,D0,n )\n\n%LPFILTER creates the transfer function of a lowpass filter.\n\n%   Detailed explanation goes here\n\n\n\n%use function dftuv to set up the meshgrid arrays needed for computing\n\n%the required distances.\n\n[U, V] = dftuv(M,N);\n\n\n\n%compute the distances D(U,V)\n\nD = sqrt(U.^2 + V.^2);\n\n\n\n%begin filter computations\n\nswitch type\n\n    case 'ideal'\n\n        H = double(D <= D0);\n\n    case 'btw'\n\n        if nargin == 4\n\n            n = 1;\n\n        end\n\n        H = 1./(1+(D./D0).^(2*n));\n\n    case 'gaussian'\n\n        H = exp(-(D.^2)./(2*(D0^2)));\n\n    otherwise\n\n        error('Unkown filter type');\nend\n```\n- dftuv函数\n\n```matlab\nfunction [ U,V ] = dftuv( M, N )\n\n%DFTUV 实现频域滤波器的网格函数\n\n%   Detailed explanation goes here\n\nu = 0:(M - 1);\n\nv = 0:(N - 1);\n\nidx = find(u > M/2); %找大于M/2的数据\n\nu(idx) = u(idx) - M; %将大于M/2的数据减去M\n\nidy = find(v > N/2);\n\nv(idy) = v(idy) - N;\n\n[V, U] = meshgrid(v, u);\n```\n\n- 总结：\n1. 图像平滑之后，变得更柔和，但也会更模糊    \n2. 会出现的问题:图像的边缘部分往往也处于高频，会被滤除\n\n","source":"_posts/频域滤波.md","raw":"---\ntitle: 频域滤波\ntop: false\ncover: false\nimg: https://i.loli.net/2019/07/17/5d2e73bb14bd344648.png\ntoc: true\nmathjax: true\ndate: 2019-07-19 09:53:45\npassword:\nsummary: 二维傅立叶变换、Matlab实现傅立叶变换及其逆变换、DFT滤波\ntags:\n- 图像处理\n- Matlab\ncategories:\n- Digital Image Processing\n---\n\n# 频域滤波\n\n1. 对图像平滑的低通滤波\n2. 对图像锐化的高通滤波\n3. 去除周期的选择性滤波\n\n## 二维傅里叶变换\n- 二维傅里叶变换:\n$$ F(u,v)=\\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} f(x,y)e^{-j2\\pi(ux + vy)}\\,\\mathrm{d}x \\mathrm{d}y $$\n\n- 二维傅里叶逆变换：\n$$ f(x,y) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} F(u,v)e^{j2\\pi(ux + vy)}\\,dxdy $$\n\n## 二维离散傅里叶变换\n\nf(x,y)代表一幅大小为M×N的图像，其中x=0,1,......,M-1,y=0,1,.....,N-1,DFT如下\n\n$$ F(u,v)=\\int_{x=0}^{M-1} \\int_{y=0}^{N-1} f(x,y)e^{-j2\\pi(\\frac{ux}{M}+\\frac{vy}{N})}\\,\\mathrm{d}x \\mathrm{d}y $$\n\nIDFT：\n\n$$ f(x,y)=\\frac{1}{MN}\\int_{x=0}^{M-1} \\int_{y=0}^{N-1} F(u,v)e^{j2\\pi(\\frac{ux}{M}+\\frac{vy}{N})}\\,\\mathrm{d}x \\mathrm{d}y $$\n\n这里的F(u,v)被称为展开的傅里叶级数\n\n频域原点出的变换的值F(0,0)称为傅里叶变换的直流(dc)分量，F(0,0)等于f(0,0)平均值的MN倍。要注意的是在MATLAB中索引是从1开始的而不是从0开始的\n\n## MATLAB实现对图像的Fourier变换和逆变换\n+ Fourier变换，f为原图像\n\n```matlab\n>> F = fft2(f);\n```\n\n+ Fourier谱\n\n```matlab\n>> S = abs(F);\n```\n\n该函数计算的是数组中每个元素的幅值( $ \\sqrt{r^2+i^2} $ )\n可以在这里观察到4个角的亮点，这就是周期特性的结果，不便观察\n+ 将交换的原点移动到频域矩形的中心\n\n```matlab\n>> Fc = fftshift(F)\n```\n\n频谱范围大，不便观察\n+ 取模，缩放\n\n```matlab\nS2 = log(1 + abs(Fc));\n```\n\n+ Fourier逆变换\n\n```matlab\n>> f = ifft2(F);\n```\n\n下面是完整代码\n\n```matlab\nimg=imread('moon.jpg');\nsubplot(2,2,1);\n    imshow(img);\n    title('原图');\n\nf=rgb2gray(img);    %对于RGB图像必须做的一步，也可以用im2double函数\nF=fft2(f);          %Fourier变换\nF1=log(abs(F)+1);   %取模,缩放\nsubplot(2,2,2);\n    imshow(F1,[]);\n    title('傅里叶变换频谱图');\n\nFs=fftshift(F);      %将频谱图中零频率成分移动至频谱图中心\nS=log(abs(Fs)+1);    %取模并进行缩放\nsubplot(2,2,3);\n    imshow(S,[]);\n    title('频移后的频谱图');\n\nfr=real(ifft2(ifftshift(Fs)));  %频率域反变换到空间域，并取实部\nret=im2uint8(mat2gray(fr));    %更改图像类型\nsubplot(2,2,4);\n    imshow(ret);\n    title('逆傅里叶变换');\n```\n\n结果\n![](https://i.loli.net/2019/07/18/5d3043778b4e114553.jpg)\n如果使用`>> f = im2double(img)`进行处理，则会出现以下结果\n![](https://i.loli.net/2019/07/18/5d304377bcc9554917.jpg)\n\n- 分析    \n1. 图像Fourier变换之后立即imshow会报错\n![](https://i.loli.net/2019/07/18/5d3043779bef722309.jpg)\n这是因为经过fourier变换之后的图像矩阵为复数矩阵，包含实部和虚部，此时进行`abs(f)`取复数矩阵的模，再显示。\n2. `rgb2gray()`和`im2double()`的使用\n这一点要特别注意，对于RGB图像，`imread()`是已三维矩阵的形式来存储的，要先进行类型转换，否则会出现空白    \n3. `rgb2gray()`转换为灰度图像,得到的图像呈灰色基调，见‘结果’\n4. `im2double()`转换成双精度图像，得到的图像呈白色基调，见‘结果’\n其他图像处理结果\n![](https://i.loli.net/2019/07/18/5d304377bd0c676784.jpg)\n\n![](https://i.loli.net/2019/07/18/5d304377b0b2610307.jpg)\n可以看到Fourier逆变换处理之后的图片为原图的灰度图片。\n## 对图像Fourier变换的意义分析\n\n对于一个图像，其频率是表征图像中灰度变化剧烈程度的指标，是灰度在平面空间的梯度。设f为一个能量有限的模拟信号，其傅里叶变换代表f的频谱。从纯粹的数学意义上来看，Fourier变换是将一个函数转换成一系列的周期函数来进行处理的。从物理角度来看，Fourier变换是将图像从空间域转换到频率域，逆变换是将图像从频率域转换到空间域。也就是说，Fourier变换是将图像的灰度分布函数变换成图像的频率分布函数。**这里要注意是灰度分布函数**,下面还会说到。\n\nFourie逆变换是将图像的频率分布函数转换成灰度分布函数(原始图像的灰度分布函数),图像的概念前边说过，用一个二维矩阵来表示空间上的各点，z=f(x,y)，但空间是三维的，因此空间上的物体在另一个维度上的关系必须由梯度来表示。\n\nFourier频谱图上的明暗点，意义是指图像上的某一点与邻域点差异的强弱，即梯度的大小。\n\n对频谱移频到原点之后，可以看出图像的频率分布是以原点为圆心，对称分布的.\n\n\n## DFT滤波\n\n### 滤波步骤\n1. 用函数`tofloat`把输入图像转换成浮点图像\n```matlab\n>> [f, revertclass] = tofloat(f);\n```\n2. 用函数`paddedsize`来获得填充参数\n```matlab\n>> PQ = paddedsize(size(f));\n```\n3. 得到有填充的Fourier变换\n```matlab\n>> F = fft2(f,PQ(1), PQ(2));\n```\n4. 生成大小为PQ(1)×PQ(2)的滤波函数H,函数类型要满足如下图所示,\n![](https://i.loli.net/2019/07/19/5d318dcf343b438405.jpg)    \n如果是类似这样的\n![](https://i.loli.net/2019/07/19/5d318dcf4915275796.jpg)    \n```matlab\n>> H = lpfilter('gaussian',PQ(1),PQ(2),2*sig);\n```\n在使用滤波器之前，要先`H = fftshift(H)`\n5. 用滤波器乘以FFT变换\n```matlab\n>> G = H .* F;\n```\n6. 获得G的逆Fourier变换\n```matlab\n>> g = ifft2(G);\n```\n7. 修剪左上部矩形为原始大小\n```matlab\n>> g = g(1:size(f, 1), 1:size(f, 2));\n```\n8. 把滤波后的图像变换为输入图像的类\n```matlab\n>> g = revertclass(g);\n```\n### Matlab实现\n\n```matlab\nf = imread('1.jpg');\n\nf = rgb2gray(f);\n\n%未填充的滤波\n\n[M,N] = size(f);\n\n[f, revertclass] = tofloat(f);\n\nF = fft2(f);\n\nsig = 10;\n\nH = lpfilter('gaussian', M, N, sig);\n\nG = H.*F;\n\ng = ifft2(G);\n\ng = revertclass(g);\n\nfigure(1);\n\nsubplot(1,2,1);\n\nimshow(g)\n\ntitle('未填充的滤波');\n\n%已填充的滤波\n\nPQ = paddedsize(size(f));\n\nFp = fft2(f,PQ(1),PQ(2));\n\nHp = lpfilter('gaussian',PQ(1),PQ(2),2*sig);\n\nGp = Hp.*Fp;\n\ngp = ifft2(Gp);\n\ngpc = gp(1:size(f,1),1:size(f,2));\n\ngpc = revertclass(gpc);\n\nsubplot(1,2,2);\n\nimshow(gpc);\n\ntitle('已填充的滤波');\n```\n\n这里展示了不填充滤波和填充滤波的两种情况，结果\n![](https://i.loli.net/2019/07/19/5d318dcf1e88071166.jpg)\n可以观察到未填充滤波处理后图像的垂直边缘未模糊\n\n涉及到的函数    \n- paddedsize函数\n\n```matlab\nfunction PQ = paddedsize(AB, CD, PARAM)\n\nif nargin == 1\n\nPQ = 2*AB;\n\nelseif nargin == 2 & ~ischar(CD) %如果CD不为字符串\n\nPQ = AB + CD -1;\n\nPQ = 2 *ceil(PQ / 2);\n\nelseif nargin == 2 %如果CD处为字符串\n\nm = max(AB);\n\nP = 2^nextpow2(2*m); %取2的整数次幂\n\nPQ = [P, P];\n\nelseif nargin == 3\n\nm = max([AB CD]);\n\nP = 2^nextpow2(2*m);\n\nPQ = [P, P];\n\nelse\n\nerror('wrong number of inputs.')\n\nend\n```\n- lpfilter函数\n\n```matlab\nfunction [ H, D ] = lpfilter( type,M,N,D0,n )\n\n%LPFILTER creates the transfer function of a lowpass filter.\n\n%   Detailed explanation goes here\n\n\n\n%use function dftuv to set up the meshgrid arrays needed for computing\n\n%the required distances.\n\n[U, V] = dftuv(M,N);\n\n\n\n%compute the distances D(U,V)\n\nD = sqrt(U.^2 + V.^2);\n\n\n\n%begin filter computations\n\nswitch type\n\n    case 'ideal'\n\n        H = double(D <= D0);\n\n    case 'btw'\n\n        if nargin == 4\n\n            n = 1;\n\n        end\n\n        H = 1./(1+(D./D0).^(2*n));\n\n    case 'gaussian'\n\n        H = exp(-(D.^2)./(2*(D0^2)));\n\n    otherwise\n\n        error('Unkown filter type');\nend\n```\n- dftuv函数\n\n```matlab\nfunction [ U,V ] = dftuv( M, N )\n\n%DFTUV 实现频域滤波器的网格函数\n\n%   Detailed explanation goes here\n\nu = 0:(M - 1);\n\nv = 0:(N - 1);\n\nidx = find(u > M/2); %找大于M/2的数据\n\nu(idx) = u(idx) - M; %将大于M/2的数据减去M\n\nidy = find(v > N/2);\n\nv(idy) = v(idy) - N;\n\n[V, U] = meshgrid(v, u);\n```\n\n- 总结：\n1. 图像平滑之后，变得更柔和，但也会更模糊    \n2. 会出现的问题:图像的边缘部分往往也处于高频，会被滤除\n\n","slug":"频域滤波","published":1,"updated":"2020-02-24T10:49:41.450Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0ts002q74jumfm0w731","content":"<h1 id=\"频域滤波\"><a href=\"#频域滤波\" class=\"headerlink\" title=\"频域滤波\"></a>频域滤波</h1><ol>\n<li>对图像平滑的低通滤波</li>\n<li>对图像锐化的高通滤波</li>\n<li>去除周期的选择性滤波</li>\n</ol>\n<h2 id=\"二维傅里叶变换\"><a href=\"#二维傅里叶变换\" class=\"headerlink\" title=\"二维傅里叶变换\"></a>二维傅里叶变换</h2><ul>\n<li><p>二维傅里叶变换:<br>$$ F(u,v)=\\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} f(x,y)e^{-j2\\pi(ux + vy)}\\,\\mathrm{d}x \\mathrm{d}y $$</p>\n</li>\n<li><p>二维傅里叶逆变换：<br>$$ f(x,y) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} F(u,v)e^{j2\\pi(ux + vy)}\\,dxdy $$</p>\n</li>\n</ul>\n<h2 id=\"二维离散傅里叶变换\"><a href=\"#二维离散傅里叶变换\" class=\"headerlink\" title=\"二维离散傅里叶变换\"></a>二维离散傅里叶变换</h2><p>f(x,y)代表一幅大小为M×N的图像，其中x=0,1,……,M-1,y=0,1,…..,N-1,DFT如下</p>\n<p>$$ F(u,v)=\\int_{x=0}^{M-1} \\int_{y=0}^{N-1} f(x,y)e^{-j2\\pi(\\frac{ux}{M}+\\frac{vy}{N})}\\,\\mathrm{d}x \\mathrm{d}y $$</p>\n<p>IDFT：</p>\n<p>$$ f(x,y)=\\frac{1}{MN}\\int_{x=0}^{M-1} \\int_{y=0}^{N-1} F(u,v)e^{j2\\pi(\\frac{ux}{M}+\\frac{vy}{N})}\\,\\mathrm{d}x \\mathrm{d}y $$</p>\n<p>这里的F(u,v)被称为展开的傅里叶级数</p>\n<p>频域原点出的变换的值F(0,0)称为傅里叶变换的直流(dc)分量，F(0,0)等于f(0,0)平均值的MN倍。要注意的是在MATLAB中索引是从1开始的而不是从0开始的</p>\n<h2 id=\"MATLAB实现对图像的Fourier变换和逆变换\"><a href=\"#MATLAB实现对图像的Fourier变换和逆变换\" class=\"headerlink\" title=\"MATLAB实现对图像的Fourier变换和逆变换\"></a>MATLAB实现对图像的Fourier变换和逆变换</h2><ul>\n<li>Fourier变换，f为原图像</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> F <span class=\"token operator\">=</span> <span class=\"token function\">fft2</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<ul>\n<li>Fourier谱</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> S <span class=\"token operator\">=</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>该函数计算的是数组中每个元素的幅值( $ \\sqrt{r^2+i^2} $ )<br>可以在这里观察到4个角的亮点，这就是周期特性的结果，不便观察</p>\n<ul>\n<li>将交换的原点移动到频域矩形的中心</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> Fc <span class=\"token operator\">=</span> <span class=\"token function\">fftshift</span><span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">)</span></code></pre>\n<p>频谱范围大，不便观察</p>\n<ul>\n<li>取模，缩放</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">S2 <span class=\"token operator\">=</span> <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>Fc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<ul>\n<li>Fourier逆变换</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> f <span class=\"token operator\">=</span> <span class=\"token function\">ifft2</span><span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>下面是完整代码</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">img<span class=\"token operator\">=</span><span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">'moon.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'原图'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nf<span class=\"token operator\">=</span><span class=\"token function\">rgb2gray</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\" spellcheck=\"true\">%对于RGB图像必须做的一步，也可以用im2double函数</span>\nF<span class=\"token operator\">=</span><span class=\"token function\">fft2</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>          <span class=\"token comment\" spellcheck=\"true\">%Fourier变换</span>\nF1<span class=\"token operator\">=</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\" spellcheck=\"true\">%取模,缩放</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>F1<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'傅里叶变换频谱图'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nFs<span class=\"token operator\">=</span><span class=\"token function\">fftshift</span><span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>      <span class=\"token comment\" spellcheck=\"true\">%将频谱图中零频率成分移动至频谱图中心</span>\nS<span class=\"token operator\">=</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>Fs<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\" spellcheck=\"true\">%取模并进行缩放</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>S<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'频移后的频谱图'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nfr<span class=\"token operator\">=</span><span class=\"token function\">real</span><span class=\"token punctuation\">(</span><span class=\"token function\">ifft2</span><span class=\"token punctuation\">(</span><span class=\"token function\">ifftshift</span><span class=\"token punctuation\">(</span>Fs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">%频率域反变换到空间域，并取实部</span>\nret<span class=\"token operator\">=</span><span class=\"token function\">im2uint8</span><span class=\"token punctuation\">(</span><span class=\"token function\">mat2gray</span><span class=\"token punctuation\">(</span>fr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\" spellcheck=\"true\">%更改图像类型</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'逆傅里叶变换'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>结果<br><img src=\"https://i.loli.net/2019/07/18/5d3043778b4e114553.jpg\" alt><br>如果使用<code>&gt;&gt; f = im2double(img)</code>进行处理，则会出现以下结果<br><img src=\"https://i.loli.net/2019/07/18/5d304377bcc9554917.jpg\" alt></p>\n<ul>\n<li>分析    </li>\n</ul>\n<ol>\n<li>图像Fourier变换之后立即imshow会报错<br><img src=\"https://i.loli.net/2019/07/18/5d3043779bef722309.jpg\" alt><br>这是因为经过fourier变换之后的图像矩阵为复数矩阵，包含实部和虚部，此时进行<code>abs(f)</code>取复数矩阵的模，再显示。</li>\n<li><code>rgb2gray()</code>和<code>im2double()</code>的使用<br>这一点要特别注意，对于RGB图像，<code>imread()</code>是已三维矩阵的形式来存储的，要先进行类型转换，否则会出现空白    </li>\n<li><code>rgb2gray()</code>转换为灰度图像,得到的图像呈灰色基调，见‘结果’</li>\n<li><code>im2double()</code>转换成双精度图像，得到的图像呈白色基调，见‘结果’<br>其他图像处理结果<br><img src=\"https://i.loli.net/2019/07/18/5d304377bd0c676784.jpg\" alt></li>\n</ol>\n<p><img src=\"https://i.loli.net/2019/07/18/5d304377b0b2610307.jpg\" alt><br>可以看到Fourier逆变换处理之后的图片为原图的灰度图片。</p>\n<h2 id=\"对图像Fourier变换的意义分析\"><a href=\"#对图像Fourier变换的意义分析\" class=\"headerlink\" title=\"对图像Fourier变换的意义分析\"></a>对图像Fourier变换的意义分析</h2><p>对于一个图像，其频率是表征图像中灰度变化剧烈程度的指标，是灰度在平面空间的梯度。设f为一个能量有限的模拟信号，其傅里叶变换代表f的频谱。从纯粹的数学意义上来看，Fourier变换是将一个函数转换成一系列的周期函数来进行处理的。从物理角度来看，Fourier变换是将图像从空间域转换到频率域，逆变换是将图像从频率域转换到空间域。也就是说，Fourier变换是将图像的灰度分布函数变换成图像的频率分布函数。<strong>这里要注意是灰度分布函数</strong>,下面还会说到。</p>\n<p>Fourie逆变换是将图像的频率分布函数转换成灰度分布函数(原始图像的灰度分布函数),图像的概念前边说过，用一个二维矩阵来表示空间上的各点，z=f(x,y)，但空间是三维的，因此空间上的物体在另一个维度上的关系必须由梯度来表示。</p>\n<p>Fourier频谱图上的明暗点，意义是指图像上的某一点与邻域点差异的强弱，即梯度的大小。</p>\n<p>对频谱移频到原点之后，可以看出图像的频率分布是以原点为圆心，对称分布的.</p>\n<h2 id=\"DFT滤波\"><a href=\"#DFT滤波\" class=\"headerlink\" title=\"DFT滤波\"></a>DFT滤波</h2><h3 id=\"滤波步骤\"><a href=\"#滤波步骤\" class=\"headerlink\" title=\"滤波步骤\"></a>滤波步骤</h3><ol>\n<li>用函数<code>tofloat</code>把输入图像转换成浮点图像<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> <span class=\"token punctuation\">[</span>f<span class=\"token punctuation\">,</span> revertclass<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">tofloat</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</li>\n<li>用函数<code>paddedsize</code>来获得填充参数<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> PQ <span class=\"token operator\">=</span> <span class=\"token function\">paddedsize</span><span class=\"token punctuation\">(</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</li>\n<li>得到有填充的Fourier变换<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> F <span class=\"token operator\">=</span> <span class=\"token function\">fft2</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span><span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</li>\n<li>生成大小为PQ(1)×PQ(2)的滤波函数H,函数类型要满足如下图所示,<br><img src=\"https://i.loli.net/2019/07/19/5d318dcf343b438405.jpg\" alt><br>如果是类似这样的<br><img src=\"https://i.loli.net/2019/07/19/5d318dcf4915275796.jpg\" alt>    <pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> H <span class=\"token operator\">=</span> <span class=\"token function\">lpfilter</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gaussian'</span><span class=\"token punctuation\">,</span><span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>sig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n在使用滤波器之前，要先<code>H = fftshift(H)</code></li>\n<li>用滤波器乘以FFT变换<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> G <span class=\"token operator\">=</span> H <span class=\"token operator\">.*</span> F<span class=\"token punctuation\">;</span></code></pre>\n</li>\n<li>获得G的逆Fourier变换<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> g <span class=\"token operator\">=</span> <span class=\"token function\">ifft2</span><span class=\"token punctuation\">(</span>G<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</li>\n<li>修剪左上部矩形为原始大小<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> g <span class=\"token operator\">=</span> <span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</li>\n<li>把滤波后的图像变换为输入图像的类<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token operator\">></span><span class=\"token operator\">></span> g <span class=\"token operator\">=</span> <span class=\"token function\">revertclass</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<h3 id=\"Matlab实现\"><a href=\"#Matlab实现\" class=\"headerlink\" title=\"Matlab实现\"></a>Matlab实现</h3></li>\n</ol>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">f <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nf <span class=\"token operator\">=</span> <span class=\"token function\">rgb2gray</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%未填充的滤波</span>\n\n<span class=\"token punctuation\">[</span>M<span class=\"token punctuation\">,</span>N<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">size</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">[</span>f<span class=\"token punctuation\">,</span> revertclass<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">tofloat</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nF <span class=\"token operator\">=</span> <span class=\"token function\">fft2</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nsig <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\n\nH <span class=\"token operator\">=</span> <span class=\"token function\">lpfilter</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gaussian'</span><span class=\"token punctuation\">,</span> M<span class=\"token punctuation\">,</span> N<span class=\"token punctuation\">,</span> sig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nG <span class=\"token operator\">=</span> H<span class=\"token operator\">.*</span>F<span class=\"token punctuation\">;</span>\n\ng <span class=\"token operator\">=</span> <span class=\"token function\">ifft2</span><span class=\"token punctuation\">(</span>G<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ng <span class=\"token operator\">=</span> <span class=\"token function\">revertclass</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'未填充的滤波'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%已填充的滤波</span>\n\nPQ <span class=\"token operator\">=</span> <span class=\"token function\">paddedsize</span><span class=\"token punctuation\">(</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nFp <span class=\"token operator\">=</span> <span class=\"token function\">fft2</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span><span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nHp <span class=\"token operator\">=</span> <span class=\"token function\">lpfilter</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gaussian'</span><span class=\"token punctuation\">,</span><span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>sig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nGp <span class=\"token operator\">=</span> Hp<span class=\"token operator\">.*</span>Fp<span class=\"token punctuation\">;</span>\n\ngp <span class=\"token operator\">=</span> <span class=\"token function\">ifft2</span><span class=\"token punctuation\">(</span>Gp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ngpc <span class=\"token operator\">=</span> <span class=\"token function\">gp</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ngpc <span class=\"token operator\">=</span> <span class=\"token function\">revertclass</span><span class=\"token punctuation\">(</span>gpc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>gpc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'已填充的滤波'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>这里展示了不填充滤波和填充滤波的两种情况，结果<br><img src=\"https://i.loli.net/2019/07/19/5d318dcf1e88071166.jpg\" alt><br>可以观察到未填充滤波处理后图像的垂直边缘未模糊</p>\n<p>涉及到的函数    </p>\n<ul>\n<li>paddedsize函数</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token keyword\">function</span> PQ <span class=\"token operator\">=</span> <span class=\"token function\">paddedsize</span><span class=\"token punctuation\">(</span>AB<span class=\"token punctuation\">,</span> CD<span class=\"token punctuation\">,</span> PARAM<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> nargin <span class=\"token operator\">==</span> <span class=\"token number\">1</span>\n\nPQ <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>AB<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">elseif</span> nargin <span class=\"token operator\">==</span> <span class=\"token number\">2</span> <span class=\"token operator\">&amp;</span> <span class=\"token operator\">~</span><span class=\"token function\">ischar</span><span class=\"token punctuation\">(</span>CD<span class=\"token punctuation\">)</span> <span class=\"token comment\" spellcheck=\"true\">%如果CD不为字符串</span>\n\nPQ <span class=\"token operator\">=</span> AB <span class=\"token operator\">+</span> CD <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\nPQ <span class=\"token operator\">=</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>PQ <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">elseif</span> nargin <span class=\"token operator\">==</span> <span class=\"token number\">2</span> <span class=\"token comment\" spellcheck=\"true\">%如果CD处为字符串</span>\n\nm <span class=\"token operator\">=</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span>AB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nP <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token operator\">^</span><span class=\"token function\">nextpow2</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">%取2的整数次幂</span>\n\nPQ <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>P<span class=\"token punctuation\">,</span> P<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">elseif</span> nargin <span class=\"token operator\">==</span> <span class=\"token number\">3</span>\n\nm <span class=\"token operator\">=</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>AB CD<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nP <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token operator\">^</span><span class=\"token function\">nextpow2</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nPQ <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>P<span class=\"token punctuation\">,</span> P<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">else</span>\n\n<span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'wrong number of inputs.'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">end</span></code></pre>\n<ul>\n<li>lpfilter函数</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token keyword\">function</span> <span class=\"token punctuation\">[</span> H<span class=\"token punctuation\">,</span> D <span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">lpfilter</span><span class=\"token punctuation\">(</span> type<span class=\"token punctuation\">,</span>M<span class=\"token punctuation\">,</span>N<span class=\"token punctuation\">,</span>D0<span class=\"token punctuation\">,</span>n <span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%LPFILTER creates the transfer function of a lowpass filter.</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%   Detailed explanation goes here</span>\n\n\n\n<span class=\"token comment\" spellcheck=\"true\">%use function dftuv to set up the meshgrid arrays needed for computing</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%the required distances.</span>\n\n<span class=\"token punctuation\">[</span>U<span class=\"token punctuation\">,</span> V<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">dftuv</span><span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">,</span>N<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n\n<span class=\"token comment\" spellcheck=\"true\">%compute the distances D(U,V)</span>\n\nD <span class=\"token operator\">=</span> <span class=\"token function\">sqrt</span><span class=\"token punctuation\">(</span>U<span class=\"token operator\">.^</span><span class=\"token number\">2</span> <span class=\"token operator\">+</span> V<span class=\"token operator\">.^</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n\n<span class=\"token comment\" spellcheck=\"true\">%begin filter computations</span>\n\n<span class=\"token keyword\">switch</span> type\n\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'ideal'</span>\n\n        H <span class=\"token operator\">=</span> <span class=\"token function\">double</span><span class=\"token punctuation\">(</span>D <span class=\"token operator\">&lt;=</span> D0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'btw'</span>\n\n        <span class=\"token keyword\">if</span> nargin <span class=\"token operator\">==</span> <span class=\"token number\">4</span>\n\n            n <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">end</span>\n\n        H <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token operator\">./</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>D<span class=\"token operator\">./</span>D0<span class=\"token punctuation\">)</span><span class=\"token operator\">.^</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'gaussian'</span>\n\n        H <span class=\"token operator\">=</span> <span class=\"token function\">exp</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token punctuation\">(</span>D<span class=\"token operator\">.^</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">./</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>D0<span class=\"token operator\">^</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">otherwise</span>\n\n        <span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Unkown filter type'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">end</span></code></pre>\n<ul>\n<li>dftuv函数</li>\n</ul>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token keyword\">function</span> <span class=\"token punctuation\">[</span> U<span class=\"token punctuation\">,</span>V <span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">dftuv</span><span class=\"token punctuation\">(</span> M<span class=\"token punctuation\">,</span> N <span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%DFTUV 实现频域滤波器的网格函数</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%   Detailed explanation goes here</span>\n\nu <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>M <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nv <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>N <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nidx <span class=\"token operator\">=</span> <span class=\"token function\">find</span><span class=\"token punctuation\">(</span>u <span class=\"token operator\">></span> M<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">%找大于M/2的数据</span>\n\n<span class=\"token function\">u</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">u</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> M<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">%将大于M/2的数据减去M</span>\n\nidy <span class=\"token operator\">=</span> <span class=\"token function\">find</span><span class=\"token punctuation\">(</span>v <span class=\"token operator\">></span> N<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">v</span><span class=\"token punctuation\">(</span>idy<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">v</span><span class=\"token punctuation\">(</span>idy<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> N<span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">[</span>V<span class=\"token punctuation\">,</span> U<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">meshgrid</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">,</span> u<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<ul>\n<li>总结：</li>\n</ul>\n<ol>\n<li>图像平滑之后，变得更柔和，但也会更模糊    </li>\n<li>会出现的问题:图像的边缘部分往往也处于高频，会被滤除</li>\n</ol>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"频域滤波\"><a href=\"#频域滤波\" class=\"headerlink\" title=\"频域滤波\"></a>频域滤波</h1><ol>\n<li>对图像平滑的低通滤波</li>\n<li>对图像锐化的高通滤波</li>\n<li>去除周期的选择性滤波</li>\n</ol>\n<h2 id=\"二维傅里叶变换\"><a href=\"#二维傅里叶变换\" class=\"headerlink\" title=\"二维傅里叶变换\"></a>二维傅里叶变换</h2><ul>\n<li><p>二维傅里叶变换:<br>$$ F(u,v)=\\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} f(x,y)e^{-j2\\pi(ux + vy)}\\,\\mathrm{d}x \\mathrm{d}y $$</p>\n</li>\n<li><p>二维傅里叶逆变换：<br>$$ f(x,y) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} F(u,v)e^{j2\\pi(ux + vy)}\\,dxdy $$</p>\n</li>\n</ul>\n<h2 id=\"二维离散傅里叶变换\"><a href=\"#二维离散傅里叶变换\" class=\"headerlink\" title=\"二维离散傅里叶变换\"></a>二维离散傅里叶变换</h2><p>f(x,y)代表一幅大小为M×N的图像，其中x=0,1,……,M-1,y=0,1,…..,N-1,DFT如下</p>\n<p>$$ F(u,v)=\\int_{x=0}^{M-1} \\int_{y=0}^{N-1} f(x,y)e^{-j2\\pi(\\frac{ux}{M}+\\frac{vy}{N})}\\,\\mathrm{d}x \\mathrm{d}y $$</p>\n<p>IDFT：</p>\n<p>$$ f(x,y)=\\frac{1}{MN}\\int_{x=0}^{M-1} \\int_{y=0}^{N-1} F(u,v)e^{j2\\pi(\\frac{ux}{M}+\\frac{vy}{N})}\\,\\mathrm{d}x \\mathrm{d}y $$</p>\n<p>这里的F(u,v)被称为展开的傅里叶级数</p>\n<p>频域原点出的变换的值F(0,0)称为傅里叶变换的直流(dc)分量，F(0,0)等于f(0,0)平均值的MN倍。要注意的是在MATLAB中索引是从1开始的而不是从0开始的</p>\n<h2 id=\"MATLAB实现对图像的Fourier变换和逆变换\"><a href=\"#MATLAB实现对图像的Fourier变换和逆变换\" class=\"headerlink\" title=\"MATLAB实现对图像的Fourier变换和逆变换\"></a>MATLAB实现对图像的Fourier变换和逆变换</h2><ul>\n<li>Fourier变换，f为原图像</li>\n</ul>\n<pre><code class=\"matlab\">&gt;&gt; F = fft2(f);</code></pre>\n<ul>\n<li>Fourier谱</li>\n</ul>\n<pre><code class=\"matlab\">&gt;&gt; S = abs(F);</code></pre>\n<p>该函数计算的是数组中每个元素的幅值( $ \\sqrt{r^2+i^2} $ )<br>可以在这里观察到4个角的亮点，这就是周期特性的结果，不便观察</p>\n<ul>\n<li>将交换的原点移动到频域矩形的中心</li>\n</ul>\n<pre><code class=\"matlab\">&gt;&gt; Fc = fftshift(F)</code></pre>\n<p>频谱范围大，不便观察</p>\n<ul>\n<li>取模，缩放</li>\n</ul>\n<pre><code class=\"matlab\">S2 = log(1 + abs(Fc));</code></pre>\n<ul>\n<li>Fourier逆变换</li>\n</ul>\n<pre><code class=\"matlab\">&gt;&gt; f = ifft2(F);</code></pre>\n<p>下面是完整代码</p>\n<pre><code class=\"matlab\">img=imread(&#39;moon.jpg&#39;);\nsubplot(2,2,1);\n    imshow(img);\n    title(&#39;原图&#39;);\n\nf=rgb2gray(img);    %对于RGB图像必须做的一步，也可以用im2double函数\nF=fft2(f);          %Fourier变换\nF1=log(abs(F)+1);   %取模,缩放\nsubplot(2,2,2);\n    imshow(F1,[]);\n    title(&#39;傅里叶变换频谱图&#39;);\n\nFs=fftshift(F);      %将频谱图中零频率成分移动至频谱图中心\nS=log(abs(Fs)+1);    %取模并进行缩放\nsubplot(2,2,3);\n    imshow(S,[]);\n    title(&#39;频移后的频谱图&#39;);\n\nfr=real(ifft2(ifftshift(Fs)));  %频率域反变换到空间域，并取实部\nret=im2uint8(mat2gray(fr));    %更改图像类型\nsubplot(2,2,4);\n    imshow(ret);\n    title(&#39;逆傅里叶变换&#39;);</code></pre>\n<p>结果<br><img src=\"https://i.loli.net/2019/07/18/5d3043778b4e114553.jpg\" alt><br>如果使用<code>&gt;&gt; f = im2double(img)</code>进行处理，则会出现以下结果<br><img src=\"https://i.loli.net/2019/07/18/5d304377bcc9554917.jpg\" alt></p>\n<ul>\n<li>分析    </li>\n</ul>\n<ol>\n<li>图像Fourier变换之后立即imshow会报错<br><img src=\"https://i.loli.net/2019/07/18/5d3043779bef722309.jpg\" alt><br>这是因为经过fourier变换之后的图像矩阵为复数矩阵，包含实部和虚部，此时进行<code>abs(f)</code>取复数矩阵的模，再显示。</li>\n<li><code>rgb2gray()</code>和<code>im2double()</code>的使用<br>这一点要特别注意，对于RGB图像，<code>imread()</code>是已三维矩阵的形式来存储的，要先进行类型转换，否则会出现空白    </li>\n<li><code>rgb2gray()</code>转换为灰度图像,得到的图像呈灰色基调，见‘结果’</li>\n<li><code>im2double()</code>转换成双精度图像，得到的图像呈白色基调，见‘结果’<br>其他图像处理结果<br><img src=\"https://i.loli.net/2019/07/18/5d304377bd0c676784.jpg\" alt></li>\n</ol>\n<p><img src=\"https://i.loli.net/2019/07/18/5d304377b0b2610307.jpg\" alt><br>可以看到Fourier逆变换处理之后的图片为原图的灰度图片。</p>\n<h2 id=\"对图像Fourier变换的意义分析\"><a href=\"#对图像Fourier变换的意义分析\" class=\"headerlink\" title=\"对图像Fourier变换的意义分析\"></a>对图像Fourier变换的意义分析</h2><p>对于一个图像，其频率是表征图像中灰度变化剧烈程度的指标，是灰度在平面空间的梯度。设f为一个能量有限的模拟信号，其傅里叶变换代表f的频谱。从纯粹的数学意义上来看，Fourier变换是将一个函数转换成一系列的周期函数来进行处理的。从物理角度来看，Fourier变换是将图像从空间域转换到频率域，逆变换是将图像从频率域转换到空间域。也就是说，Fourier变换是将图像的灰度分布函数变换成图像的频率分布函数。<strong>这里要注意是灰度分布函数</strong>,下面还会说到。</p>\n<p>Fourie逆变换是将图像的频率分布函数转换成灰度分布函数(原始图像的灰度分布函数),图像的概念前边说过，用一个二维矩阵来表示空间上的各点，z=f(x,y)，但空间是三维的，因此空间上的物体在另一个维度上的关系必须由梯度来表示。</p>\n<p>Fourier频谱图上的明暗点，意义是指图像上的某一点与邻域点差异的强弱，即梯度的大小。</p>\n<p>对频谱移频到原点之后，可以看出图像的频率分布是以原点为圆心，对称分布的.</p>\n<h2 id=\"DFT滤波\"><a href=\"#DFT滤波\" class=\"headerlink\" title=\"DFT滤波\"></a>DFT滤波</h2><h3 id=\"滤波步骤\"><a href=\"#滤波步骤\" class=\"headerlink\" title=\"滤波步骤\"></a>滤波步骤</h3><ol>\n<li>用函数<code>tofloat</code>把输入图像转换成浮点图像<pre><code class=\"matlab\">&gt;&gt; [f, revertclass] = tofloat(f);</code></pre>\n</li>\n<li>用函数<code>paddedsize</code>来获得填充参数<pre><code class=\"matlab\">&gt;&gt; PQ = paddedsize(size(f));</code></pre>\n</li>\n<li>得到有填充的Fourier变换<pre><code class=\"matlab\">&gt;&gt; F = fft2(f,PQ(1), PQ(2));</code></pre>\n</li>\n<li>生成大小为PQ(1)×PQ(2)的滤波函数H,函数类型要满足如下图所示,<br><img src=\"https://i.loli.net/2019/07/19/5d318dcf343b438405.jpg\" alt><br>如果是类似这样的<br><img src=\"https://i.loli.net/2019/07/19/5d318dcf4915275796.jpg\" alt>    <pre><code class=\"matlab\">&gt;&gt; H = lpfilter(&#39;gaussian&#39;,PQ(1),PQ(2),2*sig);</code></pre>\n在使用滤波器之前，要先<code>H = fftshift(H)</code></li>\n<li>用滤波器乘以FFT变换<pre><code class=\"matlab\">&gt;&gt; G = H .* F;</code></pre>\n</li>\n<li>获得G的逆Fourier变换<pre><code class=\"matlab\">&gt;&gt; g = ifft2(G);</code></pre>\n</li>\n<li>修剪左上部矩形为原始大小<pre><code class=\"matlab\">&gt;&gt; g = g(1:size(f, 1), 1:size(f, 2));</code></pre>\n</li>\n<li>把滤波后的图像变换为输入图像的类<pre><code class=\"matlab\">&gt;&gt; g = revertclass(g);</code></pre>\n<h3 id=\"Matlab实现\"><a href=\"#Matlab实现\" class=\"headerlink\" title=\"Matlab实现\"></a>Matlab实现</h3></li>\n</ol>\n<pre><code class=\"matlab\">f = imread(&#39;1.jpg&#39;);\n\nf = rgb2gray(f);\n\n%未填充的滤波\n\n[M,N] = size(f);\n\n[f, revertclass] = tofloat(f);\n\nF = fft2(f);\n\nsig = 10;\n\nH = lpfilter(&#39;gaussian&#39;, M, N, sig);\n\nG = H.*F;\n\ng = ifft2(G);\n\ng = revertclass(g);\n\nfigure(1);\n\nsubplot(1,2,1);\n\nimshow(g)\n\ntitle(&#39;未填充的滤波&#39;);\n\n%已填充的滤波\n\nPQ = paddedsize(size(f));\n\nFp = fft2(f,PQ(1),PQ(2));\n\nHp = lpfilter(&#39;gaussian&#39;,PQ(1),PQ(2),2*sig);\n\nGp = Hp.*Fp;\n\ngp = ifft2(Gp);\n\ngpc = gp(1:size(f,1),1:size(f,2));\n\ngpc = revertclass(gpc);\n\nsubplot(1,2,2);\n\nimshow(gpc);\n\ntitle(&#39;已填充的滤波&#39;);</code></pre>\n<p>这里展示了不填充滤波和填充滤波的两种情况，结果<br><img src=\"https://i.loli.net/2019/07/19/5d318dcf1e88071166.jpg\" alt><br>可以观察到未填充滤波处理后图像的垂直边缘未模糊</p>\n<p>涉及到的函数    </p>\n<ul>\n<li>paddedsize函数</li>\n</ul>\n<pre><code class=\"matlab\">function PQ = paddedsize(AB, CD, PARAM)\n\nif nargin == 1\n\nPQ = 2*AB;\n\nelseif nargin == 2 &amp; ~ischar(CD) %如果CD不为字符串\n\nPQ = AB + CD -1;\n\nPQ = 2 *ceil(PQ / 2);\n\nelseif nargin == 2 %如果CD处为字符串\n\nm = max(AB);\n\nP = 2^nextpow2(2*m); %取2的整数次幂\n\nPQ = [P, P];\n\nelseif nargin == 3\n\nm = max([AB CD]);\n\nP = 2^nextpow2(2*m);\n\nPQ = [P, P];\n\nelse\n\nerror(&#39;wrong number of inputs.&#39;)\n\nend</code></pre>\n<ul>\n<li>lpfilter函数</li>\n</ul>\n<pre><code class=\"matlab\">function [ H, D ] = lpfilter( type,M,N,D0,n )\n\n%LPFILTER creates the transfer function of a lowpass filter.\n\n%   Detailed explanation goes here\n\n\n\n%use function dftuv to set up the meshgrid arrays needed for computing\n\n%the required distances.\n\n[U, V] = dftuv(M,N);\n\n\n\n%compute the distances D(U,V)\n\nD = sqrt(U.^2 + V.^2);\n\n\n\n%begin filter computations\n\nswitch type\n\n    case &#39;ideal&#39;\n\n        H = double(D &lt;= D0);\n\n    case &#39;btw&#39;\n\n        if nargin == 4\n\n            n = 1;\n\n        end\n\n        H = 1./(1+(D./D0).^(2*n));\n\n    case &#39;gaussian&#39;\n\n        H = exp(-(D.^2)./(2*(D0^2)));\n\n    otherwise\n\n        error(&#39;Unkown filter type&#39;);\nend</code></pre>\n<ul>\n<li>dftuv函数</li>\n</ul>\n<pre><code class=\"matlab\">function [ U,V ] = dftuv( M, N )\n\n%DFTUV 实现频域滤波器的网格函数\n\n%   Detailed explanation goes here\n\nu = 0:(M - 1);\n\nv = 0:(N - 1);\n\nidx = find(u &gt; M/2); %找大于M/2的数据\n\nu(idx) = u(idx) - M; %将大于M/2的数据减去M\n\nidy = find(v &gt; N/2);\n\nv(idy) = v(idy) - N;\n\n[V, U] = meshgrid(v, u);</code></pre>\n<ul>\n<li>总结：</li>\n</ul>\n<ol>\n<li>图像平滑之后，变得更柔和，但也会更模糊    </li>\n<li>会出现的问题:图像的边缘部分往往也处于高频，会被滤除</li>\n</ol>\n"},{"title":"频域滤波器及其应用","top":false,"cover":false,"img":"https://i.loli.net/2019/07/17/5d2e73bb14bd344648.png","toc":true,"mathjax":true,"date":"2019-07-20T02:54:08.000Z","password":null,"summary":"各种滤波器的原理及Matlab实现","_content":"\n# 频域滤波器\n\n## 低通滤波器\n\n### 理想低通滤波器\n\n在以原点为圆心，以$D_0$为半径的圆内无衰减通过所有频率，而在圆外切断所有频率的二维低通滤波器，称为理想低通滤波器(ILPF)，定义为\n$$y=\\begin{cases}\n1,\\quad D(x,y)\\leq 0\\\\\n0, \\quad D(x,y) > 0\n\\end{cases}$$\n$D_0$是一个常数，D(u,v)是频率域中心点(u,v)与频率矩形中心的距离，即\n$$ D(u,v)=\\lbrack{(u-\\frac{P}{2})^2+(v-\\frac{Q}{2})^2}\\rbrack^\\frac{1}{2} $$\n过渡点称为**截止频率**\n![](https://i.loli.net/2019/07/21/5d341bf1f0cb755202.jpg)\n\n### 布特沃斯低通滤波器\n截止频率位于距原点$D_0$处的n阶布特沃斯低通滤波器(BLPF)的传递函数的定义为:\n$$H(u,v)=\\frac{1}{1+{[D(u,v)/D_0]}^{2n}}$$\n截止频率点是当D(u,v) = $D_0$时的点\n![](https://i.loli.net/2019/07/21/5d341bf1f101518273.jpg)\n\n### 高斯低通滤波器\n二维形式:\n$$H(u,v) = e^{-D^2(u,v)/2{D_0}^2} $$\n$D_0$ 是截止频率\n![](https://i.loli.net/2019/07/21/5d341bf1f163e99741.jpg)\n\n### 使用低通滤波器平滑图像\n\n#### 1. 高斯低通滤波器\n\n```matlab\nf = imread('1.jpg');\nf = rgb2gray(f);\n[f, revertclass] = tofloat(f);\nPQ = paddedsize(size(f));\n[U, V] = dftuv(PQ(1), PQ(2));\nD = hypot(U, V);\nD0 = 0.05*PQ(2);\nF = fft2(f, PQ(1), PQ(2));\nH = exp(-(D .^ 2)/(2 * (D0^2))); %高斯低通滤波器\ng = dftfilt(f, H);\ng = revertclass(g);\nfigure, imshow(fftshift(H));\nfigure, imshow(log(1 + abs(fftshift(F))), [])\nfigure, imshow(g);\n```\n\n滤波结果：\n![](https://i.loli.net/2019/07/20/5d32d02f5468855048.jpg)\n\n除了之前说的几个M函数外，还需要用到`dftfilt()`函数\n\n```matlab\nfunction g=dftfilt(f,H)\n%DFTFILT Performs frequency domain filtering.\n%   G=DFTFILT(F,H) filters F in the frequency domain using the\n%   filter transfer function H. The output, G, is the filtered\n%   image, which has the same size as F. DFTFILT automatically pads\n%   F to be the same size as H. Function PADDEDSIZE can be used\n%   to determine an appropriate size for H.\n%\n%   DFTFILT assumes that F is real and that H is a real, uncentered,\n%   circularly-symmetric filter function.\n\n%Obtain the FFT of the padded input.\nF=fft2(f,size(H,1),size(H,2));\n\n%Perform filtering.\ng=real(ifft2(H.*F));\n\n%Crop to original size.\ng=g(1:size(f,1),1:size(f,2));\n```\n\n#### 2. Butterworth滤波\n\n该函数输入为灰度图像，自由设置截止频率$D_0$和BLPF的阶数n，输出为滤波后的图像(已归一化到[0,255])\n\n```matlab\nfunction [image_out] = Bfilter(image_in, D0, N)\n% Butterworth滤波器，在频率域进行滤波\n% 输入为需要进行滤波的灰度图像，Butterworth滤波器的截止频率D0，阶数N\n% 输出为滤波之后的灰度图像\n\n[m, n] = size(image_in);\nP = 2 * m;\nQ = 2 * n;\n\nfp = zeros(P, Q);\n%对图像填充0,并且乘以(-1)^(x+y) 以移到变换中心\nfor i = 1 : m\n    for j = 1 : n\n        fp(i, j) = double(image_in(i, j)) * (-1)^(i+j);\n    end\nend\n% 对填充后的图像进行傅里叶变换\nF1 = fft2(fp);\n\n% 生成Butterworth滤波函数，中心在(m+1,n+1)\nBw = zeros(P, Q);\na = D0^(2 * N);\nfor u = 1 : P\n    for v = 1 : Q\n        temp = (u-(m+1.0))^2 + (v-(n+1.0))^2;\n        Bw(u, v) = 1 / (1 + (temp^N) / a);\n    end\nend\n\n%进行滤波\nG = F1 .* Bw;\n\n% 反傅里叶变换\ngp = ifft2(G);\n\n% 处理得到的图像\nimage_out = zeros(m, n, 'uint8');\ngp = real(gp);\ng = zeros(m, n);\nfor i = 1 : m\n    for j = 1 : n\n        g(i, j) = gp(i, j) * (-1)^(i+j);\n        \n    end\nend\nmmax = max(g(:));\nmmin = min(g(:));\nrange = mmax-mmin;\nfor i = 1 : m\n    for j = 1 : n\n        image_out(i,j) = uint8(255 * (g(i, j)-mmin) / range);\n    end\nend\nend\n```\n\n测试BLPF的阶数为2,截止频率分别为10,40,80,150,450\n\n```matlab\nclear all;\nclose all;\nclc;\n\nimage1 = imread('2.jpg');\n\nimage2 = Bfilter(image1, 10, 2);\nimage3 = Bfilter(image1, 40, 2);\nimage4 = Bfilter(image1, 80, 2);\nimage5 = Bfilter(image1, 150, 2);\nimage6 = Bfilter(image1, 450, 2);\n\n% 显示图像\nsubplot(2,3,1), imshow(image1), title('原图像');\nsubplot(2,3,2), imshow(image2), title('D0 = 10, n = 2');\nsubplot(2,3,3), imshow(image3), title('D0 = 40, n = 2');\nsubplot(2,3,4), imshow(image4), title('D0 = 80, n = 2');\nsubplot(2,3,5), imshow(image5), title('D0 = 150, n = 2');\nsubplot(2,3,6), imshow(image6), title('D0 = 450, n = 2');\n```\n\n滤波结果如下:\n![](https://i.loli.net/2019/07/20/5d32d02f43bc610556.jpg)\n分析结果:    \n1. 模糊的平滑过渡是截止频率增大的函数\n2. 滤波后输出三副连续的色图，原因是rgb图像的分三次呈现    \n   一副彩图是由三色组成,红绿蓝三色，图像读取到matlab后，有三个参数m × n × 3, 代表的是三色叠加，处理之后的图将三色展开分别呈现了，所以才会出现三副连续的色图    \n![](https://i.loli.net/2019/07/20/5d32d80a09a9124012.jpg)\n\n换成彩色图可以明显看到\n![](https://i.loli.net/2019/07/20/5d32d80a3073491464.jpg)\n\n## 高通滤波器\n\n图像的锐化可以在频率与通过高通滤波器来实现\n一个高通滤波器可以由一个低通滤波器来实现:\n$$H_{HP}(u,v)=1-H_{LP}(u,v)$$\n被低通滤波器衰减的频率可以通过高通滤波器\n\n### 理想高通滤波器\n二维理想高通滤波器可以定义为\n$$ H(u,v)=\\begin{cases}\n1,\\quad D(u,v)\\leq D_0\\\\\n0,\\quad D(u,v)>D_0\n\\end{cases}\n$$\n![](https://i.loli.net/2019/07/21/5d341bf1c410443073.jpg)\n### 布特沃斯高通滤波器\n截止频率为$D_0$的n阶布特沃斯高通滤波器(BHPF)的定义为:\n$$ H(u,v)=\\frac{1}{1+[D_0/D(u,v)]^{2n}}$$\n![](https://i.loli.net/2019/07/21/5d341bf1c376281237.jpg)\n### 高斯高通滤波器\n截止频率处在距频率矩形中心距离为$D_0$的高斯高通滤波器(GHPF)的传递函数如下:\n$$H(u,v)=1-e^{-D^2(u,v)/2D_0^2}$$\n![](https://i.loli.net/2019/07/21/5d341bf1c3f7954220.jpg)\n\n\n### 使用高通滤波器锐化图像\n\n使用高通滤波器来锐化图像，与平滑图像类似，只是将低通滤波器换成了高通滤波器，具体步骤不再赘述\n\n```matlab\nf = imread('1.jpg');\nf = rgb2gray(f);\n[f, revertclass] = tofloat(f);\nPQ = paddedsize(size(f));\n[U, V] = dftuv(PQ(1), PQ(2));\nD = hypot(U, V);\nD0 = 0.05*PQ(1);\nF = fft2(f, PQ(1), PQ(2));\nH = hpfilter('gaussian',PQ(1), PQ(2), D0);\ng = dftfilt(f, H);\ng = revertclass(g);\nfigure(1)\nsubplot(2,2,1);\nimshow(f,[]);\ntitle('原图像')\nsubplot(2,2,2);\nimshow(fftshift(H));\ntitle('高斯高通滤波器');\nsubplot(2,2,3);\nimshow(log(1 + abs(fftshift(F))), [])\ntitle('滤波后图像谱');\nsubplot(2,2,4);\nimshow(g);\ntitle('滤波后图像');\n```\n\n同样这里需要的是高通滤波函数hpfilter()\n\n```matlab\nfunction [H] = hpfilter(type,M,N,D0,n)\n%HPFILTER Computes freq. domain highpass filters\n%\t\tTHIS IS NOT A STANDARD MATLAB FUNCTION\n%\t\tH = hpfilter (type,M,N,D0,n) creates the\n%\t\ttransfer function of a highpass filter, H, of\n%\t\tthe specified type and size MxN. Possible\n%\t\tvalues for type, D0, and n are:\n%\n%\t\t'ideal'\t\t\t\tIdeal highpass filter with\n%\t\t\t\t\t\tcutoff frequency D0. If\n%\t\t\t\t\t\tsupplied, n is ignored.\n%\t\t'btw'\t\t\t\tButterworth highpass filter\n%\t\t\t\t\t\tof order n, and cutoff D0.\n%\t\t'gaussn'\t\t\tGaussian highpass filter with\n%\t\t\t\t\t\tcutoff (standard deviation)D0.\n%\t\t\t\t\t\tIf supplied, n is ignored.\n%\t\tM and N should be even numbers for DFT\n%\t\tfiltering.\n%\n%\t\tClass support: double, uint8, uint16\n%\t\tThe output is of class double\n\n%       The transfer function Hhp of a highpass filter\n%       is 1 - Hlp, where Hlp is the transfer function of\n%       the corresponding lowpass filter.  Thus, we can\n%       use function lpfilter to generate highpass filters\n\n%       If filter is btw, make sure that n is provided\n%       Otherwise, pass n=1 as an arbitrary value to\n%       prevent error message\n\nif nargin == 4\n    n = 1; %default value of n\nend\n\nHlp = lpfilter(type,M,N,D0,n);\nH = 1 - Hlp;\n\n%       End of function\n```\n\n锐化结果:\n1. IHPF\n![](https://i.loli.net/2019/07/21/5d341eae3a6b123891.jpg)\n2. BHPF\n![](https://i.loli.net/2019/07/21/5d341bf1f13e453488.jpg)\n3. GHPF\n![](https://i.loli.net/2019/07/21/5d341eae4fa8d96779.jpg)\n\n\n","source":"_posts/频域滤波器及其应用.md","raw":"---\ntitle: 频域滤波器及其应用\ntop: false\ncover: false\nimg: https://i.loli.net/2019/07/17/5d2e73bb14bd344648.png\ntoc: true\nmathjax: true\ndate: 2019-07-20 10:54:08\npassword:\nsummary: 各种滤波器的原理及Matlab实现\ntags:\n- 图像处理\n- Matlab\ncategories:\n- Digital Image Processing\n---\n\n# 频域滤波器\n\n## 低通滤波器\n\n### 理想低通滤波器\n\n在以原点为圆心，以$D_0$为半径的圆内无衰减通过所有频率，而在圆外切断所有频率的二维低通滤波器，称为理想低通滤波器(ILPF)，定义为\n$$y=\\begin{cases}\n1,\\quad D(x,y)\\leq 0\\\\\n0, \\quad D(x,y) > 0\n\\end{cases}$$\n$D_0$是一个常数，D(u,v)是频率域中心点(u,v)与频率矩形中心的距离，即\n$$ D(u,v)=\\lbrack{(u-\\frac{P}{2})^2+(v-\\frac{Q}{2})^2}\\rbrack^\\frac{1}{2} $$\n过渡点称为**截止频率**\n![](https://i.loli.net/2019/07/21/5d341bf1f0cb755202.jpg)\n\n### 布特沃斯低通滤波器\n截止频率位于距原点$D_0$处的n阶布特沃斯低通滤波器(BLPF)的传递函数的定义为:\n$$H(u,v)=\\frac{1}{1+{[D(u,v)/D_0]}^{2n}}$$\n截止频率点是当D(u,v) = $D_0$时的点\n![](https://i.loli.net/2019/07/21/5d341bf1f101518273.jpg)\n\n### 高斯低通滤波器\n二维形式:\n$$H(u,v) = e^{-D^2(u,v)/2{D_0}^2} $$\n$D_0$ 是截止频率\n![](https://i.loli.net/2019/07/21/5d341bf1f163e99741.jpg)\n\n### 使用低通滤波器平滑图像\n\n#### 1. 高斯低通滤波器\n\n```matlab\nf = imread('1.jpg');\nf = rgb2gray(f);\n[f, revertclass] = tofloat(f);\nPQ = paddedsize(size(f));\n[U, V] = dftuv(PQ(1), PQ(2));\nD = hypot(U, V);\nD0 = 0.05*PQ(2);\nF = fft2(f, PQ(1), PQ(2));\nH = exp(-(D .^ 2)/(2 * (D0^2))); %高斯低通滤波器\ng = dftfilt(f, H);\ng = revertclass(g);\nfigure, imshow(fftshift(H));\nfigure, imshow(log(1 + abs(fftshift(F))), [])\nfigure, imshow(g);\n```\n\n滤波结果：\n![](https://i.loli.net/2019/07/20/5d32d02f5468855048.jpg)\n\n除了之前说的几个M函数外，还需要用到`dftfilt()`函数\n\n```matlab\nfunction g=dftfilt(f,H)\n%DFTFILT Performs frequency domain filtering.\n%   G=DFTFILT(F,H) filters F in the frequency domain using the\n%   filter transfer function H. The output, G, is the filtered\n%   image, which has the same size as F. DFTFILT automatically pads\n%   F to be the same size as H. Function PADDEDSIZE can be used\n%   to determine an appropriate size for H.\n%\n%   DFTFILT assumes that F is real and that H is a real, uncentered,\n%   circularly-symmetric filter function.\n\n%Obtain the FFT of the padded input.\nF=fft2(f,size(H,1),size(H,2));\n\n%Perform filtering.\ng=real(ifft2(H.*F));\n\n%Crop to original size.\ng=g(1:size(f,1),1:size(f,2));\n```\n\n#### 2. Butterworth滤波\n\n该函数输入为灰度图像，自由设置截止频率$D_0$和BLPF的阶数n，输出为滤波后的图像(已归一化到[0,255])\n\n```matlab\nfunction [image_out] = Bfilter(image_in, D0, N)\n% Butterworth滤波器，在频率域进行滤波\n% 输入为需要进行滤波的灰度图像，Butterworth滤波器的截止频率D0，阶数N\n% 输出为滤波之后的灰度图像\n\n[m, n] = size(image_in);\nP = 2 * m;\nQ = 2 * n;\n\nfp = zeros(P, Q);\n%对图像填充0,并且乘以(-1)^(x+y) 以移到变换中心\nfor i = 1 : m\n    for j = 1 : n\n        fp(i, j) = double(image_in(i, j)) * (-1)^(i+j);\n    end\nend\n% 对填充后的图像进行傅里叶变换\nF1 = fft2(fp);\n\n% 生成Butterworth滤波函数，中心在(m+1,n+1)\nBw = zeros(P, Q);\na = D0^(2 * N);\nfor u = 1 : P\n    for v = 1 : Q\n        temp = (u-(m+1.0))^2 + (v-(n+1.0))^2;\n        Bw(u, v) = 1 / (1 + (temp^N) / a);\n    end\nend\n\n%进行滤波\nG = F1 .* Bw;\n\n% 反傅里叶变换\ngp = ifft2(G);\n\n% 处理得到的图像\nimage_out = zeros(m, n, 'uint8');\ngp = real(gp);\ng = zeros(m, n);\nfor i = 1 : m\n    for j = 1 : n\n        g(i, j) = gp(i, j) * (-1)^(i+j);\n        \n    end\nend\nmmax = max(g(:));\nmmin = min(g(:));\nrange = mmax-mmin;\nfor i = 1 : m\n    for j = 1 : n\n        image_out(i,j) = uint8(255 * (g(i, j)-mmin) / range);\n    end\nend\nend\n```\n\n测试BLPF的阶数为2,截止频率分别为10,40,80,150,450\n\n```matlab\nclear all;\nclose all;\nclc;\n\nimage1 = imread('2.jpg');\n\nimage2 = Bfilter(image1, 10, 2);\nimage3 = Bfilter(image1, 40, 2);\nimage4 = Bfilter(image1, 80, 2);\nimage5 = Bfilter(image1, 150, 2);\nimage6 = Bfilter(image1, 450, 2);\n\n% 显示图像\nsubplot(2,3,1), imshow(image1), title('原图像');\nsubplot(2,3,2), imshow(image2), title('D0 = 10, n = 2');\nsubplot(2,3,3), imshow(image3), title('D0 = 40, n = 2');\nsubplot(2,3,4), imshow(image4), title('D0 = 80, n = 2');\nsubplot(2,3,5), imshow(image5), title('D0 = 150, n = 2');\nsubplot(2,3,6), imshow(image6), title('D0 = 450, n = 2');\n```\n\n滤波结果如下:\n![](https://i.loli.net/2019/07/20/5d32d02f43bc610556.jpg)\n分析结果:    \n1. 模糊的平滑过渡是截止频率增大的函数\n2. 滤波后输出三副连续的色图，原因是rgb图像的分三次呈现    \n   一副彩图是由三色组成,红绿蓝三色，图像读取到matlab后，有三个参数m × n × 3, 代表的是三色叠加，处理之后的图将三色展开分别呈现了，所以才会出现三副连续的色图    \n![](https://i.loli.net/2019/07/20/5d32d80a09a9124012.jpg)\n\n换成彩色图可以明显看到\n![](https://i.loli.net/2019/07/20/5d32d80a3073491464.jpg)\n\n## 高通滤波器\n\n图像的锐化可以在频率与通过高通滤波器来实现\n一个高通滤波器可以由一个低通滤波器来实现:\n$$H_{HP}(u,v)=1-H_{LP}(u,v)$$\n被低通滤波器衰减的频率可以通过高通滤波器\n\n### 理想高通滤波器\n二维理想高通滤波器可以定义为\n$$ H(u,v)=\\begin{cases}\n1,\\quad D(u,v)\\leq D_0\\\\\n0,\\quad D(u,v)>D_0\n\\end{cases}\n$$\n![](https://i.loli.net/2019/07/21/5d341bf1c410443073.jpg)\n### 布特沃斯高通滤波器\n截止频率为$D_0$的n阶布特沃斯高通滤波器(BHPF)的定义为:\n$$ H(u,v)=\\frac{1}{1+[D_0/D(u,v)]^{2n}}$$\n![](https://i.loli.net/2019/07/21/5d341bf1c376281237.jpg)\n### 高斯高通滤波器\n截止频率处在距频率矩形中心距离为$D_0$的高斯高通滤波器(GHPF)的传递函数如下:\n$$H(u,v)=1-e^{-D^2(u,v)/2D_0^2}$$\n![](https://i.loli.net/2019/07/21/5d341bf1c3f7954220.jpg)\n\n\n### 使用高通滤波器锐化图像\n\n使用高通滤波器来锐化图像，与平滑图像类似，只是将低通滤波器换成了高通滤波器，具体步骤不再赘述\n\n```matlab\nf = imread('1.jpg');\nf = rgb2gray(f);\n[f, revertclass] = tofloat(f);\nPQ = paddedsize(size(f));\n[U, V] = dftuv(PQ(1), PQ(2));\nD = hypot(U, V);\nD0 = 0.05*PQ(1);\nF = fft2(f, PQ(1), PQ(2));\nH = hpfilter('gaussian',PQ(1), PQ(2), D0);\ng = dftfilt(f, H);\ng = revertclass(g);\nfigure(1)\nsubplot(2,2,1);\nimshow(f,[]);\ntitle('原图像')\nsubplot(2,2,2);\nimshow(fftshift(H));\ntitle('高斯高通滤波器');\nsubplot(2,2,3);\nimshow(log(1 + abs(fftshift(F))), [])\ntitle('滤波后图像谱');\nsubplot(2,2,4);\nimshow(g);\ntitle('滤波后图像');\n```\n\n同样这里需要的是高通滤波函数hpfilter()\n\n```matlab\nfunction [H] = hpfilter(type,M,N,D0,n)\n%HPFILTER Computes freq. domain highpass filters\n%\t\tTHIS IS NOT A STANDARD MATLAB FUNCTION\n%\t\tH = hpfilter (type,M,N,D0,n) creates the\n%\t\ttransfer function of a highpass filter, H, of\n%\t\tthe specified type and size MxN. Possible\n%\t\tvalues for type, D0, and n are:\n%\n%\t\t'ideal'\t\t\t\tIdeal highpass filter with\n%\t\t\t\t\t\tcutoff frequency D0. If\n%\t\t\t\t\t\tsupplied, n is ignored.\n%\t\t'btw'\t\t\t\tButterworth highpass filter\n%\t\t\t\t\t\tof order n, and cutoff D0.\n%\t\t'gaussn'\t\t\tGaussian highpass filter with\n%\t\t\t\t\t\tcutoff (standard deviation)D0.\n%\t\t\t\t\t\tIf supplied, n is ignored.\n%\t\tM and N should be even numbers for DFT\n%\t\tfiltering.\n%\n%\t\tClass support: double, uint8, uint16\n%\t\tThe output is of class double\n\n%       The transfer function Hhp of a highpass filter\n%       is 1 - Hlp, where Hlp is the transfer function of\n%       the corresponding lowpass filter.  Thus, we can\n%       use function lpfilter to generate highpass filters\n\n%       If filter is btw, make sure that n is provided\n%       Otherwise, pass n=1 as an arbitrary value to\n%       prevent error message\n\nif nargin == 4\n    n = 1; %default value of n\nend\n\nHlp = lpfilter(type,M,N,D0,n);\nH = 1 - Hlp;\n\n%       End of function\n```\n\n锐化结果:\n1. IHPF\n![](https://i.loli.net/2019/07/21/5d341eae3a6b123891.jpg)\n2. BHPF\n![](https://i.loli.net/2019/07/21/5d341bf1f13e453488.jpg)\n3. GHPF\n![](https://i.loli.net/2019/07/21/5d341eae4fa8d96779.jpg)\n\n\n","slug":"频域滤波器及其应用","published":1,"updated":"2020-02-24T10:49:41.451Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70cp0ts002t74juu78xepbf","content":"<h1 id=\"频域滤波器\"><a href=\"#频域滤波器\" class=\"headerlink\" title=\"频域滤波器\"></a>频域滤波器</h1><h2 id=\"低通滤波器\"><a href=\"#低通滤波器\" class=\"headerlink\" title=\"低通滤波器\"></a>低通滤波器</h2><h3 id=\"理想低通滤波器\"><a href=\"#理想低通滤波器\" class=\"headerlink\" title=\"理想低通滤波器\"></a>理想低通滤波器</h3><p>在以原点为圆心，以$D_0$为半径的圆内无衰减通过所有频率，而在圆外切断所有频率的二维低通滤波器，称为理想低通滤波器(ILPF)，定义为<br>$$y=\\begin{cases}<br>1,\\quad D(x,y)\\leq 0\\<br>0, \\quad D(x,y) &gt; 0<br>\\end{cases}$$<br>$D_0$是一个常数，D(u,v)是频率域中心点(u,v)与频率矩形中心的距离，即<br>$$ D(u,v)=\\lbrack{(u-\\frac{P}{2})^2+(v-\\frac{Q}{2})^2}\\rbrack^\\frac{1}{2} $$<br>过渡点称为<strong>截止频率</strong><br><img src=\"https://i.loli.net/2019/07/21/5d341bf1f0cb755202.jpg\" alt></p>\n<h3 id=\"布特沃斯低通滤波器\"><a href=\"#布特沃斯低通滤波器\" class=\"headerlink\" title=\"布特沃斯低通滤波器\"></a>布特沃斯低通滤波器</h3><p>截止频率位于距原点$D_0$处的n阶布特沃斯低通滤波器(BLPF)的传递函数的定义为:<br>$$H(u,v)=\\frac{1}{1+{[D(u,v)/D_0]}^{2n}}$$<br>截止频率点是当D(u,v) = $D_0$时的点<br><img src=\"https://i.loli.net/2019/07/21/5d341bf1f101518273.jpg\" alt></p>\n<h3 id=\"高斯低通滤波器\"><a href=\"#高斯低通滤波器\" class=\"headerlink\" title=\"高斯低通滤波器\"></a>高斯低通滤波器</h3><p>二维形式:<br>$$H(u,v) = e^{-D^2(u,v)/2{D_0}^2} $$<br>$D_0$ 是截止频率<br><img src=\"https://i.loli.net/2019/07/21/5d341bf1f163e99741.jpg\" alt></p>\n<h3 id=\"使用低通滤波器平滑图像\"><a href=\"#使用低通滤波器平滑图像\" class=\"headerlink\" title=\"使用低通滤波器平滑图像\"></a>使用低通滤波器平滑图像</h3><h4 id=\"1-高斯低通滤波器\"><a href=\"#1-高斯低通滤波器\" class=\"headerlink\" title=\"1. 高斯低通滤波器\"></a>1. 高斯低通滤波器</h4><pre class=\" language-matlab\"><code class=\"language-matlab\">f <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nf <span class=\"token operator\">=</span> <span class=\"token function\">rgb2gray</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">[</span>f<span class=\"token punctuation\">,</span> revertclass<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">tofloat</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nPQ <span class=\"token operator\">=</span> <span class=\"token function\">paddedsize</span><span class=\"token punctuation\">(</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">[</span>U<span class=\"token punctuation\">,</span> V<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">dftuv</span><span class=\"token punctuation\">(</span><span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nD <span class=\"token operator\">=</span> <span class=\"token function\">hypot</span><span class=\"token punctuation\">(</span>U<span class=\"token punctuation\">,</span> V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nD0 <span class=\"token operator\">=</span> <span class=\"token number\">0.05</span><span class=\"token operator\">*</span><span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nF <span class=\"token operator\">=</span> <span class=\"token function\">fft2</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nH <span class=\"token operator\">=</span> <span class=\"token function\">exp</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token punctuation\">(</span>D <span class=\"token operator\">.^</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>D0<span class=\"token operator\">^</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">%高斯低通滤波器</span>\ng <span class=\"token operator\">=</span> <span class=\"token function\">dftfilt</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ng <span class=\"token operator\">=</span> <span class=\"token function\">revertclass</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfigure<span class=\"token punctuation\">,</span> <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token function\">fftshift</span><span class=\"token punctuation\">(</span>H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfigure<span class=\"token punctuation\">,</span> <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span><span class=\"token function\">fftshift</span><span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfigure<span class=\"token punctuation\">,</span> <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>滤波结果：<br><img src=\"https://i.loli.net/2019/07/20/5d32d02f5468855048.jpg\" alt></p>\n<p>除了之前说的几个M函数外，还需要用到<code>dftfilt()</code>函数</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token keyword\">function</span> g<span class=\"token operator\">=</span><span class=\"token function\">dftfilt</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span>H<span class=\"token punctuation\">)</span>\n<span class=\"token comment\" spellcheck=\"true\">%DFTFILT Performs frequency domain filtering.</span>\n<span class=\"token comment\" spellcheck=\"true\">%   G=DFTFILT(F,H) filters F in the frequency domain using the</span>\n<span class=\"token comment\" spellcheck=\"true\">%   filter transfer function H. The output, G, is the filtered</span>\n<span class=\"token comment\" spellcheck=\"true\">%   image, which has the same size as F. DFTFILT automatically pads</span>\n<span class=\"token comment\" spellcheck=\"true\">%   F to be the same size as H. Function PADDEDSIZE can be used</span>\n<span class=\"token comment\" spellcheck=\"true\">%   to determine an appropriate size for H.</span>\n%\n<span class=\"token comment\" spellcheck=\"true\">%   DFTFILT assumes that F is real and that H is a real, uncentered,</span>\n<span class=\"token comment\" spellcheck=\"true\">%   circularly-symmetric filter function.</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%Obtain the FFT of the padded input.</span>\nF<span class=\"token operator\">=</span><span class=\"token function\">fft2</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>H<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>H<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%Perform filtering.</span>\ng<span class=\"token operator\">=</span><span class=\"token function\">real</span><span class=\"token punctuation\">(</span><span class=\"token function\">ifft2</span><span class=\"token punctuation\">(</span>H<span class=\"token operator\">.*</span>F<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%Crop to original size.</span>\ng<span class=\"token operator\">=</span><span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<h4 id=\"2-Butterworth滤波\"><a href=\"#2-Butterworth滤波\" class=\"headerlink\" title=\"2. Butterworth滤波\"></a>2. Butterworth滤波</h4><p>该函数输入为灰度图像，自由设置截止频率$D_0$和BLPF的阶数n，输出为滤波后的图像(已归一化到[0,255])</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token keyword\">function</span> <span class=\"token punctuation\">[</span>image_out<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">Bfilter</span><span class=\"token punctuation\">(</span>image_in<span class=\"token punctuation\">,</span> D0<span class=\"token punctuation\">,</span> N<span class=\"token punctuation\">)</span>\n<span class=\"token comment\" spellcheck=\"true\">% Butterworth滤波器，在频率域进行滤波</span>\n<span class=\"token comment\" spellcheck=\"true\">% 输入为需要进行滤波的灰度图像，Butterworth滤波器的截止频率D0，阶数N</span>\n<span class=\"token comment\" spellcheck=\"true\">% 输出为滤波之后的灰度图像</span>\n\n<span class=\"token punctuation\">[</span>m<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">size</span><span class=\"token punctuation\">(</span>image_in<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nP <span class=\"token operator\">=</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> m<span class=\"token punctuation\">;</span>\nQ <span class=\"token operator\">=</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> n<span class=\"token punctuation\">;</span>\n\nfp <span class=\"token operator\">=</span> <span class=\"token function\">zeros</span><span class=\"token punctuation\">(</span>P<span class=\"token punctuation\">,</span> Q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\" spellcheck=\"true\">%对图像填充0,并且乘以(-1)^(x+y) 以移到变换中心</span>\n<span class=\"token keyword\">for</span> <span class=\"token number\">i</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> m\n    <span class=\"token keyword\">for</span> <span class=\"token number\">j</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> n\n        <span class=\"token function\">fp</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token punctuation\">,</span> <span class=\"token number\">j</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">double</span><span class=\"token punctuation\">(</span><span class=\"token function\">image_in</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token punctuation\">,</span> <span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token operator\">+</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span>\n<span class=\"token comment\" spellcheck=\"true\">% 对填充后的图像进行傅里叶变换</span>\nF1 <span class=\"token operator\">=</span> <span class=\"token function\">fft2</span><span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">% 生成Butterworth滤波函数，中心在(m+1,n+1)</span>\nBw <span class=\"token operator\">=</span> <span class=\"token function\">zeros</span><span class=\"token punctuation\">(</span>P<span class=\"token punctuation\">,</span> Q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\na <span class=\"token operator\">=</span> D0<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> N<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> u <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> P\n    <span class=\"token keyword\">for</span> v <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> Q\n        temp <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>u<span class=\"token operator\">-</span><span class=\"token punctuation\">(</span>m<span class=\"token operator\">+</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>v<span class=\"token operator\">-</span><span class=\"token punctuation\">(</span>n<span class=\"token operator\">+</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">Bw</span><span class=\"token punctuation\">(</span>u<span class=\"token punctuation\">,</span> v<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>temp<span class=\"token operator\">^</span>N<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%进行滤波</span>\nG <span class=\"token operator\">=</span> F1 <span class=\"token operator\">.*</span> Bw<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">% 反傅里叶变换</span>\ngp <span class=\"token operator\">=</span> <span class=\"token function\">ifft2</span><span class=\"token punctuation\">(</span>G<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">% 处理得到的图像</span>\nimage_out <span class=\"token operator\">=</span> <span class=\"token function\">zeros</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">,</span> <span class=\"token string\">'uint8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngp <span class=\"token operator\">=</span> <span class=\"token function\">real</span><span class=\"token punctuation\">(</span>gp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ng <span class=\"token operator\">=</span> <span class=\"token function\">zeros</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token number\">i</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> m\n    <span class=\"token keyword\">for</span> <span class=\"token number\">j</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> n\n        <span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token punctuation\">,</span> <span class=\"token number\">j</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">gp</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token punctuation\">,</span> <span class=\"token number\">j</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token operator\">+</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span>\nmmax <span class=\"token operator\">=</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmmin <span class=\"token operator\">=</span> <span class=\"token function\">min</span><span class=\"token punctuation\">(</span><span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nrange <span class=\"token operator\">=</span> mmax<span class=\"token operator\">-</span>mmin<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token number\">i</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> m\n    <span class=\"token keyword\">for</span> <span class=\"token number\">j</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> n\n        <span class=\"token function\">image_out</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token punctuation\">,</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">uint8</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token punctuation\">,</span> <span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>mmin<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> range<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre>\n<p>测试BLPF的阶数为2,截止频率分别为10,40,80,150,450</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">clear all<span class=\"token punctuation\">;</span>\nclose all<span class=\"token punctuation\">;</span>\nclc<span class=\"token punctuation\">;</span>\n\nimage1 <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nimage2 <span class=\"token operator\">=</span> <span class=\"token function\">Bfilter</span><span class=\"token punctuation\">(</span>image1<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nimage3 <span class=\"token operator\">=</span> <span class=\"token function\">Bfilter</span><span class=\"token punctuation\">(</span>image1<span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nimage4 <span class=\"token operator\">=</span> <span class=\"token function\">Bfilter</span><span class=\"token punctuation\">(</span>image1<span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nimage5 <span class=\"token operator\">=</span> <span class=\"token function\">Bfilter</span><span class=\"token punctuation\">(</span>image1<span class=\"token punctuation\">,</span> <span class=\"token number\">150</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nimage6 <span class=\"token operator\">=</span> <span class=\"token function\">Bfilter</span><span class=\"token punctuation\">(</span>image1<span class=\"token punctuation\">,</span> <span class=\"token number\">450</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">% 显示图像</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>image1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'原图像'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>image2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'D0 = 10, n = 2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>image3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'D0 = 40, n = 2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>image4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'D0 = 80, n = 2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>image5<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'D0 = 150, n = 2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>image6<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'D0 = 450, n = 2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>滤波结果如下:<br><img src=\"https://i.loli.net/2019/07/20/5d32d02f43bc610556.jpg\" alt><br>分析结果:    </p>\n<ol>\n<li>模糊的平滑过渡是截止频率增大的函数</li>\n<li>滤波后输出三副连续的色图，原因是rgb图像的分三次呈现<br>一副彩图是由三色组成,红绿蓝三色，图像读取到matlab后，有三个参数m × n × 3, 代表的是三色叠加，处理之后的图将三色展开分别呈现了，所以才会出现三副连续的色图<br><img src=\"https://i.loli.net/2019/07/20/5d32d80a09a9124012.jpg\" alt></li>\n</ol>\n<p>换成彩色图可以明显看到<br><img src=\"https://i.loli.net/2019/07/20/5d32d80a3073491464.jpg\" alt></p>\n<h2 id=\"高通滤波器\"><a href=\"#高通滤波器\" class=\"headerlink\" title=\"高通滤波器\"></a>高通滤波器</h2><p>图像的锐化可以在频率与通过高通滤波器来实现<br>一个高通滤波器可以由一个低通滤波器来实现:<br>$$H_{HP}(u,v)=1-H_{LP}(u,v)$$<br>被低通滤波器衰减的频率可以通过高通滤波器</p>\n<h3 id=\"理想高通滤波器\"><a href=\"#理想高通滤波器\" class=\"headerlink\" title=\"理想高通滤波器\"></a>理想高通滤波器</h3><p>二维理想高通滤波器可以定义为<br>$$ H(u,v)=\\begin{cases}<br>1,\\quad D(u,v)\\leq D_0\\<br>0,\\quad D(u,v)&gt;D_0<br>\\end{cases}<br>$$<br><img src=\"https://i.loli.net/2019/07/21/5d341bf1c410443073.jpg\" alt></p>\n<h3 id=\"布特沃斯高通滤波器\"><a href=\"#布特沃斯高通滤波器\" class=\"headerlink\" title=\"布特沃斯高通滤波器\"></a>布特沃斯高通滤波器</h3><p>截止频率为$D_0$的n阶布特沃斯高通滤波器(BHPF)的定义为:<br>$$ H(u,v)=\\frac{1}{1+[D_0/D(u,v)]^{2n}}$$<br><img src=\"https://i.loli.net/2019/07/21/5d341bf1c376281237.jpg\" alt></p>\n<h3 id=\"高斯高通滤波器\"><a href=\"#高斯高通滤波器\" class=\"headerlink\" title=\"高斯高通滤波器\"></a>高斯高通滤波器</h3><p>截止频率处在距频率矩形中心距离为$D_0$的高斯高通滤波器(GHPF)的传递函数如下:<br>$$H(u,v)=1-e^{-D^2(u,v)/2D_0^2}$$<br><img src=\"https://i.loli.net/2019/07/21/5d341bf1c3f7954220.jpg\" alt></p>\n<h3 id=\"使用高通滤波器锐化图像\"><a href=\"#使用高通滤波器锐化图像\" class=\"headerlink\" title=\"使用高通滤波器锐化图像\"></a>使用高通滤波器锐化图像</h3><p>使用高通滤波器来锐化图像，与平滑图像类似，只是将低通滤波器换成了高通滤波器，具体步骤不再赘述</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\">f <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nf <span class=\"token operator\">=</span> <span class=\"token function\">rgb2gray</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">[</span>f<span class=\"token punctuation\">,</span> revertclass<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">tofloat</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nPQ <span class=\"token operator\">=</span> <span class=\"token function\">paddedsize</span><span class=\"token punctuation\">(</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">[</span>U<span class=\"token punctuation\">,</span> V<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">dftuv</span><span class=\"token punctuation\">(</span><span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nD <span class=\"token operator\">=</span> <span class=\"token function\">hypot</span><span class=\"token punctuation\">(</span>U<span class=\"token punctuation\">,</span> V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nD0 <span class=\"token operator\">=</span> <span class=\"token number\">0.05</span><span class=\"token operator\">*</span><span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nF <span class=\"token operator\">=</span> <span class=\"token function\">fft2</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nH <span class=\"token operator\">=</span> <span class=\"token function\">hpfilter</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gaussian'</span><span class=\"token punctuation\">,</span><span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">PQ</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> D0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ng <span class=\"token operator\">=</span> <span class=\"token function\">dftfilt</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ng <span class=\"token operator\">=</span> <span class=\"token function\">revertclass</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'原图像'</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token function\">fftshift</span><span class=\"token punctuation\">(</span>H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'高斯高通滤波器'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span><span class=\"token function\">fftshift</span><span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'滤波后图像谱'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'滤波后图像'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>同样这里需要的是高通滤波函数hpfilter()</p>\n<pre class=\" language-matlab\"><code class=\"language-matlab\"><span class=\"token keyword\">function</span> <span class=\"token punctuation\">[</span>H<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">hpfilter</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span>M<span class=\"token punctuation\">,</span>N<span class=\"token punctuation\">,</span>D0<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span>\n<span class=\"token comment\" spellcheck=\"true\">%HPFILTER Computes freq. domain highpass filters</span>\n<span class=\"token comment\" spellcheck=\"true\">%        THIS IS NOT A STANDARD MATLAB FUNCTION</span>\n<span class=\"token comment\" spellcheck=\"true\">%        H = hpfilter (type,M,N,D0,n) creates the</span>\n<span class=\"token comment\" spellcheck=\"true\">%        transfer function of a highpass filter, H, of</span>\n<span class=\"token comment\" spellcheck=\"true\">%        the specified type and size MxN. Possible</span>\n<span class=\"token comment\" spellcheck=\"true\">%        values for type, D0, and n are:</span>\n%\n<span class=\"token comment\" spellcheck=\"true\">%        </span><span class=\"token string\">'ideal'</span>                Ideal highpass filter with\n<span class=\"token comment\" spellcheck=\"true\">%                        cutoff frequency D0. If</span>\n<span class=\"token comment\" spellcheck=\"true\">%                        supplied, n is ignored.</span>\n<span class=\"token comment\" spellcheck=\"true\">%        </span><span class=\"token string\">'btw'</span>                Butterworth highpass filter\n<span class=\"token comment\" spellcheck=\"true\">%                        of order n, and cutoff D0.</span>\n<span class=\"token comment\" spellcheck=\"true\">%        </span><span class=\"token string\">'gaussn'</span>            Gaussian highpass filter with\n<span class=\"token comment\" spellcheck=\"true\">%                        cutoff (standard deviation)D0.</span>\n<span class=\"token comment\" spellcheck=\"true\">%                        If supplied, n is ignored.</span>\n<span class=\"token comment\" spellcheck=\"true\">%        M and N should be even numbers for DFT</span>\n<span class=\"token comment\" spellcheck=\"true\">%        filtering.</span>\n%\n<span class=\"token comment\" spellcheck=\"true\">%        Class support: double, uint8, uint16</span>\n<span class=\"token comment\" spellcheck=\"true\">%        The output is of class double</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%       The transfer function Hhp of a highpass filter</span>\n<span class=\"token comment\" spellcheck=\"true\">%       is 1 - Hlp, where Hlp is the transfer function of</span>\n<span class=\"token comment\" spellcheck=\"true\">%       the corresponding lowpass filter.  Thus, we can</span>\n<span class=\"token comment\" spellcheck=\"true\">%       use function lpfilter to generate highpass filters</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%       If filter is btw, make sure that n is provided</span>\n<span class=\"token comment\" spellcheck=\"true\">%       Otherwise, pass n=1 as an arbitrary value to</span>\n<span class=\"token comment\" spellcheck=\"true\">%       prevent error message</span>\n\n<span class=\"token keyword\">if</span> nargin <span class=\"token operator\">==</span> <span class=\"token number\">4</span>\n    n <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">%default value of n</span>\n<span class=\"token keyword\">end</span>\n\nHlp <span class=\"token operator\">=</span> <span class=\"token function\">lpfilter</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span>M<span class=\"token punctuation\">,</span>N<span class=\"token punctuation\">,</span>D0<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nH <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">-</span> Hlp<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">%       End of function</span></code></pre>\n<p>锐化结果:</p>\n<ol>\n<li>IHPF<br><img src=\"https://i.loli.net/2019/07/21/5d341eae3a6b123891.jpg\" alt></li>\n<li>BHPF<br><img src=\"https://i.loli.net/2019/07/21/5d341bf1f13e453488.jpg\" alt></li>\n<li>GHPF<br><img src=\"https://i.loli.net/2019/07/21/5d341eae4fa8d96779.jpg\" alt></li>\n</ol>\n","site":{"data":{"friends":[{"name":"Github","url":"https://github.com/liuyaanng","title":"访问主页","introduction":"我是练习时长两年半的小白程序员，喜欢唱，跳，Music和写代码","avatar":"https://avatars3.githubusercontent.com/u/41953649?s=460&v=4"}],"musics":[{"name":"We Can not Stop","artist":"Boyce Avenue&Bea Miller","url":"/medias/music/wecantstop.mp3","cover":"https://i.loli.net/2019/08/03/Z2ABnhKQ8fY6pVP.jpg"},{"name":"Leaving Akina","artist":"Leon","url":"/medias/music/LeavingAkina.mp3","cover":"https://i.loli.net/2019/08/03/fqFWCVij25rLITc.jpg"}]}},"excerpt":"","more":"<h1 id=\"频域滤波器\"><a href=\"#频域滤波器\" class=\"headerlink\" title=\"频域滤波器\"></a>频域滤波器</h1><h2 id=\"低通滤波器\"><a href=\"#低通滤波器\" class=\"headerlink\" title=\"低通滤波器\"></a>低通滤波器</h2><h3 id=\"理想低通滤波器\"><a href=\"#理想低通滤波器\" class=\"headerlink\" title=\"理想低通滤波器\"></a>理想低通滤波器</h3><p>在以原点为圆心，以$D_0$为半径的圆内无衰减通过所有频率，而在圆外切断所有频率的二维低通滤波器，称为理想低通滤波器(ILPF)，定义为<br>$$y=\\begin{cases}<br>1,\\quad D(x,y)\\leq 0\\<br>0, \\quad D(x,y) &gt; 0<br>\\end{cases}$$<br>$D_0$是一个常数，D(u,v)是频率域中心点(u,v)与频率矩形中心的距离，即<br>$$ D(u,v)=\\lbrack{(u-\\frac{P}{2})^2+(v-\\frac{Q}{2})^2}\\rbrack^\\frac{1}{2} $$<br>过渡点称为<strong>截止频率</strong><br><img src=\"https://i.loli.net/2019/07/21/5d341bf1f0cb755202.jpg\" alt></p>\n<h3 id=\"布特沃斯低通滤波器\"><a href=\"#布特沃斯低通滤波器\" class=\"headerlink\" title=\"布特沃斯低通滤波器\"></a>布特沃斯低通滤波器</h3><p>截止频率位于距原点$D_0$处的n阶布特沃斯低通滤波器(BLPF)的传递函数的定义为:<br>$$H(u,v)=\\frac{1}{1+{[D(u,v)/D_0]}^{2n}}$$<br>截止频率点是当D(u,v) = $D_0$时的点<br><img src=\"https://i.loli.net/2019/07/21/5d341bf1f101518273.jpg\" alt></p>\n<h3 id=\"高斯低通滤波器\"><a href=\"#高斯低通滤波器\" class=\"headerlink\" title=\"高斯低通滤波器\"></a>高斯低通滤波器</h3><p>二维形式:<br>$$H(u,v) = e^{-D^2(u,v)/2{D_0}^2} $$<br>$D_0$ 是截止频率<br><img src=\"https://i.loli.net/2019/07/21/5d341bf1f163e99741.jpg\" alt></p>\n<h3 id=\"使用低通滤波器平滑图像\"><a href=\"#使用低通滤波器平滑图像\" class=\"headerlink\" title=\"使用低通滤波器平滑图像\"></a>使用低通滤波器平滑图像</h3><h4 id=\"1-高斯低通滤波器\"><a href=\"#1-高斯低通滤波器\" class=\"headerlink\" title=\"1. 高斯低通滤波器\"></a>1. 高斯低通滤波器</h4><pre><code class=\"matlab\">f = imread(&#39;1.jpg&#39;);\nf = rgb2gray(f);\n[f, revertclass] = tofloat(f);\nPQ = paddedsize(size(f));\n[U, V] = dftuv(PQ(1), PQ(2));\nD = hypot(U, V);\nD0 = 0.05*PQ(2);\nF = fft2(f, PQ(1), PQ(2));\nH = exp(-(D .^ 2)/(2 * (D0^2))); %高斯低通滤波器\ng = dftfilt(f, H);\ng = revertclass(g);\nfigure, imshow(fftshift(H));\nfigure, imshow(log(1 + abs(fftshift(F))), [])\nfigure, imshow(g);</code></pre>\n<p>滤波结果：<br><img src=\"https://i.loli.net/2019/07/20/5d32d02f5468855048.jpg\" alt></p>\n<p>除了之前说的几个M函数外，还需要用到<code>dftfilt()</code>函数</p>\n<pre><code class=\"matlab\">function g=dftfilt(f,H)\n%DFTFILT Performs frequency domain filtering.\n%   G=DFTFILT(F,H) filters F in the frequency domain using the\n%   filter transfer function H. The output, G, is the filtered\n%   image, which has the same size as F. DFTFILT automatically pads\n%   F to be the same size as H. Function PADDEDSIZE can be used\n%   to determine an appropriate size for H.\n%\n%   DFTFILT assumes that F is real and that H is a real, uncentered,\n%   circularly-symmetric filter function.\n\n%Obtain the FFT of the padded input.\nF=fft2(f,size(H,1),size(H,2));\n\n%Perform filtering.\ng=real(ifft2(H.*F));\n\n%Crop to original size.\ng=g(1:size(f,1),1:size(f,2));</code></pre>\n<h4 id=\"2-Butterworth滤波\"><a href=\"#2-Butterworth滤波\" class=\"headerlink\" title=\"2. Butterworth滤波\"></a>2. Butterworth滤波</h4><p>该函数输入为灰度图像，自由设置截止频率$D_0$和BLPF的阶数n，输出为滤波后的图像(已归一化到[0,255])</p>\n<pre><code class=\"matlab\">function [image_out] = Bfilter(image_in, D0, N)\n% Butterworth滤波器，在频率域进行滤波\n% 输入为需要进行滤波的灰度图像，Butterworth滤波器的截止频率D0，阶数N\n% 输出为滤波之后的灰度图像\n\n[m, n] = size(image_in);\nP = 2 * m;\nQ = 2 * n;\n\nfp = zeros(P, Q);\n%对图像填充0,并且乘以(-1)^(x+y) 以移到变换中心\nfor i = 1 : m\n    for j = 1 : n\n        fp(i, j) = double(image_in(i, j)) * (-1)^(i+j);\n    end\nend\n% 对填充后的图像进行傅里叶变换\nF1 = fft2(fp);\n\n% 生成Butterworth滤波函数，中心在(m+1,n+1)\nBw = zeros(P, Q);\na = D0^(2 * N);\nfor u = 1 : P\n    for v = 1 : Q\n        temp = (u-(m+1.0))^2 + (v-(n+1.0))^2;\n        Bw(u, v) = 1 / (1 + (temp^N) / a);\n    end\nend\n\n%进行滤波\nG = F1 .* Bw;\n\n% 反傅里叶变换\ngp = ifft2(G);\n\n% 处理得到的图像\nimage_out = zeros(m, n, &#39;uint8&#39;);\ngp = real(gp);\ng = zeros(m, n);\nfor i = 1 : m\n    for j = 1 : n\n        g(i, j) = gp(i, j) * (-1)^(i+j);\n\n    end\nend\nmmax = max(g(:));\nmmin = min(g(:));\nrange = mmax-mmin;\nfor i = 1 : m\n    for j = 1 : n\n        image_out(i,j) = uint8(255 * (g(i, j)-mmin) / range);\n    end\nend\nend</code></pre>\n<p>测试BLPF的阶数为2,截止频率分别为10,40,80,150,450</p>\n<pre><code class=\"matlab\">clear all;\nclose all;\nclc;\n\nimage1 = imread(&#39;2.jpg&#39;);\n\nimage2 = Bfilter(image1, 10, 2);\nimage3 = Bfilter(image1, 40, 2);\nimage4 = Bfilter(image1, 80, 2);\nimage5 = Bfilter(image1, 150, 2);\nimage6 = Bfilter(image1, 450, 2);\n\n% 显示图像\nsubplot(2,3,1), imshow(image1), title(&#39;原图像&#39;);\nsubplot(2,3,2), imshow(image2), title(&#39;D0 = 10, n = 2&#39;);\nsubplot(2,3,3), imshow(image3), title(&#39;D0 = 40, n = 2&#39;);\nsubplot(2,3,4), imshow(image4), title(&#39;D0 = 80, n = 2&#39;);\nsubplot(2,3,5), imshow(image5), title(&#39;D0 = 150, n = 2&#39;);\nsubplot(2,3,6), imshow(image6), title(&#39;D0 = 450, n = 2&#39;);</code></pre>\n<p>滤波结果如下:<br><img src=\"https://i.loli.net/2019/07/20/5d32d02f43bc610556.jpg\" alt><br>分析结果:    </p>\n<ol>\n<li>模糊的平滑过渡是截止频率增大的函数</li>\n<li>滤波后输出三副连续的色图，原因是rgb图像的分三次呈现<br>一副彩图是由三色组成,红绿蓝三色，图像读取到matlab后，有三个参数m × n × 3, 代表的是三色叠加，处理之后的图将三色展开分别呈现了，所以才会出现三副连续的色图<br><img src=\"https://i.loli.net/2019/07/20/5d32d80a09a9124012.jpg\" alt></li>\n</ol>\n<p>换成彩色图可以明显看到<br><img src=\"https://i.loli.net/2019/07/20/5d32d80a3073491464.jpg\" alt></p>\n<h2 id=\"高通滤波器\"><a href=\"#高通滤波器\" class=\"headerlink\" title=\"高通滤波器\"></a>高通滤波器</h2><p>图像的锐化可以在频率与通过高通滤波器来实现<br>一个高通滤波器可以由一个低通滤波器来实现:<br>$$H_{HP}(u,v)=1-H_{LP}(u,v)$$<br>被低通滤波器衰减的频率可以通过高通滤波器</p>\n<h3 id=\"理想高通滤波器\"><a href=\"#理想高通滤波器\" class=\"headerlink\" title=\"理想高通滤波器\"></a>理想高通滤波器</h3><p>二维理想高通滤波器可以定义为<br>$$ H(u,v)=\\begin{cases}<br>1,\\quad D(u,v)\\leq D_0\\<br>0,\\quad D(u,v)&gt;D_0<br>\\end{cases}<br>$$<br><img src=\"https://i.loli.net/2019/07/21/5d341bf1c410443073.jpg\" alt></p>\n<h3 id=\"布特沃斯高通滤波器\"><a href=\"#布特沃斯高通滤波器\" class=\"headerlink\" title=\"布特沃斯高通滤波器\"></a>布特沃斯高通滤波器</h3><p>截止频率为$D_0$的n阶布特沃斯高通滤波器(BHPF)的定义为:<br>$$ H(u,v)=\\frac{1}{1+[D_0/D(u,v)]^{2n}}$$<br><img src=\"https://i.loli.net/2019/07/21/5d341bf1c376281237.jpg\" alt></p>\n<h3 id=\"高斯高通滤波器\"><a href=\"#高斯高通滤波器\" class=\"headerlink\" title=\"高斯高通滤波器\"></a>高斯高通滤波器</h3><p>截止频率处在距频率矩形中心距离为$D_0$的高斯高通滤波器(GHPF)的传递函数如下:<br>$$H(u,v)=1-e^{-D^2(u,v)/2D_0^2}$$<br><img src=\"https://i.loli.net/2019/07/21/5d341bf1c3f7954220.jpg\" alt></p>\n<h3 id=\"使用高通滤波器锐化图像\"><a href=\"#使用高通滤波器锐化图像\" class=\"headerlink\" title=\"使用高通滤波器锐化图像\"></a>使用高通滤波器锐化图像</h3><p>使用高通滤波器来锐化图像，与平滑图像类似，只是将低通滤波器换成了高通滤波器，具体步骤不再赘述</p>\n<pre><code class=\"matlab\">f = imread(&#39;1.jpg&#39;);\nf = rgb2gray(f);\n[f, revertclass] = tofloat(f);\nPQ = paddedsize(size(f));\n[U, V] = dftuv(PQ(1), PQ(2));\nD = hypot(U, V);\nD0 = 0.05*PQ(1);\nF = fft2(f, PQ(1), PQ(2));\nH = hpfilter(&#39;gaussian&#39;,PQ(1), PQ(2), D0);\ng = dftfilt(f, H);\ng = revertclass(g);\nfigure(1)\nsubplot(2,2,1);\nimshow(f,[]);\ntitle(&#39;原图像&#39;)\nsubplot(2,2,2);\nimshow(fftshift(H));\ntitle(&#39;高斯高通滤波器&#39;);\nsubplot(2,2,3);\nimshow(log(1 + abs(fftshift(F))), [])\ntitle(&#39;滤波后图像谱&#39;);\nsubplot(2,2,4);\nimshow(g);\ntitle(&#39;滤波后图像&#39;);</code></pre>\n<p>同样这里需要的是高通滤波函数hpfilter()</p>\n<pre><code class=\"matlab\">function [H] = hpfilter(type,M,N,D0,n)\n%HPFILTER Computes freq. domain highpass filters\n%        THIS IS NOT A STANDARD MATLAB FUNCTION\n%        H = hpfilter (type,M,N,D0,n) creates the\n%        transfer function of a highpass filter, H, of\n%        the specified type and size MxN. Possible\n%        values for type, D0, and n are:\n%\n%        &#39;ideal&#39;                Ideal highpass filter with\n%                        cutoff frequency D0. If\n%                        supplied, n is ignored.\n%        &#39;btw&#39;                Butterworth highpass filter\n%                        of order n, and cutoff D0.\n%        &#39;gaussn&#39;            Gaussian highpass filter with\n%                        cutoff (standard deviation)D0.\n%                        If supplied, n is ignored.\n%        M and N should be even numbers for DFT\n%        filtering.\n%\n%        Class support: double, uint8, uint16\n%        The output is of class double\n\n%       The transfer function Hhp of a highpass filter\n%       is 1 - Hlp, where Hlp is the transfer function of\n%       the corresponding lowpass filter.  Thus, we can\n%       use function lpfilter to generate highpass filters\n\n%       If filter is btw, make sure that n is provided\n%       Otherwise, pass n=1 as an arbitrary value to\n%       prevent error message\n\nif nargin == 4\n    n = 1; %default value of n\nend\n\nHlp = lpfilter(type,M,N,D0,n);\nH = 1 - Hlp;\n\n%       End of function</code></pre>\n<p>锐化结果:</p>\n<ol>\n<li>IHPF<br><img src=\"https://i.loli.net/2019/07/21/5d341eae3a6b123891.jpg\" alt></li>\n<li>BHPF<br><img src=\"https://i.loli.net/2019/07/21/5d341bf1f13e453488.jpg\" alt></li>\n<li>GHPF<br><img src=\"https://i.loli.net/2019/07/21/5d341eae4fa8d96779.jpg\" alt></li>\n</ol>\n"}],"PostAsset":[{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/19.png","slug":"19.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Vim/vim.gif","slug":"vim.gif","post":"ck70cp0ti001v74ju9iq0plt0","modified":0,"renderable":0},{"_id":"source/_posts/About-Proxy/3.png","slug":"3.png","post":"ck70cp0sd000774juhkjworx0","modified":0,"renderable":0},{"_id":"source/_posts/Bilibili-Evolved/1.png","slug":"1.png","post":"ck70cp0sp000d74ju7wuw0k3s","modified":0,"renderable":0},{"_id":"source/_posts/Bilibili-Evolved/2.png","slug":"2.png","post":"ck70cp0sp000d74ju7wuw0k3s","modified":0,"renderable":0},{"_id":"source/_posts/Bilibili-Evolved/3.png","slug":"3.png","post":"ck70cp0sp000d74ju7wuw0k3s","modified":0,"renderable":0},{"_id":"source/_posts/Enjoy-PyTorch-Task1/1.png","slug":"1.png","post":"ck70cp0sv000g74jukv5uesns","modified":0,"renderable":0},{"_id":"source/_posts/Enjoy-PyTorch/1.png","slug":"1.png","post":"ck70cp0t0000j74ju7b8ava4v","modified":0,"renderable":0},{"_id":"source/_posts/PCA算法实现/01.png","slug":"01.png","post":"ck70cp0tf001o74jug5fdjm8t","modified":0,"renderable":0},{"_id":"source/_posts/PCA算法实现/02.png","slug":"02.png","post":"ck70cp0tf001o74jug5fdjm8t","modified":0,"renderable":0},{"_id":"source/_posts/SORT/BUBBLE_SORT.gif","slug":"BUBBLE_SORT.gif","post":"ck70cp0tg001r74jumzscsu3w","modified":0,"renderable":0},{"_id":"source/_posts/SORT/INSERTION_SORT.gif","slug":"INSERTION_SORT.gif","post":"ck70cp0tg001r74jumzscsu3w","modified":0,"renderable":0},{"_id":"source/_posts/SORT/MERGE_SORT.gif","slug":"MERGE_SORT.gif","post":"ck70cp0tg001r74jumzscsu3w","modified":0,"renderable":0},{"_id":"source/_posts/SORT/SELECT_SORT.gif","slug":"SELECT_SORT.gif","post":"ck70cp0tg001r74jumzscsu3w","modified":0,"renderable":0},{"_id":"source/_posts/Vim/0.jpg","slug":"0.jpg","post":"ck70cp0ti001v74ju9iq0plt0","modified":0,"renderable":0},{"_id":"source/_posts/Vim/colemak.png","slug":"colemak.png","post":"ck70cp0ti001v74ju9iq0plt0","modified":0,"renderable":0},{"_id":"source/_posts/Vim/vim_cheat_sheet.png","slug":"vim_cheat_sheet.png","post":"ck70cp0ti001v74ju9iq0plt0","modified":0,"renderable":0},{"_id":"source/_posts/Face-Recognition-with-OpenCV/1.png","slug":"1.png","post":"ck70cp0t2000q74jukkrx91ez","modified":0,"renderable":0},{"_id":"source/_posts/Face-Recognition-with-OpenCV/2.png","slug":"2.png","post":"ck70cp0t2000q74jukkrx91ez","modified":0,"renderable":0},{"_id":"source/_posts/Face-Recognition-with-OpenCV/4.jpg","slug":"4.jpg","post":"ck70cp0t2000q74jukkrx91ez","modified":0,"renderable":0},{"_id":"source/_posts/Face-Recognition-with-OpenCV/5.png","slug":"5.png","post":"ck70cp0t2000q74jukkrx91ez","modified":0,"renderable":0},{"_id":"source/_posts/Face-Recognition-with-OpenCV/6.png","slug":"6.png","post":"ck70cp0t2000q74jukkrx91ez","modified":0,"renderable":0},{"_id":"source/_posts/Face-Recognition-with-OpenCV/7.jpg","slug":"7.jpg","post":"ck70cp0t2000q74jukkrx91ez","modified":0,"renderable":0},{"_id":"source/_posts/Face-Recognition-with-OpenCV/att_faces.zip","slug":"att_faces.zip","post":"ck70cp0t2000q74jukkrx91ez","modified":0,"renderable":0},{"_id":"source/_posts/PCA原理分析/01.png","slug":"01.png","post":"ck70cp0te001m74jumo69b3ho","modified":0,"renderable":0},{"_id":"source/_posts/PCA原理分析/02.png","slug":"02.png","post":"ck70cp0te001m74jumo69b3ho","modified":0,"renderable":0},{"_id":"source/_posts/PCA原理分析/03.png","slug":"03.png","post":"ck70cp0te001m74jumo69b3ho","modified":0,"renderable":0},{"_id":"source/_posts/PCA原理分析/05.png","slug":"05.png","post":"ck70cp0te001m74jumo69b3ho","modified":0,"renderable":0},{"_id":"source/_posts/PCA原理分析/06.png","slug":"06.png","post":"ck70cp0te001m74jumo69b3ho","modified":0,"renderable":0},{"_id":"source/_posts/PCA原理分析/07.png","slug":"07.png","post":"ck70cp0te001m74jumo69b3ho","modified":0,"renderable":0},{"_id":"source/_posts/PCA原理分析/PCA.pdf","slug":"PCA.pdf","post":"ck70cp0te001m74jumo69b3ho","modified":0,"renderable":0},{"_id":"source/_posts/Bilibili-Evolved/0.svg","slug":"0.svg","post":"ck70cp0sp000d74ju7wuw0k3s","modified":0,"renderable":0},{"_id":"source/_posts/Bilibili-Evolved/4.png","slug":"4.png","post":"ck70cp0sp000d74ju7wuw0k3s","modified":0,"renderable":0},{"_id":"source/_posts/Bilibili-Evolved/5.png","slug":"5.png","post":"ck70cp0sp000d74ju7wuw0k3s","modified":0,"renderable":0},{"_id":"source/_posts/Bilibili-Evolved/6.png","slug":"6.png","post":"ck70cp0sp000d74ju7wuw0k3s","modified":0,"renderable":0},{"_id":"source/_posts/Bilibili-Evolved/7.png","slug":"7.png","post":"ck70cp0sp000d74ju7wuw0k3s","modified":0,"renderable":0},{"_id":"source/_posts/About-Proxy/1.png","slug":"1.png","post":"ck70cp0sd000774juhkjworx0","modified":0,"renderable":0},{"_id":"source/_posts/About-Proxy/2.png","slug":"2.png","post":"ck70cp0sd000774juhkjworx0","modified":0,"renderable":0},{"_id":"source/_posts/About-Proxy/4.png","slug":"4.png","post":"ck70cp0sd000774juhkjworx0","modified":0,"renderable":0},{"_id":"source/_posts/About-Proxy/5.png","slug":"5.png","post":"ck70cp0sd000774juhkjworx0","modified":0,"renderable":0},{"_id":"source/_posts/About-Proxy/6.png","slug":"6.png","post":"ck70cp0sd000774juhkjworx0","modified":0,"renderable":0},{"_id":"source/_posts/About-Proxy/7.png","slug":"7.png","post":"ck70cp0sd000774juhkjworx0","modified":0,"renderable":0},{"_id":"source/_posts/About-Proxy/8.png","slug":"8.png","post":"ck70cp0sd000774juhkjworx0","modified":0,"renderable":0},{"_id":"source/_posts/About-Proxy/9.png","slug":"9.png","post":"ck70cp0sd000774juhkjworx0","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/17.png","slug":"17.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Anaconda/0.jpeg","slug":"0.jpeg","post":"ck70cp0sk000a74juz6n971kp","modified":0,"renderable":0},{"_id":"source/_posts/Anaconda/00.jpg","slug":"00.jpg","post":"ck70cp0sk000a74juz6n971kp","modified":0,"renderable":0},{"_id":"source/_posts/Anaconda/1.png","slug":"1.png","post":"ck70cp0sk000a74juz6n971kp","modified":0,"renderable":0},{"_id":"source/_posts/Anaconda/10.png","slug":"10.png","post":"ck70cp0sk000a74juz6n971kp","modified":0,"renderable":0},{"_id":"source/_posts/Anaconda/2.png","slug":"2.png","post":"ck70cp0sk000a74juz6n971kp","modified":0,"renderable":0},{"_id":"source/_posts/Anaconda/3.png","slug":"3.png","post":"ck70cp0sk000a74juz6n971kp","modified":0,"renderable":0},{"_id":"source/_posts/Anaconda/4.png","slug":"4.png","post":"ck70cp0sk000a74juz6n971kp","modified":0,"renderable":0},{"_id":"source/_posts/Anaconda/5.png","slug":"5.png","post":"ck70cp0sk000a74juz6n971kp","modified":0,"renderable":0},{"_id":"source/_posts/Anaconda/6.png","slug":"6.png","post":"ck70cp0sk000a74juz6n971kp","modified":0,"renderable":0},{"_id":"source/_posts/Anaconda/7.png","slug":"7.png","post":"ck70cp0sk000a74juz6n971kp","modified":0,"renderable":0},{"_id":"source/_posts/Anaconda/8.png","slug":"8.png","post":"ck70cp0sk000a74juz6n971kp","modified":0,"renderable":0},{"_id":"source/_posts/Anaconda/9.png","slug":"9.png","post":"ck70cp0sk000a74juz6n971kp","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/1.png","slug":"1.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/10.png","slug":"10.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/11.png","slug":"11.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/12.png","slug":"12.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/2.png","slug":"2.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/3.png","slug":"3.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/4.png","slug":"4.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/5.png","slug":"5.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/6.png","slug":"6.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/7.png","slug":"7.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/8.png","slug":"8.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/9.png","slug":"9.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/albert.png","slug":"albert.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/main.png","slug":"main.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Arch-Linux/music.png","slug":"music.png","post":"ck70cp0s9000574ju0n4l3s0j","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/1.png","slug":"1.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/10.png","slug":"10.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/11.png","slug":"11.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/12.png","slug":"12.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/13.png","slug":"13.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/14.png","slug":"14.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/15.png","slug":"15.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/16.png","slug":"16.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/18.png","slug":"18.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/2.png","slug":"2.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/20.png","slug":"20.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/3.png","slug":"3.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/4.png","slug":"4.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/5.png","slug":"5.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/6.png","slug":"6.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/7.png","slug":"7.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/8.png","slug":"8.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/9.png","slug":"9.png","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0},{"_id":"source/_posts/Manjaro-i3wm-环境配置篇/paper.jpg","slug":"paper.jpg","post":"ck70cp0t9001774ju2zamo4o1","modified":0,"renderable":0}],"PostCategory":[{"post_id":"ck70cp0sk000a74juz6n971kp","category_id":"ck70cp0sp000c74jub3erjy33","_id":"ck70cp0t2000n74ju2urz0qre"},{"post_id":"ck70cp0sp000d74ju7wuw0k3s","category_id":"ck70cp0sp000c74jub3erjy33","_id":"ck70cp0t4000s74ju0ihy6ghd"},{"post_id":"ck70cp0ss000f74juw30izqln","category_id":"ck70cp0t1000m74jum3s14tlj","_id":"ck70cp0t6000y74jui947a548"},{"post_id":"ck70cp0sv000g74jukv5uesns","category_id":"ck70cp0t4000t74ju545f9ani","_id":"ck70cp0t8001674juu1nc3udu"},{"post_id":"ck70cp0t0000j74ju7b8ava4v","category_id":"ck70cp0t4000t74ju545f9ani","_id":"ck70cp0tb001a74juuyn73zxf"},{"post_id":"ck70cp0t9001774ju2zamo4o1","category_id":"ck70cp0sp000c74jub3erjy33","_id":"ck70cp0td001f74juw3mk53qb"},{"post_id":"ck70cp0t1000l74ju3dz5awgk","category_id":"ck70cp0t8001574ju3g5w9vah","_id":"ck70cp0te001i74jup8wxeerk"},{"post_id":"ck70cp0ta001974juiehkuj41","category_id":"ck70cp0sp000c74jub3erjy33","_id":"ck70cp0tf001n74juo9dovsy2"},{"post_id":"ck70cp0t2000q74jukkrx91ez","category_id":"ck70cp0tb001b74jutip213e4","_id":"ck70cp0tg001p74juc3qnaoe3"},{"post_id":"ck70cp0td001h74ju6p3hh6a2","category_id":"ck70cp0sp000c74jub3erjy33","_id":"ck70cp0th001s74juumh2rokg"},{"post_id":"ck70cp0t4000v74ju9no20563","category_id":"ck70cp0te001j74judtt5mntj","_id":"ck70cp0ti001w74jusdcwa2se"},{"post_id":"ck70cp0t8001474judddgd7ta","category_id":"ck70cp0tg001q74ju190z86a7","_id":"ck70cp0tl002374ju1vyjq1hr"},{"post_id":"ck70cp0ti001v74ju9iq0plt0","category_id":"ck70cp0sp000c74jub3erjy33","_id":"ck70cp0tm002574ju9u0eqkej"},{"post_id":"ck70cp0tj001z74ju18fz74mv","category_id":"ck70cp0sp000c74jub3erjy33","_id":"ck70cp0tn002a74ju75gu1hum"},{"post_id":"ck70cp0te001m74jumo69b3ho","category_id":"ck70cp0tg001q74ju190z86a7","_id":"ck70cp0to002d74ju4g2x3bqr"},{"post_id":"ck70cp0tl002474jun49b4hwr","category_id":"ck70cp0t1000m74jum3s14tlj","_id":"ck70cp0tp002h74judszmdcfo"},{"post_id":"ck70cp0tf001o74jug5fdjm8t","category_id":"ck70cp0tg001q74ju190z86a7","_id":"ck70cp0tq002l74jusn3t6wzw"},{"post_id":"ck70cp0to002b74juh1rhjj1t","category_id":"ck70cp0t1000m74jum3s14tlj","_id":"ck70cp0tr002p74juc41pbhrz"},{"post_id":"ck70cp0tg001r74jumzscsu3w","category_id":"ck70cp0tn002974juk4gzu9xn","_id":"ck70cp0ts002s74jukznlyj8u"},{"post_id":"ck70cp0tp002f74jur958wfar","category_id":"ck70cp0t1000m74jum3s14tlj","_id":"ck70cp0tt002w74junu264wrl"},{"post_id":"ck70cp0tq002j74ju7vgcoaki","category_id":"ck70cp0t1000m74jum3s14tlj","_id":"ck70cp0tu002y74juso9prldc"},{"post_id":"ck70cp0tr002n74ju8penhlsj","category_id":"ck70cp0tg001q74ju190z86a7","_id":"ck70cp0tu003174jukvk9ybh1"},{"post_id":"ck70cp0tn002774juaj1rmsbo","category_id":"ck70cp0tp002i74junvo9jsip","_id":"ck70cp0tu003374jun500x3eh"},{"post_id":"ck70cp0ts002q74jumfm0w731","category_id":"ck70cp0t1000m74jum3s14tlj","_id":"ck70cp0tu003574ju18hgzaaq"},{"post_id":"ck70cp0ts002t74juu78xepbf","category_id":"ck70cp0t1000m74jum3s14tlj","_id":"ck70cp0tv003874ju2no15gsj"}],"PostTag":[{"post_id":"ck70cp0s9000574ju0n4l3s0j","tag_id":"ck70cp0sh000874jurfu4239v","_id":"ck70cp0t0000k74ju0skxx951"},{"post_id":"ck70cp0s9000574ju0n4l3s0j","tag_id":"ck70cp0sq000e74juunx6doio","_id":"ck70cp0t2000o74ju8yzzndxd"},{"post_id":"ck70cp0sk000a74juz6n971kp","tag_id":"ck70cp0sx000i74jumesi1jre","_id":"ck70cp0t5000w74jut45998cj"},{"post_id":"ck70cp0sk000a74juz6n971kp","tag_id":"ck70cp0t2000p74juzel9me6w","_id":"ck70cp0t6001074jutykesvpa"},{"post_id":"ck70cp0sn000b74juah2ndrjd","tag_id":"ck70cp0t4000u74juwrjb3pnp","_id":"ck70cp0t7001374juqom2fhwj"},{"post_id":"ck70cp0sp000d74ju7wuw0k3s","tag_id":"ck70cp0t7001274jubumohxli","_id":"ck70cp0td001g74juak73kb7p"},{"post_id":"ck70cp0sp000d74ju7wuw0k3s","tag_id":"ck70cp0ta001874junf950ymd","_id":"ck70cp0te001k74jusn794kto"},{"post_id":"ck70cp0ss000f74juw30izqln","tag_id":"ck70cp0tc001d74juyeyx1scc","_id":"ck70cp0th001u74juor6k68a5"},{"post_id":"ck70cp0ss000f74juw30izqln","tag_id":"ck70cp0te001l74jur70vcy9x","_id":"ck70cp0tj001y74ju0nq3bfii"},{"post_id":"ck70cp0sv000g74jukv5uesns","tag_id":"ck70cp0th001t74ju0lnsxusl","_id":"ck70cp0tn002874ju9vhhv7w5"},{"post_id":"ck70cp0sv000g74jukv5uesns","tag_id":"ck70cp0tk002074juu8ci7ska","_id":"ck70cp0to002c74ju499gagtp"},{"post_id":"ck70cp0tl002474jun49b4hwr","tag_id":"ck70cp0tc001d74juyeyx1scc","_id":"ck70cp0tp002g74juqk17yrn8"},{"post_id":"ck70cp0tl002474jun49b4hwr","tag_id":"ck70cp0te001l74jur70vcy9x","_id":"ck70cp0tq002k74jufqlwm0n0"},{"post_id":"ck70cp0tp002f74jur958wfar","tag_id":"ck70cp0tc001d74juyeyx1scc","_id":"ck70cp0tr002o74jurltgdngp"},{"post_id":"ck70cp0tp002f74jur958wfar","tag_id":"ck70cp0te001l74jur70vcy9x","_id":"ck70cp0ts002r74jumkc4o8rf"},{"post_id":"ck70cp0t0000j74ju7b8ava4v","tag_id":"ck70cp0th001t74ju0lnsxusl","_id":"ck70cp0tt002v74jum0oaoypd"},{"post_id":"ck70cp0t0000j74ju7b8ava4v","tag_id":"ck70cp0to002e74ju20j2qso5","_id":"ck70cp0tu002x74juf1c5siov"},{"post_id":"ck70cp0tq002j74ju7vgcoaki","tag_id":"ck70cp0tc001d74juyeyx1scc","_id":"ck70cp0tu003074ju7lwmflr7"},{"post_id":"ck70cp0tq002j74ju7vgcoaki","tag_id":"ck70cp0te001l74jur70vcy9x","_id":"ck70cp0tu003274jubyxhquoq"},{"post_id":"ck70cp0tr002n74ju8penhlsj","tag_id":"ck70cp0tc001d74juyeyx1scc","_id":"ck70cp0tu003474juyqouayu7"},{"post_id":"ck70cp0tr002n74ju8penhlsj","tag_id":"ck70cp0te001l74jur70vcy9x","_id":"ck70cp0tv003774jueu8zs95n"},{"post_id":"ck70cp0ts002q74jumfm0w731","tag_id":"ck70cp0tc001d74juyeyx1scc","_id":"ck70cp0tv003974jujxhmcthx"},{"post_id":"ck70cp0ts002q74jumfm0w731","tag_id":"ck70cp0te001l74jur70vcy9x","_id":"ck70cp0tv003b74july6lj67y"},{"post_id":"ck70cp0ts002t74juu78xepbf","tag_id":"ck70cp0tc001d74juyeyx1scc","_id":"ck70cp0tv003c74juvm1sxdfa"},{"post_id":"ck70cp0ts002t74juu78xepbf","tag_id":"ck70cp0te001l74jur70vcy9x","_id":"ck70cp0tv003e74jub3oes0fb"},{"post_id":"ck70cp0t1000l74ju3dz5awgk","tag_id":"ck70cp0tq002m74jurckqu1ny","_id":"ck70cp0tv003f74juvu6ily5f"},{"post_id":"ck70cp0t1000l74ju3dz5awgk","tag_id":"ck70cp0tt002u74juexxgb7ep","_id":"ck70cp0tw003h74jubcdq4mre"},{"post_id":"ck70cp0t1000l74ju3dz5awgk","tag_id":"ck70cp0tu002z74jubus8dx7j","_id":"ck70cp0tw003i74ju6wtxl0wl"},{"post_id":"ck70cp0t2000q74jukkrx91ez","tag_id":"ck70cp0tt002u74juexxgb7ep","_id":"ck70cp0tw003k74jumse9mavu"},{"post_id":"ck70cp0t2000q74jukkrx91ez","tag_id":"ck70cp0tv003a74jupahybkun","_id":"ck70cp0tw003l74ju7r4uelwp"},{"post_id":"ck70cp0t2000q74jukkrx91ez","tag_id":"ck70cp0tu002z74jubus8dx7j","_id":"ck70cp0tw003n74ju4u61vpym"},{"post_id":"ck70cp0t2000q74jukkrx91ez","tag_id":"ck70cp0tw003g74judj09nna4","_id":"ck70cp0tw003o74juzevgxqhz"},{"post_id":"ck70cp0t3000r74juwv7jld9d","tag_id":"ck70cp0tw003j74jujn9hvmda","_id":"ck70cp0tx003q74ju3utd1hoz"},{"post_id":"ck70cp0t3000r74juwv7jld9d","tag_id":"ck70cp0tw003m74juzlwtqn3b","_id":"ck70cp0tx003r74ju9e8bf2zm"},{"post_id":"ck70cp0t4000v74ju9no20563","tag_id":"ck70cp0tc001d74juyeyx1scc","_id":"ck70cp0ty003w74ju6lfof73a"},{"post_id":"ck70cp0t4000v74ju9no20563","tag_id":"ck70cp0te001l74jur70vcy9x","_id":"ck70cp0ty003x74jux1wy1to6"},{"post_id":"ck70cp0t4000v74ju9no20563","tag_id":"ck70cp0tt002u74juexxgb7ep","_id":"ck70cp0ty003z74ju64ci9n1r"},{"post_id":"ck70cp0t4000v74ju9no20563","tag_id":"ck70cp0tu002z74jubus8dx7j","_id":"ck70cp0ty004074jut77iziwy"},{"post_id":"ck70cp0t8001474judddgd7ta","tag_id":"ck70cp0tc001d74juyeyx1scc","_id":"ck70cp0tz004374juj2znzl0i"},{"post_id":"ck70cp0t8001474judddgd7ta","tag_id":"ck70cp0ty003y74ju4yq3hc9l","_id":"ck70cp0tz004474jum9hasulk"},{"post_id":"ck70cp0t8001474judddgd7ta","tag_id":"ck70cp0tu002z74jubus8dx7j","_id":"ck70cp0tz004674ju5uyh1gka"},{"post_id":"ck70cp0t9001774ju2zamo4o1","tag_id":"ck70cp0tz004274junmfktgjj","_id":"ck70cp0u0004874jud6kaft90"},{"post_id":"ck70cp0t9001774ju2zamo4o1","tag_id":"ck70cp0tz004574jue1t2pe01","_id":"ck70cp0u0004974ju8w2b0kri"},{"post_id":"ck70cp0ta001974juiehkuj41","tag_id":"ck70cp0tz004774jun4n0nnqb","_id":"ck70cp0u0004b74judrwqivk2"},{"post_id":"ck70cp0tc001e74ju87ina0ik","tag_id":"ck70cp0u0004a74jujb832jy3","_id":"ck70cp0u1004d74jube5vhmgk"},{"post_id":"ck70cp0td001h74ju6p3hh6a2","tag_id":"ck70cp0tt002u74juexxgb7ep","_id":"ck70cp0u1004f74ju731i8jwm"},{"post_id":"ck70cp0te001m74jumo69b3ho","tag_id":"ck70cp0u1004e74juimpedra4","_id":"ck70cp0u2004h74juk3ae8fu0"},{"post_id":"ck70cp0tf001o74jug5fdjm8t","tag_id":"ck70cp0tc001d74juyeyx1scc","_id":"ck70cp0u3004l74ju9csa2ud6"},{"post_id":"ck70cp0tf001o74jug5fdjm8t","tag_id":"ck70cp0u1004e74juimpedra4","_id":"ck70cp0u3004m74ju2kw2ium8"},{"post_id":"ck70cp0tf001o74jug5fdjm8t","tag_id":"ck70cp0tt002u74juexxgb7ep","_id":"ck70cp0u3004o74judn6fowp0"},{"post_id":"ck70cp0tf001o74jug5fdjm8t","tag_id":"ck70cp0tu002z74jubus8dx7j","_id":"ck70cp0u3004p74ju5cte4k31"},{"post_id":"ck70cp0tg001r74jumzscsu3w","tag_id":"ck70cp0tw003g74judj09nna4","_id":"ck70cp0u4004r74juyvdwk896"},{"post_id":"ck70cp0ti001v74ju9iq0plt0","tag_id":"ck70cp0u3004n74jut50yxbl7","_id":"ck70cp0u4004t74ju4701ttd6"},{"post_id":"ck70cp0ti001v74ju9iq0plt0","tag_id":"ck70cp0u3004q74ju0a8ny6gb","_id":"ck70cp0u4004u74juchkwc52o"},{"post_id":"ck70cp0tj001z74ju18fz74mv","tag_id":"ck70cp0u4004s74ju5fontro1","_id":"ck70cp0u4004w74jul33a95p6"},{"post_id":"ck70cp0tn002774juaj1rmsbo","tag_id":"ck70cp0tt002u74juexxgb7ep","_id":"ck70cp0u5004y74juu87o7gh9"},{"post_id":"ck70cp0to002b74juh1rhjj1t","tag_id":"ck70cp0tc001d74juyeyx1scc","_id":"ck70cp0u5005074juqgn4u5c7"},{"post_id":"ck70cp0to002b74juh1rhjj1t","tag_id":"ck70cp0tu002z74jubus8dx7j","_id":"ck70cp0u5005174jubpez7yog"},{"post_id":"ck70cp0to002b74juh1rhjj1t","tag_id":"ck70cp0tt002u74juexxgb7ep","_id":"ck70cp0u5005274juqw7wquc7"}],"Tag":[{"name":"Arch","_id":"ck70cp0sh000874jurfu4239v"},{"name":"linux","_id":"ck70cp0sq000e74juunx6doio"},{"name":"Python","_id":"ck70cp0sx000i74jumesi1jre"},{"name":"Anaconda3","_id":"ck70cp0t2000p74juzel9me6w"},{"name":"实习","_id":"ck70cp0t4000u74juwrjb3pnp"},{"name":"Bilibili.com","_id":"ck70cp0t7001274jubumohxli"},{"name":"Script","_id":"ck70cp0ta001874junf950ymd"},{"name":"图像处理","_id":"ck70cp0tc001d74juyeyx1scc"},{"name":"Matlab","_id":"ck70cp0te001l74jur70vcy9x"},{"name":"PyTorch","_id":"ck70cp0th001t74ju0lnsxusl"},{"name":"Deep Learning","_id":"ck70cp0tk002074juu8ci7ska"},{"name":"Deep Learing","_id":"ck70cp0to002e74ju20j2qso5"},{"name":"Face_Detection","_id":"ck70cp0tq002m74jurckqu1ny"},{"name":"OpenCV","_id":"ck70cp0tt002u74juexxgb7ep"},{"name":"c++","_id":"ck70cp0tu002z74jubus8dx7j"},{"name":"Face Recongnition","_id":"ck70cp0tv003a74jupahybkun"},{"name":"python","_id":"ck70cp0tw003g74judj09nna4"},{"name":"Git","_id":"ck70cp0tw003j74jujn9hvmda"},{"name":"Github","_id":"ck70cp0tw003m74juzlwtqn3b"},{"name":"LBP","_id":"ck70cp0ty003y74ju4yq3hc9l"},{"name":"Manjaro","_id":"ck70cp0tz004274junmfktgjj"},{"name":"i3wm","_id":"ck70cp0tz004574jue1t2pe01"},{"name":"Markdown","_id":"ck70cp0tz004774jun4n0nnqb"},{"name":"plan","_id":"ck70cp0u0004a74jujb832jy3"},{"name":"PCA","_id":"ck70cp0u1004e74juimpedra4"},{"name":"Vim","_id":"ck70cp0u3004n74jut50yxbl7"},{"name":"Linux","_id":"ck70cp0u3004q74ju0a8ny6gb"},{"name":"hexo","_id":"ck70cp0u4004s74ju5fontro1"}]}}